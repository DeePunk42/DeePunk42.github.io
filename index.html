<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
  <title>
    

    Whirling-In-Rags
  </title>

  
  <link rel="shortcut icon" href="/icon.svg">
  

  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  

  <!-- 字体 -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">

  
<link rel="stylesheet" href="/css/root.css">

  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/post.css">

<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <header class="header">
  <section class="header-container">
    <a class="logo" href="/">Whirling-In-Rags</a>
    <ul class="nav">
      
      <li><a href="/archives">archives</a></li>
      
      <li><a href="/about">about</a></li>
      
    </ul>
  </section>
</header>
  <main class="main">
    <div class="post-list">
  
  <section class="post-item">
    <a class="post-item-title" href="/2024/11/23/CVE-2024-38077%20(madlicense)%20reproduction/">CVE-2024-38077  Reproduction</a>
    <div class="post-item-summary">
      
Talk is cheap, show me your bomb

1. Vuln Analyze1.1 Call Stack # Child-SP          RetAddr               Call Site

00 000000b9`d2ffbd30 00007fff`67a76fec     lserver!CDataCoding::DecodeData
01 000000b9`d2ffbd70 00007fff`67a5c793     lser
      <a class="read-more" href="/2024/11/23/CVE-2024-38077%20(madlicense)%20reproduction/"> ... </a>
    </div>
    <div class="post-item-extra">
      <div class="date">2024.11.23</div>
      <div class="tags">
        
        <div class="tag-item">PWN</div>
        
        <div class="tag-item">windows</div>
        
        <div class="tag-item">rpc</div>
        
        <div class="tag-item">cve</div>
        
      </div>
    </div>
  </section>
  
  <section class="post-item">
    <a class="post-item-title" href="/2024/04/30/Geekctf2024-wp/">Geekctf2024-wp</a>
    <div class="post-item-summary">
      WriteUp for GeekCTF 2024DeePunk
2024-04-14 (Updated: 2024-04-30)
出题之余想打打比赛复健一下，没想到题目质量出奇的高，最后pwn方向第二
memo0换表base64，注意密文被动态解密过一次
memo1edit函数中读取v3类型为long long，随后与unsigned int idx进行有符号比较，最后转换为unsigned int 传入myread中。构造负数v3使其补码为想要的目标值即可达成栈溢出
1-1
      <a class="read-more" href="/2024/04/30/Geekctf2024-wp/"> ... </a>
    </div>
    <div class="post-item-extra">
      <div class="date">2024.04.30</div>
      <div class="tags">
        
        <div class="tag-item">PWN</div>
        
        <div class="tag-item">wp</div>
        
      </div>
    </div>
  </section>
  
  <section class="post-item">
    <a class="post-item-title" href="/2024/04/30/dl%E7%9B%B8%E5%85%B3%E6%94%BB%E5%87%BB/">dl相关攻击</a>
    <div class="post-item-summary">
      动态链接机制使用动态链接时，程序按模块拆分为多个独立部分，在程序运行时才链接在一起。linux中ELF动态链接文件称为动态共享对象(DSO)，以.so为拓展名。常用的C语言运行库glibc保存为libc.so。
链接的操作由动态链接器ld完成。运行时动态链接器与普通共享对象一同被映射到进程的地址空间，程序在运行时首先运行ld，完成所有动态链接工作后再转交主程序。
如果程序中存在跨模块的数据访问，由于目标变量的地址要在装载时才能确定，需要使得程序中的代码地址无关。于是把跟地址相
      <a class="read-more" href="/2024/04/30/dl%E7%9B%B8%E5%85%B3%E6%94%BB%E5%87%BB/"> ... </a>
    </div>
    <div class="post-item-extra">
      <div class="date">2024.04.30</div>
      <div class="tags">
        
        <div class="tag-item">PWN</div>
        
      </div>
    </div>
  </section>
  
  <section class="post-item">
    <a class="post-item-title" href="/2024/01/01/2023-%E5%9C%A8%E9%80%83%E7%A6%BB%E4%B9%8B%E5%90%8E/">2023 在逃离之后</a>
    <div class="post-item-summary">
      熬过了艰难的期末，终于有点精力写些想表达的东西。这种感觉一如高考完的那个暑假里，在迷茫中写写划划，企图在文字中找到一种力量感。之后的一年，过得像中学墙上的模范议论文，填满了字，读不出意思。即使在人生走马灯里，也是被”a few years later”一笔带过的水平。当然，好的故事总要学会在不该精彩的地方不精彩。正好前年的故事也忘讲了，那就从头讲起吧。
高考完的日子，一拨人忙着缅怀，一拨人忙着逃离。我理应也忙着逃离。但忍不住给喜欢的女生发了条消息，顺理成章地，让本就不太一帆风
      <a class="read-more" href="/2024/01/01/2023-%E5%9C%A8%E9%80%83%E7%A6%BB%E4%B9%8B%E5%90%8E/"> ... </a>
    </div>
    <div class="post-item-extra">
      <div class="date">2024.01.01</div>
      <div class="tags">
        
        <div class="tag-item">摸</div>
        
      </div>
    </div>
  </section>
  
  <section class="post-item">
    <a class="post-item-title" href="/2023/09/14/php-pwn/">A Brief Introduction to PHP Heap Exploitation</a>
    <div class="post-item-summary">
      It&#96;s my first time encountering this fancy pwn item, known as Web Pwn, on WACON2023. I have few experience on php coding, so it spent me a long time to figure out how ZendMM actually works.
The Memory Management of Zend EnginePHP codes 
      <a class="read-more" href="/2023/09/14/php-pwn/"> ... </a>
    </div>
    <div class="post-item-extra">
      <div class="date">2023.09.14</div>
      <div class="tags">
        
        <div class="tag-item">PWN</div>
        
        <div class="tag-item">wp</div>
        
        <div class="tag-item">PHP</div>
        
      </div>
    </div>
  </section>
  
  <section class="post-item">
    <a class="post-item-title" href="/2023/08/29/Tricks-of-Shellcode/">Tricks of Shellcode</a>
    <div class="post-item-summary">
      
最近打了挺多比赛，碰到一些比较有意思的题和方法

shellcode的题挺多，往往都是加了一些乱七八糟的限制。一般要么限制字符，要么开沙箱。限制字符基本上就通过手搓我不会或者alpha3之类的工具实现，这里讲一些绕过沙箱的办法。
切换架构题目不仅禁止getshell，甚至限制了orw，如果沙箱没有对系统架构进行检查，就可以使用切换架构的方式。
原理是沙箱通过检测系统调用号判断是否放行，而64位和32位架构下的系统调用号又不相同，切换到另一种架构，就能实现绕过黑名单检查
这种
      <a class="read-more" href="/2023/08/29/Tricks-of-Shellcode/"> ... </a>
    </div>
    <div class="post-item-extra">
      <div class="date">2023.08.29</div>
      <div class="tags">
        
        <div class="tag-item">PWN</div>
        
      </div>
    </div>
  </section>
  
  <section class="post-item">
    <a class="post-item-title" href="/2023/08/27/%E6%91%B8/">摸</a>
    <div class="post-item-summary">
      在电专摸了一年，不知不觉已经成了老油条的形状
大一整体处于一个比较迷茫的状态。开学时，机缘巧合下碰见了凝聚的招新赛，靠着热情冲了一个月，以pwn手的身份进入，随后就开始长达一个半学期的摸鱼期。期间或是卷分数（集电学院的风气懂的都懂），或是搞一些乱七八糟的比赛（也没有什么成绩），更多的时候，记忆缺失，大抵是在摸鱼罢
后来大一下，去了趟ASC的观摩，认识了一些凝聚的学长和Beetoven，还认识了南昌大学的cs佬。突然觉得，搞这些也挺有意思。此后开始参与更多凝聚的活动（并捡起所剩
      <a class="read-more" href="/2023/08/27/%E6%91%B8/"> ... </a>
    </div>
    <div class="post-item-extra">
      <div class="date">2023.08.27</div>
      <div class="tags">
        
        <div class="tag-item">摸</div>
        
      </div>
    </div>
  </section>
  
  <section class="post-item">
    <a class="post-item-title" href="/2023/08/12/SROP/">SROP初见杀-NepCTF2023</a>
    <div class="post-item-summary">
      这次比赛第一题就是很明显的SROP，正好啥也不会，学习了一下
SROPSROP全称为Sigreturn Oriented Programming，其攻击核心为通过伪造一个Signal Frame（以下简称sigFrame）在栈上，同时触发sigreturn系统调用，让内核为我们恢复一个sigFrame所描述的进程，如一个shell、一个wrtie系统调用打印栈地址等，同时通过对sigFrame中rsp和rip的修改，连接多个sigFrame，可通过多次触发sigreturn系
      <a class="read-more" href="/2023/08/12/SROP/"> ... </a>
    </div>
    <div class="post-item-extra">
      <div class="date">2023.08.12</div>
      <div class="tags">
        
        <div class="tag-item">PWN</div>
        
      </div>
    </div>
  </section>
  
  <section class="post-item">
    <a class="post-item-title" href="/2023/08/11/IOFILE-exploit/">IOFILE exploit</a>
    <div class="post-item-summary">
      序前段时间给人讲课，碰上了高版本glibc堆利用这部分。刚好自己啥也不会，于是花了些时间好好学了下IOFILE在高版本下的利用。好在最后没有翻车，自己在备课期间也独立完成了一些经典例题，算是有了一些粗浅的收获。现以一个初学者的目光重新梳理学习IOFILE利用的整个过程。
辅助手法IOFILE的利用，通常需要伪造IOFILE结构体，随后通过一些方式触发IO流，使得程序调用我们劫持后的IO函数，从而达成getshell或者orw。所以IOFILE exploit实际上是整个利用环
      <a class="read-more" href="/2023/08/11/IOFILE-exploit/"> ... </a>
    </div>
    <div class="post-item-extra">
      <div class="date">2023.08.11</div>
      <div class="tags">
        
        <div class="tag-item">PWN</div>
        
      </div>
    </div>
  </section>
  
  <section class="post-item">
    <a class="post-item-title" href="/2023/07/27/house-of-cat/">house of cat强网杯复现</a>
    <div class="post-item-summary">
      
最后一天的题，水水

逆向格式检查LOGIN | r00t QWBQWXFadmin
CAT | r00t QWBQWXF$\xff

功能分析addindex在0到15间
0x418&lt;&#x3D; size &lt;&#x3D;0x46f
使用calloc
deletUAF
showwrite 0x30
edit限制2次
每次只能修改0x30
攻击流程分析由于不存在对exit的调用，且在main函数中无限循环，故无法进行FSOP
可以采用house of kiwi的
      <a class="read-more" href="/2023/07/27/house-of-cat/"> ... </a>
    </div>
    <div class="post-item-extra">
      <div class="date">2023.07.27</div>
      <div class="tags">
        
        <div class="tag-item">PWN</div>
        
        <div class="tag-item">wp</div>
        
      </div>
    </div>
  </section>
  
</div>


<div class="paginator">
  <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">下一页</a>
</div>

  </main>
  <footer class="footer">
  
  <span>Copyright © 2021 deepunk</span>
  
</footer>
  
<script src="/js/theme.js"></script>

</body>

</html>